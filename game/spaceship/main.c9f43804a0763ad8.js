"use strict";(self.webpackChunkgame_spaceship=self.webpackChunkgame_spaceship||[]).push([[179],{116:()=>{function wt(n){return"function"==typeof n}function ac(n){const t=n(i=>{Error.call(i),i.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}const Sd=ac(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((i,r)=>`${r+1}) ${i.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t});function ta(n,e){if(n){const t=n.indexOf(e);0<=t&&n.splice(t,1)}}class Bn{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;const{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(const s of t)s.remove(this);else t.remove(this);const{initialTeardown:i}=this;if(wt(i))try{i()}catch(s){e=s instanceof Sd?s.errors:[s]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const s of r)try{ww(s)}catch(o){e=e??[],o instanceof Sd?e=[...e,...o.errors]:e.push(o)}}if(e)throw new Sd(e)}}add(e){var t;if(e&&e!==this)if(this.closed)ww(e);else{if(e instanceof Bn){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(t=this._finalizers)&&void 0!==t?t:[]).push(e)}}_hasParent(e){const{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){const{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){const{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&ta(t,e)}remove(e){const{_finalizers:t}=this;t&&ta(t,e),e instanceof Bn&&e._removeParent(this)}}Bn.EMPTY=(()=>{const n=new Bn;return n.closed=!0,n})();const yw=Bn.EMPTY;function bw(n){return n instanceof Bn||n&&"closed"in n&&wt(n.remove)&&wt(n.add)&&wt(n.unsubscribe)}function ww(n){wt(n)?n():n.unsubscribe()}const js={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},Md={setTimeout(n,e,...t){const{delegate:i}=Md;return i?.setTimeout?i.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){const{delegate:e}=Md;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function xw(n){Md.setTimeout(()=>{const{onUnhandledError:e}=js;if(!e)throw n;e(n)})}function Im(){}const MO=Pm("C",void 0,void 0);function Pm(n,e,t){return{kind:n,value:e,error:t}}let $s=null;function Ed(n){if(js.useDeprecatedSynchronousErrorHandling){const e=!$s;if(e&&($s={errorThrown:!1,error:null}),n(),e){const{errorThrown:t,error:i}=$s;if($s=null,t)throw i}}else n()}class Lm extends Bn{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,bw(e)&&e.add(this)):this.destination=IO}static create(e,t,i){return new lc(e,t,i)}next(e){this.isStopped?Nm(function AO(n){return Pm("N",n,void 0)}(e),this):this._next(e)}error(e){this.isStopped?Nm(function EO(n){return Pm("E",void 0,n)}(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?Nm(MO,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const TO=Function.prototype.bind;function Om(n,e){return TO.call(n,e)}class DO{constructor(e){this.partialObserver=e}next(e){const{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(i){Ad(i)}}error(e){const{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(i){Ad(i)}else Ad(e)}complete(){const{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){Ad(t)}}}class lc extends Lm{constructor(e,t,i){let r;if(super(),wt(e)||!e)r={next:e??void 0,error:t??void 0,complete:i??void 0};else{let s;this&&js.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),r={next:e.next&&Om(e.next,s),error:e.error&&Om(e.error,s),complete:e.complete&&Om(e.complete,s)}):r=e}this.destination=new DO(r)}}function Ad(n){js.useDeprecatedSynchronousErrorHandling?function CO(n){js.useDeprecatedSynchronousErrorHandling&&$s&&($s.errorThrown=!0,$s.error=n)}(n):xw(n)}function Nm(n,e){const{onStoppedNotification:t}=js;t&&Md.setTimeout(()=>t(n,e))}const IO={closed:!0,next:Im,error:function RO(n){throw n},complete:Im},Fm="function"==typeof Symbol&&Symbol.observable||"@@observable";function xs(n){return n}function Sw(n){return 0===n.length?xs:1===n.length?n[0]:function(t){return n.reduce((i,r)=>r(i),t)}}let Ht=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){const i=new n;return i.source=this,i.operator=t,i}subscribe(t,i,r){const s=function OO(n){return n&&n instanceof Lm||function LO(n){return n&&wt(n.next)&&wt(n.error)&&wt(n.complete)}(n)&&bw(n)}(t)?t:new lc(t,i,r);return Ed(()=>{const{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(i){t.error(i)}}forEach(t,i){return new(i=Mw(i))((r,s)=>{const o=new lc({next:a=>{try{t(a)}catch(l){s(l),o.unsubscribe()}},error:s,complete:r});this.subscribe(o)})}_subscribe(t){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(t)}[Fm](){return this}pipe(...t){return Sw(t)(this)}toPromise(t){return new(t=Mw(t))((i,r)=>{let s;this.subscribe(o=>s=o,o=>r(o),()=>i(s))})}}return n.create=e=>new n(e),n})();function Mw(n){var e;return null!==(e=n??js.Promise)&&void 0!==e?e:Promise}const NO=ac(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let zt=(()=>{class n extends Ht{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){const i=new Ew(this,this);return i.operator=t,i}_throwIfClosed(){if(this.closed)throw new NO}next(t){Ed(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const i of this.currentObservers)i.next(t)}})}error(t){Ed(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;const{observers:i}=this;for(;i.length;)i.shift().error(t)}})}complete(){Ed(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){const{hasError:i,isStopped:r,observers:s}=this;return i||r?yw:(this.currentObservers=null,s.push(t),new Bn(()=>{this.currentObservers=null,ta(s,t)}))}_checkFinalizedStatuses(t){const{hasError:i,thrownError:r,isStopped:s}=this;i?t.error(r):s&&t.complete()}asObservable(){const t=new Ht;return t.source=this,t}}return n.create=(e,t)=>new Ew(e,t),n})();class Ew extends zt{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===i||i.call(t,e)}error(e){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===i||i.call(t,e)}complete(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)}_subscribe(e){var t,i;return null!==(i=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==i?i:yw}}class si extends zt{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){const{hasError:e,thrownError:t,_value:i}=this;if(e)throw t;return this._throwIfClosed(),i}next(e){super.next(this._value=e)}}function Aw(n){return wt(n?.lift)}function on(n){return e=>{if(Aw(e))return e.lift(function(t){try{return n(t,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function Kt(n,e,t,i,r){return new FO(n,e,t,i,r)}class FO extends Lm{constructor(e,t,i,r,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=t?function(a){try{t(a)}catch(l){e.error(l)}}:super._next,this._error=r?function(a){try{r(a)}catch(l){e.error(l)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:t}=this;super.unsubscribe(),!t&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}}function Ot(n,e){return on((t,i)=>{let r=0;t.subscribe(Kt(i,s=>{i.next(n.call(e,s,r++))}))})}function Ss(n){return this instanceof Ss?(this.v=n,this):new Ss(n)}function Rw(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,e=n[Symbol.asyncIterator];return e?e.call(n):(n=function Vm(n){var e="function"==typeof Symbol&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&"number"==typeof n.length)return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(n),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(s){t[s]=n[s]&&function(o){return new Promise(function(a,l){!function r(s,o,a,l){Promise.resolve(l).then(function(c){s({value:c,done:a})},o)}(a,l,(o=n[s](o)).done,o.value)})}}}"function"==typeof SuppressedError&&SuppressedError;const Hm=n=>n&&"number"==typeof n.length&&"function"!=typeof n;function Iw(n){return wt(n?.then)}function Pw(n){return wt(n[Fm])}function Lw(n){return Symbol.asyncIterator&&wt(n?.[Symbol.asyncIterator])}function Ow(n){return new TypeError(`You provided ${null!==n&&"object"==typeof n?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const Nw=function rN(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function Fw(n){return wt(n?.[Nw])}function kw(n){return function Dw(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=t.apply(n,e||[]),s=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(h){i[h]&&(r[h]=function(f){return new Promise(function(p,_){s.push([h,f,p,_])>1||a(h,f)})})}function a(h,f){try{!function l(h){h.value instanceof Ss?Promise.resolve(h.value.v).then(c,u):d(s[0][2],h)}(i[h](f))}catch(p){d(s[0][3],p)}}function c(h){a("next",h)}function u(h){a("throw",h)}function d(h,f){h(f),s.shift(),s.length&&a(s[0][0],s[0][1])}}(this,arguments,function*(){const t=n.getReader();try{for(;;){const{value:i,done:r}=yield Ss(t.read());if(r)return yield Ss(void 0);yield yield Ss(i)}}finally{t.releaseLock()}})}function Uw(n){return wt(n?.getReader)}function oi(n){if(n instanceof Ht)return n;if(null!=n){if(Pw(n))return function sN(n){return new Ht(e=>{const t=n[Fm]();if(wt(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(n);if(Hm(n))return function oN(n){return new Ht(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}(n);if(Iw(n))return function aN(n){return new Ht(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,xw)})}(n);if(Lw(n))return Bw(n);if(Fw(n))return function lN(n){return new Ht(e=>{for(const t of n)if(e.next(t),e.closed)return;e.complete()})}(n);if(Uw(n))return function cN(n){return Bw(kw(n))}(n)}throw Ow(n)}function Bw(n){return new Ht(e=>{(function uN(n,e){var t,i,r,s;return function Cw(n,e,t,i){return new(t||(t=Promise))(function(s,o){function a(u){try{c(i.next(u))}catch(d){o(d)}}function l(u){try{c(i.throw(u))}catch(d){o(d)}}function c(u){u.done?s(u.value):function r(s){return s instanceof t?s:new t(function(o){o(s)})}(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})}(this,void 0,void 0,function*(){try{for(t=Rw(n);!(i=yield t.next()).done;)if(e.next(i.value),e.closed)return}catch(o){r={error:o}}finally{try{i&&!i.done&&(s=t.return)&&(yield s.call(t))}finally{if(r)throw r.error}}e.complete()})})(n,e).catch(t=>e.error(t))})}function Wr(n,e,t,i=0,r=!1){const s=e.schedule(function(){t(),r?n.add(this.schedule(null,i)):this.unsubscribe()},i);if(n.add(s),!r)return s}function Tn(n,e,t=1/0){return wt(e)?Tn((i,r)=>Ot((s,o)=>e(i,s,r,o))(oi(n(i,r))),t):("number"==typeof e&&(t=e),on((i,r)=>function dN(n,e,t,i,r,s,o,a){const l=[];let c=0,u=0,d=!1;const h=()=>{d&&!l.length&&!c&&e.complete()},f=_=>c<i?p(_):l.push(_),p=_=>{s&&e.next(_),c++;let g=!1;oi(t(_,u++)).subscribe(Kt(e,m=>{r?.(m),s?f(m):e.next(m)},()=>{g=!0},void 0,()=>{if(g)try{for(c--;l.length&&c<i;){const m=l.shift();o?Wr(e,o,()=>p(m)):p(m)}h()}catch(m){e.error(m)}}))};return n.subscribe(Kt(e,f,()=>{d=!0,h()})),()=>{a?.()}}(i,r,n,t)))}function na(n=1/0){return Tn(xs,n)}const pr=new Ht(n=>n.complete());function Vw(n){return n&&wt(n.schedule)}function zm(n){return n[n.length-1]}function cc(n){return Vw(zm(n))?n.pop():void 0}function Hw(n,e=0){return on((t,i)=>{t.subscribe(Kt(i,r=>Wr(i,n,()=>i.next(r),e),()=>Wr(i,n,()=>i.complete(),e),r=>Wr(i,n,()=>i.error(r),e)))})}function zw(n,e=0){return on((t,i)=>{i.add(n.schedule(()=>t.subscribe(i),e))})}function Gw(n,e){if(!n)throw new Error("Iterable cannot be null");return new Ht(t=>{Wr(t,e,()=>{const i=n[Symbol.asyncIterator]();Wr(t,e,()=>{i.next().then(r=>{r.done?t.complete():t.next(r.value)})},0,!0)})})}function Nn(n,e){return e?function bN(n,e){if(null!=n){if(Pw(n))return function mN(n,e){return oi(n).pipe(zw(e),Hw(e))}(n,e);if(Hm(n))return function _N(n,e){return new Ht(t=>{let i=0;return e.schedule(function(){i===n.length?t.complete():(t.next(n[i++]),t.closed||this.schedule())})})}(n,e);if(Iw(n))return function gN(n,e){return oi(n).pipe(zw(e),Hw(e))}(n,e);if(Lw(n))return Gw(n,e);if(Fw(n))return function vN(n,e){return new Ht(t=>{let i;return Wr(t,e,()=>{i=n[Nw](),Wr(t,e,()=>{let r,s;try{({value:r,done:s}=i.next())}catch(o){return void t.error(o)}s?t.complete():t.next(r)},0,!0)}),()=>wt(i?.return)&&i.return()})}(n,e);if(Uw(n))return function yN(n,e){return Gw(kw(n),e)}(n,e)}throw Ow(n)}(n,e):oi(n)}function Ww(...n){const e=cc(n),t=function pN(n,e){return"number"==typeof zm(n)?n.pop():e}(n,1/0),i=n;return i.length?1===i.length?oi(i[0]):na(t)(Nn(i,e)):pr}function $e(...n){return Nn(n,cc(n))}function jw(n={}){const{connector:e=(()=>new zt),resetOnError:t=!0,resetOnComplete:i=!0,resetOnRefCountZero:r=!0}=n;return s=>{let o,a,l,c=0,u=!1,d=!1;const h=()=>{a?.unsubscribe(),a=void 0},f=()=>{h(),o=l=void 0,u=d=!1},p=()=>{const _=o;f(),_?.unsubscribe()};return on((_,g)=>{c++,!d&&!u&&h();const m=l=l??e();g.add(()=>{c--,0===c&&!d&&!u&&(a=Gm(p,r))}),m.subscribe(g),!o&&c>0&&(o=new lc({next:v=>m.next(v),error:v=>{d=!0,h(),a=Gm(f,t,v),m.error(v)},complete:()=>{u=!0,h(),a=Gm(f,i),m.complete()}}),oi(_).subscribe(o))})(s)}}function Gm(n,e,...t){if(!0===e)return void n();if(!1===e)return;const i=new lc({next:()=>{i.unsubscribe(),n()}});return oi(e(...t)).subscribe(i)}function mr(n,e){return on((t,i)=>{let r=null,s=0,o=!1;const a=()=>o&&!r&&i.complete();t.subscribe(Kt(i,l=>{r?.unsubscribe();let c=0;const u=s++;oi(n(l,u)).subscribe(r=Kt(i,d=>i.next(e?e(l,d,u,c++):d),()=>{r=null,a()}))},()=>{o=!0,a()}))})}function $w(n,e=xs){return n=n??wN,on((t,i)=>{let r,s=!0;t.subscribe(Kt(i,o=>{const a=e(o);(s||!n(r,a))&&(s=!1,r=a,i.next(o))}))})}function wN(n,e){return n===e}function Pt(n){for(let e in n)if(n[e]===Pt)return e;throw Error("Could not find renamed property on target object.")}function Cd(n,e){for(const t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function wn(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(wn).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const e=n.toString();if(null==e)return""+e;const t=e.indexOf("\n");return-1===t?e:e.substring(0,t)}function Wm(n,e){return null==n||""===n?null===e?"":e:null==e||""===e?n:n+" "+e}const xN=Pt({__forward_ref__:Pt});function jm(n){return n.__forward_ref__=jm,n.toString=function(){return wn(this())},n}function Qe(n){return $m(n)?n():n}function $m(n){return"function"==typeof n&&n.hasOwnProperty(xN)&&n.__forward_ref__===jm}function Xm(n){return n&&!!n.\u0275providers}class he extends Error{constructor(e,t){super(function Td(n,e){return`NG0${Math.abs(n)}${e?": "+e:""}`}(e,t)),this.code=e}}function tt(n){return"string"==typeof n?n:null==n?"":String(n)}function Dd(n,e){throw new he(-201,!1)}function ki(n,e){null==n&&function Dt(n,e,t,i){throw new Error(`ASSERTION ERROR: ${n}`+(null==i?"":` [Expected=> ${t} ${i} ${e} <=Actual]`))}(e,n,null,"!=")}function Ee(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function Yn(n){return{providers:n.providers||[],imports:n.imports||[]}}function Rd(n){return qw(n,Id)||qw(n,Zw)}function qw(n,e){return n.hasOwnProperty(e)?n[e]:null}function Yw(n){return n&&(n.hasOwnProperty(qm)||n.hasOwnProperty(RN))?n[qm]:null}const Id=Pt({\u0275prov:Pt}),qm=Pt({\u0275inj:Pt}),Zw=Pt({ngInjectableDef:Pt}),RN=Pt({ngInjectorDef:Pt});var Ge=(()=>((Ge=Ge||{})[Ge.Default=0]="Default",Ge[Ge.Host=1]="Host",Ge[Ge.Self=2]="Self",Ge[Ge.SkipSelf=4]="SkipSelf",Ge[Ge.Optional=8]="Optional",Ge))();let Ym;function Kw(){return Ym}function ai(n){const e=Ym;return Ym=n,e}function Jw(n,e,t){const i=Rd(n);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:t&Ge.Optional?null:void 0!==e?e:void Dd(wn(n))}const kt=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),uc={},Zm="__NG_DI_FLAG__",Pd="ngTempTokenPath",PN=/\n/gm,Qw="__source";let ia;function Ms(n){const e=ia;return ia=n,e}function NN(n,e=Ge.Default){if(void 0===ia)throw new he(-203,!1);return null===ia?Jw(n,void 0,e):ia.get(n,e&Ge.Optional?null:void 0,e)}function te(n,e=Ge.Default){return(Kw()||NN)(Qe(n),e)}function _e(n,e=Ge.Default){return te(n,Ld(e))}function Ld(n){return typeof n>"u"||"number"==typeof n?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function Km(n){const e=[];for(let t=0;t<n.length;t++){const i=Qe(n[t]);if(Array.isArray(i)){if(0===i.length)throw new he(900,!1);let r,s=Ge.Default;for(let o=0;o<i.length;o++){const a=i[o],l=FN(a);"number"==typeof l?-1===l?r=a.token:s|=l:r=a}e.push(te(r,s))}else e.push(te(i))}return e}function dc(n,e){return n[Zm]=e,n.prototype[Zm]=e,n}function FN(n){return n[Zm]}function jr(n){return{toString:n}.toString()}var gr=(()=>((gr=gr||{})[gr.OnPush=0]="OnPush",gr[gr.Default=1]="Default",gr))(),Mi=(()=>{return(n=Mi||(Mi={}))[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",Mi;var n})();const _r={},Ct=[],Od=Pt({\u0275cmp:Pt}),Jm=Pt({\u0275dir:Pt}),Qm=Pt({\u0275pipe:Pt}),tx=Pt({\u0275mod:Pt}),$r=Pt({\u0275fac:Pt}),hc=Pt({__NG_ELEMENT_ID__:Pt}),nx=Pt({__NG_ENV_ID__:Pt});function ix(n,e,t){let i=n.length;for(;;){const r=n.indexOf(e,t);if(-1===r)return r;if(0===r||n.charCodeAt(r-1)<=32){const s=e.length;if(r+s===i||n.charCodeAt(r+s)<=32)return r}t=r+1}}function eg(n,e,t){let i=0;for(;i<t.length;){const r=t[i];if("number"==typeof r){if(0!==r)break;i++;const s=t[i++],o=t[i++],a=t[i++];n.setAttribute(e,o,a,s)}else{const s=r,o=t[++i];sx(s)?n.setProperty(e,s,o):n.setAttribute(e,s,o),i++}}return i}function rx(n){return 3===n||4===n||6===n}function sx(n){return 64===n.charCodeAt(0)}function fc(n,e){if(null!==e&&0!==e.length)if(null===n||0===n.length)n=e.slice();else{let t=-1;for(let i=0;i<e.length;i++){const r=e[i];"number"==typeof r?t=r:0===t||ox(n,t,r,null,-1===t||2===t?e[++i]:null)}}return n}function ox(n,e,t,i,r){let s=0,o=n.length;if(-1===e)o=-1;else for(;s<n.length;){const a=n[s++];if("number"==typeof a){if(a===e){o=-1;break}if(a>e){o=s-1;break}}}for(;s<n.length;){const a=n[s];if("number"==typeof a)break;if(a===t){if(null===i)return void(null!==r&&(n[s+1]=r));if(i===n[s+1])return void(n[s+2]=r)}s++,null!==i&&s++,null!==r&&s++}-1!==o&&(n.splice(o,0,e),s=o+1),n.splice(s++,0,t),null!==i&&n.splice(s++,0,i),null!==r&&n.splice(s++,0,r)}const ax="ng-template";function BN(n,e,t){let i=0,r=!0;for(;i<n.length;){let s=n[i++];if("string"==typeof s&&r){const o=n[i++];if(t&&"class"===s&&-1!==ix(o.toLowerCase(),e,0))return!0}else{if(1===s){for(;i<n.length&&"string"==typeof(s=n[i++]);)if(s.toLowerCase()===e)return!0;return!1}"number"==typeof s&&(r=!1)}}return!1}function lx(n){return 4===n.type&&n.value!==ax}function VN(n,e,t){return e===(4!==n.type||t?n.value:ax)}function HN(n,e,t){let i=4;const r=n.attrs||[],s=function WN(n){for(let e=0;e<n.length;e++)if(rx(n[e]))return e;return n.length}(r);let o=!1;for(let a=0;a<e.length;a++){const l=e[a];if("number"!=typeof l){if(!o)if(4&i){if(i=2|1&i,""!==l&&!VN(n,l,t)||""===l&&1===e.length){if(qi(i))return!1;o=!0}}else{const c=8&i?l:e[++a];if(8&i&&null!==n.attrs){if(!BN(n.attrs,c,t)){if(qi(i))return!1;o=!0}continue}const d=zN(8&i?"class":l,r,lx(n),t);if(-1===d){if(qi(i))return!1;o=!0;continue}if(""!==c){let h;h=d>s?"":r[d+1].toLowerCase();const f=8&i?h:null;if(f&&-1!==ix(f,c,0)||2&i&&c!==h){if(qi(i))return!1;o=!0}}}}else{if(!o&&!qi(i)&&!qi(l))return!1;if(o&&qi(l))continue;o=!1,i=l|1&i}}return qi(i)||o}function qi(n){return 0==(1&n)}function zN(n,e,t,i){if(null===e)return-1;let r=0;if(i||!t){let s=!1;for(;r<e.length;){const o=e[r];if(o===n)return r;if(3===o||6===o)s=!0;else{if(1===o||2===o){let a=e[++r];for(;"string"==typeof a;)a=e[++r];continue}if(4===o)break;if(0===o){r+=4;continue}}r+=s?1:2}return-1}return function jN(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){const i=n[t];if("number"==typeof i)return-1;if(i===e)return t;t++}return-1}(e,n)}function cx(n,e,t=!1){for(let i=0;i<e.length;i++)if(HN(n,e[i],t))return!0;return!1}function ux(n,e){return n?":not("+e.trim()+")":e}function XN(n){let e=n[0],t=1,i=2,r="",s=!1;for(;t<n.length;){let o=n[t];if("string"==typeof o)if(2&i){const a=n[++t];r+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else 8&i?r+="."+o:4&i&&(r+=" "+o);else""!==r&&!qi(o)&&(e+=ux(s,r),r=""),i=o,s=s||!qi(i);t++}return""!==r&&(e+=ux(s,r)),e}function qs(n){return jr(()=>{const e=hx(n),t={...e,decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===gr.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||Mi.Emulated,styles:n.styles||Ct,_:null,schemas:n.schemas||null,tView:null,id:""};fx(t);const i=n.dependencies;return t.directiveDefs=Nd(i,!1),t.pipeDefs=Nd(i,!0),t.id=function tF(n){let e=0;const t=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,n.consts,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery].join("|");for(const r of t)e=Math.imul(31,e)+r.charCodeAt(0)<<0;return e+=2147483648,"c"+e}(t),t})}function KN(n){return Rt(n)||Hn(n)}function JN(n){return null!==n}function li(n){return jr(()=>({type:n.type,bootstrap:n.bootstrap||Ct,declarations:n.declarations||Ct,imports:n.imports||Ct,exports:n.exports||Ct,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function dx(n,e){if(null==n)return _r;const t={};for(const i in n)if(n.hasOwnProperty(i)){let r=n[i],s=r;Array.isArray(r)&&(s=r[1],r=r[0]),t[r]=i,e&&(e[r]=s)}return t}function Vn(n){return jr(()=>{const e=hx(n);return fx(e),e})}function ci(n){return{type:n.type,name:n.name,factory:null,pure:!1!==n.pure,standalone:!0===n.standalone,onDestroy:n.type.prototype.ngOnDestroy||null}}function Rt(n){return n[Od]||null}function Hn(n){return n[Jm]||null}function ui(n){return n[Qm]||null}function Ei(n,e){const t=n[tx]||null;if(!t&&!0===e)throw new Error(`Type ${wn(n)} does not have '\u0275mod' property.`);return t}function hx(n){const e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:n.inputs||_r,exportAs:n.exportAs||null,standalone:!0===n.standalone,signals:!0===n.signals,selectors:n.selectors||Ct,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:dx(n.inputs,e),outputs:dx(n.outputs)}}function fx(n){n.features?.forEach(e=>e(n))}function Nd(n,e){if(!n)return null;const t=e?ui:KN;return()=>("function"==typeof n?n():n).map(i=>t(i)).filter(JN)}const xn=0,Me=1,it=2,jt=3,Yi=4,pc=5,zn=6,sa=7,an=8,oa=9,Ys=10,rt=11,mc=12,px=13,aa=14,ln=15,gc=16,la=17,vr=18,_c=19,mx=20,Es=21,Xr=22,Fd=23,kd=24,mt=25,tg=1,gx=2,yr=7,ca=9,Gn=11;function Ai(n){return Array.isArray(n)&&"object"==typeof n[tg]}function di(n){return Array.isArray(n)&&!0===n[tg]}function ng(n){return 0!=(4&n.flags)}function Zs(n){return n.componentOffset>-1}function Bd(n){return 1==(1&n.flags)}function Zi(n){return!!n.template}function ig(n){return 0!=(512&n[it])}function Ks(n,e){return n.hasOwnProperty($r)?n[$r]:null}let aF=kt.WeakRef??class oF{constructor(e){this.ref=e}deref(){return this.ref}},cF=0,br=null,Vd=!1;function Dn(n){const e=br;return br=n,e}class wx{constructor(){this.id=cF++,this.ref=function lF(n){return new aF(n)}(this),this.producers=new Map,this.consumers=new Map,this.trackingVersion=0,this.valueVersion=0}consumerPollProducersForChange(){for(const[e,t]of this.producers){const i=t.producerNode.deref();if(null!=i&&t.atTrackingVersion===this.trackingVersion){if(i.producerPollStatus(t.seenValueVersion))return!0}else this.producers.delete(e),i?.consumers.delete(this.id)}return!1}producerMayHaveChanged(){const e=Vd;Vd=!0;try{for(const[t,i]of this.consumers){const r=i.consumerNode.deref();null!=r&&r.trackingVersion===i.atTrackingVersion?r.onConsumerDependencyMayHaveChanged():(this.consumers.delete(t),r?.producers.delete(this.id))}}finally{Vd=e}}producerAccessed(){if(Vd)throw new Error("");if(null===br)return;let e=br.producers.get(this.id);void 0===e?(e={consumerNode:br.ref,producerNode:this.ref,seenValueVersion:this.valueVersion,atTrackingVersion:br.trackingVersion},br.producers.set(this.id,e),this.consumers.set(br.id,e)):(e.seenValueVersion=this.valueVersion,e.atTrackingVersion=br.trackingVersion)}get hasProducers(){return this.producers.size>0}get producerUpdatesAllowed(){return!1!==br?.consumerAllowSignalWrites}producerPollStatus(e){return this.valueVersion!==e||(this.onProducerUpdateValueVersion(),this.valueVersion!==e)}}let xx=null;function Sx(n){const e=Dn(null);try{return n()}finally{Dn(e)}}const Mx=()=>{};class fF extends wx{constructor(e,t,i){super(),this.watch=e,this.schedule=t,this.dirty=!1,this.cleanupFn=Mx,this.registerOnCleanup=r=>{this.cleanupFn=r},this.consumerAllowSignalWrites=i}notify(){this.dirty||this.schedule(this),this.dirty=!0}onConsumerDependencyMayHaveChanged(){this.notify()}onProducerUpdateValueVersion(){}run(){if(this.dirty=!1,0!==this.trackingVersion&&!this.consumerPollProducersForChange())return;const e=Dn(this);this.trackingVersion++;try{this.cleanupFn(),this.cleanupFn=Mx,this.watch(this.registerOnCleanup)}finally{Dn(e)}}cleanup(){this.cleanupFn()}}class pF{constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}isFirstChange(){return this.firstChange}}function Js(){return Ex}function Ex(n){return n.type.prototype.ngOnChanges&&(n.setInput=gF),mF}function mF(){const n=Cx(this),e=n?.current;if(e){const t=n.previous;if(t===_r)n.previous=e;else for(let i in e)t[i]=e[i];n.current=null,this.ngOnChanges(e)}}function gF(n,e,t,i){const r=this.declaredInputs[t],s=Cx(n)||function _F(n,e){return n[Ax]=e}(n,{previous:_r,current:null}),o=s.current||(s.current={}),a=s.previous,l=a[r];o[r]=new pF(l&&l.currentValue,e,a===_r),n[i]=e}Js.ngInherit=!0;const Ax="__ngSimpleChanges__";function Cx(n){return n[Ax]||null}const wr=function(n,e,t){};function Vt(n){for(;Array.isArray(n);)n=n[xn];return n}function Gd(n,e){return Vt(e[n])}function hi(n,e){return Vt(e[n.index])}function Rx(n,e){return n.data[e]}function Ci(n,e){const t=e[n];return Ai(t)?t:t[xn]}function As(n,e){return null==e?null:n[e]}function Ix(n){n[la]=0}function MF(n){1024&n[it]||(n[it]|=1024,Lx(n,1))}function Px(n){1024&n[it]&&(n[it]&=-1025,Lx(n,-1))}function Lx(n,e){let t=n[jt];if(null===t)return;t[pc]+=e;let i=t;for(t=t[jt];null!==t&&(1===e&&1===i[pc]||-1===e&&0===i[pc]);)t[pc]+=e,i=t,t=t[jt]}function Ox(n,e){if(256==(256&n[it]))throw new he(911,!1);null===n[Es]&&(n[Es]=[]),n[Es].push(e)}const qe={lFrame:$x(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function Fx(){return qe.bindingsEnabled}function ie(){return qe.lFrame.lView}function Mt(){return qe.lFrame.tView}function Fn(){let n=Bx();for(;null!==n&&64===n.type;)n=n.parent;return n}function Bx(){return qe.lFrame.currentTNode}function xr(n,e){const t=qe.lFrame;t.currentTNode=n,t.isParent=e}function cg(){return qe.lFrame.isParent}function ug(){qe.lFrame.isParent=!1}function ha(){return qe.lFrame.bindingIndex++}function Yr(n){const e=qe.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function FF(n,e){const t=qe.lFrame;t.bindingIndex=t.bindingRootIndex=n,dg(e)}function dg(n){qe.lFrame.currentDirectiveIndex=n}function Gx(){return qe.lFrame.currentQueryIndex}function fg(n){qe.lFrame.currentQueryIndex=n}function UF(n){const e=n[Me];return 2===e.type?e.declTNode:1===e.type?n[zn]:null}function Wx(n,e,t){if(t&Ge.SkipSelf){let r=e,s=n;for(;!(r=r.parent,null!==r||t&Ge.Host||(r=UF(s),null===r||(s=s[aa],10&r.type))););if(null===r)return!1;e=r,n=s}const i=qe.lFrame=jx();return i.currentTNode=e,i.lView=n,!0}function pg(n){const e=jx(),t=n[Me];qe.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function jx(){const n=qe.lFrame,e=null===n?null:n.child;return null===e?$x(n):e}function $x(n){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=e),e}function Xx(){const n=qe.lFrame;return qe.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const qx=Xx;function mg(){const n=Xx();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function Kn(){return qe.lFrame.selectedIndex}function Qs(n){qe.lFrame.selectedIndex=n}function $t(){const n=qe.lFrame;return Rx(n.tView,n.selectedIndex)}let Zx=!0;function Wd(){return Zx}function Cs(n){Zx=n}function jd(n,e){for(let t=e.directiveStart,i=e.directiveEnd;t<i;t++){const s=n.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:c,ngOnDestroy:u}=s;o&&(n.contentHooks??=[]).push(-t,o),a&&((n.contentHooks??=[]).push(t,a),(n.contentCheckHooks??=[]).push(t,a)),l&&(n.viewHooks??=[]).push(-t,l),c&&((n.viewHooks??=[]).push(t,c),(n.viewCheckHooks??=[]).push(t,c)),null!=u&&(n.destroyHooks??=[]).push(t,u)}}function $d(n,e,t){Kx(n,e,3,t)}function Xd(n,e,t,i){(3&n[it])===t&&Kx(n,e,t,i)}function gg(n,e){let t=n[it];(3&t)===e&&(t&=8191,t+=1,n[it]=t)}function Kx(n,e,t,i){const s=i??-1,o=e.length-1;let a=0;for(let l=void 0!==i?65535&n[la]:0;l<o;l++)if("number"==typeof e[l+1]){if(a=e[l],null!=i&&a>=i)break}else e[l]<0&&(n[la]+=65536),(a<s||-1==s)&&($F(n,t,e,l),n[la]=(4294901760&n[la])+l+2),l++}function Jx(n,e){wr(4,n,e);const t=Dn(null);try{e.call(n)}finally{Dn(t),wr(5,n,e)}}function $F(n,e,t,i){const r=t[i]<0,s=t[i+1],a=n[r?-t[i]:t[i]];r?n[it]>>13<n[la]>>16&&(3&n[it])===e&&(n[it]+=8192,Jx(a,s)):Jx(a,s)}const fa=-1;class bc{constructor(e,t,i){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=i}}function Qx(n){return n!==fa}function qd(n){return 32767&n}function Yd(n,e){let t=function ZF(n){return n>>16}(n),i=e;for(;t>0;)i=i[aa],t--;return i}let vg=!0;function Zd(n){const e=vg;return vg=n,e}const eS=255,tS=5;let KF=0;const Sr={};function Kd(n,e){const t=nS(n,e);if(-1!==t)return t;const i=e[Me];i.firstCreatePass&&(n.injectorIndex=e.length,yg(i.data,n),yg(e,null),yg(i.blueprint,null));const r=bg(n,e),s=n.injectorIndex;if(Qx(r)){const o=qd(r),a=Yd(r,e),l=a[Me].data;for(let c=0;c<8;c++)e[s+c]=a[o+c]|l[o+c]}return e[s+8]=r,s}function yg(n,e){n.push(0,0,0,0,0,0,0,0,e)}function nS(n,e){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===e[n.injectorIndex+8]?-1:n.injectorIndex}function bg(n,e){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let t=0,i=null,r=e;for(;null!==r;){if(i=uS(r),null===i)return fa;if(t++,r=r[aa],-1!==i.injectorIndex)return i.injectorIndex|t<<16}return fa}function wg(n,e,t){!function JF(n,e,t){let i;"string"==typeof t?i=t.charCodeAt(0)||0:t.hasOwnProperty(hc)&&(i=t[hc]),null==i&&(i=t[hc]=KF++);const r=i&eS;e.data[n+(r>>tS)]|=1<<r}(n,e,t)}function iS(n,e,t){if(t&Ge.Optional||void 0!==n)return n;Dd()}function rS(n,e,t,i){if(t&Ge.Optional&&void 0===i&&(i=null),!(t&(Ge.Self|Ge.Host))){const r=n[oa],s=ai(void 0);try{return r?r.get(e,i,t&Ge.Optional):Jw(e,i,t&Ge.Optional)}finally{ai(s)}}return iS(i,0,t)}function sS(n,e,t,i=Ge.Default,r){if(null!==n){if(2048&e[it]&&!(i&Ge.Self)){const o=function ik(n,e,t,i,r){let s=n,o=e;for(;null!==s&&null!==o&&2048&o[it]&&!(512&o[it]);){const a=oS(s,o,t,i|Ge.Self,Sr);if(a!==Sr)return a;let l=s.parent;if(!l){const c=o[mx];if(c){const u=c.get(t,Sr,i);if(u!==Sr)return u}l=uS(o),o=o[aa]}s=l}return r}(n,e,t,i,Sr);if(o!==Sr)return o}const s=oS(n,e,t,i,Sr);if(s!==Sr)return s}return rS(e,t,i,r)}function oS(n,e,t,i,r){const s=function tk(n){if("string"==typeof n)return n.charCodeAt(0)||0;const e=n.hasOwnProperty(hc)?n[hc]:void 0;return"number"==typeof e?e>=0?e&eS:nk:e}(t);if("function"==typeof s){if(!Wx(e,n,i))return i&Ge.Host?iS(r,0,i):rS(e,t,i,r);try{const o=s(i);if(null!=o||i&Ge.Optional)return o;Dd()}finally{qx()}}else if("number"==typeof s){let o=null,a=nS(n,e),l=fa,c=i&Ge.Host?e[ln][zn]:null;for((-1===a||i&Ge.SkipSelf)&&(l=-1===a?bg(n,e):e[a+8],l!==fa&&lS(i,!1)?(o=e[Me],a=qd(l),e=Yd(l,e)):a=-1);-1!==a;){const u=e[Me];if(aS(s,a,u.data)){const d=ek(a,e,t,o,i,c);if(d!==Sr)return d}l=e[a+8],l!==fa&&lS(i,e[Me].data[a+8]===c)&&aS(s,a,e)?(o=u,a=qd(l),e=Yd(l,e)):a=-1}}return r}function ek(n,e,t,i,r,s){const o=e[Me],a=o.data[n+8],u=Jd(a,o,t,null==i?Zs(a)&&vg:i!=o&&0!=(3&a.type),r&Ge.Host&&s===a);return null!==u?eo(e,o,u,a):Sr}function Jd(n,e,t,i,r){const s=n.providerIndexes,o=e.data,a=1048575&s,l=n.directiveStart,u=s>>20,h=r?a+u:n.directiveEnd;for(let f=i?a:a+u;f<h;f++){const p=o[f];if(f<l&&t===p||f>=l&&p.type===t)return f}if(r){const f=o[l];if(f&&Zi(f)&&f.type===t)return l}return null}function eo(n,e,t,i){let r=n[t];const s=e.data;if(function XF(n){return n instanceof bc}(r)){const o=r;o.resolving&&function SN(n,e){const t=e?`. Dependency path: ${e.join(" > ")} > ${n}`:"";throw new he(-200,`Circular dependency in DI detected for ${n}${t}`)}(function It(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():tt(n)}(s[t]));const a=Zd(o.canSeeViewProviders);o.resolving=!0;const l=o.injectImpl?ai(o.injectImpl):null;Wx(n,i,Ge.Default);try{r=n[t]=o.factory(void 0,s,n,i),e.firstCreatePass&&t>=i.directiveStart&&function jF(n,e,t){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:s}=e.type.prototype;if(i){const o=Ex(e);(t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o)}r&&(t.preOrderHooks??=[]).push(0-n,r),s&&((t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s))}(t,s[t],e)}finally{null!==l&&ai(l),Zd(a),o.resolving=!1,qx()}}return r}function aS(n,e,t){return!!(t[e+(n>>tS)]&1<<n)}function lS(n,e){return!(n&Ge.Self||n&Ge.Host&&e)}class pa{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,i){return sS(this._tNode,this._lView,e,Ld(i),t)}}function nk(){return new pa(Fn(),ie())}function xg(n){return $m(n)?()=>{const e=xg(Qe(n));return e&&e()}:Ks(n)}function uS(n){const e=n[Me],t=e.type;return 2===t?e.declTNode:1===t?n[zn]:null}const ga="__parameters__";function va(n,e,t){return jr(()=>{const i=function Sg(n){return function(...t){if(n){const i=n(...t);for(const r in i)this[r]=i[r]}}}(e);function r(...s){if(this instanceof r)return i.apply(this,s),this;const o=new r(...s);return a.annotation=o,a;function a(l,c,u){const d=l.hasOwnProperty(ga)?l[ga]:Object.defineProperty(l,ga,{value:[]})[ga];for(;d.length<=u;)d.push(null);return(d[u]=d[u]||[]).push(o),l}}return t&&(r.prototype=Object.create(t.prototype)),r.prototype.ngMetadataName=n,r.annotationCls=r,r})}function Sc(n,e){n.forEach(t=>Array.isArray(t)?Sc(t,e):e(t))}function hS(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function eh(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function Ti(n,e,t){let i=ya(n,e);return i>=0?n[1|i]=t:(i=~i,function lk(n,e,t,i){let r=n.length;if(r==e)n.push(t,i);else if(1===r)n.push(i,n[0]),n[0]=t;else{for(r--,n.push(n[r-1],n[r]);r>e;)n[r]=n[r-2],r--;n[e]=t,n[e+1]=i}}(n,i,e,t)),i}function Mg(n,e){const t=ya(n,e);if(t>=0)return n[1|t]}function ya(n,e){return function fS(n,e,t){let i=0,r=n.length>>t;for(;r!==i;){const s=i+(r-i>>1),o=n[s<<t];if(e===o)return s<<t;o>e?r=s:i=s+1}return~(r<<t)}(n,e,1)}const nh=dc(va("Optional"),8),ih=dc(va("SkipSelf"),4);function lh(n){return 128==(128&n.flags)}var fi=(()=>((fi=fi||{})[fi.Important=1]="Important",fi[fi.DashCase=2]="DashCase",fi))();const Dk=/^>|^->|<!--|-->|--!>|<!-$/g,Rk=/(<|>)/,Ik="\u200b$1\u200b";const Dg=new Map;let Pk=0;const Ig="__ngContext__";function Wn(n,e){Ai(e)?(n[Ig]=e[_c],function Ok(n){Dg.set(n[_c],n)}(e)):n[Ig]=e}let Pg;function Lg(n,e){return Pg(n,e)}function Cc(n){const e=n[jt];return di(e)?e[jt]:e}function LS(n){return NS(n[mc])}function OS(n){return NS(n[Yi])}function NS(n){for(;null!==n&&!di(n);)n=n[Yi];return n}function xa(n,e,t,i,r){if(null!=i){let s,o=!1;di(i)?s=i:Ai(i)&&(o=!0,i=i[xn]);const a=Vt(i);0===n&&null!==t?null==r?VS(e,t,a):to(e,t,a,r||null,!0):1===n&&null!==t?to(e,t,a,r||null,!0):2===n?function ph(n,e,t){const i=hh(n,e);i&&function Qk(n,e,t,i){n.removeChild(e,t,i)}(n,i,e,t)}(e,a,o):3===n&&e.destroyNode(a),null!=s&&function n2(n,e,t,i,r){const s=t[yr];s!==Vt(t)&&xa(e,n,i,s,r);for(let a=Gn;a<t.length;a++){const l=t[a];Dc(l[Me],l,n,e,i,s)}}(e,n,s,t,r)}}function Og(n,e){return n.createComment(function ES(n){return n.replace(Dk,e=>e.replace(Rk,Ik))}(e))}function dh(n,e,t){return n.createElement(e,t)}function kS(n,e){const t=n[ca],i=t.indexOf(e);Px(e),t.splice(i,1)}function Ng(n,e){if(n.length<=Gn)return;const t=Gn+e,i=n[t];if(i){const r=i[gc];null!==r&&r!==n&&kS(r,i),e>0&&(n[t-1][Yi]=i[Yi]);const s=eh(n,Gn+e);!function jk(n,e){Dc(n,e,e[rt],2,null,null),e[xn]=null,e[zn]=null}(i[Me],i);const o=s[vr];null!==o&&o.detachView(s[Me]),i[jt]=null,i[Yi]=null,i[it]&=-129}return i}function US(n,e){if(!(256&e[it])){const t=e[rt];e[Fd]?.destroy(),e[kd]?.destroy(),t.destroyNode&&Dc(n,e,t,3,null,null),function qk(n){let e=n[mc];if(!e)return Fg(n[Me],n);for(;e;){let t=null;if(Ai(e))t=e[mc];else{const i=e[Gn];i&&(t=i)}if(!t){for(;e&&!e[Yi]&&e!==n;)Ai(e)&&Fg(e[Me],e),e=e[jt];null===e&&(e=n),Ai(e)&&Fg(e[Me],e),t=e&&e[Yi]}e=t}}(e)}}function Fg(n,e){if(!(256&e[it])){e[it]&=-129,e[it]|=256,function Jk(n,e){let t;if(null!=n&&null!=(t=n.destroyHooks))for(let i=0;i<t.length;i+=2){const r=e[t[i]];if(!(r instanceof bc)){const s=t[i+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){const a=r[s[o]],l=s[o+1];wr(4,a,l);try{l.call(a)}finally{wr(5,a,l)}}else{wr(4,r,s);try{s.call(r)}finally{wr(5,r,s)}}}}}(n,e),function Kk(n,e){const t=n.cleanup,i=e[sa];if(null!==t)for(let s=0;s<t.length-1;s+=2)if("string"==typeof t[s]){const o=t[s+3];o>=0?i[o]():i[-o].unsubscribe(),s+=2}else t[s].call(i[t[s+1]]);null!==i&&(e[sa]=null);const r=e[Es];if(null!==r){e[Es]=null;for(let s=0;s<r.length;s++)(0,r[s])()}}(n,e),1===e[Me].type&&e[rt].destroy();const t=e[gc];if(null!==t&&di(e[jt])){t!==e[jt]&&kS(t,e);const i=e[vr];null!==i&&i.detachView(n)}!function Nk(n){Dg.delete(n[_c])}(e)}}function kg(n,e,t){return function BS(n,e,t){let i=e;for(;null!==i&&40&i.type;)i=(e=i).parent;if(null===i)return t[xn];{const{componentOffset:r}=i;if(r>-1){const{encapsulation:s}=n.data[i.directiveStart+r];if(s===Mi.None||s===Mi.Emulated)return null}return hi(i,t)}}(n,e.parent,t)}function to(n,e,t,i,r){n.insertBefore(e,t,i,r)}function VS(n,e,t){n.appendChild(e,t)}function HS(n,e,t,i,r){null!==i?to(n,e,t,i,r):VS(n,e,t)}function hh(n,e){return n.parentNode(e)}let Ug,zg,WS=function GS(n,e,t){return 40&n.type?hi(n,t):null};function fh(n,e,t,i){const r=kg(n,i,e),s=e[rt],a=function zS(n,e,t){return WS(n,e,t)}(i.parent||e[zn],i,e);if(null!=r)if(Array.isArray(t))for(let l=0;l<t.length;l++)HS(s,r,t[l],a,!1);else HS(s,r,t,a,!1);void 0!==Ug&&Ug(s,i,e,t,r)}function Tc(n,e){if(null!==e){const t=e.type;if(3&t)return hi(e,n);if(4&t)return Bg(-1,n[e.index]);if(8&t){const i=e.child;if(null!==i)return Tc(n,i);{const r=n[e.index];return di(r)?Bg(-1,r):Vt(r)}}if(32&t)return Lg(e,n)()||Vt(n[e.index]);{const i=$S(n,e);return null!==i?Array.isArray(i)?i[0]:Tc(Cc(n[ln]),i):Tc(n,e.next)}}return null}function $S(n,e){return null!==e?n[ln][zn].projection[e.projection]:null}function Bg(n,e){const t=Gn+n+1;if(t<e.length){const i=e[t],r=i[Me].firstChild;if(null!==r)return Tc(i,r)}return e[yr]}function Vg(n,e,t,i,r,s,o){for(;null!=t;){const a=i[t.index],l=t.type;if(o&&0===e&&(a&&Wn(Vt(a),i),t.flags|=2),32!=(32&t.flags))if(8&l)Vg(n,e,t.child,i,r,s,!1),xa(e,n,r,a,s);else if(32&l){const c=Lg(t,i);let u;for(;u=c();)xa(e,n,r,u,s);xa(e,n,r,a,s)}else 16&l?qS(n,e,i,t,r,s):xa(e,n,r,a,s);t=o?t.projectionNext:t.next}}function Dc(n,e,t,i,r,s){Vg(t,i,n.firstChild,e,r,s,!1)}function qS(n,e,t,i,r,s){const o=t[ln],l=o[zn].projection[i.projection];if(Array.isArray(l))for(let c=0;c<l.length;c++)xa(e,n,r,l[c],s);else{let c=l;const u=o[jt];lh(i)&&(c.flags|=128),Vg(n,e,c,u,r,s,!0)}}function YS(n,e,t){""===t?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function ZS(n,e,t){const{mergedAttrs:i,classes:r,styles:s}=t;null!==i&&eg(n,e,i),null!==r&&YS(n,e,r),null!==s&&function s2(n,e,t){n.setAttribute(e,"style",t)}(n,e,s)}class eM{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}function Ts(n){return n instanceof eM?n.changingThisBreaksApplicationSecurity:n}class Ce{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=Ee({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}const Oc=new Ce("ENVIRONMENT_INITIALIZER"),uM=new Ce("INJECTOR",-1),dM=new Ce("INJECTOR_DEF_TYPES");class hM{get(e,t=uc){if(t===uc){const i=new Error(`NullInjectorError: No provider for ${wn(e)}!`);throw i.name="NullInjectorError",i}return t}}function P2(...n){return{\u0275providers:pM(0,n),\u0275fromNgModule:!0}}function pM(n,...e){const t=[],i=new Set;let r;return Sc(e,s=>{const o=s;qg(o,t,[],i)&&(r||=[],r.push(o))}),void 0!==r&&mM(r,t),t}function mM(n,e){for(let t=0;t<n.length;t++){const{providers:r}=n[t];Yg(r,s=>{e.push(s)})}}function qg(n,e,t,i){if(!(n=Qe(n)))return!1;let r=null,s=Yw(n);const o=!s&&Rt(n);if(s||o){if(o&&!o.standalone)return!1;r=n}else{const l=n.ngModule;if(s=Yw(l),!s)return!1;r=l}const a=i.has(r);if(o){if(a)return!1;if(i.add(r),o.dependencies){const l="function"==typeof o.dependencies?o.dependencies():o.dependencies;for(const c of l)qg(c,e,t,i)}}else{if(!s)return!1;{if(null!=s.imports&&!a){let c;i.add(r);try{Sc(s.imports,u=>{qg(u,e,t,i)&&(c||=[],c.push(u))})}finally{}void 0!==c&&mM(c,e)}if(!a){const c=Ks(r)||(()=>new r);e.push({provide:r,useFactory:c,deps:Ct},{provide:dM,useValue:r,multi:!0},{provide:Oc,useValue:()=>te(r),multi:!0})}const l=s.providers;null==l||a||Yg(l,u=>{e.push(u)})}}return r!==n&&void 0!==n.providers}function Yg(n,e){for(let t of n)Xm(t)&&(t=t.\u0275providers),Array.isArray(t)?Yg(t,e):e(t)}const L2=Pt({provide:String,useValue:Pt});function Zg(n){return null!==n&&"object"==typeof n&&L2 in n}function no(n){return"function"==typeof n}const Kg=new Ce("Set Injector scope."),vh={},N2={};let Jg;function yh(){return void 0===Jg&&(Jg=new hM),Jg}class Kr{}class Qg extends Kr{get destroyed(){return this._destroyed}constructor(e,t,i,r){super(),this.parent=t,this.source=i,this.scopes=r,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,t_(e,o=>this.processProvider(o)),this.records.set(uM,Ma(void 0,this)),r.has("environment")&&this.records.set(Kr,Ma(void 0,this));const s=this.records.get(Kg);null!=s&&"string"==typeof s.value&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(dM.multi,Ct,Ge.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const t of this._ngOnDestroyHooks)t.ngOnDestroy();const e=this._onDestroyHooks;this._onDestroyHooks=[];for(const t of e)t()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();const t=Ms(this),i=ai(void 0);try{return e()}finally{Ms(t),ai(i)}}get(e,t=uc,i=Ge.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(nx))return e[nx](this);i=Ld(i);const r=Ms(this),s=ai(void 0);try{if(!(i&Ge.SkipSelf)){let a=this.records.get(e);if(void 0===a){const l=function V2(n){return"function"==typeof n||"object"==typeof n&&n instanceof Ce}(e)&&Rd(e);a=l&&this.injectableDefInScope(l)?Ma(e_(e),vh):null,this.records.set(e,a)}if(null!=a)return this.hydrate(e,a)}return(i&Ge.Self?yh():this.parent).get(e,t=i&Ge.Optional&&t===uc?null:t)}catch(o){if("NullInjectorError"===o.name){if((o[Pd]=o[Pd]||[]).unshift(wn(e)),r)throw o;return function kN(n,e,t,i){const r=n[Pd];throw e[Qw]&&r.unshift(e[Qw]),n.message=function UN(n,e,t,i=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.slice(2):n;let r=wn(e);if(Array.isArray(e))r=e.map(wn).join(" -> ");else if("object"==typeof e){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+("string"==typeof a?JSON.stringify(a):wn(a)))}r=`{${s.join(", ")}}`}return`${t}${i?"("+i+")":""}[${r}]: ${n.replace(PN,"\n  ")}`}("\n"+n.message,r,t,i),n.ngTokenPath=r,n[Pd]=null,n}(o,e,"R3InjectorError",this.source)}throw o}finally{ai(s),Ms(r)}}resolveInjectorInitializers(){const e=Ms(this),t=ai(void 0);try{const i=this.get(Oc.multi,Ct,Ge.Self);for(const r of i)r()}finally{Ms(e),ai(t)}}toString(){const e=[],t=this.records;for(const i of t.keys())e.push(wn(i));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new he(205,!1)}processProvider(e){let t=no(e=Qe(e))?e:Qe(e&&e.provide);const i=function k2(n){return Zg(n)?Ma(void 0,n.useValue):Ma(vM(n),vh)}(e);if(no(e)||!0!==e.multi)this.records.get(t);else{let r=this.records.get(t);r||(r=Ma(void 0,vh,!0),r.factory=()=>Km(r.multi),this.records.set(t,r)),t=e,r.multi.push(e)}this.records.set(t,i)}hydrate(e,t){return t.value===vh&&(t.value=N2,t.value=t.factory()),"object"==typeof t.value&&t.value&&function B2(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}injectableDefInScope(e){if(!e.providedIn)return!1;const t=Qe(e.providedIn);return"string"==typeof t?"any"===t||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){const t=this._onDestroyHooks.indexOf(e);-1!==t&&this._onDestroyHooks.splice(t,1)}}function e_(n){const e=Rd(n),t=null!==e?e.factory:Ks(n);if(null!==t)return t;if(n instanceof Ce)throw new he(204,!1);if(n instanceof Function)return function F2(n){const e=n.length;if(e>0)throw function Mc(n,e){const t=[];for(let i=0;i<n;i++)t.push(e);return t}(e,"?"),new he(204,!1);const t=function DN(n){return n&&(n[Id]||n[Zw])||null}(n);return null!==t?()=>t.factory(n):()=>new n}(n);throw new he(204,!1)}function vM(n,e,t){let i;if(no(n)){const r=Qe(n);return Ks(r)||e_(r)}if(Zg(n))i=()=>Qe(n.useValue);else if(function _M(n){return!(!n||!n.useFactory)}(n))i=()=>n.useFactory(...Km(n.deps||[]));else if(function gM(n){return!(!n||!n.useExisting)}(n))i=()=>te(Qe(n.useExisting));else{const r=Qe(n&&(n.useClass||n.provide));if(!function U2(n){return!!n.deps}(n))return Ks(r)||e_(r);i=()=>new r(...Km(n.deps))}return i}function Ma(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function t_(n,e){for(const t of n)Array.isArray(t)?t_(t,e):t&&Xm(t)?t_(t.\u0275providers,e):e(t)}const bh=new Ce("AppId",{providedIn:"root",factory:()=>H2}),H2="ng",yM=new Ce("Platform Initializer"),io=new Ce("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),z2=new Ce("AnimationModuleType"),n_=new Ce("CSP nonce",{providedIn:"root",factory:()=>function Rc(){if(void 0!==zg)return zg;if(typeof document<"u")return document;throw new he(210,!1)}().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});let wM=(n,e)=>null;function xM(n,e){return wM(n,e)}class K2{}class EM{}class Q2{resolveComponentFactory(e){throw function J2(n){const e=Error(`No component factory found for ${wn(n)}.`);return e.ngComponent=n,e}(e)}}let Ea=(()=>{class n{}return n.NULL=new Q2,n})();function eU(){return Aa(Fn(),ie())}function Aa(n,e){return new mi(hi(n,e))}let mi=(()=>{class n{constructor(t){this.nativeElement=t}}return n.__NG_ELEMENT_ID__=eU,n})();function tU(n){return n instanceof mi?n.nativeElement:n}class CM{}let iU=(()=>{class n{}return n.\u0275prov=Ee({token:n,providedIn:"root",factory:()=>null}),n})();class Ah{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const rU=new Ah("16.1.5"),f_={};function Uc(n){for(;n;){n[it]|=64;const e=Cc(n);if(ig(n)&&!e)return n;n=e}return null}function p_(n){return n.ngOriginalError}class ro{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&p_(e);for(;t&&p_(t);)t=p_(t);return t||null}}const RM=new Ce("",{providedIn:"root",factory:()=>!1});function Jr(n){return n instanceof Function?n():n}class NM extends wx{constructor(){super(...arguments),this.consumerAllowSignalWrites=!1,this._lView=null}set lView(e){this._lView=e}onConsumerDependencyMayHaveChanged(){Uc(this._lView)}onProducerUpdateValueVersion(){}get hasReadASignal(){return this.hasProducers}runInContext(e,t,i){const r=Dn(this);this.trackingVersion++;try{e(t,i)}finally{Dn(r)}}destroy(){this.trackingVersion++}}let Th=null;function FM(){return Th??=new NM,Th}function kM(n,e){return n[e]??FM()}function UM(n,e){const t=FM();t.hasReadASignal&&(n[e]=Th,t.lView=n,Th=new NM)}const st={};function Ta(n){BM(Mt(),ie(),Kn()+n,!1)}function BM(n,e,t,i){if(!i)if(3==(3&e[it])){const s=n.preOrderCheckHooks;null!==s&&$d(e,s,t)}else{const s=n.preOrderHooks;null!==s&&Xd(e,s,0,t)}Qs(t)}function WM(n,e=null,t=null,i){const r=jM(n,e,t,i);return r.resolveInjectorInitializers(),r}function jM(n,e=null,t=null,i,r=new Set){const s=[t||Ct,P2(n)];return i=i||("object"==typeof n?void 0:wn(n)),new Qg(s,e||yh(),i||null,r)}let gi=(()=>{class n{static create(t,i){if(Array.isArray(t))return WM({name:""},i,t,"");{const r=t.name??"";return WM({name:r},t.parent,t.providers,r)}}}return n.THROW_IF_NOT_FOUND=uc,n.NULL=new hM,n.\u0275prov=Ee({token:n,providedIn:"any",factory:()=>te(uM)}),n.__NG_ELEMENT_ID__=-1,n})();function De(n,e=Ge.Default){const t=ie();return null===t?te(n,e):sS(Fn(),t,Qe(n),e)}function Dh(n,e,t,i,r,s,o,a,l,c,u){const d=e.blueprint.slice();return d[xn]=r,d[it]=140|i,(null!==c||n&&2048&n[it])&&(d[it]|=2048),Ix(d),d[jt]=d[aa]=n,d[an]=t,d[Ys]=o||n&&n[Ys],d[rt]=a||n&&n[rt],d[oa]=l||n&&n[oa]||null,d[zn]=s,d[_c]=function Lk(){return Pk++}(),d[Xr]=u,d[mx]=c,d[ln]=2==e.type?n[ln]:d,d}function Da(n,e,t,i,r){let s=n.data[e];if(null===s)s=function m_(n,e,t,i,r){const s=Bx(),o=cg(),l=n.data[e]=function MU(n,e,t,i,r,s){let o=e?e.injectorIndex:-1,a=0;return function da(){return null!==qe.skipHydrationRootTNode}()&&(a|=128),{type:t,index:i,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,t,e,i,r);return null===n.firstChild&&(n.firstChild=l),null!==s&&(o?null==s.child&&null!==l.parent&&(s.child=l):null===s.next&&(s.next=l,l.prev=s)),l}(n,e,t,i,r),function NF(){return qe.lFrame.inI18n}()&&(s.flags|=32);else if(64&s.type){s.type=t,s.value=i,s.attrs=r;const o=function yc(){const n=qe.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}();s.injectorIndex=null===o?-1:o.injectorIndex}return xr(s,!0),s}function Bc(n,e,t,i){if(0===t)return-1;const r=e.length;for(let s=0;s<t;s++)e.push(i),n.blueprint.push(i),n.data.push(null);return r}function XM(n,e,t,i,r){const s=kM(e,Fd),o=Kn(),a=2&i;try{if(Qs(-1),a&&e.length>mt&&BM(n,e,mt,!1),wr(a?2:0,r),a)s.runInContext(t,i,r);else{const c=Dn(null);try{t(i,r)}finally{Dn(c)}}}finally{a&&null===e[Fd]&&UM(e,Fd),Qs(o),wr(a?3:1,r)}}function g_(n,e,t){if(ng(e)){const i=Dn(null);try{const s=e.directiveEnd;for(let o=e.directiveStart;o<s;o++){const a=n.data[o];a.contentQueries&&a.contentQueries(1,t[o],o)}}finally{Dn(i)}}}function __(n,e,t){Fx()&&(function IU(n,e,t,i){const r=t.directiveStart,s=t.directiveEnd;Zs(t)&&function UU(n,e,t){const i=hi(e,n),r=qM(t);let o=16;t.signals?o=4096:t.onPush&&(o=64);const a=Rh(n,Dh(n,r,null,o,i,e,null,n[Ys].rendererFactory.createRenderer(i,t),null,null,null));n[e.index]=a}(e,t,n.data[r+t.componentOffset]),n.firstCreatePass||Kd(t,e),Wn(i,e);const o=t.initialInputs;for(let a=r;a<s;a++){const l=n.data[a],c=eo(e,n,a,t);Wn(c,e),null!==o&&BU(0,a-r,c,l,0,o),Zi(l)&&(Ci(t.index,e)[an]=eo(e,n,a,t))}}(n,e,t,hi(t,e)),64==(64&t.flags)&&QM(n,e,t))}function v_(n,e,t=hi){const i=e.localNames;if(null!==i){let r=e.index+1;for(let s=0;s<i.length;s+=2){const o=i[s+1],a=-1===o?t(e,n):n[o];n[r++]=a}}}function qM(n){const e=n.tView;return null===e||e.incompleteFirstPass?n.tView=y_(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function y_(n,e,t,i,r,s,o,a,l,c,u){const d=mt+i,h=d+r,f=function vU(n,e){const t=[];for(let i=0;i<e;i++)t.push(i<n?null:st);return t}(d,h),p="function"==typeof c?c():c;return f[Me]={type:n,blueprint:f,template:t,queries:null,viewQuery:a,declTNode:e,data:f.slice().fill(null,d),bindingStartIndex:d,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:l,consts:p,incompleteFirstPass:!1,ssrId:u}}let YM=n=>null;function ZM(n,e,t,i){for(let r in n)if(n.hasOwnProperty(r)){t=null===t?{}:t;const s=n[r];null===i?KM(t,e,r,s):i.hasOwnProperty(r)&&KM(t,e,i[r],s)}return t}function KM(n,e,t,i){n.hasOwnProperty(t)?n[t].push(e,i):n[t]=[e,i]}function b_(n,e,t,i){if(Fx()){const r=null===i?null:{"":-1},s=function LU(n,e){const t=n.directiveRegistry;let i=null,r=null;if(t)for(let s=0;s<t.length;s++){const o=t[s];if(cx(e,o.selectors,!1))if(i||(i=[]),Zi(o))if(null!==o.findHostDirectiveDefs){const a=[];r=r||new Map,o.findHostDirectiveDefs(o,a,r),i.unshift(...a,o),w_(n,e,a.length)}else i.unshift(o),w_(n,e,0);else r=r||new Map,o.findHostDirectiveDefs?.(o,i,r),i.push(o)}return null===i?null:[i,r]}(n,t);let o,a;null===s?o=a=null:[o,a]=s,null!==o&&JM(n,e,t,o,r,a),r&&function OU(n,e,t){if(e){const i=n.localNames=[];for(let r=0;r<e.length;r+=2){const s=t[e[r+1]];if(null==s)throw new he(-301,!1);i.push(e[r],s)}}}(t,i,r)}t.mergedAttrs=fc(t.mergedAttrs,t.attrs)}function JM(n,e,t,i,r,s){for(let c=0;c<i.length;c++)wg(Kd(t,e),n,i[c].type);!function FU(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}(t,n.data.length,i.length);for(let c=0;c<i.length;c++){const u=i[c];u.providersResolver&&u.providersResolver(u)}let o=!1,a=!1,l=Bc(n,e,i.length,null);for(let c=0;c<i.length;c++){const u=i[c];t.mergedAttrs=fc(t.mergedAttrs,u.hostAttrs),kU(n,t,e,l,u),NU(l,u,r),null!==u.contentQueries&&(t.flags|=4),(null!==u.hostBindings||null!==u.hostAttrs||0!==u.hostVars)&&(t.flags|=64);const d=u.type.prototype;!o&&(d.ngOnChanges||d.ngOnInit||d.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),o=!0),!a&&(d.ngOnChanges||d.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),a=!0),l++}!function EU(n,e,t){const r=e.directiveEnd,s=n.data,o=e.attrs,a=[];let l=null,c=null;for(let u=e.directiveStart;u<r;u++){const d=s[u],h=t?t.get(d):null,p=h?h.outputs:null;l=ZM(d.inputs,u,l,h?h.inputs:null),c=ZM(d.outputs,u,c,p);const _=null===l||null===o||lx(e)?null:VU(l,u,o);a.push(_)}null!==l&&(l.hasOwnProperty("class")&&(e.flags|=8),l.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=l,e.outputs=c}(n,t,s)}function QM(n,e,t){const i=t.directiveStart,r=t.directiveEnd,s=t.index,o=function kF(){return qe.lFrame.currentDirectiveIndex}();try{Qs(s);for(let a=i;a<r;a++){const l=n.data[a],c=e[a];dg(a),(null!==l.hostBindings||0!==l.hostVars||null!==l.hostAttrs)&&PU(l,c)}}finally{Qs(-1),dg(o)}}function PU(n,e){null!==n.hostBindings&&n.hostBindings(1,e)}function w_(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function NU(n,e,t){if(t){if(e.exportAs)for(let i=0;i<e.exportAs.length;i++)t[e.exportAs[i]]=n;Zi(e)&&(t[""]=n)}}function kU(n,e,t,i,r){n.data[i]=r;const s=r.factory||(r.factory=Ks(r.type)),o=new bc(s,Zi(r),De);n.blueprint[i]=o,t[i]=o,function DU(n,e,t,i,r){const s=r.hostBindings;if(s){let o=n.hostBindingOpCodes;null===o&&(o=n.hostBindingOpCodes=[]);const a=~e.index;(function RU(n){let e=n.length;for(;e>0;){const t=n[--e];if("number"==typeof t&&t<0)return t}return 0})(o)!=a&&o.push(a),o.push(t,i,s)}}(n,e,i,Bc(n,t,r.hostVars,st),r)}function Mr(n,e,t,i,r,s){const o=hi(n,e);!function x_(n,e,t,i,r,s,o){if(null==s)n.removeAttribute(e,r,t);else{const a=null==o?tt(s):o(s,i||"",r);n.setAttribute(e,r,a,t)}}(e[rt],o,s,n.value,t,i,r)}function BU(n,e,t,i,r,s){const o=s[e];if(null!==o)for(let a=0;a<o.length;)eE(i,t,o[a++],o[a++],o[a++])}function eE(n,e,t,i,r){const s=Dn(null);try{const o=n.inputTransforms;null!==o&&o.hasOwnProperty(i)&&(r=o[i].call(e,r)),null!==n.setInput?n.setInput(e,r,t,i):e[i]=r}finally{Dn(s)}}function VU(n,e,t){let i=null,r=0;for(;r<t.length;){const s=t[r];if(0!==s)if(5!==s){if("number"==typeof s)break;if(n.hasOwnProperty(s)){null===i&&(i=[]);const o=n[s];for(let a=0;a<o.length;a+=2)if(o[a]===e){i.push(s,o[a+1],t[r+1]);break}}r+=2}else r+=2;else r+=4}return i}function tE(n,e,t,i){return[n,!0,!1,e,null,0,i,t,null,null,null]}function nE(n,e){const t=n.contentQueries;if(null!==t)for(let i=0;i<t.length;i+=2){const s=t[i+1];if(-1!==s){const o=n.data[s];fg(t[i]),o.contentQueries(2,e[s],s)}}}function Rh(n,e){return n[mc]?n[px][Yi]=e:n[mc]=e,n[px]=e,e}function S_(n,e,t){fg(0);const i=Dn(null);try{e(n,t)}finally{Dn(i)}}function iE(n){return n[sa]||(n[sa]=[])}function rE(n){return n.cleanup||(n.cleanup=[])}function oE(n,e){const t=n[oa],i=t?t.get(ro,null):null;i&&i.handleError(e)}function M_(n,e,t,i,r){for(let s=0;s<t.length;){const o=t[s++],a=t[s++];eE(n.data[o],e[o],i,a,r)}}function HU(n,e){const t=Ci(e,n),i=t[Me];!function zU(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}(i,t);const r=t[xn];null!==r&&null===t[Xr]&&(t[Xr]=xM(r,t[oa])),E_(i,t,t[an])}function E_(n,e,t){pg(e);try{const i=n.viewQuery;null!==i&&S_(1,i,t);const r=n.template;null!==r&&XM(n,e,r,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&nE(n,e),n.staticViewQueries&&S_(2,n.viewQuery,t);const s=n.components;null!==s&&function GU(n,e){for(let t=0;t<e.length;t++)HU(n,e[t])}(e,s)}catch(i){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),i}finally{e[it]&=-5,mg()}}let Ih=(()=>{class n{}return n.__NG_ELEMENT_ID__=jU,n.__NG_ENV_ID__=e=>e,n})();class WU extends Ih{constructor(e){super(),this._lView=e}onDestroy(e){return Ox(this._lView,e),()=>function EF(n,e){if(null===n[Es])return;const t=n[Es].indexOf(e);-1!==t&&n[Es].splice(t,1)}(this._lView,e)}}function jU(){return new WU(ie())}let aE=(()=>{class n{constructor(){this.all=new Set,this.queue=new Map}create(t,i,r){const s=typeof Zone>"u"?null:Zone.current,o=new fF(t,c=>{this.all.has(c)&&this.queue.set(c,s)},r);let a;this.all.add(o),o.notify();const l=()=>{o.cleanup(),a?.(),this.all.delete(o),this.queue.delete(o)};return a=i?.onDestroy(l),{destroy:l}}flush(){if(0!==this.queue.size)for(const[t,i]of this.queue)this.queue.delete(t),i?i.run(()=>t.run()):t.run()}get isQueueEmpty(){return 0===this.queue.size}}return n.\u0275prov=Ee({token:n,providedIn:"root",factory:()=>new n}),n})();function Ph(n,e,t){let i=t?n.styles:null,r=t?n.classes:null,s=0;if(null!==e)for(let o=0;o<e.length;o++){const a=e[o];"number"==typeof a?s=a:1==s?r=Wm(r,a):2==s&&(i=Wm(i,a+": "+e[++o]+";"))}t?n.styles=i:n.stylesWithoutHost=i,t?n.classes=r:n.classesWithoutHost=r}function Vc(n,e,t,i,r=!1){for(;null!==t;){const s=e[t.index];if(null!==s&&i.push(Vt(s)),di(s)){for(let a=Gn;a<s.length;a++){const l=s[a],c=l[Me].firstChild;null!==c&&Vc(l[Me],l,c,i)}s[yr]!==s[xn]&&i.push(s[yr])}const o=t.type;if(8&o)Vc(n,e,t.child,i);else if(32&o){const a=Lg(t,e);let l;for(;l=a();)i.push(l)}else if(16&o){const a=$S(e,t);if(Array.isArray(a))i.push(...a);else{const l=Cc(e[ln]);Vc(l[Me],l,a,i,!0)}}t=r?t.projectionNext:t.next}return i}function Lh(n,e,t,i=!0){const r=e[Ys].rendererFactory;r.begin&&r.begin();try{lE(n,e,n.template,t)}catch(o){throw i&&oE(e,o),o}finally{r.end&&r.end(),e[Ys].effectManager?.flush()}}function lE(n,e,t,i){const r=e[it];if(256!=(256&r)){e[Ys].effectManager?.flush(),pg(e);try{Ix(e),function Hx(n){return qe.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==t&&XM(n,e,t,2,i);const o=3==(3&r);if(o){const c=n.preOrderCheckHooks;null!==c&&$d(e,c,null)}else{const c=n.preOrderHooks;null!==c&&Xd(e,c,0,null),gg(e,0)}if(function qU(n){for(let e=LS(n);null!==e;e=OS(e)){if(!e[gx])continue;const t=e[ca];for(let i=0;i<t.length;i++){MF(t[i])}}}(e),cE(e,2),null!==n.contentQueries&&nE(n,e),o){const c=n.contentCheckHooks;null!==c&&$d(e,c)}else{const c=n.contentHooks;null!==c&&Xd(e,c,1),gg(e,1)}!function _U(n,e){const t=n.hostBindingOpCodes;if(null===t)return;const i=kM(e,kd);try{for(let r=0;r<t.length;r++){const s=t[r];if(s<0)Qs(~s);else{const o=s,a=t[++r],l=t[++r];FF(a,o),i.runInContext(l,2,e[o])}}}finally{null===e[kd]&&UM(e,kd),Qs(-1)}}(n,e);const a=n.components;null!==a&&dE(e,a,0);const l=n.viewQuery;if(null!==l&&S_(2,l,i),o){const c=n.viewCheckHooks;null!==c&&$d(e,c)}else{const c=n.viewHooks;null!==c&&Xd(e,c,2),gg(e,2)}!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),e[it]&=-73,Px(e)}finally{mg()}}}function cE(n,e){for(let t=LS(n);null!==t;t=OS(t))for(let i=Gn;i<t.length;i++)uE(t[i],e)}function YU(n,e,t){uE(Ci(e,n),t)}function uE(n,e){if(!function xF(n){return 128==(128&n[it])}(n))return;const t=n[Me];if(80&n[it]&&0===e||1024&n[it]||2===e)lE(t,n,t.template,n[an]);else if(n[pc]>0){cE(n,1);const r=n[Me].components;null!==r&&dE(n,r,1)}}function dE(n,e,t){for(let i=0;i<e.length;i++)YU(n,e[i],t)}class Hc{get rootNodes(){const e=this._lView,t=e[Me];return Vc(t,e,t.firstChild,[])}constructor(e,t){this._lView=e,this._cdRefInjectingView=t,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[an]}set context(e){this._lView[an]=e}get destroyed(){return 256==(256&this._lView[it])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[jt];if(di(e)){const t=e[8],i=t?t.indexOf(this):-1;i>-1&&(Ng(e,i),eh(t,i))}this._attachedToViewContainer=!1}US(this._lView[Me],this._lView)}onDestroy(e){Ox(this._lView,e)}markForCheck(){Uc(this._cdRefInjectingView||this._lView)}detach(){this._lView[it]&=-129}reattach(){this._lView[it]|=128}detectChanges(){Lh(this._lView[Me],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new he(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function Xk(n,e){Dc(n,e,e[rt],2,null,null)}(this._lView[Me],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new he(902,!1);this._appRef=e}}class ZU extends Hc{constructor(e){super(e),this._view=e}detectChanges(){const e=this._view;Lh(e[Me],e,e[an],!1)}checkNoChanges(){}get context(){return null}}class hE extends Ea{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=Rt(e);return new zc(t,this.ngModule)}}function fE(n){const e=[];for(let t in n)n.hasOwnProperty(t)&&e.push({propName:n[t],templateName:t});return e}class JU{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,i){i=Ld(i);const r=this.injector.get(e,f_,i);return r!==f_||t===f_?r:this.parentInjector.get(e,t,i)}}class zc extends EM{get inputs(){const e=this.componentDef,t=e.inputTransforms,i=fE(e.inputs);if(null!==t)for(const r of i)t.hasOwnProperty(r.propName)&&(r.transform=t[r.propName]);return i}get outputs(){return fE(this.componentDef.outputs)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=function qN(n){return n.map(XN).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,i,r){let s=(r=r||this.ngModule)instanceof Kr?r:r?.injector;s&&null!==this.componentDef.getStandaloneInjector&&(s=this.componentDef.getStandaloneInjector(s)||s);const o=s?new JU(e,s):e,a=o.get(CM,null);if(null===a)throw new he(407,!1);const u={rendererFactory:a,sanitizer:o.get(iU,null),effectManager:o.get(aE,null)},d=a.createRenderer(null,this.componentDef),h=this.componentDef.selectors[0][0]||"div",f=i?function yU(n,e,t,i){const s=i.get(RM,!1)||t===Mi.ShadowDom,o=n.selectRootElement(e,s);return function bU(n){YM(n)}(o),o}(d,i,this.componentDef.encapsulation,o):dh(d,h,function KU(n){const e=n.toLowerCase();return"svg"===e?"svg":"math"===e?"math":null}(h)),g=this.componentDef.signals?4608:this.componentDef.onPush?576:528,m=y_(0,null,null,1,0,null,null,null,null,null,null),v=Dh(null,m,null,g,null,null,u,d,o,null,null);let y,b;pg(v);try{const w=this.componentDef;let S,C=null;w.findHostDirectiveDefs?(S=[],C=new Map,w.findHostDirectiveDefs(w,S,C),S.push(w)):S=[w];const I=function eB(n,e){const t=n[Me],i=mt;return n[i]=e,Da(t,i,2,"#host",null)}(v,f),x=function tB(n,e,t,i,r,s,o){const a=r[Me];!function nB(n,e,t,i){for(const r of n)e.mergedAttrs=fc(e.mergedAttrs,r.hostAttrs);null!==e.mergedAttrs&&(Ph(e,e.mergedAttrs,!0),null!==t&&ZS(i,t,e))}(i,n,e,o);let l=null;null!==e&&(l=xM(e,r[oa]));const c=s.rendererFactory.createRenderer(e,t);let u=16;t.signals?u=4096:t.onPush&&(u=64);const d=Dh(r,qM(t),null,u,r[n.index],n,s,c,null,null,l);return a.firstCreatePass&&w_(a,n,i.length-1),Rh(r,d),r[n.index]=d}(I,f,w,S,v,u,d);b=Rx(m,mt),f&&function rB(n,e,t,i){if(i)eg(n,t,["ng-version",rU.full]);else{const{attrs:r,classes:s}=function YN(n){const e=[],t=[];let i=1,r=2;for(;i<n.length;){let s=n[i];if("string"==typeof s)2===r?""!==s&&e.push(s,n[++i]):8===r&&t.push(s);else{if(!qi(r))break;r=s}i++}return{attrs:e,classes:t}}(e.selectors[0]);r&&eg(n,t,r),s&&s.length>0&&YS(n,t,s.join(" "))}}(d,w,f,i),void 0!==t&&function sB(n,e,t){const i=n.projection=[];for(let r=0;r<e.length;r++){const s=t[r];i.push(null!=s?Array.from(s):null)}}(b,this.ngContentSelectors,t),y=function iB(n,e,t,i,r,s){const o=Fn(),a=r[Me],l=hi(o,r);JM(a,r,o,t,null,i);for(let u=0;u<t.length;u++)Wn(eo(r,a,o.directiveStart+u,o),r);QM(a,r,o),l&&Wn(l,r);const c=eo(r,a,o.directiveStart+o.componentOffset,o);if(n[an]=r[an]=c,null!==s)for(const u of s)u(c,e);return g_(a,o,n),c}(x,w,S,C,v,[oB]),E_(m,v,null)}finally{mg()}return new QU(this.componentType,y,Aa(b,v),v,b)}}class QU extends K2{constructor(e,t,i,r,s){super(),this.location=i,this._rootLView=r,this._tNode=s,this.previousInputValues=null,this.instance=t,this.hostView=this.changeDetectorRef=new ZU(r),this.componentType=e}setInput(e,t){const i=this._tNode.inputs;let r;if(null!==i&&(r=i[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;const s=this._rootLView;M_(s[Me],s,r,e,t),this.previousInputValues.set(e,t),Uc(Ci(this._tNode.index,s))}}get injector(){return new pa(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}function oB(){const n=Fn();jd(ie()[Me],n)}function Oh(n){let e=function pE(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),t=!0;const i=[n];for(;e;){let r;if(Zi(n))r=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new he(903,!1);r=e.\u0275dir}if(r){if(t){i.push(r);const o=n;o.inputs=Nh(n.inputs),o.inputTransforms=Nh(n.inputTransforms),o.declaredInputs=Nh(n.declaredInputs),o.outputs=Nh(n.outputs);const a=r.hostBindings;a&&uB(n,a);const l=r.viewQuery,c=r.contentQueries;if(l&&lB(n,l),c&&cB(n,c),Cd(n.inputs,r.inputs),Cd(n.declaredInputs,r.declaredInputs),Cd(n.outputs,r.outputs),null!==r.inputTransforms&&(null===o.inputTransforms&&(o.inputTransforms={}),Cd(o.inputTransforms,r.inputTransforms)),Zi(r)&&r.data.animation){const u=n.data;u.animation=(u.animation||[]).concat(r.data.animation)}}const s=r.features;if(s)for(let o=0;o<s.length;o++){const a=s[o];a&&a.ngInherit&&a(n),a===Oh&&(t=!1)}}e=Object.getPrototypeOf(e)}!function aB(n){let e=0,t=null;for(let i=n.length-1;i>=0;i--){const r=n[i];r.hostVars=e+=r.hostVars,r.hostAttrs=fc(r.hostAttrs,t=fc(t,r.hostAttrs))}}(i)}function Nh(n){return n===_r?{}:n===Ct?[]:n}function lB(n,e){const t=n.viewQuery;n.viewQuery=t?(i,r)=>{e(i,r),t(i,r)}:e}function cB(n,e){const t=n.contentQueries;n.contentQueries=t?(i,r,s)=>{e(i,r,s),t(i,r,s)}:e}function uB(n,e){const t=n.hostBindings;n.hostBindings=t?(i,r)=>{e(i,r),t(i,r)}:e}function Fh(n){return!!function A_(n){return null!==n&&("function"==typeof n||"object"==typeof n)}(n)&&(Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n)}function jn(n,e,t){return!Object.is(n[e],t)&&(n[e]=t,!0)}function Uh(n,e,t,i){const r=ie();return jn(r,ha(),e)&&(Mt(),Mr($t(),r,n,e,t,i)),Uh}function Pa(n,e,t,i,r,s){const a=function so(n,e,t,i){const r=jn(n,e,t);return jn(n,e+1,i)||r}(n,function qr(){return qe.lFrame.bindingIndex}(),t,r);return Yr(2),a?e+tt(t)+i+tt(r)+s:st}function zh(n,e,t,i,r,s,o,a){const l=ie(),c=Mt(),u=n+mt,d=c.firstCreatePass?function NB(n,e,t,i,r,s,o,a,l){const c=e.consts,u=Da(e,n,4,o||null,As(c,a));b_(e,t,u,As(c,l)),jd(e,u);const d=u.tView=y_(2,u,i,r,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,c,null);return null!==e.queries&&(e.queries.template(e,u),d.queries=e.queries.embeddedTView(u)),u}(u,c,l,e,t,i,r,s,o):c.data[u];xr(d,!1);const h=IE(c,l,d,n);Wd()&&fh(c,l,h,d),Wn(h,l),Rh(l,l[u]=tE(h,l,h,d)),Bd(d)&&__(c,l,d),null!=o&&v_(l,d,a)}let IE=function PE(n,e,t,i){return Cs(!0),e[rt].createComment("")};function Gh(n,e,t){const i=ie();return jn(i,ha(),e)&&function Di(n,e,t,i,r,s,o,a){const l=hi(e,t);let u,c=e.inputs;!a&&null!=c&&(u=c[i])?(M_(n,t,u,i,r),Zs(e)&&function CU(n,e){const t=Ci(e,n);16&t[it]||(t[it]|=64)}(t,e.index)):3&e.type&&(i=function AU(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(i),r=null!=o?o(r,e.value||"",i):r,s.setProperty(l,i,r))}(Mt(),$t(),i,n,e,i[rt],t,!1),Gh}function P_(n,e,t,i,r){const o=r?"class":"style";M_(n,t,e.inputs[o],o,i)}function Ba(n,e,t,i){const r=ie(),s=Mt(),o=mt+n,a=r[rt],l=s.firstCreatePass?function VB(n,e,t,i,r,s){const o=e.consts,l=Da(e,n,2,i,As(o,r));return b_(e,t,l,As(o,s)),null!==l.attrs&&Ph(l,l.attrs,!1),null!==l.mergedAttrs&&Ph(l,l.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,l),l}(o,s,r,e,t,i):s.data[o],c=LE(s,r,l,a,e,n);r[o]=c;const u=Bd(l);return xr(l,!0),ZS(a,c,l),32!=(32&l.flags)&&Wd()&&fh(s,r,c,l),0===function AF(){return qe.lFrame.elementDepthCount}()&&Wn(c,r),function CF(){qe.lFrame.elementDepthCount++}(),u&&(__(s,r,l),g_(s,l,r)),null!==i&&v_(r,l),Ba}function Va(){let n=Fn();cg()?ug():(n=n.parent,xr(n,!1));const e=n;(function DF(n){return qe.skipHydrationRootTNode===n})(e)&&function LF(){qe.skipHydrationRootTNode=null}(),function TF(){qe.lFrame.elementDepthCount--}();const t=Mt();return t.firstCreatePass&&(jd(t,n),ng(n)&&t.queries.elementEnd(n)),null!=e.classesWithoutHost&&function qF(n){return 0!=(8&n.flags)}(e)&&P_(t,e,ie(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function YF(n){return 0!=(16&n.flags)}(e)&&P_(t,e,ie(),e.stylesWithoutHost,!1),Va}function Wh(n,e,t,i){return Ba(n,e,t,i),Va(),Wh}let LE=(n,e,t,i,r,s)=>(Cs(!0),dh(i,r,function Yx(){return qe.lFrame.currentNamespace}()));function jh(n,e,t){const i=ie(),r=Mt(),s=n+mt,o=r.firstCreatePass?function GB(n,e,t,i,r){const s=e.consts,o=As(s,i),a=Da(e,n,8,"ng-container",o);return null!==o&&Ph(a,o,!0),b_(e,t,a,As(s,r)),null!==e.queries&&e.queries.elementStart(e,a),a}(s,r,i,e,t):r.data[s];xr(o,!0);const a=NE(r,i,o,n);return i[s]=a,Wd()&&fh(r,i,a,o),Wn(a,i),Bd(o)&&(__(r,i,o),g_(r,o,i)),null!=t&&v_(i,o),jh}function $h(){let n=Fn();const e=Mt();return cg()?ug():(n=n.parent,xr(n,!1)),e.firstCreatePass&&(jd(e,n),ng(n)&&e.queries.elementEnd(n)),$h}let NE=(n,e,t,i)=>(Cs(!0),Og(e[rt],""));function Xh(n){return!!n&&"function"==typeof n.then}function kE(n){return!!n&&"function"==typeof n.subscribe}function qh(n,e,t,i){const r=ie(),s=Mt(),o=Fn();return function BE(n,e,t,i,r,s,o){const a=Bd(i),c=n.firstCreatePass&&rE(n),u=e[an],d=iE(e);let h=!0;if(3&i.type||o){const _=hi(i,e),g=o?o(_):_,m=d.length,v=o?b=>o(Vt(b[i.index])):i.index;let y=null;if(!o&&a&&(y=function $B(n,e,t,i){const r=n.cleanup;if(null!=r)for(let s=0;s<r.length-1;s+=2){const o=r[s];if(o===t&&r[s+1]===i){const a=e[sa],l=r[s+2];return a.length>l?a[l]:null}"string"==typeof o&&(s+=2)}return null}(n,e,r,i.index)),null!==y)(y.__ngLastListenerFn__||y).__ngNextListenerFn__=s,y.__ngLastListenerFn__=s,h=!1;else{s=HE(i,e,u,s,!1);const b=t.listen(g,r,s);d.push(s,b),c&&c.push(r,v,m,m+1)}}else s=HE(i,e,u,s,!1);const f=i.outputs;let p;if(h&&null!==f&&(p=f[r])){const _=p.length;if(_)for(let g=0;g<_;g+=2){const w=e[p[g]][p[g+1]].subscribe(s),S=d.length;d.push(s,w),c&&c.push(r,i.index,S,-(S+1))}}}(s,r,r[rt],o,n,e,i),qh}function VE(n,e,t,i){try{return wr(6,e,t),!1!==t(i)}catch(r){return oE(n,r),!1}finally{wr(7,e,t)}}function HE(n,e,t,i,r){return function s(o){if(o===Function)return i;Uc(n.componentOffset>-1?Ci(n.index,e):e);let l=VE(e,t,i,o),c=s.__ngNextListenerFn__;for(;c;)l=VE(e,t,c,o)&&l,c=c.__ngNextListenerFn__;return r&&!1===l&&o.preventDefault(),l}}function L_(n=1){return function BF(n){return(qe.lFrame.contextLView=function VF(n,e){for(;n>0;)e=e[aa],n--;return e}(n,qe.lFrame.contextLView))[an]}(n)}function Yh(n,e){return n<<17|e<<2}function Ds(n){return n>>17&32767}function N_(n){return 2|n}function oo(n){return(131068&n)>>2}function F_(n,e){return-131069&n|e<<2}function k_(n){return 1|n}function KE(n,e,t,i,r){const s=n[t+1],o=null===e;let a=i?Ds(s):oo(s),l=!1;for(;0!==a&&(!1===l||o);){const u=n[a+1];t3(n[a],e)&&(l=!0,n[a+1]=i?k_(u):N_(u)),a=i?Ds(u):oo(u)}l&&(n[t+1]=i?N_(s):k_(s))}function t3(n,e){return null===n||null==e||(Array.isArray(n)?n[1]:n)===e||!(!Array.isArray(n)||"string"!=typeof e)&&ya(n,e)>=0}const Mn={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function JE(n){return n.substring(Mn.key,Mn.keyEnd)}function n3(n){return n.substring(Mn.value,Mn.valueEnd)}function eA(n,e){const t=Mn.textEnd;let i=Mn.key=Ha(n,e,t);return t===i?-1:(i=Mn.keyEnd=function o3(n,e,t){let i;for(;e<t&&(45===(i=n.charCodeAt(e))||95===i||(-33&i)>=65&&(-33&i)<=90||i>=48&&i<=57);)e++;return e}(n,i,t),i=nA(n,i,t),i=Mn.value=Ha(n,i,t),i=Mn.valueEnd=function a3(n,e,t){let i=-1,r=-1,s=-1,o=e,a=o;for(;o<t;){const l=n.charCodeAt(o++);if(59===l)return a;34===l||39===l?a=o=iA(n,l,o,t):e===o-4&&85===s&&82===r&&76===i&&40===l?a=o=iA(n,41,o,t):l>32&&(a=o),s=r,r=i,i=-33&l}return a}(n,i,t),nA(n,i,t))}function Ha(n,e,t){for(;e<t&&n.charCodeAt(e)<=32;)e++;return e}function nA(n,e,t,i){return(e=Ha(n,e,t))<t&&e++,e}function iA(n,e,t,i){let r=-1,s=t;for(;s<i;){const o=n.charCodeAt(s++);if(o==e&&92!==r)return s;r=92==o&&92===r?0:o}throw new Error}function Ar(n){!function Ji(n,e,t,i){const r=Mt(),s=Yr(2);r.firstUpdatePass&&function aA(n,e,t,i){const r=n.data;if(null===r[t+1]){const s=r[Kn()],o=oA(n,t);dA(s,i)&&null===e&&!o&&(e=!1),e=function u3(n,e,t,i){const r=function hg(n){const e=qe.lFrame.currentDirectiveIndex;return-1===e?null:n[e]}(n);let s=i?e.residualClasses:e.residualStyles;if(null===r)0===(i?e.classBindings:e.styleBindings)&&(t=Xc(t=U_(null,n,e,t,i),e.attrs,i),s=null);else{const o=e.directiveStylingLast;if(-1===o||n[o]!==r)if(t=U_(r,n,e,t,i),null===s){let l=function d3(n,e,t){const i=t?e.classBindings:e.styleBindings;if(0!==oo(i))return n[Ds(i)]}(n,e,i);void 0!==l&&Array.isArray(l)&&(l=U_(null,n,e,l[1],i),l=Xc(l,e.attrs,i),function h3(n,e,t,i){n[Ds(t?e.classBindings:e.styleBindings)]=i}(n,e,i,l))}else s=function f3(n,e,t){let i;const r=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<r;s++)i=Xc(i,n[s].hostAttrs,t);return Xc(i,e.attrs,t)}(n,e,i)}return void 0!==s&&(i?e.residualClasses=s:e.residualStyles=s),t}(r,s,e,i),function QB(n,e,t,i,r,s){let o=s?e.classBindings:e.styleBindings,a=Ds(o),l=oo(o);n[i]=t;let u,c=!1;if(Array.isArray(t)?(u=t[1],(null===u||ya(t,u)>0)&&(c=!0)):u=t,r)if(0!==l){const h=Ds(n[a+1]);n[i+1]=Yh(h,a),0!==h&&(n[h+1]=F_(n[h+1],i)),n[a+1]=function KB(n,e){return 131071&n|e<<17}(n[a+1],i)}else n[i+1]=Yh(a,0),0!==a&&(n[a+1]=F_(n[a+1],i)),a=i;else n[i+1]=Yh(l,0),0===a?a=i:n[l+1]=F_(n[l+1],i),l=i;c&&(n[i+1]=N_(n[i+1])),KE(n,u,i,!0),KE(n,u,i,!1),function e3(n,e,t,i,r){const s=r?n.residualClasses:n.residualStyles;null!=s&&"string"==typeof e&&ya(s,e)>=0&&(t[i+1]=k_(t[i+1]))}(e,u,n,i,s),o=Yh(a,l),s?e.classBindings=o:e.styleBindings=o}(r,s,e,t,o,i)}}(r,null,s,i);const o=ie();if(t!==st&&jn(o,s,t)){const a=r.data[Kn()];if(dA(a,i)&&!oA(r,s)){let l=i?a.classesWithoutHost:a.stylesWithoutHost;null!==l&&(t=Wm(l,t||"")),P_(r,a,o,t,i)}else!function g3(n,e,t,i,r,s,o,a){r===st&&(r=Ct);let l=0,c=0,u=0<r.length?r[0]:null,d=0<s.length?s[0]:null;for(;null!==u||null!==d;){const h=l<r.length?r[l+1]:void 0,f=c<s.length?s[c+1]:void 0;let _,p=null;u===d?(l+=2,c+=2,h!==f&&(p=d,_=f)):null===d||null!==u&&u<d?(l+=2,p=u):(c+=2,p=d,_=f),null!==p&&cA(n,e,t,i,p,_,o,a),u=l<r.length?r[l]:null,d=c<s.length?s[c]:null}}(r,a,o,o[rt],o[s+1],o[s+1]=function p3(n,e,t){if(null==t||""===t)return Ct;const i=[],r=Ts(t);if(Array.isArray(r))for(let s=0;s<r.length;s++)n(i,r[s],!0);else if("object"==typeof r)for(const s in r)r.hasOwnProperty(s)&&n(i,s,r[s]);else"string"==typeof r&&e(i,r);return i}(n,e,t),i,s)}}(lA,l3,n,!1)}function l3(n,e){for(let t=function r3(n){return function tA(n){Mn.key=0,Mn.keyEnd=0,Mn.value=0,Mn.valueEnd=0,Mn.textEnd=n.length}(n),eA(n,Ha(n,0,Mn.textEnd))}(e);t>=0;t=eA(e,t))lA(n,JE(e),n3(e))}function oA(n,e){return e>=n.expandoStartIndex}function U_(n,e,t,i,r){let s=null;const o=t.directiveEnd;let a=t.directiveStylingLast;for(-1===a?a=t.directiveStart:a++;a<o&&(s=e[a],i=Xc(i,s.hostAttrs,r),s!==n);)a++;return null!==n&&(t.directiveStylingLast=a),i}function Xc(n,e,t){const i=t?1:2;let r=-1;if(null!==e)for(let s=0;s<e.length;s++){const o=e[s];"number"==typeof o?r=o:r===i&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),Ti(n,o,!!t||e[++s]))}return void 0===n?null:n}function lA(n,e,t){Ti(n,e,Ts(t))}function cA(n,e,t,i,r,s,o,a){if(!(3&e.type))return;const l=n.data,c=l[a+1],u=function JB(n){return 1==(1&n)}(c)?uA(l,e,t,r,oo(c),o):void 0;Zh(u)||(Zh(s)||function ZB(n){return 2==(2&n)}(c)&&(s=uA(l,null,t,r,a,o)),function r2(n,e,t,i,r){if(e)r?n.addClass(t,i):n.removeClass(t,i);else{let s=-1===i.indexOf("-")?void 0:fi.DashCase;null==r?n.removeStyle(t,i,s):("string"==typeof r&&r.endsWith("!important")&&(r=r.slice(0,-10),s|=fi.Important),n.setStyle(t,i,r,s))}}(i,o,Gd(Kn(),t),r,s))}function uA(n,e,t,i,r,s){const o=null===e;let a;for(;r>0;){const l=n[r],c=Array.isArray(l),u=c?l[1]:l,d=null===u;let h=t[r+1];h===st&&(h=d?Ct:void 0);let f=d?Mg(h,i):u===i?h:void 0;if(c&&!Zh(f)&&(f=Mg(l,i)),Zh(f)&&(a=f,o))return a;const p=n[r+1];r=o?Ds(p):oo(p)}if(null!==e){let l=s?e.residualClasses:e.residualStyles;null!=l&&(a=Mg(l,i))}return a}function Zh(n){return void 0!==n}function dA(n,e){return 0!=(n.flags&(e?8:16))}function B_(n,e=""){const t=ie(),i=Mt(),r=n+mt,s=i.firstCreatePass?Da(i,r,1,e,null):i.data[r],o=hA(i,t,s,e,n);t[r]=o,Wd()&&fh(i,t,o,s),xr(s,!1)}let hA=(n,e,t,i,r)=>(Cs(!0),function uh(n,e){return n.createText(e)}(e[rt],i));function Kh(n){return V_("",n,""),Kh}function V_(n,e,t){const i=ie(),r=function Ia(n,e,t,i){return jn(n,ha(),t)?e+tt(t)+i:st}(i,n,e,t);return r!==st&&function Qr(n,e,t){const i=Gd(e,n);!function FS(n,e,t){n.setValue(e,t)}(n[rt],i,t)}(i,Kn(),r),V_}const Ga="en-US";let NA=Ga;function G_(n,e,t,i,r){if(n=Qe(n),Array.isArray(n))for(let s=0;s<n.length;s++)G_(n[s],e,t,i,r);else{const s=Mt(),o=ie();let a=no(n)?n:Qe(n.provide),l=vM(n);const c=Fn(),u=1048575&c.providerIndexes,d=c.directiveStart,h=c.providerIndexes>>20;if(no(n)||!n.multi){const f=new bc(l,r,De),p=j_(a,e,r?u:u+h,d);-1===p?(wg(Kd(c,o),s,a),W_(s,n,e.length),e.push(a),c.directiveStart++,c.directiveEnd++,r&&(c.providerIndexes+=1048576),t.push(f),o.push(f)):(t[p]=f,o[p]=f)}else{const f=j_(a,e,u+h,d),p=j_(a,e,u,u+h),g=p>=0&&t[p];if(r&&!g||!r&&!(f>=0&&t[f])){wg(Kd(c,o),s,a);const m=function FV(n,e,t,i,r){const s=new bc(n,t,De);return s.multi=[],s.index=e,s.componentProviders=0,oC(s,r,i&&!t),s}(r?NV:OV,t.length,r,i,l);!r&&g&&(t[p].providerFactory=m),W_(s,n,e.length,0),e.push(a),c.directiveStart++,c.directiveEnd++,r&&(c.providerIndexes+=1048576),t.push(m),o.push(m)}else W_(s,n,f>-1?f:p,oC(t[r?p:f],l,!r&&i));!r&&i&&g&&t[p].componentProviders++}}}function W_(n,e,t,i){const r=no(e),s=function O2(n){return!!n.useClass}(e);if(r||s){const l=(s?Qe(e.useClass):e).prototype.ngOnDestroy;if(l){const c=n.destroyHooks||(n.destroyHooks=[]);if(!r&&e.multi){const u=c.indexOf(t);-1===u?c.push(t,[i,l]):c[u+1].push(i,l)}else c.push(t,l)}}}function oC(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function j_(n,e,t,i){for(let r=t;r<i;r++)if(e[r]===n)return r;return-1}function OV(n,e,t,i){return $_(this.multi,[])}function NV(n,e,t,i){const r=this.multi;let s;if(this.providerFactory){const o=this.providerFactory.componentProviders,a=eo(t,t[Me],this.providerFactory.index,i);s=a.slice(0,o),$_(r,s);for(let l=o;l<a.length;l++)s.push(a[l])}else s=[],$_(r,s);return s}function $_(n,e){for(let t=0;t<n.length;t++)e.push((0,n[t])());return e}function aC(n,e=[]){return t=>{t.providersResolver=(i,r)=>function LV(n,e,t){const i=Mt();if(i.firstCreatePass){const r=Zi(n);G_(t,i.data,i.blueprint,r,!0),G_(e,i.data,i.blueprint,r,!1)}}(i,r?r(n):n,e)}}class Wa{}class lC{}class X_ extends Wa{constructor(e,t,i){super(),this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new hE(this);const r=Ei(e);this._bootstrapComponents=Jr(r.bootstrap),this._r3Injector=jM(e,t,[{provide:Wa,useValue:this},{provide:Ea,useValue:this.componentFactoryResolver},...i],wn(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class q_ extends lC{constructor(e){super(),this.moduleType=e}create(e){return new X_(this.moduleType,e,[])}}class cC extends Wa{constructor(e){super(),this.componentFactoryResolver=new hE(this),this.instance=null;const t=new Qg([...e.providers,{provide:Wa,useValue:this},{provide:Ea,useValue:this.componentFactoryResolver}],e.parent||yh(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}}function Y_(n,e,t=null){return new cC({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}let BV=(()=>{class n{constructor(t){this._injector=t,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){const i=pM(0,t.type),r=i.length>0?Y_([i],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t,r)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(const t of this.cachedInjectors.values())null!==t&&t.destroy()}finally{this.cachedInjectors.clear()}}}return n.\u0275prov=Ee({token:n,providedIn:"environment",factory:()=>new n(te(Kr))}),n})();function Z_(n){n.getStandaloneInjector=e=>e.get(BV).getOrCreateStandaloneInjector(n)}function gC(n,e,t,i,r,s){const o=e+t;return jn(n,o,r)?function Er(n,e,t){return n[e]=t}(n,o+1,s?i.call(s,r):i(r)):function Qc(n,e){const t=n[e];return t===st?void 0:t}(n,o+1)}function xC(n,e,t){const i=n+mt,r=ie(),s=function ua(n,e){return n[e]}(r,i);return function eu(n,e){return n[Me].data[e].pure}(r,i)?gC(r,function Zn(){const n=qe.lFrame;let e=n.bindingRootIndex;return-1===e&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}(),e,s.transform,t,s):s.transform(t)}function J_(n){return e=>{setTimeout(n,void 0,e)}}const kn=class cH extends zt{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,t,i){let r=e,s=t||(()=>null),o=i;if(e&&"object"==typeof e){const l=e;r=l.next?.bind(l),s=l.error?.bind(l),o=l.complete?.bind(l)}this.__isAsync&&(s=J_(s),r&&(r=J_(r)),o&&(o=J_(o)));const a=super.subscribe({next:r,error:s,complete:o});return e instanceof Bn&&e.add(a),a}};function uH(){return this._results[Symbol.iterator]()}class Q_{get changes(){return this._changes||(this._changes=new kn)}constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const t=Q_.prototype;t[Symbol.iterator]||(t[Symbol.iterator]=uH)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){const i=this;i.dirty=!1;const r=function Ui(n){return n.flat(Number.POSITIVE_INFINITY)}(e);(this._changesDetected=!function ok(n,e,t){if(n.length!==e.length)return!1;for(let i=0;i<n.length;i++){let r=n[i],s=e[i];if(t&&(r=t(r),s=t(s)),s!==r)return!1}return!0}(i._results,r,t))&&(i._results=r,i.length=r.length,i.last=r[this.length-1],i.first=r[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let Tr=(()=>{class n{}return n.__NG_ELEMENT_ID__=fH,n})();const dH=Tr,hH=class extends dH{constructor(e,t,i){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=i}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,t){return this.createEmbeddedViewImpl(e,t,null)}createEmbeddedViewImpl(e,t,i){const o=this._declarationTContainer.tView,a=Dh(this._declarationLView,o,e,4096&this._declarationLView[it]?4096:16,null,o.declTNode,null,null,null,t||null,i||null);a[gc]=this._declarationLView[this._declarationTContainer.index];const c=this._declarationLView[vr];return null!==c&&(a[vr]=c.createEmbeddedView(o)),E_(o,a,e),new Hc(a)}};function fH(){return nf(Fn(),ie())}function nf(n,e){return 4&n.type?new hH(e,n,Aa(n,e)):null}let Vi=(()=>{class n{}return n.__NG_ELEMENT_ID__=bH,n})();function bH(){return TC(Fn(),ie())}const wH=Vi,AC=class extends wH{constructor(e,t,i){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=i}get element(){return Aa(this._hostTNode,this._hostLView)}get injector(){return new pa(this._hostTNode,this._hostLView)}get parentInjector(){const e=bg(this._hostTNode,this._hostLView);if(Qx(e)){const t=Yd(e,this._hostLView),i=qd(e);return new pa(t[Me].data[i+8],t)}return new pa(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=CC(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-Gn}createEmbeddedView(e,t,i){let r,s;"number"==typeof i?r=i:null!=i&&(r=i.index,s=i.injector);const a=e.createEmbeddedViewImpl(t||{},s,null);return this.insertImpl(a,r,false),a}createComponent(e,t,i,r,s){const o=e&&!function xc(n){return"function"==typeof n}(e);let a;if(o)a=t;else{const _=t||{};a=_.index,i=_.injector,r=_.projectableNodes,s=_.environmentInjector||_.ngModuleRef}const l=o?e:new zc(Rt(e)),c=i||this.parentInjector;if(!s&&null==l.ngModule){const g=(o?c:this.parentInjector).get(Kr,null);g&&(s=g)}Rt(l.componentType??{});const f=l.create(c,r,null,s);return this.insertImpl(f.hostView,a,false),f}insert(e,t){return this.insertImpl(e,t,!1)}insertImpl(e,t,i){const r=e._lView,s=r[Me];if(function SF(n){return di(n[jt])}(r)){const l=this.indexOf(e);if(-1!==l)this.detach(l);else{const c=r[jt],u=new AC(c,c[zn],c[jt]);u.detach(u.indexOf(e))}}const o=this._adjustIndex(t),a=this._lContainer;if(function Yk(n,e,t,i){const r=Gn+i,s=t.length;i>0&&(t[r-1][Yi]=e),i<s-Gn?(e[Yi]=t[r],hS(t,Gn+i,e)):(t.push(e),e[Yi]=null),e[jt]=t;const o=e[gc];null!==o&&t!==o&&function Zk(n,e){const t=n[ca];e[ln]!==e[jt][jt][ln]&&(n[gx]=!0),null===t?n[ca]=[e]:t.push(e)}(o,e);const a=e[vr];null!==a&&a.insertView(n),e[it]|=128}(s,r,a,o),!i){const l=Bg(o,a),c=r[rt],u=hh(c,a[yr]);null!==u&&function $k(n,e,t,i,r,s){i[xn]=r,i[zn]=e,Dc(n,i,t,1,r,s)}(s,a[zn],c,r,u,l)}return e.attachToViewContainerRef(),hS(tv(a),o,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=CC(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),i=Ng(this._lContainer,t);i&&(eh(tv(this._lContainer),t),US(i[Me],i))}detach(e){const t=this._adjustIndex(e,-1),i=Ng(this._lContainer,t);return i&&null!=eh(tv(this._lContainer),t)?new Hc(i):null}_adjustIndex(e,t=0){return e??this.length+t}};function CC(n){return n[8]}function tv(n){return n[8]||(n[8]=[])}function TC(n,e){let t;const i=e[n.index];return di(i)?t=i:(t=tE(i,e,null,n),e[n.index]=t,Rh(e,t)),DC(t,e,n,i),new AC(t,n,e)}let DC=function RC(n,e,t,i){if(n[yr])return;let r;r=8&t.type?Vt(i):function xH(n,e){const t=n[rt],i=t.createComment(""),r=hi(e,n);return to(t,hh(t,r),i,function e2(n,e){return n.nextSibling(e)}(t,r),!1),i}(e,t),n[yr]=r};class nv{constructor(e){this.queryList=e,this.matches=null}clone(){return new nv(this.queryList)}setDirty(){this.queryList.setDirty()}}class iv{constructor(e=[]){this.queries=e}createEmbeddedView(e){const t=e.queries;if(null!==t){const i=null!==e.contentQueries?e.contentQueries[0]:t.length,r=[];for(let s=0;s<i;s++){const o=t.getByIndex(s);r.push(this.queries[o.indexInDeclarationView].clone())}return new iv(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)null!==kC(e,t).matches&&this.queries[t].setDirty()}}class IC{constructor(e,t,i=null){this.predicate=e,this.flags=t,this.read=i}}class rv{constructor(e=[]){this.queries=e}elementStart(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let i=0;i<this.length;i++){const r=null!==t?t.length:0,s=this.getByIndex(i).embeddedTView(e,r);s&&(s.indexInDeclarationView=i,null!==t?t.push(s):t=[s])}return null!==t?new rv(t):null}template(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class sv{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new sv(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const t=this._declarationNodeIndex;let i=e.parent;for(;null!==i&&8&i.type&&i.index!==t;)i=i.parent;return t===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(e,t){const i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){const s=i[r];this.matchTNodeWithReadOption(e,t,EH(t,s)),this.matchTNodeWithReadOption(e,t,Jd(t,e,s,!1,!1))}else i===Tr?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,Jd(t,e,i,!1,!1))}matchTNodeWithReadOption(e,t,i){if(null!==i){const r=this.metadata.read;if(null!==r)if(r===mi||r===Vi||r===Tr&&4&t.type)this.addMatch(t.index,-2);else{const s=Jd(t,e,r,!1,!1);null!==s&&this.addMatch(t.index,s)}else this.addMatch(t.index,i)}}addMatch(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}function EH(n,e){const t=n.localNames;if(null!==t)for(let i=0;i<t.length;i+=2)if(t[i]===e)return t[i+1];return null}function CH(n,e,t,i){return-1===t?function AH(n,e){return 11&n.type?Aa(n,e):4&n.type?nf(n,e):null}(e,n):-2===t?function TH(n,e,t){return t===mi?Aa(e,n):t===Tr?nf(e,n):t===Vi?TC(e,n):void 0}(n,e,i):eo(n,n[Me],t,e)}function PC(n,e,t,i){const r=e[vr].queries[i];if(null===r.matches){const s=n.data,o=t.matches,a=[];for(let l=0;l<o.length;l+=2){const c=o[l];a.push(c<0?null:CH(e,s[c],o[l+1],t.metadata.read))}r.matches=a}return r.matches}function ov(n,e,t,i){const r=n.queries.getByIndex(t),s=r.matches;if(null!==s){const o=PC(n,e,r,t);for(let a=0;a<s.length;a+=2){const l=s[a];if(l>0)i.push(o[a/2]);else{const c=s[a+1],u=e[-l];for(let d=Gn;d<u.length;d++){const h=u[d];h[gc]===h[jt]&&ov(h[Me],h,c,i)}if(null!==u[ca]){const d=u[ca];for(let h=0;h<d.length;h++){const f=d[h];ov(f[Me],f,c,i)}}}}}return i}function av(n){const e=ie(),t=Mt(),i=Gx();fg(i+1);const r=kC(t,i);if(n.dirty&&function wF(n){return 4==(4&n[it])}(e)===(2==(2&r.metadata.flags))){if(null===r.matches)n.reset([]);else{const s=r.crossesNgTemplate?ov(t,e,i,[]):PC(t,e,r,i);n.reset(s,tU),n.notifyOnChanges()}return!0}return!1}function LC(n,e,t){const i=Mt();i.firstCreatePass&&(function FC(n,e,t){null===n.queries&&(n.queries=new rv),n.queries.track(new sv(e,t))}(i,new IC(n,e,t),-1),2==(2&e)&&(i.staticViewQueries=!0)),function NC(n,e,t){const i=new Q_(4==(4&t));(function SU(n,e,t,i){const r=iE(e);r.push(t),n.firstCreatePass&&rE(n).push(i,r.length-1)})(n,e,i,i.destroy),null===e[vr]&&(e[vr]=new iv),e[vr].queries.push(new nv(i))}(i,ie(),e)}function kC(n,e){return n.queries.getByIndex(e)}const pv=new Ce("Application Initializer");let mv=(()=>{class n{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((t,i)=>{this.resolve=t,this.reject=i}),this.appInits=_e(pv,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const t=[];for(const r of this.appInits){const s=r();if(Xh(s))t.push(s);else if(kE(s)){const o=new Promise((a,l)=>{s.subscribe({complete:a,error:l})});t.push(o)}}const i=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{i()}).catch(r=>{this.reject(r)}),0===t.length&&i(),this.initialized=!0}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ee({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),eT=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ee({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();const es=new Ce("LocaleId",{providedIn:"root",factory:()=>_e(es,Ge.Optional|Ge.SkipSelf)||function JH(){return typeof $localize<"u"&&$localize.locale||Ga}()});let tT=(()=>{class n{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new si(!1)}add(){this.hasPendingTasks.next(!0);const t=this.taskId++;return this.pendingTasks.add(t),t}remove(t){this.pendingTasks.delete(t),0===this.pendingTasks.size&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks.next(!1)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ee({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class ez{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}}let nT=(()=>{class n{compileModuleSync(t){return new q_(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){const i=this.compileModuleSync(t),s=Jr(Ei(t).declarations).reduce((o,a)=>{const l=Rt(a);return l&&o.push(new zc(l)),o},[]);return new ez(i,s)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ee({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function sT(...n){}class Et{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new kn(!1),this.onMicrotaskEmpty=new kn(!1),this.onStable=new kn(!1),this.onError=new kn(!1),typeof Zone>"u")throw new he(908,!1);Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!i&&t,r.shouldCoalesceRunChangeDetection=i,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function iz(){const n="function"==typeof kt.requestAnimationFrame;let e=kt[n?"requestAnimationFrame":"setTimeout"],t=kt[n?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&t){const i=e[Zone.__symbol__("OriginalDelegate")];i&&(e=i);const r=t[Zone.__symbol__("OriginalDelegate")];r&&(t=r)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function oz(n){const e=()=>{!function sz(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(kt,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,_v(n),n.isCheckStableRunning=!0,gv(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),_v(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,i,r,s,o,a)=>{try{return oT(n),t.invokeTask(r,s,o,a)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||n.shouldCoalesceRunChangeDetection)&&e(),aT(n)}},onInvoke:(t,i,r,s,o,a,l)=>{try{return oT(n),t.invoke(r,s,o,a,l)}finally{n.shouldCoalesceRunChangeDetection&&e(),aT(n)}},onHasTask:(t,i,r,s)=>{t.hasTask(r,s),i===r&&("microTask"==s.change?(n._hasPendingMicrotasks=s.microTask,_v(n),gv(n)):"macroTask"==s.change&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(t,i,r,s)=>(t.handleError(r,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}(r)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Et.isInAngularZone())throw new he(909,!1)}static assertNotInAngularZone(){if(Et.isInAngularZone())throw new he(909,!1)}run(e,t,i){return this._inner.run(e,t,i)}runTask(e,t,i,r){const s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+r,e,rz,sT,sT);try{return s.runTask(o,t,i)}finally{s.cancelTask(o)}}runGuarded(e,t,i){return this._inner.runGuarded(e,t,i)}runOutsideAngular(e){return this._outer.run(e)}}const rz={};function gv(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function _v(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function oT(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function aT(n){n._nesting--,gv(n)}class az{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new kn,this.onMicrotaskEmpty=new kn,this.onStable=new kn,this.onError=new kn}run(e,t,i){return e.apply(t,i)}runGuarded(e,t,i){return e.apply(t,i)}runOutsideAngular(e){return e()}runTask(e,t,i,r){return e.apply(t,i)}}const lT=new Ce("",{providedIn:"root",factory:cT});function cT(){const n=_e(Et);let e=!0;return Ww(new Ht(r=>{e=n.isStable&&!n.hasPendingMacrotasks&&!n.hasPendingMicrotasks,n.runOutsideAngular(()=>{r.next(e),r.complete()})}),new Ht(r=>{let s;n.runOutsideAngular(()=>{s=n.onStable.subscribe(()=>{Et.assertNotInAngularZone(),queueMicrotask(()=>{!e&&!n.hasPendingMacrotasks&&!n.hasPendingMicrotasks&&(e=!0,r.next(!0))})})});const o=n.onUnstable.subscribe(()=>{Et.assertInAngularZone(),e&&(e=!1,n.runOutsideAngular(()=>{r.next(!1)}))});return()=>{s.unsubscribe(),o.unsubscribe()}}).pipe(jw()))}const uT=new Ce(""),sf=new Ce("");let bv,vv=(()=>{class n{constructor(t,i,r){this._ngZone=t,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,bv||(function lz(n){bv=n}(r),r.addToWindow(i)),this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Et.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(t)||(clearTimeout(i.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,i,r){let s=-1;i&&i>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==s),t(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:t,timeoutId:s,updateCb:r})}whenStable(t,i,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,i,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(t){this.registry.registerApplication(t,this)}unregisterApplication(t){this.registry.unregisterApplication(t)}findProviders(t,i,r){return[]}}return n.\u0275fac=function(t){return new(t||n)(te(Et),te(yv),te(sf))},n.\u0275prov=Ee({token:n,factory:n.\u0275fac}),n})(),yv=(()=>{class n{constructor(){this._applications=new Map}registerApplication(t,i){this._applications.set(t,i)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,i=!0){return bv?.findTestabilityInTree(this,t,i)??null}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ee({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})(),Rs=null;const dT=new Ce("AllowMultipleToken"),wv=new Ce("PlatformDestroyListeners"),xv=new Ce("appBootstrapListener");class fT{constructor(e,t){this.name=e,this.token=t}}function mT(n,e,t=[]){const i=`Platform: ${e}`,r=new Ce(i);return(s=[])=>{let o=Sv();if(!o||o.injector.get(dT,!1)){const a=[...t,...s,{provide:r,useValue:!0}];n?n(a):function dz(n){if(Rs&&!Rs.get(dT,!1))throw new he(400,!1);(function hT(){!function dF(n){xx=n}(()=>{throw new he(600,!1)})})(),Rs=n;const e=n.get(_T);(function pT(n){n.get(yM,null)?.forEach(t=>t())})(n)}(function gT(n=[],e){return gi.create({name:e,providers:[{provide:Kg,useValue:"platform"},{provide:wv,useValue:new Set([()=>Rs=null])},...n]})}(a,i))}return function fz(n){const e=Sv();if(!e)throw new he(401,!1);return e}()}}function Sv(){return Rs?.get(_T)??null}let _T=(()=>{class n{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,i){const r=function pz(n="zone.js",e){return"noop"===n?new az:"zone.js"===n?new Et(e):n}(i?.ngZone,function vT(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}({eventCoalescing:i?.ngZoneEventCoalescing,runCoalescing:i?.ngZoneRunCoalescing}));return r.run(()=>{const s=function UV(n,e,t){return new X_(n,e,t)}(t.moduleType,this.injector,function ST(n){return[{provide:Et,useFactory:n},{provide:Oc,multi:!0,useFactory:()=>{const e=_e(gz,{optional:!0});return()=>e.initialize()}},{provide:xT,useFactory:mz},{provide:lT,useFactory:cT}]}(()=>r)),o=s.injector.get(ro,null);return r.runOutsideAngular(()=>{const a=r.onError.subscribe({next:l=>{o.handleError(l)}});s.onDestroy(()=>{af(this._modules,s),a.unsubscribe()})}),function yT(n,e,t){try{const i=t();return Xh(i)?i.catch(r=>{throw e.runOutsideAngular(()=>n.handleError(r)),r}):i}catch(i){throw e.runOutsideAngular(()=>n.handleError(i)),i}}(o,r,()=>{const a=s.injector.get(mv);return a.runInitializers(),a.donePromise.then(()=>(function FA(n){ki(n,"Expected localeId to be defined"),"string"==typeof n&&(NA=n.toLowerCase().replace(/_/g,"-"))}(s.injector.get(es,Ga)||Ga),this._moduleDoBootstrap(s),s))})})}bootstrapModule(t,i=[]){const r=bT({},i);return function cz(n,e,t){const i=new q_(t);return Promise.resolve(i)}(0,0,t).then(s=>this.bootstrapModuleFactory(s,r))}_moduleDoBootstrap(t){const i=t.injector.get(lo);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(r=>i.bootstrap(r));else{if(!t.instance.ngDoBootstrap)throw new he(-403,!1);t.instance.ngDoBootstrap(i)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new he(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());const t=this._injector.get(wv,null);t&&(t.forEach(i=>i()),t.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return n.\u0275fac=function(t){return new(t||n)(te(gi))},n.\u0275prov=Ee({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();function bT(n,e){return Array.isArray(e)?e.reduce(bT,n):{...n,...e}}let lo=(()=>{class n{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=_e(xT),this.zoneIsStable=_e(lT),this.componentTypes=[],this.components=[],this.isStable=_e(tT).hasPendingTasks.pipe(mr(t=>t?$e(!1):this.zoneIsStable),$w(),jw()),this._injector=_e(Kr)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(t,i){const r=t instanceof EM;if(!this._injector.get(mv).done)throw!r&&function ra(n){const e=Rt(n)||Hn(n)||ui(n);return null!==e&&e.standalone}(t),new he(405,!1);let o;o=r?t:this._injector.get(Ea).resolveComponentFactory(t),this.componentTypes.push(o.componentType);const a=function uz(n){return n.isBoundToModule}(o)?void 0:this._injector.get(Wa),c=o.create(gi.NULL,[],i||o.selector,a),u=c.location.nativeElement,d=c.injector.get(uT,null);return d?.registerApplication(u),c.onDestroy(()=>{this.detachView(c.hostView),af(this.components,c),d?.unregisterApplication(u)}),this._loadComponent(c),c}tick(){if(this._runningTick)throw new he(101,!1);try{this._runningTick=!0;for(let t of this._views)t.detectChanges()}catch(t){this.internalErrorHandler(t)}finally{this._runningTick=!1}}attachView(t){const i=t;this._views.push(i),i.attachToAppRef(this)}detachView(t){const i=t;af(this._views,i),i.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t);const i=this._injector.get(xv,[]);i.push(...this._bootstrapListeners),i.forEach(r=>r(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>af(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new he(406,!1);const t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ee({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function af(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}const xT=new Ce("",{providedIn:"root",factory:()=>_e(ro).handleError.bind(void 0)});function mz(){const n=_e(Et),e=_e(ro);return t=>n.runOutsideAngular(()=>e.handleError(t))}let gz=(()=>{class n{constructor(){this.zone=_e(Et),this.applicationRef=_e(lo)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ee({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();let Mv=(()=>{class n{}return n.__NG_ELEMENT_ID__=vz,n})();function vz(n){return function yz(n,e,t){if(Zs(n)&&!t){const i=Ci(n.index,e);return new Hc(i,i)}return 47&n.type?new Hc(e[ln],e):null}(Fn(),ie(),16==(16&n))}class CT{constructor(){}supports(e){return Fh(e)}create(e){return new Ez(e)}}const Mz=(n,e)=>e;class Ez{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||Mz}forEachItem(e){let t;for(t=this._itHead;null!==t;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,i=this._removalsHead,r=0,s=null;for(;t||i;){const o=!i||t&&t.currentIndex<DT(i,r,s)?t:i,a=DT(o,r,s),l=o.currentIndex;if(o===i)r--,i=i._nextRemoved;else if(t=t._next,null==o.previousIndex)r++;else{s||(s=[]);const c=a-r,u=l-r;if(c!=u){for(let h=0;h<c;h++){const f=h<s.length?s[h]:s[h]=0,p=f+h;u<=p&&p<c&&(s[h]=f+1)}s[o.previousIndex]=u-c}}a!==l&&e(o,a,l)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}diff(e){if(null==e&&(e=[]),!Fh(e))throw new he(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let r,s,o,t=this._itHead,i=!1;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),null!==t&&Object.is(t.trackById,o)?(i&&(t=this._verifyReinsertion(t,s,o,a)),Object.is(t.item,s)||this._addIdentityChange(t,s)):(t=this._mismatch(t,s,o,a),i=!0),t=t._next}else r=0,function _B(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{const t=n[Symbol.iterator]();let i;for(;!(i=t.next()).done;)e(i.value)}}(e,a=>{o=this._trackByFn(r,a),null!==t&&Object.is(t.trackById,o)?(i&&(t=this._verifyReinsertion(t,a,o,r)),Object.is(t.item,a)||this._addIdentityChange(t,a)):(t=this._mismatch(t,a,o,r),i=!0),t=t._next,r++}),this.length=r;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,i,r){let s;return null===e?s=this._itTail:(s=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,s,r)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(i,r))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,s,r)):e=this._addAfter(new Az(t,i),s,r),e}_verifyReinsertion(e,t,i,r){let s=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==s?e=this._reinsertAfter(s,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}_truncate(e){for(;null!==e;){const t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const r=e._prevRemoved,s=e._nextRemoved;return null===r?this._removalsHead=s:r._nextRemoved=s,null===s?this._removalsTail=r:s._prevRemoved=r,this._insertAfter(e,t,i),this._addToMoves(e,i),e}_moveAfter(e,t,i){return this._unlink(e),this._insertAfter(e,t,i),this._addToMoves(e,i),e}_addAfter(e,t,i){return this._insertAfter(e,t,i),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,t,i){const r=null===t?this._itHead:t._next;return e._next=r,e._prev=t,null===r?this._itTail=e:r._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new TT),this._linkedRecords.put(e),e.currentIndex=i,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const t=e._prev,i=e._next;return null===t?this._itHead=i:t._next=i,null===i?this._itTail=t:i._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new TT),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class Az{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class Cz{constructor(){this._head=null,this._tail=null}add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===t||t<=i.currentIndex)&&Object.is(i.trackById,e))return i;return null}remove(e){const t=e._prevDup,i=e._nextDup;return null===t?this._head=i:t._nextDup=i,null===i?this._tail=t:i._prevDup=t,null===this._head}}class TT{constructor(){this.map=new Map}put(e){const t=e.trackById;let i=this.map.get(t);i||(i=new Cz,this.map.set(t,i)),i.add(e)}get(e,t){const r=this.map.get(e);return r?r.get(e,t):null}remove(e){const t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function DT(n,e,t){const i=n.previousIndex;if(null===i)return i;let r=0;return t&&i<t.length&&(r=t[i]),i+e+r}function IT(){return new uf([new CT])}let uf=(()=>{class n{constructor(t){this.factories=t}static create(t,i){if(null!=i){const r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:i=>n.create(t,i||IT()),deps:[[n,new ih,new nh]]}}find(t){const i=this.factories.find(r=>r.supports(t));if(null!=i)return i;throw new he(901,!1)}}return n.\u0275prov=Ee({token:n,providedIn:"root",factory:IT}),n})();const Pz=mT(null,"core",[]);let Lz=(()=>{class n{constructor(t){}}return n.\u0275fac=function(t){return new(t||n)(te(lo))},n.\u0275mod=li({type:n}),n.\u0275inj=Yn({}),n})(),Pv=null;function Xa(){return Pv}class jz{}const Nt=new Ce("DocumentToken");let Lv=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ee({token:n,factory:function(){return _e(Xz)},providedIn:"platform"}),n})();const $z=new Ce("Location Initialized");let Xz=(()=>{class n extends Lv{constructor(){super(),this._doc=_e(Nt),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Xa().getBaseHref(this._doc)}onPopState(t){const i=Xa().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",t,!1),()=>i.removeEventListener("popstate",t)}onHashChange(t){const i=Xa().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",t,!1),()=>i.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,i,r){this._history.pushState(t,i,r)}replaceState(t,i,r){this._history.replaceState(t,i,r)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ee({token:n,factory:function(){return new n},providedIn:"platform"}),n})();function Ov(n,e){if(0==n.length)return e;if(0==e.length)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?n+e.substring(1):1==t?n+e:n+"/"+e}function BT(n){const e=n.match(/#|\?|$/),t=e&&e.index||n.length;return n.slice(0,t-("/"===n[t-1]?1:0))+n.slice(t)}function ts(n){return n&&"?"!==n[0]?"?"+n:n}let uo=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ee({token:n,factory:function(){return _e(HT)},providedIn:"root"}),n})();const VT=new Ce("appBaseHref");let HT=(()=>{class n extends uo{constructor(t,i){super(),this._platformLocation=t,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??_e(Nt).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return Ov(this._baseHref,t)}path(t=!1){const i=this._platformLocation.pathname+ts(this._platformLocation.search),r=this._platformLocation.hash;return r&&t?`${i}${r}`:i}pushState(t,i,r,s){const o=this.prepareExternalUrl(r+ts(s));this._platformLocation.pushState(t,i,o)}replaceState(t,i,r,s){const o=this.prepareExternalUrl(r+ts(s));this._platformLocation.replaceState(t,i,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}}return n.\u0275fac=function(t){return new(t||n)(te(Lv),te(VT,8))},n.\u0275prov=Ee({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),qz=(()=>{class n extends uo{constructor(t,i){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],null!=i&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let i=this._platformLocation.hash;return null==i&&(i="#"),i.length>0?i.substring(1):i}prepareExternalUrl(t){const i=Ov(this._baseHref,t);return i.length>0?"#"+i:i}pushState(t,i,r,s){let o=this.prepareExternalUrl(r+ts(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.pushState(t,i,o)}replaceState(t,i,r,s){let o=this.prepareExternalUrl(r+ts(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.replaceState(t,i,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}}return n.\u0275fac=function(t){return new(t||n)(te(Lv),te(VT,8))},n.\u0275prov=Ee({token:n,factory:n.\u0275fac}),n})(),hf=(()=>{class n{constructor(t){this._subject=new kn,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;const i=this._locationStrategy.getBaseHref();this._basePath=function Kz(n){if(new RegExp("^(https?:)?//").test(n)){const[,t]=n.split(/\/\/[^\/]+/);return t}return n}(BT(zT(i))),this._locationStrategy.onPopState(r=>{this._subject.emit({url:this.path(!0),pop:!0,state:r.state,type:r.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,i=""){return this.path()==this.normalize(t+ts(i))}normalize(t){return n.stripTrailingSlash(function Zz(n,e){if(!n||!e.startsWith(n))return e;const t=e.substring(n.length);return""===t||["/",";","?","#"].includes(t[0])?t:e}(this._basePath,zT(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,i="",r=null){this._locationStrategy.pushState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+ts(i)),r)}replaceState(t,i="",r=null){this._locationStrategy.replaceState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+ts(i)),r)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)})),()=>{const i=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(i,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",i){this._urlChangeListeners.forEach(r=>r(t,i))}subscribe(t,i,r){return this._subject.subscribe({next:t,error:i,complete:r})}}return n.normalizeQueryParams=ts,n.joinWithSlash=Ov,n.stripTrailingSlash=BT,n.\u0275fac=function(t){return new(t||n)(te(uo))},n.\u0275prov=Ee({token:n,factory:function(){return function Yz(){return new hf(te(uo))}()},providedIn:"root"}),n})();function zT(n){return n.replace(/\/index.html$/,"")}class kG{constructor(e,t,i,r){this.$implicit=e,this.ngForOf=t,this.index=i,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let QT=(()=>{class n{set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}constructor(t,i,r){this._viewContainer=t,this._template=i,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const i=this._viewContainer;t.forEachOperation((r,s,o)=>{if(null==r.previousIndex)i.createEmbeddedView(this._template,new kG(r.item,this._ngForOf,-1,-1),null===o?void 0:o);else if(null==o)i.remove(null===s?void 0:s);else if(null!==s){const a=i.get(s);i.move(a,o),eD(a,r)}});for(let r=0,s=i.length;r<s;r++){const a=i.get(r).context;a.index=r,a.count=s,a.ngForOf=this._ngForOf}t.forEachIdentityChange(r=>{eD(i.get(r.currentIndex),r)})}static ngTemplateContextGuard(t,i){return!0}}return n.\u0275fac=function(t){return new(t||n)(De(Vi),De(Tr),De(uf))},n.\u0275dir=Vn({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0}),n})();function eD(n,e){n.context.$implicit=e.item}let tD=(()=>{class n{constructor(t,i){this._viewContainer=t,this._context=new UG,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){nD("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){nD("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,i){return!0}}return n.\u0275fac=function(t){return new(t||n)(De(Vi),De(Tr))},n.\u0275dir=Vn({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),n})();class UG{constructor(){this.$implicit=null,this.ngIf=null}}function nD(n,e){if(e&&!e.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${wn(e)}'.`)}class HG{createSubscription(e,t){return Sx(()=>e.subscribe({next:t,error:i=>{throw i}}))}dispose(e){Sx(()=>e.unsubscribe())}}class zG{createSubscription(e,t){return e.then(t,i=>{throw i})}dispose(e){}}const GG=new zG,WG=new HG;let rD=(()=>{class n{constructor(t){this._latestValue=null,this._subscription=null,this._obj=null,this._strategy=null,this._ref=t}ngOnDestroy(){this._subscription&&this._dispose(),this._ref=null}transform(t){return this._obj?t!==this._obj?(this._dispose(),this.transform(t)):this._latestValue:(t&&this._subscribe(t),this._latestValue)}_subscribe(t){this._obj=t,this._strategy=this._selectStrategy(t),this._subscription=this._strategy.createSubscription(t,i=>this._updateLatestValue(t,i))}_selectStrategy(t){if(Xh(t))return GG;if(kE(t))return WG;throw function tr(n,e){return new he(2100,!1)}()}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(t,i){t===this._obj&&(this._latestValue=i,this._ref.markForCheck())}}return n.\u0275fac=function(t){return new(t||n)(De(Mv,16))},n.\u0275pipe=ci({name:"async",type:n,pure:!1,standalone:!0}),n})(),lW=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=li({type:n}),n.\u0275inj=Yn({}),n})();const oD="browser";function aD(n){return"server"===n}let fW=(()=>{class n{}return n.\u0275prov=Ee({token:n,providedIn:"root",factory:()=>new pW(te(Nt),window)}),n})();class pW{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const t=function mW(n,e){const t=n.getElementById(e)||n.getElementsByName(e)[0];if(t)return t;if("function"==typeof n.createTreeWalker&&n.body&&"function"==typeof n.body.attachShadow){const i=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT);let r=i.currentNode;for(;r;){const s=r.shadowRoot;if(s){const o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}r=i.nextNode()}}return null}(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){if(this.supportScrollRestoration()){const t=this.window.history;t&&t.scrollRestoration&&(t.scrollRestoration=e)}}scrollToElement(e){const t=e.getBoundingClientRect(),i=t.left+this.window.pageXOffset,r=t.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(i-s[0],r-s[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const e=lD(this.window.history)||lD(Object.getPrototypeOf(this.window.history));return!(!e||!e.writable&&!e.set)}catch{return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}function lD(n){return Object.getOwnPropertyDescriptor(n,"scrollRestoration")}class BW extends jz{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class Kv extends BW{static makeCurrent(){!function Wz(n){Pv||(Pv=n)}(new Kv)}onAndCancel(e,t,i){return e.addEventListener(t,i),()=>{e.removeEventListener(t,i)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function VW(){return ou=ou||document.querySelector("base"),ou?ou.getAttribute("href"):null}();return null==t?null:function HW(n){Mf=Mf||document.createElement("a"),Mf.setAttribute("href",n);const e=Mf.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){ou=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return function OG(n,e){e=encodeURIComponent(e);for(const t of n.split(";")){const i=t.indexOf("="),[r,s]=-1==i?[t,""]:[t.slice(0,i),t.slice(i+1)];if(r.trim()===e)return decodeURIComponent(s)}return null}(document.cookie,e)}}let Mf,ou=null,GW=(()=>{class n{build(){return new XMLHttpRequest}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ee({token:n,factory:n.\u0275fac}),n})();const Jv=new Ce("EventManagerPlugins");let fD=(()=>{class n{constructor(t,i){this._zone=i,this._eventNameToPlugin=new Map,t.forEach(r=>{r.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,i,r){return this._findPluginFor(i).addEventListener(t,i,r)}getZone(){return this._zone}_findPluginFor(t){let i=this._eventNameToPlugin.get(t);if(i)return i;if(i=this._plugins.find(s=>s.supports(t)),!i)throw new he(5101,!1);return this._eventNameToPlugin.set(t,i),i}}return n.\u0275fac=function(t){return new(t||n)(te(Jv),te(Et))},n.\u0275prov=Ee({token:n,factory:n.\u0275fac}),n})();class pD{constructor(e){this._doc=e}}const Qv="ng-app-id";let mD=(()=>{class n{constructor(t,i,r,s={}){this.doc=t,this.appId=i,this.nonce=r,this.platformId=s,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=aD(s),this.resetHostNodes()}addStyles(t){for(const i of t)1===this.changeUsageCount(i,1)&&this.onStyleAdded(i)}removeStyles(t){for(const i of t)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){const t=this.styleNodesInDOM;t&&(t.forEach(i=>i.remove()),t.clear());for(const i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(t){this.hostNodes.add(t);for(const i of this.getAllStyles())this.addStyleToHost(t,i)}removeHost(t){this.hostNodes.delete(t)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(t){for(const i of this.hostNodes)this.addStyleToHost(i,t)}onStyleRemoved(t){const i=this.styleRef;i.get(t)?.elements?.forEach(r=>r.remove()),i.delete(t)}collectServerRenderedStyles(){const t=this.doc.head?.querySelectorAll(`style[${Qv}="${this.appId}"]`);if(t?.length){const i=new Map;return t.forEach(r=>{null!=r.textContent&&i.set(r.textContent,r)}),i}return null}changeUsageCount(t,i){const r=this.styleRef;if(r.has(t)){const s=r.get(t);return s.usage+=i,s.usage}return r.set(t,{usage:i,elements:[]}),i}getStyleElement(t,i){const r=this.styleNodesInDOM,s=r?.get(i);if(s?.parentNode===t)return r.delete(i),s.removeAttribute(Qv),s;{const o=this.doc.createElement("style");return this.nonce&&o.setAttribute("nonce",this.nonce),o.textContent=i,this.platformIsServer&&o.setAttribute(Qv,this.appId),o}}addStyleToHost(t,i){const r=this.getStyleElement(t,i);t.appendChild(r);const s=this.styleRef,o=s.get(i)?.elements;o?o.push(r):s.set(i,{elements:[r],usage:1})}resetHostNodes(){const t=this.hostNodes;t.clear(),t.add(this.doc.head)}}return n.\u0275fac=function(t){return new(t||n)(te(Nt),te(bh),te(n_,8),te(io))},n.\u0275prov=Ee({token:n,factory:n.\u0275fac}),n})();const ey={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},ty=/%COMP%/g,XW=new Ce("RemoveStylesOnCompDestroy",{providedIn:"root",factory:()=>!1});function _D(n,e){return e.map(t=>t.replace(ty,n))}let vD=(()=>{class n{constructor(t,i,r,s,o,a,l,c=null){this.eventManager=t,this.sharedStylesHost=i,this.appId=r,this.removeStylesOnCompDestroy=s,this.doc=o,this.platformId=a,this.ngZone=l,this.nonce=c,this.rendererByCompId=new Map,this.platformIsServer=aD(a),this.defaultRenderer=new ny(t,o,l,this.platformIsServer)}createRenderer(t,i){if(!t||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===Mi.ShadowDom&&(i={...i,encapsulation:Mi.Emulated});const r=this.getOrCreateRenderer(t,i);return r instanceof bD?r.applyToHost(t):r instanceof iy&&r.applyStyles(),r}getOrCreateRenderer(t,i){const r=this.rendererByCompId;let s=r.get(i.id);if(!s){const o=this.doc,a=this.ngZone,l=this.eventManager,c=this.sharedStylesHost,u=this.removeStylesOnCompDestroy,d=this.platformIsServer;switch(i.encapsulation){case Mi.Emulated:s=new bD(l,c,i,this.appId,u,o,a,d);break;case Mi.ShadowDom:return new KW(l,c,t,i,o,a,this.nonce,d);default:s=new iy(l,c,i,u,o,a,d)}r.set(i.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}}return n.\u0275fac=function(t){return new(t||n)(te(fD),te(mD),te(bh),te(XW),te(Nt),te(io),te(Et),te(n_))},n.\u0275prov=Ee({token:n,factory:n.\u0275fac}),n})();class ny{constructor(e,t,i,r){this.eventManager=e,this.doc=t,this.ngZone=i,this.platformIsServer=r,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(ey[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(yD(e)?e.content:e).appendChild(t)}insertBefore(e,t,i){e&&(yD(e)?e.content:e).insertBefore(t,i)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let i="string"==typeof e?this.doc.querySelector(e):e;if(!i)throw new he(-5104,!1);return t||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,i,r){if(r){t=r+":"+t;const s=ey[r];s?e.setAttributeNS(s,t,i):e.setAttribute(t,i)}else e.setAttribute(t,i)}removeAttribute(e,t,i){if(i){const r=ey[i];r?e.removeAttributeNS(r,t):e.removeAttribute(`${i}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,i,r){r&(fi.DashCase|fi.Important)?e.style.setProperty(t,i,r&fi.Important?"important":""):e.style[t]=i}removeStyle(e,t,i){i&fi.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,i){e[t]=i}setValue(e,t){e.nodeValue=t}listen(e,t,i){if("string"==typeof e&&!(e=Xa().getGlobalEventTarget(this.doc,e)))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(i))}decoratePreventDefault(e){return t=>{if("__ngUnwrap__"===t)return e;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))&&t.preventDefault()}}}function yD(n){return"TEMPLATE"===n.tagName&&void 0!==n.content}class KW extends ny{constructor(e,t,i,r,s,o,a,l){super(e,s,o,l),this.sharedStylesHost=t,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const c=_D(r.id,r.styles);for(const u of c){const d=document.createElement("style");a&&d.setAttribute("nonce",a),d.textContent=u,this.shadowRoot.appendChild(d)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,i){return super.insertBefore(this.nodeOrShadowRoot(e),t,i)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class iy extends ny{constructor(e,t,i,r,s,o,a,l){super(e,s,o,a),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=r,this.styles=l?_D(l,i.styles):i.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}}class bD extends iy{constructor(e,t,i,r,s,o,a,l){const c=r+"-"+i.id;super(e,t,i,s,o,a,l,c),this.contentAttr=function qW(n){return"_ngcontent-%COMP%".replace(ty,n)}(c),this.hostAttr=function YW(n){return"_nghost-%COMP%".replace(ty,n)}(c)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){const i=super.createElement(e,t);return super.setAttribute(i,this.contentAttr,""),i}}let JW=(()=>{class n extends pD{constructor(t){super(t)}supports(t){return!0}addEventListener(t,i,r){return t.addEventListener(i,r,!1),()=>this.removeEventListener(t,i,r)}removeEventListener(t,i,r){return t.removeEventListener(i,r)}}return n.\u0275fac=function(t){return new(t||n)(te(Nt))},n.\u0275prov=Ee({token:n,factory:n.\u0275fac}),n})();const wD=["alt","control","meta","shift"],QW={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},e4={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let t4=(()=>{class n extends pD{constructor(t){super(t)}supports(t){return null!=n.parseEventName(t)}addEventListener(t,i,r){const s=n.parseEventName(i),o=n.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Xa().onAndCancel(t,s.domEventName,o))}static parseEventName(t){const i=t.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const s=n._normalizeKey(i.pop());let o="",a=i.indexOf("code");if(a>-1&&(i.splice(a,1),o="code."),wD.forEach(c=>{const u=i.indexOf(c);u>-1&&(i.splice(u,1),o+=c+".")}),o+=s,0!=i.length||0===s.length)return null;const l={};return l.domEventName=r,l.fullKey=o,l}static matchEventFullKeyCode(t,i){let r=QW[t.key]||t.key,s="";return i.indexOf("code.")>-1&&(r=t.code,s="code."),!(null==r||!r)&&(r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),wD.forEach(o=>{o!==r&&(0,e4[o])(t)&&(s+=o+".")}),s+=r,s===i)}static eventCallback(t,i,r){return s=>{n.matchEventFullKeyCode(s,t)&&r.runGuarded(()=>i(s))}}static _normalizeKey(t){return"esc"===t?"escape":t}}return n.\u0275fac=function(t){return new(t||n)(te(Nt))},n.\u0275prov=Ee({token:n,factory:n.\u0275fac}),n})();const s4=mT(Pz,"browser",[{provide:io,useValue:oD},{provide:yM,useValue:function n4(){Kv.makeCurrent()},multi:!0},{provide:Nt,useFactory:function r4(){return function c2(n){zg=n}(document),document},deps:[]}]),o4=new Ce(""),MD=[{provide:sf,useClass:class zW{addToWindow(e){kt.getAngularTestability=(i,r=!0)=>{const s=e.findTestabilityInTree(i,r);if(null==s)throw new he(5103,!1);return s},kt.getAllAngularTestabilities=()=>e.getAllTestabilities(),kt.getAllAngularRootElements=()=>e.getAllRootElements(),kt.frameworkStabilizers||(kt.frameworkStabilizers=[]),kt.frameworkStabilizers.push(i=>{const r=kt.getAllAngularTestabilities();let s=r.length,o=!1;const a=function(l){o=o||l,s--,0==s&&i(o)};r.forEach(l=>{l.whenStable(a)})})}findTestabilityInTree(e,t,i){return null==t?null:e.getTestability(t)??(i?Xa().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},deps:[]},{provide:uT,useClass:vv,deps:[Et,yv,sf]},{provide:vv,useClass:vv,deps:[Et,yv,sf]}],ED=[{provide:Kg,useValue:"root"},{provide:ro,useFactory:function i4(){return new ro},deps:[]},{provide:Jv,useClass:JW,multi:!0,deps:[Nt,Et,io]},{provide:Jv,useClass:t4,multi:!0,deps:[Nt]},vD,mD,fD,{provide:CM,useExisting:vD},{provide:class gW{},useClass:GW,deps:[]},[]];let sy,a4=(()=>{class n{constructor(t){}static withServerTransition(t){return{ngModule:n,providers:[{provide:bh,useValue:t.appId}]}}}return n.\u0275fac=function(t){return new(t||n)(te(o4,12))},n.\u0275mod=li({type:n}),n.\u0275inj=Yn({providers:[...ED,...MD],imports:[lW,Lz]}),n})(),AD=(()=>{class n{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}}return n.\u0275fac=function(t){return new(t||n)(te(Nt))},n.\u0275prov=Ee({token:n,factory:function(t){let i=null;return i=t?new t:function c4(){return new AD(te(Nt))}(),i},providedIn:"root"}),n})();function RD(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Un(n,e){RD(n,e),e.add(n)}function Ye(n,e,t){RD(n,e),e.set(n,t)}function qt(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}function ID(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function W(n,e){return function p4(n,e){return e.get?e.get.call(n):e.value}(n,ID(n,e,"get"))}function He(n,e,t){return function m4(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}(n,ID(n,e,"set"),t),t}typeof window<"u"&&window;try{sy=typeof Intl<"u"&&Intl.v8BreakIterator}catch{sy=!1}let au,ho,oy,Dr=(()=>{class n{constructor(t){this._platformId=t,this.isBrowser=this._platformId?function hW(n){return n===oD}(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!sy)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}}return n.\u0275fac=function(t){return new(t||n)(te(io))},n.\u0275prov=Ee({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function LD(n){return function g4(){if(null==au&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>au=!0}))}finally{au=au||!1}return au}()?n:!!n.capture}function _4(){if(null==ho){if("object"!=typeof document||!document||"function"!=typeof Element||!Element)return ho=!1,ho;if("scrollBehavior"in document.documentElement.style)ho=!0;else{const n=Element.prototype.scrollTo;ho=!!n&&!/\{\s*\[native code\]\s*\}/.test(n.toString())}}return ho}function ay(){let n=typeof document<"u"&&document?document.activeElement:null;for(;n&&n.shadowRoot;){const e=n.shadowRoot.activeElement;if(e===n)break;n=e}return n}function fo(n){return n.composedPath?n.composedPath()[0]:n.target}function OD(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}function Rr(n){return n<=0?()=>pr:on((e,t)=>{let i=0;e.subscribe(Kt(t,r=>{++i<=n&&(t.next(r),n<=i&&t.complete())}))})}function nr(n,e){return on((t,i)=>{let r=0;t.subscribe(Kt(i,s=>n.call(e,s,r++)&&i.next(s)))})}function ND(n){return nr((e,t)=>n<=t)}function Af(n){return on((e,t)=>{oi(n).subscribe(Kt(t,()=>t.complete(),Im)),!t.closed&&e.subscribe(t)})}function Cf(n){return Array.isArray(n)?n:[n]}function vn(n){return null==n?"":"string"==typeof n?n:`${n}px`}function Tf(n){return n instanceof mi?n.nativeElement:n}let T4=(()=>{class n{create(t){return typeof MutationObserver>"u"?null:new MutationObserver(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ee({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),D4=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=li({type:n}),n.\u0275inj=Yn({providers:[T4]}),n})();const{isArray:R4}=Array,{getPrototypeOf:I4,prototype:P4,keys:L4}=Object;const{isArray:F4}=Array;function FD(n){return Ot(e=>function k4(n,e){return F4(e)?n(...e):n(e)}(n,e))}function Df(...n){const e=cc(n),t=function fN(n){return wt(zm(n))?n.pop():void 0}(n),{args:i,keys:r}=function O4(n){if(1===n.length){const e=n[0];if(R4(e))return{args:e,keys:null};if(function N4(n){return n&&"object"==typeof n&&I4(n)===P4}(e)){const t=L4(e);return{args:t.map(i=>e[i]),keys:t}}}return{args:n,keys:null}}(n);if(0===i.length)return Nn([],e);const s=new Ht(function B4(n,e,t=xs){return i=>{kD(e,()=>{const{length:r}=n,s=new Array(r);let o=r,a=r;for(let l=0;l<r;l++)kD(e,()=>{const c=Nn(n[l],e);let u=!1;c.subscribe(Kt(i,d=>{s[l]=d,u||(u=!0,a--),a||i.next(t(s.slice()))},()=>{--o||i.complete()}))},i)},i)}}(i,e,r?o=>function U4(n,e){return n.reduce((t,i,r)=>(t[i]=e[r],t),{})}(r,o):xs));return t?s.pipe(FD(t)):s}function kD(n,e,t){n?Wr(t,n,e):e()}function Rf(...n){return function V4(){return na(1)}()(Nn(n,cc(n)))}class H4 extends Bn{constructor(e,t){super()}schedule(e,t=0){return this}}const If={setInterval(n,e,...t){const{delegate:i}=If;return i?.setInterval?i.setInterval(n,e,...t):setInterval(n,e,...t)},clearInterval(n){const{delegate:e}=If;return(e?.clearInterval||clearInterval)(n)},delegate:void 0};class ly extends H4{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var i;if(this.closed)return this;this.state=e;const r=this.id,s=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(s,r,t)),this.pending=!0,this.delay=t,this.id=null!==(i=this.id)&&void 0!==i?i:this.requestAsyncId(s,this.id,t),this}requestAsyncId(e,t,i=0){return If.setInterval(e.flush.bind(e,this),i)}recycleAsyncId(e,t,i=0){if(null!=i&&this.delay===i&&!1===this.pending)return t;null!=t&&If.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(e,t);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let r,i=!1;try{this.work(e)}catch(s){i=!0,r=s||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){const{id:e,scheduler:t}=this,{actions:i}=t;this.work=this.state=this.scheduler=null,this.pending=!1,ta(i,this),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}}const UD={now:()=>(UD.delegate||Date).now(),delegate:void 0};class lu{constructor(e,t=lu.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,i){return new this.schedulerActionCtor(this,e).schedule(i,t)}}lu.now=UD.now;class cy extends lu{constructor(e,t=lu.now){super(e,t),this.actions=[],this._active=!1}flush(e){const{actions:t}=this;if(this._active)return void t.push(e);let i;this._active=!0;do{if(i=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,i){for(;e=t.shift();)e.unsubscribe();throw i}}}const uy=new cy(ly),z4=uy;function dy(...n){const e=cc(n);return on((t,i)=>{(e?Rf(n,t,e):Rf(n,t)).subscribe(i)})}const BD=new Set;let po,W4=(()=>{class n{constructor(t,i){this._platform=t,this._nonce=i,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):$4}matchMedia(t){return(this._platform.WEBKIT||this._platform.BLINK)&&function j4(n,e){if(!BD.has(n))try{po||(po=document.createElement("style"),e&&(po.nonce=e),po.setAttribute("type","text/css"),document.head.appendChild(po)),po.sheet&&(po.sheet.insertRule(`@media ${n} {body{ }}`,0),BD.add(n))}catch(t){console.error(t)}}(t,this._nonce),this._matchMedia(t)}}return n.\u0275fac=function(t){return new(t||n)(te(Dr),te(n_,8))},n.\u0275prov=Ee({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function $4(n){return{matches:"all"===n||""===n,media:n,addListener:()=>{},removeListener:()=>{}}}let X4=(()=>{class n{constructor(t,i){this._mediaMatcher=t,this._zone=i,this._queries=new Map,this._destroySubject=new zt}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(t){return VD(Cf(t)).some(r=>this._registerQuery(r).mql.matches)}observe(t){let s=Df(VD(Cf(t)).map(o=>this._registerQuery(o).observable));return s=Rf(s.pipe(Rr(1)),s.pipe(ND(1),function G4(n,e=uy){return on((t,i)=>{let r=null,s=null,o=null;const a=()=>{if(r){r.unsubscribe(),r=null;const c=s;s=null,i.next(c)}};function l(){const c=o+n,u=e.now();if(u<c)return r=this.schedule(void 0,c-u),void i.add(r);a()}t.subscribe(Kt(i,c=>{s=c,o=e.now(),r||(r=e.schedule(l,n),i.add(r))},()=>{a(),i.complete()},void 0,()=>{s=r=null}))})}(0))),s.pipe(Ot(o=>{const a={matches:!1,breakpoints:{}};return o.forEach(({matches:l,query:c})=>{a.matches=a.matches||l,a.breakpoints[c]=l}),a}))}_registerQuery(t){if(this._queries.has(t))return this._queries.get(t);const i=this._mediaMatcher.matchMedia(t),s={observable:new Ht(o=>{const a=l=>this._zone.run(()=>o.next(l));return i.addListener(a),()=>{i.removeListener(a)}}).pipe(dy(i),Ot(({matches:o})=>({query:t,matches:o})),Af(this._destroySubject)),mql:i};return this._queries.set(t,s),s}}return n.\u0275fac=function(t){return new(t||n)(te(W4),te(Et))},n.\u0275prov=Ee({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function VD(n){return n.map(e=>e.split(",")).reduce((e,t)=>e.concat(t)).map(e=>e.trim())}let GD=(()=>{class n{constructor(t){this._platform=t}isDisabled(t){return t.hasAttribute("disabled")}isVisible(t){return function K4(n){return!!(n.offsetWidth||n.offsetHeight||"function"==typeof n.getClientRects&&n.getClientRects().length)}(t)&&"visible"===getComputedStyle(t).visibility}isTabbable(t){if(!this._platform.isBrowser)return!1;const i=function Z4(n){try{return n.frameElement}catch{return null}}(function o5(n){return n.ownerDocument&&n.ownerDocument.defaultView||window}(t));if(i&&(-1===jD(i)||!this.isVisible(i)))return!1;let r=t.nodeName.toLowerCase(),s=jD(t);return t.hasAttribute("contenteditable")?-1!==s:!("iframe"===r||"object"===r||this._platform.WEBKIT&&this._platform.IOS&&!function r5(n){let e=n.nodeName.toLowerCase(),t="input"===e&&n.type;return"text"===t||"password"===t||"select"===e||"textarea"===e}(t))&&("audio"===r?!!t.hasAttribute("controls")&&-1!==s:"video"===r?-1!==s&&(null!==s||this._platform.FIREFOX||t.hasAttribute("controls")):t.tabIndex>=0)}isFocusable(t,i){return function s5(n){return!function Q4(n){return function t5(n){return"input"==n.nodeName.toLowerCase()}(n)&&"hidden"==n.type}(n)&&(function J4(n){let e=n.nodeName.toLowerCase();return"input"===e||"select"===e||"button"===e||"textarea"===e}(n)||function e5(n){return function n5(n){return"a"==n.nodeName.toLowerCase()}(n)&&n.hasAttribute("href")}(n)||n.hasAttribute("contenteditable")||WD(n))}(t)&&!this.isDisabled(t)&&(i?.ignoreVisibility||this.isVisible(t))}}return n.\u0275fac=function(t){return new(t||n)(te(Dr))},n.\u0275prov=Ee({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function WD(n){if(!n.hasAttribute("tabindex")||void 0===n.tabIndex)return!1;let e=n.getAttribute("tabindex");return!(!e||isNaN(parseInt(e,10)))}function jD(n){if(!WD(n))return null;const e=parseInt(n.getAttribute("tabindex")||"",10);return isNaN(e)?-1:e}class a5{get enabled(){return this._enabled}set enabled(e){this._enabled=e,this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(e,this._startAnchor),this._toggleAnchorTabIndex(e,this._endAnchor))}constructor(e,t,i,r,s=!1){this._element=e,this._checker=t,this._ngZone=i,this._document=r,this._hasAttached=!1,this.startAnchorListener=()=>this.focusLastTabbableElement(),this.endAnchorListener=()=>this.focusFirstTabbableElement(),this._enabled=!0,s||this.attachAnchors()}destroy(){const e=this._startAnchor,t=this._endAnchor;e&&(e.removeEventListener("focus",this.startAnchorListener),e.remove()),t&&(t.removeEventListener("focus",this.endAnchorListener),t.remove()),this._startAnchor=this._endAnchor=null,this._hasAttached=!1}attachAnchors(){return!!this._hasAttached||(this._ngZone.runOutsideAngular(()=>{this._startAnchor||(this._startAnchor=this._createAnchor(),this._startAnchor.addEventListener("focus",this.startAnchorListener)),this._endAnchor||(this._endAnchor=this._createAnchor(),this._endAnchor.addEventListener("focus",this.endAnchorListener))}),this._element.parentNode&&(this._element.parentNode.insertBefore(this._startAnchor,this._element),this._element.parentNode.insertBefore(this._endAnchor,this._element.nextSibling),this._hasAttached=!0),this._hasAttached)}focusInitialElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusInitialElement(e)))})}focusFirstTabbableElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusFirstTabbableElement(e)))})}focusLastTabbableElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusLastTabbableElement(e)))})}_getRegionBoundary(e){const t=this._element.querySelectorAll(`[cdk-focus-region-${e}], [cdkFocusRegion${e}], [cdk-focus-${e}]`);return"start"==e?t.length?t[0]:this._getFirstTabbableElement(this._element):t.length?t[t.length-1]:this._getLastTabbableElement(this._element)}focusInitialElement(e){const t=this._element.querySelector("[cdk-focus-initial], [cdkFocusInitial]");if(t){if(!this._checker.isFocusable(t)){const i=this._getFirstTabbableElement(t);return i?.focus(e),!!i}return t.focus(e),!0}return this.focusFirstTabbableElement(e)}focusFirstTabbableElement(e){const t=this._getRegionBoundary("start");return t&&t.focus(e),!!t}focusLastTabbableElement(e){const t=this._getRegionBoundary("end");return t&&t.focus(e),!!t}hasAttached(){return this._hasAttached}_getFirstTabbableElement(e){if(this._checker.isFocusable(e)&&this._checker.isTabbable(e))return e;const t=e.children;for(let i=0;i<t.length;i++){const r=t[i].nodeType===this._document.ELEMENT_NODE?this._getFirstTabbableElement(t[i]):null;if(r)return r}return null}_getLastTabbableElement(e){if(this._checker.isFocusable(e)&&this._checker.isTabbable(e))return e;const t=e.children;for(let i=t.length-1;i>=0;i--){const r=t[i].nodeType===this._document.ELEMENT_NODE?this._getLastTabbableElement(t[i]):null;if(r)return r}return null}_createAnchor(){const e=this._document.createElement("div");return this._toggleAnchorTabIndex(this._enabled,e),e.classList.add("cdk-visually-hidden"),e.classList.add("cdk-focus-trap-anchor"),e.setAttribute("aria-hidden","true"),e}_toggleAnchorTabIndex(e,t){e?t.setAttribute("tabindex","0"):t.removeAttribute("tabindex")}toggleAnchors(e){this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(e,this._startAnchor),this._toggleAnchorTabIndex(e,this._endAnchor))}_executeOnStable(e){this._ngZone.isStable?e():this._ngZone.onStable.pipe(Rr(1)).subscribe(e)}}let l5=(()=>{class n{constructor(t,i,r){this._checker=t,this._ngZone=i,this._document=r}create(t,i=!1){return new a5(t,this._checker,this._ngZone,this._document,i)}}return n.\u0275fac=function(t){return new(t||n)(te(GD),te(Et),te(Nt))},n.\u0275prov=Ee({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const d5=new Ce("cdk-input-modality-detector-options"),h5={ignoreKeys:[18,17,224,91,16]},Ya=LD({passive:!0,capture:!0});let f5=(()=>{class n{get mostRecentModality(){return this._modality.value}constructor(t,i,r,s){this._platform=t,this._mostRecentTarget=null,this._modality=new si(null),this._lastTouchMs=0,this._onKeydown=o=>{this._options?.ignoreKeys?.some(a=>a===o.keyCode)||(this._modality.next("keyboard"),this._mostRecentTarget=fo(o))},this._onMousedown=o=>{Date.now()-this._lastTouchMs<650||(this._modality.next(function c5(n){return 0===n.buttons||0===n.offsetX&&0===n.offsetY}(o)?"keyboard":"mouse"),this._mostRecentTarget=fo(o))},this._onTouchstart=o=>{!function u5(n){const e=n.touches&&n.touches[0]||n.changedTouches&&n.changedTouches[0];return!(!e||-1!==e.identifier||null!=e.radiusX&&1!==e.radiusX||null!=e.radiusY&&1!==e.radiusY)}(o)?(this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=fo(o)):this._modality.next("keyboard")},this._options={...h5,...s},this.modalityDetected=this._modality.pipe(ND(1)),this.modalityChanged=this.modalityDetected.pipe($w()),t.isBrowser&&i.runOutsideAngular(()=>{r.addEventListener("keydown",this._onKeydown,Ya),r.addEventListener("mousedown",this._onMousedown,Ya),r.addEventListener("touchstart",this._onTouchstart,Ya)})}ngOnDestroy(){this._modality.complete(),this._platform.isBrowser&&(document.removeEventListener("keydown",this._onKeydown,Ya),document.removeEventListener("mousedown",this._onMousedown,Ya),document.removeEventListener("touchstart",this._onTouchstart,Ya))}}return n.\u0275fac=function(t){return new(t||n)(te(Dr),te(Et),te(Nt),te(d5,8))},n.\u0275prov=Ee({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const m5=new Ce("cdk-focus-monitor-default-options"),Pf=LD({passive:!0,capture:!0});let g5=(()=>{class n{constructor(t,i,r,s,o){this._ngZone=t,this._platform=i,this._inputModalityDetector=r,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=window.setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new zt,this._rootNodeFocusAndBlurListener=a=>{for(let c=fo(a);c;c=c.parentElement)"focus"===a.type?this._onFocus(a,c):this._onBlur(a,c)},this._document=s,this._detectionMode=o?.detectionMode||0}monitor(t,i=!1){const r=Tf(t);if(!this._platform.isBrowser||1!==r.nodeType)return $e();const s=function y4(n){if(function v4(){if(null==oy){const n=typeof document<"u"?document.head:null;oy=!(!n||!n.createShadowRoot&&!n.attachShadow)}return oy}()){const e=n.getRootNode?n.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&e instanceof ShadowRoot)return e}return null}(r)||this._getDocument(),o=this._elementInfo.get(r);if(o)return i&&(o.checkChildren=!0),o.subject;const a={checkChildren:i,subject:new zt,rootNode:s};return this._elementInfo.set(r,a),this._registerGlobalListeners(a),a.subject}stopMonitoring(t){const i=Tf(t),r=this._elementInfo.get(i);r&&(r.subject.complete(),this._setClasses(i),this._elementInfo.delete(i),this._removeGlobalListeners(r))}focusVia(t,i,r){const s=Tf(t);s===this._getDocument().activeElement?this._getClosestElementsInfo(s).forEach(([a,l])=>this._originChanged(a,i,l)):(this._setOrigin(i),"function"==typeof s.focus&&s.focus(r))}ngOnDestroy(){this._elementInfo.forEach((t,i)=>this.stopMonitoring(i))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_getFocusOrigin(t){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(t)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:t&&this._isLastInteractionFromInputLabel(t)?"mouse":"program"}_shouldBeAttributedToTouch(t){return 1===this._detectionMode||!!t?.contains(this._inputModalityDetector._mostRecentTarget)}_setClasses(t,i){t.classList.toggle("cdk-focused",!!i),t.classList.toggle("cdk-touch-focused","touch"===i),t.classList.toggle("cdk-keyboard-focused","keyboard"===i),t.classList.toggle("cdk-mouse-focused","mouse"===i),t.classList.toggle("cdk-program-focused","program"===i)}_setOrigin(t,i=!1){this._ngZone.runOutsideAngular(()=>{this._origin=t,this._originFromTouchInteraction="touch"===t&&i,0===this._detectionMode&&(clearTimeout(this._originTimeoutId),this._originTimeoutId=setTimeout(()=>this._origin=null,this._originFromTouchInteraction?650:1))})}_onFocus(t,i){const r=this._elementInfo.get(i),s=fo(t);!r||!r.checkChildren&&i!==s||this._originChanged(i,this._getFocusOrigin(s),r)}_onBlur(t,i){const r=this._elementInfo.get(i);!r||r.checkChildren&&t.relatedTarget instanceof Node&&i.contains(t.relatedTarget)||(this._setClasses(i),this._emitOrigin(r,null))}_emitOrigin(t,i){t.subject.observers.length&&this._ngZone.run(()=>t.subject.next(i))}_registerGlobalListeners(t){if(!this._platform.isBrowser)return;const i=t.rootNode,r=this._rootNodeFocusListenerCount.get(i)||0;r||this._ngZone.runOutsideAngular(()=>{i.addEventListener("focus",this._rootNodeFocusAndBlurListener,Pf),i.addEventListener("blur",this._rootNodeFocusAndBlurListener,Pf)}),this._rootNodeFocusListenerCount.set(i,r+1),1==++this._monitoredElementCount&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(Af(this._stopInputModalityDetector)).subscribe(s=>{this._setOrigin(s,!0)}))}_removeGlobalListeners(t){const i=t.rootNode;if(this._rootNodeFocusListenerCount.has(i)){const r=this._rootNodeFocusListenerCount.get(i);r>1?this._rootNodeFocusListenerCount.set(i,r-1):(i.removeEventListener("focus",this._rootNodeFocusAndBlurListener,Pf),i.removeEventListener("blur",this._rootNodeFocusAndBlurListener,Pf),this._rootNodeFocusListenerCount.delete(i))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(t,i,r){this._setClasses(t,i),this._emitOrigin(r,i),this._lastFocusOrigin=i}_getClosestElementsInfo(t){const i=[];return this._elementInfo.forEach((r,s)=>{(s===t||r.checkChildren&&s.contains(t))&&i.push([s,r])}),i}_isLastInteractionFromInputLabel(t){const{_mostRecentTarget:i,mostRecentModality:r}=this._inputModalityDetector;if("mouse"!==r||!i||i===t||"INPUT"!==t.nodeName&&"TEXTAREA"!==t.nodeName||t.disabled)return!1;const s=t.labels;if(s)for(let o=0;o<s.length;o++)if(s[o].contains(i))return!0;return!1}}return n.\u0275fac=function(t){return new(t||n)(te(Et),te(Dr),te(f5),te(Nt,8),te(m5,8))},n.\u0275prov=Ee({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const XD="cdk-high-contrast-black-on-white",qD="cdk-high-contrast-white-on-black",hy="cdk-high-contrast-active";let _5=(()=>{class n{constructor(t,i){this._platform=t,this._document=i,this._breakpointSubscription=_e(X4).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return 0;const t=this._document.createElement("div");t.style.backgroundColor="rgb(1,2,3)",t.style.position="absolute",this._document.body.appendChild(t);const i=this._document.defaultView||window,r=i&&i.getComputedStyle?i.getComputedStyle(t):null,s=(r&&r.backgroundColor||"").replace(/ /g,"");switch(t.remove(),s){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return 2;case"rgb(255,255,255)":case"rgb(255,250,239)":return 1}return 0}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const t=this._document.body.classList;t.remove(hy,XD,qD),this._hasCheckedHighContrastMode=!0;const i=this.getHighContrastMode();1===i?t.add(hy,XD):2===i&&t.add(hy,qD)}}}return n.\u0275fac=function(t){return new(t||n)(te(Dr),te(Nt))},n.\u0275prov=Ee({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),v5=(()=>{class n{constructor(t){t._applyBodyHighContrastModeCssClasses()}}return n.\u0275fac=function(t){return new(t||n)(te(_5))},n.\u0275mod=li({type:n}),n.\u0275inj=Yn({imports:[D4]}),n})();const y5=["addListener","removeListener"],b5=["addEventListener","removeEventListener"],w5=["on","off"];function Lf(n,e,t,i){if(wt(t)&&(i=t,t=void 0),i)return Lf(n,e,t).pipe(FD(i));const[r,s]=function M5(n){return wt(n.addEventListener)&&wt(n.removeEventListener)}(n)?b5.map(o=>a=>n[o](e,a,t)):function x5(n){return wt(n.addListener)&&wt(n.removeListener)}(n)?y5.map(YD(n,e)):function S5(n){return wt(n.on)&&wt(n.off)}(n)?w5.map(YD(n,e)):[];if(!r&&Hm(n))return Tn(o=>Lf(o,e,t))(oi(n));if(!r)throw new TypeError("Invalid event target");return new Ht(o=>{const a=(...l)=>o.next(1<l.length?l:l[0]);return r(a),()=>s(a)})}function YD(n,e){return t=>i=>n[t](e,i)}const cu={schedule(n){let e=requestAnimationFrame,t=cancelAnimationFrame;const{delegate:i}=cu;i&&(e=i.requestAnimationFrame,t=i.cancelAnimationFrame);const r=e(s=>{t=void 0,n(s)});return new Bn(()=>t?.(r))},requestAnimationFrame(...n){const{delegate:e}=cu;return(e?.requestAnimationFrame||requestAnimationFrame)(...n)},cancelAnimationFrame(...n){const{delegate:e}=cu;return(e?.cancelAnimationFrame||cancelAnimationFrame)(...n)},delegate:void 0};new class A5 extends cy{flush(e){this._active=!0;const t=this._scheduled;this._scheduled=void 0;const{actions:i}=this;let r;e=e||i.shift();do{if(r=e.execute(e.state,e.delay))break}while((e=i[0])&&e.id===t&&i.shift());if(this._active=!1,r){for(;(e=i[0])&&e.id===t&&i.shift();)e.unsubscribe();throw r}}}(class E5 extends ly{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,i=0){return null!==i&&i>0?super.requestAsyncId(e,t,i):(e.actions.push(this),e._scheduled||(e._scheduled=cu.requestAnimationFrame(()=>e.flush(void 0))))}recycleAsyncId(e,t,i=0){var r;if(null!=i?i>0:this.delay>0)return super.recycleAsyncId(e,t,i);const{actions:s}=e;null!=t&&(null===(r=s[s.length-1])||void 0===r?void 0:r.id)!==t&&(cu.cancelAnimationFrame(t),e._scheduled=void 0)}});let fy,T5=1;const Of={};function ZD(n){return n in Of&&(delete Of[n],!0)}const D5={setImmediate(n){const e=T5++;return Of[e]=!0,fy||(fy=Promise.resolve()),fy.then(()=>ZD(e)&&n()),e},clearImmediate(n){ZD(n)}},{setImmediate:R5,clearImmediate:I5}=D5,Nf={setImmediate(...n){const{delegate:e}=Nf;return(e?.setImmediate||R5)(...n)},clearImmediate(n){const{delegate:e}=Nf;return(e?.clearImmediate||I5)(n)},delegate:void 0};new class L5 extends cy{flush(e){this._active=!0;const t=this._scheduled;this._scheduled=void 0;const{actions:i}=this;let r;e=e||i.shift();do{if(r=e.execute(e.state,e.delay))break}while((e=i[0])&&e.id===t&&i.shift());if(this._active=!1,r){for(;(e=i[0])&&e.id===t&&i.shift();)e.unsubscribe();throw r}}}(class P5 extends ly{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,i=0){return null!==i&&i>0?super.requestAsyncId(e,t,i):(e.actions.push(this),e._scheduled||(e._scheduled=Nf.setImmediate(e.flush.bind(e,void 0))))}recycleAsyncId(e,t,i=0){var r;if(null!=i?i>0:this.delay>0)return super.recycleAsyncId(e,t,i);const{actions:s}=e;null!=t&&(null===(r=s[s.length-1])||void 0===r?void 0:r.id)!==t&&(Nf.clearImmediate(t),e._scheduled===t&&(e._scheduled=void 0))}});function KD(n,e=uy){return function N5(n){return on((e,t)=>{let i=!1,r=null,s=null,o=!1;const a=()=>{if(s?.unsubscribe(),s=null,i){i=!1;const c=r;r=null,t.next(c)}o&&t.complete()},l=()=>{s=null,o&&t.complete()};e.subscribe(Kt(t,c=>{i=!0,r=c,s||oi(n(c)).subscribe(s=Kt(t,a,l))},()=>{o=!0,(!i||!s||s.closed)&&t.complete()}))})}(()=>function k5(n=0,e,t=z4){let i=-1;return null!=e&&(Vw(e)?t=e:i=e),new Ht(r=>{let s=function F5(n){return n instanceof Date&&!isNaN(n)}(n)?+n-t.now():n;s<0&&(s=0);let o=0;return t.schedule(function(){r.closed||(r.next(o++),0<=i?this.schedule(void 0,i):r.complete())},s)})}(n,e))}const U5=new Ce("cdk-dir-doc",{providedIn:"root",factory:function B5(){return _e(Nt)}}),V5=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;let py=(()=>{class n{constructor(t){this.value="ltr",this.change=new kn,t&&(this.value=function H5(n){const e=n?.toLowerCase()||"";return"auto"===e&&typeof navigator<"u"&&navigator?.language?V5.test(navigator.language)?"rtl":"ltr":"rtl"===e?"rtl":"ltr"}((t.body?t.body.dir:null)||(t.documentElement?t.documentElement.dir:null)||"ltr"))}ngOnDestroy(){this.change.complete()}}return n.\u0275fac=function(t){return new(t||n)(te(U5,8))},n.\u0275prov=Ee({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),my=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=li({type:n}),n.\u0275inj=Yn({}),n})(),G5=(()=>{class n{constructor(t,i,r){this._ngZone=t,this._platform=i,this._scrolled=new zt,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=r}register(t){this.scrollContainers.has(t)||this.scrollContainers.set(t,t.elementScrolled().subscribe(()=>this._scrolled.next(t)))}deregister(t){const i=this.scrollContainers.get(t);i&&(i.unsubscribe(),this.scrollContainers.delete(t))}scrolled(t=20){return this._platform.isBrowser?new Ht(i=>{this._globalSubscription||this._addGlobalListener();const r=t>0?this._scrolled.pipe(KD(t)).subscribe(i):this._scrolled.subscribe(i);return this._scrolledCount++,()=>{r.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):$e()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((t,i)=>this.deregister(i)),this._scrolled.complete()}ancestorScrolled(t,i){const r=this.getAncestorScrollContainers(t);return this.scrolled(i).pipe(nr(s=>!s||r.indexOf(s)>-1))}getAncestorScrollContainers(t){const i=[];return this.scrollContainers.forEach((r,s)=>{this._scrollableContainsElement(s,t)&&i.push(s)}),i}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(t,i){let r=Tf(i),s=t.getElementRef().nativeElement;do{if(r==s)return!0}while(r=r.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>Lf(this._getWindow().document,"scroll").subscribe(()=>this._scrolled.next()))}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}}return n.\u0275fac=function(t){return new(t||n)(te(Et),te(Dr),te(Nt,8))},n.\u0275prov=Ee({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),JD=(()=>{class n{constructor(t,i,r){this._platform=t,this._change=new zt,this._changeListener=s=>{this._change.next(s)},this._document=r,i.runOutsideAngular(()=>{if(t.isBrowser){const s=this._getWindow();s.addEventListener("resize",this._changeListener),s.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){const t=this._getWindow();t.removeEventListener("resize",this._changeListener),t.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();const t={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),t}getViewportRect(){const t=this.getViewportScrollPosition(),{width:i,height:r}=this.getViewportSize();return{top:t.top,left:t.left,bottom:t.top+r,right:t.left+i,height:r,width:i}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const t=this._document,i=this._getWindow(),r=t.documentElement,s=r.getBoundingClientRect();return{top:-s.top||t.body.scrollTop||i.scrollY||r.scrollTop||0,left:-s.left||t.body.scrollLeft||i.scrollX||r.scrollLeft||0}}change(t=20){return t>0?this._change.pipe(KD(t)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){const t=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:t.innerWidth,height:t.innerHeight}:{width:0,height:0}}}return n.\u0275fac=function(t){return new(t||n)(te(Dr),te(Et),te(Nt,8))},n.\u0275prov=Ee({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),QD=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=li({type:n}),n.\u0275inj=Yn({}),n})(),eR=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=li({type:n}),n.\u0275inj=Yn({imports:[my,QD,my,QD]}),n})();class gy{attach(e){return this._attachedHost=e,e.attach(this)}detach(){let e=this._attachedHost;null!=e&&(this._attachedHost=null,e.detach())}get isAttached(){return null!=this._attachedHost}setAttachedHost(e){this._attachedHost=e}}class _y extends gy{constructor(e,t,i,r,s){super(),this.component=e,this.viewContainerRef=t,this.injector=i,this.componentFactoryResolver=r,this.projectableNodes=s}}class tR extends gy{constructor(e,t,i,r){super(),this.templateRef=e,this.viewContainerRef=t,this.context=i,this.injector=r}get origin(){return this.templateRef.elementRef}attach(e,t=this.context){return this.context=t,super.attach(e)}detach(){return this.context=void 0,super.detach()}}class j5 extends gy{constructor(e){super(),this.element=e instanceof mi?e.nativeElement:e}}class vy{constructor(){this._isDisposed=!1,this.attachDomPortal=null}hasAttached(){return!!this._attachedPortal}attach(e){return e instanceof _y?(this._attachedPortal=e,this.attachComponentPortal(e)):e instanceof tR?(this._attachedPortal=e,this.attachTemplatePortal(e)):this.attachDomPortal&&e instanceof j5?(this._attachedPortal=e,this.attachDomPortal(e)):void 0}detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(e){this._disposeFn=e}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}}class $5 extends vy{constructor(e,t,i,r,s){super(),this.outletElement=e,this._componentFactoryResolver=t,this._appRef=i,this._defaultInjector=r,this.attachDomPortal=o=>{const a=o.element,l=this._document.createComment("dom-portal");a.parentNode.insertBefore(l,a),this.outletElement.appendChild(a),this._attachedPortal=o,super.setDisposeFn(()=>{l.parentNode&&l.parentNode.replaceChild(a,l)})},this._document=s}attachComponentPortal(e){const i=(e.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(e.component);let r;return e.viewContainerRef?(r=e.viewContainerRef.createComponent(i,e.viewContainerRef.length,e.injector||e.viewContainerRef.injector,e.projectableNodes||void 0),this.setDisposeFn(()=>r.destroy())):(r=i.create(e.injector||this._defaultInjector||gi.NULL),this._appRef.attachView(r.hostView),this.setDisposeFn(()=>{this._appRef.viewCount>0&&this._appRef.detachView(r.hostView),r.destroy()})),this.outletElement.appendChild(this._getComponentRootNode(r)),this._attachedPortal=e,r}attachTemplatePortal(e){let t=e.viewContainerRef,i=t.createEmbeddedView(e.templateRef,e.context,{injector:e.injector});return i.rootNodes.forEach(r=>this.outletElement.appendChild(r)),i.detectChanges(),this.setDisposeFn(()=>{let r=t.indexOf(i);-1!==r&&t.remove(r)}),this._attachedPortal=e,i}dispose(){super.dispose(),this.outletElement.remove()}_getComponentRootNode(e){return e.hostView.rootNodes[0]}}let nR=(()=>{class n extends vy{constructor(t,i,r){super(),this._componentFactoryResolver=t,this._viewContainerRef=i,this._isInitialized=!1,this.attached=new kn,this.attachDomPortal=s=>{const o=s.element,a=this._document.createComment("dom-portal");s.setAttachedHost(this),o.parentNode.insertBefore(a,o),this._getRootNode().appendChild(o),this._attachedPortal=s,super.setDisposeFn(()=>{a.parentNode&&a.parentNode.replaceChild(o,a)})},this._document=r}get portal(){return this._attachedPortal}set portal(t){this.hasAttached()&&!t&&!this._isInitialized||(this.hasAttached()&&super.detach(),t&&super.attach(t),this._attachedPortal=t||null)}get attachedRef(){return this._attachedRef}ngOnInit(){this._isInitialized=!0}ngOnDestroy(){super.dispose(),this._attachedRef=this._attachedPortal=null}attachComponentPortal(t){t.setAttachedHost(this);const i=null!=t.viewContainerRef?t.viewContainerRef:this._viewContainerRef,s=(t.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(t.component),o=i.createComponent(s,i.length,t.injector||i.injector,t.projectableNodes||void 0);return i!==this._viewContainerRef&&this._getRootNode().appendChild(o.hostView.rootNodes[0]),super.setDisposeFn(()=>o.destroy()),this._attachedPortal=t,this._attachedRef=o,this.attached.emit(o),o}attachTemplatePortal(t){t.setAttachedHost(this);const i=this._viewContainerRef.createEmbeddedView(t.templateRef,t.context,{injector:t.injector});return super.setDisposeFn(()=>this._viewContainerRef.clear()),this._attachedPortal=t,this._attachedRef=i,this.attached.emit(i),i}_getRootNode(){const t=this._viewContainerRef.element.nativeElement;return t.nodeType===t.ELEMENT_NODE?t:t.parentNode}}return n.\u0275fac=function(t){return new(t||n)(De(Ea),De(Vi),De(Nt))},n.\u0275dir=Vn({type:n,selectors:[["","cdkPortalOutlet",""]],inputs:{portal:["cdkPortalOutlet","portal"]},outputs:{attached:"attached"},exportAs:["cdkPortalOutlet"],features:[Oh]}),n})(),yy=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=li({type:n}),n.\u0275inj=Yn({}),n})();const iR=_4();class X5{constructor(e,t){this._viewportRuler=e,this._previousHTMLStyles={top:"",left:""},this._isEnabled=!1,this._document=t}attach(){}enable(){if(this._canBeEnabled()){const e=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=e.style.left||"",this._previousHTMLStyles.top=e.style.top||"",e.style.left=vn(-this._previousScrollPosition.left),e.style.top=vn(-this._previousScrollPosition.top),e.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){const e=this._document.documentElement,i=e.style,r=this._document.body.style,s=i.scrollBehavior||"",o=r.scrollBehavior||"";this._isEnabled=!1,i.left=this._previousHTMLStyles.left,i.top=this._previousHTMLStyles.top,e.classList.remove("cdk-global-scrollblock"),iR&&(i.scrollBehavior=r.scrollBehavior="auto"),window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),iR&&(i.scrollBehavior=s,r.scrollBehavior=o)}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;const t=this._document.body,i=this._viewportRuler.getViewportSize();return t.scrollHeight>i.height||t.scrollWidth>i.width}}class q5{constructor(e,t,i,r){this._scrollDispatcher=e,this._ngZone=t,this._viewportRuler=i,this._config=r,this._scrollSubscription=null,this._detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}}attach(e){this._overlayRef=e}enable(){if(this._scrollSubscription)return;const e=this._scrollDispatcher.scrolled(0).pipe(nr(t=>!t||!this._overlayRef.overlayElement.contains(t.getElementRef().nativeElement)));this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=e.subscribe(()=>{const t=this._viewportRuler.getViewportScrollPosition().top;Math.abs(t-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=e.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}class rR{enable(){}disable(){}attach(){}}function by(n,e){return e.some(t=>n.bottom<t.top||n.top>t.bottom||n.right<t.left||n.left>t.right)}function sR(n,e){return e.some(t=>n.top<t.top||n.bottom>t.bottom||n.left<t.left||n.right>t.right)}class Y5{constructor(e,t,i,r){this._scrollDispatcher=e,this._viewportRuler=t,this._ngZone=i,this._config=r,this._scrollSubscription=null}attach(e){this._overlayRef=e}enable(){this._scrollSubscription||(this._scrollSubscription=this._scrollDispatcher.scrolled(this._config?this._config.scrollThrottle:0).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){const t=this._overlayRef.overlayElement.getBoundingClientRect(),{width:i,height:r}=this._viewportRuler.getViewportSize();by(t,[{width:i,height:r,bottom:r,right:i,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}}))}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}let Z5=(()=>{class n{constructor(t,i,r,s){this._scrollDispatcher=t,this._viewportRuler=i,this._ngZone=r,this.noop=()=>new rR,this.close=o=>new q5(this._scrollDispatcher,this._ngZone,this._viewportRuler,o),this.block=()=>new X5(this._viewportRuler,this._document),this.reposition=o=>new Y5(this._scrollDispatcher,this._viewportRuler,this._ngZone,o),this._document=s}}return n.\u0275fac=function(t){return new(t||n)(te(G5),te(JD),te(Et),te(Nt))},n.\u0275prov=Ee({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class oR{constructor(e){if(this.scrollStrategy=new rR,this.panelClass="",this.hasBackdrop=!1,this.backdropClass="cdk-overlay-dark-backdrop",this.disposeOnNavigation=!1,e){const t=Object.keys(e);for(const i of t)void 0!==e[i]&&(this[i]=e[i])}}}class K5{constructor(e,t){this.connectionPair=e,this.scrollableViewProperties=t}}let aR=(()=>{class n{constructor(t){this._attachedOverlays=[],this._document=t}ngOnDestroy(){this.detach()}add(t){this.remove(t),this._attachedOverlays.push(t)}remove(t){const i=this._attachedOverlays.indexOf(t);i>-1&&this._attachedOverlays.splice(i,1),0===this._attachedOverlays.length&&this.detach()}}return n.\u0275fac=function(t){return new(t||n)(te(Nt))},n.\u0275prov=Ee({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),J5=(()=>{class n extends aR{constructor(t,i){super(t),this._ngZone=i,this._keydownListener=r=>{const s=this._attachedOverlays;for(let o=s.length-1;o>-1;o--)if(s[o]._keydownEvents.observers.length>0){const a=s[o]._keydownEvents;this._ngZone?this._ngZone.run(()=>a.next(r)):a.next(r);break}}}add(t){super.add(t),this._isAttached||(this._ngZone?this._ngZone.runOutsideAngular(()=>this._document.body.addEventListener("keydown",this._keydownListener)):this._document.body.addEventListener("keydown",this._keydownListener),this._isAttached=!0)}detach(){this._isAttached&&(this._document.body.removeEventListener("keydown",this._keydownListener),this._isAttached=!1)}}return n.\u0275fac=function(t){return new(t||n)(te(Nt),te(Et,8))},n.\u0275prov=Ee({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Q5=(()=>{class n extends aR{constructor(t,i,r){super(t),this._platform=i,this._ngZone=r,this._cursorStyleIsSet=!1,this._pointerDownListener=s=>{this._pointerDownEventTarget=fo(s)},this._clickListener=s=>{const o=fo(s),a="click"===s.type&&this._pointerDownEventTarget?this._pointerDownEventTarget:o;this._pointerDownEventTarget=null;const l=this._attachedOverlays.slice();for(let c=l.length-1;c>-1;c--){const u=l[c];if(u._outsidePointerEvents.observers.length<1||!u.hasAttached())continue;if(u.overlayElement.contains(o)||u.overlayElement.contains(a))break;const d=u._outsidePointerEvents;this._ngZone?this._ngZone.run(()=>d.next(s)):d.next(s)}}}add(t){if(super.add(t),!this._isAttached){const i=this._document.body;this._ngZone?this._ngZone.runOutsideAngular(()=>this._addEventListeners(i)):this._addEventListeners(i),this._platform.IOS&&!this._cursorStyleIsSet&&(this._cursorOriginalValue=i.style.cursor,i.style.cursor="pointer",this._cursorStyleIsSet=!0),this._isAttached=!0}}detach(){if(this._isAttached){const t=this._document.body;t.removeEventListener("pointerdown",this._pointerDownListener,!0),t.removeEventListener("click",this._clickListener,!0),t.removeEventListener("auxclick",this._clickListener,!0),t.removeEventListener("contextmenu",this._clickListener,!0),this._platform.IOS&&this._cursorStyleIsSet&&(t.style.cursor=this._cursorOriginalValue,this._cursorStyleIsSet=!1),this._isAttached=!1}}_addEventListeners(t){t.addEventListener("pointerdown",this._pointerDownListener,!0),t.addEventListener("click",this._clickListener,!0),t.addEventListener("auxclick",this._clickListener,!0),t.addEventListener("contextmenu",this._clickListener,!0)}}return n.\u0275fac=function(t){return new(t||n)(te(Nt),te(Dr),te(Et,8))},n.\u0275prov=Ee({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),wy=(()=>{class n{constructor(t,i){this._platform=i,this._document=t}ngOnDestroy(){this._containerElement?.remove()}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){const t="cdk-overlay-container";if(this._platform.isBrowser||OD()){const r=this._document.querySelectorAll(`.${t}[platform="server"], .${t}[platform="test"]`);for(let s=0;s<r.length;s++)r[s].remove()}const i=this._document.createElement("div");i.classList.add(t),OD()?i.setAttribute("platform","test"):this._platform.isBrowser||i.setAttribute("platform","server"),this._document.body.appendChild(i),this._containerElement=i}}return n.\u0275fac=function(t){return new(t||n)(te(Nt),te(Dr))},n.\u0275prov=Ee({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class xy{constructor(e,t,i,r,s,o,a,l,c,u=!1){this._portalOutlet=e,this._host=t,this._pane=i,this._config=r,this._ngZone=s,this._keyboardDispatcher=o,this._document=a,this._location=l,this._outsideClickDispatcher=c,this._animationsDisabled=u,this._backdropElement=null,this._backdropClick=new zt,this._attachments=new zt,this._detachments=new zt,this._locationChanges=Bn.EMPTY,this._backdropClickHandler=d=>this._backdropClick.next(d),this._backdropTransitionendHandler=d=>{this._disposeBackdrop(d.target)},this._keydownEvents=new zt,this._outsidePointerEvents=new zt,r.scrollStrategy&&(this._scrollStrategy=r.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=r.positionStrategy}get overlayElement(){return this._pane}get backdropElement(){return this._backdropElement}get hostElement(){return this._host}attach(e){!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host);const t=this._portalOutlet.attach(e);return this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._ngZone.onStable.pipe(Rr(1)).subscribe(()=>{this.hasAttached()&&this.updatePosition()}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),this._outsideClickDispatcher.add(this),"function"==typeof t?.onDestroy&&t.onDestroy(()=>{this.hasAttached()&&this._ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>this.detach()))}),t}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();const e=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenStable(),this._locationChanges.unsubscribe(),this._outsideClickDispatcher.remove(this),e}dispose(){const e=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this._disposeBackdrop(this._backdropElement),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._outsidePointerEvents.complete(),this._outsideClickDispatcher.remove(this),this._host?.remove(),this._previousHostParent=this._pane=this._host=null,e&&this._detachments.next(),this._detachments.complete()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick}attachments(){return this._attachments}detachments(){return this._detachments}keydownEvents(){return this._keydownEvents}outsidePointerEvents(){return this._outsidePointerEvents}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(e){e!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=e,this.hasAttached()&&(e.attach(this),this.updatePosition()))}updateSize(e){this._config={...this._config,...e},this._updateElementSize()}setDirection(e){this._config={...this._config,direction:e},this._updateElementDirection()}addPanelClass(e){this._pane&&this._toggleClasses(this._pane,e,!0)}removePanelClass(e){this._pane&&this._toggleClasses(this._pane,e,!1)}getDirection(){const e=this._config.direction;return e?"string"==typeof e?e:e.value:"ltr"}updateScrollStrategy(e){e!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=e,this.hasAttached()&&(e.attach(this),e.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;const e=this._pane.style;e.width=vn(this._config.width),e.height=vn(this._config.height),e.minWidth=vn(this._config.minWidth),e.minHeight=vn(this._config.minHeight),e.maxWidth=vn(this._config.maxWidth),e.maxHeight=vn(this._config.maxHeight)}_togglePointerEvents(e){this._pane.style.pointerEvents=e?"":"none"}_attachBackdrop(){const e="cdk-overlay-backdrop-showing";this._backdropElement=this._document.createElement("div"),this._backdropElement.classList.add("cdk-overlay-backdrop"),this._animationsDisabled&&this._backdropElement.classList.add("cdk-overlay-backdrop-noop-animation"),this._config.backdropClass&&this._toggleClasses(this._backdropElement,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropElement,this._host),this._backdropElement.addEventListener("click",this._backdropClickHandler),!this._animationsDisabled&&typeof requestAnimationFrame<"u"?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{this._backdropElement&&this._backdropElement.classList.add(e)})}):this._backdropElement.classList.add(e)}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){const e=this._backdropElement;if(e){if(this._animationsDisabled)return void this._disposeBackdrop(e);e.classList.remove("cdk-overlay-backdrop-showing"),this._ngZone.runOutsideAngular(()=>{e.addEventListener("transitionend",this._backdropTransitionendHandler)}),e.style.pointerEvents="none",this._backdropTimeout=this._ngZone.runOutsideAngular(()=>setTimeout(()=>{this._disposeBackdrop(e)},500))}}_toggleClasses(e,t,i){const r=Cf(t||[]).filter(s=>!!s);r.length&&(i?e.classList.add(...r):e.classList.remove(...r))}_detachContentWhenStable(){this._ngZone.runOutsideAngular(()=>{const e=this._ngZone.onStable.pipe(Af(Ww(this._attachments,this._detachments))).subscribe(()=>{(!this._pane||!this._host||0===this._pane.children.length)&&(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._host.remove()),e.unsubscribe())})})}_disposeScrollStrategy(){const e=this._scrollStrategy;e&&(e.disable(),e.detach&&e.detach())}_disposeBackdrop(e){e&&(e.removeEventListener("click",this._backdropClickHandler),e.removeEventListener("transitionend",this._backdropTransitionendHandler),e.remove(),this._backdropElement===e&&(this._backdropElement=null)),this._backdropTimeout&&(clearTimeout(this._backdropTimeout),this._backdropTimeout=void 0)}}const lR="cdk-overlay-connected-position-bounding-box",ej=/([A-Za-z%]+)$/;class tj{get positions(){return this._preferredPositions}constructor(e,t,i,r,s){this._viewportRuler=t,this._document=i,this._platform=r,this._overlayContainer=s,this._lastBoundingBoxSize={width:0,height:0},this._isPushed=!1,this._canPush=!0,this._growAfterOpen=!1,this._hasFlexibleDimensions=!0,this._positionLocked=!1,this._viewportMargin=0,this._scrollables=[],this._preferredPositions=[],this._positionChanges=new zt,this._resizeSubscription=Bn.EMPTY,this._offsetX=0,this._offsetY=0,this._appliedPanelClasses=[],this.positionChanges=this._positionChanges,this.setOrigin(e)}attach(e){this._validatePositions(),e.hostElement.classList.add(lR),this._overlayRef=e,this._boundingBox=e.hostElement,this._pane=e.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition)return void this.reapplyLastPosition();this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const e=this._originRect,t=this._overlayRect,i=this._viewportRect,r=this._containerRect,s=[];let o;for(let a of this._preferredPositions){let l=this._getOriginPoint(e,r,a),c=this._getOverlayPoint(l,t,a),u=this._getOverlayFit(c,t,i,a);if(u.isCompletelyWithinViewport)return this._isPushed=!1,void this._applyPosition(a,l);this._canFitWithFlexibleDimensions(u,c,i)?s.push({position:a,origin:l,overlayRect:t,boundingBoxRect:this._calculateBoundingBoxRect(l,a)}):(!o||o.overlayFit.visibleArea<u.visibleArea)&&(o={overlayFit:u,overlayPoint:c,originPoint:l,position:a,overlayRect:t})}if(s.length){let a=null,l=-1;for(const c of s){const u=c.boundingBoxRect.width*c.boundingBoxRect.height*(c.position.weight||1);u>l&&(l=u,a=c)}return this._isPushed=!1,void this._applyPosition(a.position,a.origin)}if(this._canPush)return this._isPushed=!0,void this._applyPosition(o.position,o.originPoint);this._applyPosition(o.position,o.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&mo(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove(lR),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(this._isDisposed||!this._platform.isBrowser)return;const e=this._lastPosition;if(e){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const t=this._getOriginPoint(this._originRect,this._containerRect,e);this._applyPosition(e,t)}else this.apply()}withScrollableContainers(e){return this._scrollables=e,this}withPositions(e){return this._preferredPositions=e,-1===e.indexOf(this._lastPosition)&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(e){return this._viewportMargin=e,this}withFlexibleDimensions(e=!0){return this._hasFlexibleDimensions=e,this}withGrowAfterOpen(e=!0){return this._growAfterOpen=e,this}withPush(e=!0){return this._canPush=e,this}withLockedPosition(e=!0){return this._positionLocked=e,this}setOrigin(e){return this._origin=e,this}withDefaultOffsetX(e){return this._offsetX=e,this}withDefaultOffsetY(e){return this._offsetY=e,this}withTransformOriginOn(e){return this._transformOriginSelector=e,this}_getOriginPoint(e,t,i){let r,s;if("center"==i.originX)r=e.left+e.width/2;else{const o=this._isRtl()?e.right:e.left,a=this._isRtl()?e.left:e.right;r="start"==i.originX?o:a}return t.left<0&&(r-=t.left),s="center"==i.originY?e.top+e.height/2:"top"==i.originY?e.top:e.bottom,t.top<0&&(s-=t.top),{x:r,y:s}}_getOverlayPoint(e,t,i){let r,s;return r="center"==i.overlayX?-t.width/2:"start"===i.overlayX?this._isRtl()?-t.width:0:this._isRtl()?0:-t.width,s="center"==i.overlayY?-t.height/2:"top"==i.overlayY?0:-t.height,{x:e.x+r,y:e.y+s}}_getOverlayFit(e,t,i,r){const s=uR(t);let{x:o,y:a}=e,l=this._getOffset(r,"x"),c=this._getOffset(r,"y");l&&(o+=l),c&&(a+=c);let h=0-a,f=a+s.height-i.height,p=this._subtractOverflows(s.width,0-o,o+s.width-i.width),_=this._subtractOverflows(s.height,h,f),g=p*_;return{visibleArea:g,isCompletelyWithinViewport:s.width*s.height===g,fitsInViewportVertically:_===s.height,fitsInViewportHorizontally:p==s.width}}_canFitWithFlexibleDimensions(e,t,i){if(this._hasFlexibleDimensions){const r=i.bottom-t.y,s=i.right-t.x,o=cR(this._overlayRef.getConfig().minHeight),a=cR(this._overlayRef.getConfig().minWidth);return(e.fitsInViewportVertically||null!=o&&o<=r)&&(e.fitsInViewportHorizontally||null!=a&&a<=s)}return!1}_pushOverlayOnScreen(e,t,i){if(this._previousPushAmount&&this._positionLocked)return{x:e.x+this._previousPushAmount.x,y:e.y+this._previousPushAmount.y};const r=uR(t),s=this._viewportRect,o=Math.max(e.x+r.width-s.width,0),a=Math.max(e.y+r.height-s.height,0),l=Math.max(s.top-i.top-e.y,0),c=Math.max(s.left-i.left-e.x,0);let u=0,d=0;return u=r.width<=s.width?c||-o:e.x<this._viewportMargin?s.left-i.left-e.x:0,d=r.height<=s.height?l||-a:e.y<this._viewportMargin?s.top-i.top-e.y:0,this._previousPushAmount={x:u,y:d},{x:e.x+u,y:e.y+d}}_applyPosition(e,t){if(this._setTransformOrigin(e),this._setOverlayElementStyles(t,e),this._setBoundingBoxStyles(t,e),e.panelClass&&this._addPanelClasses(e.panelClass),this._lastPosition=e,this._positionChanges.observers.length){const i=this._getScrollVisibility(),r=new K5(e,i);this._positionChanges.next(r)}this._isInitialRender=!1}_setTransformOrigin(e){if(!this._transformOriginSelector)return;const t=this._boundingBox.querySelectorAll(this._transformOriginSelector);let i,r=e.overlayY;i="center"===e.overlayX?"center":this._isRtl()?"start"===e.overlayX?"right":"left":"start"===e.overlayX?"left":"right";for(let s=0;s<t.length;s++)t[s].style.transformOrigin=`${i} ${r}`}_calculateBoundingBoxRect(e,t){const i=this._viewportRect,r=this._isRtl();let s,o,a,u,d,h;if("top"===t.overlayY)o=e.y,s=i.height-o+this._viewportMargin;else if("bottom"===t.overlayY)a=i.height-e.y+2*this._viewportMargin,s=i.height-a+this._viewportMargin;else{const f=Math.min(i.bottom-e.y+i.top,e.y),p=this._lastBoundingBoxSize.height;s=2*f,o=e.y-f,s>p&&!this._isInitialRender&&!this._growAfterOpen&&(o=e.y-p/2)}if("end"===t.overlayX&&!r||"start"===t.overlayX&&r)h=i.width-e.x+this._viewportMargin,u=e.x-this._viewportMargin;else if("start"===t.overlayX&&!r||"end"===t.overlayX&&r)d=e.x,u=i.right-e.x;else{const f=Math.min(i.right-e.x+i.left,e.x),p=this._lastBoundingBoxSize.width;u=2*f,d=e.x-f,u>p&&!this._isInitialRender&&!this._growAfterOpen&&(d=e.x-p/2)}return{top:o,left:d,bottom:a,right:h,width:u,height:s}}_setBoundingBoxStyles(e,t){const i=this._calculateBoundingBoxRect(e,t);!this._isInitialRender&&!this._growAfterOpen&&(i.height=Math.min(i.height,this._lastBoundingBoxSize.height),i.width=Math.min(i.width,this._lastBoundingBoxSize.width));const r={};if(this._hasExactPosition())r.top=r.left="0",r.bottom=r.right=r.maxHeight=r.maxWidth="",r.width=r.height="100%";else{const s=this._overlayRef.getConfig().maxHeight,o=this._overlayRef.getConfig().maxWidth;r.height=vn(i.height),r.top=vn(i.top),r.bottom=vn(i.bottom),r.width=vn(i.width),r.left=vn(i.left),r.right=vn(i.right),r.alignItems="center"===t.overlayX?"center":"end"===t.overlayX?"flex-end":"flex-start",r.justifyContent="center"===t.overlayY?"center":"bottom"===t.overlayY?"flex-end":"flex-start",s&&(r.maxHeight=vn(s)),o&&(r.maxWidth=vn(o))}this._lastBoundingBoxSize=i,mo(this._boundingBox.style,r)}_resetBoundingBoxStyles(){mo(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){mo(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(e,t){const i={},r=this._hasExactPosition(),s=this._hasFlexibleDimensions,o=this._overlayRef.getConfig();if(r){const u=this._viewportRuler.getViewportScrollPosition();mo(i,this._getExactOverlayY(t,e,u)),mo(i,this._getExactOverlayX(t,e,u))}else i.position="static";let a="",l=this._getOffset(t,"x"),c=this._getOffset(t,"y");l&&(a+=`translateX(${l}px) `),c&&(a+=`translateY(${c}px)`),i.transform=a.trim(),o.maxHeight&&(r?i.maxHeight=vn(o.maxHeight):s&&(i.maxHeight="")),o.maxWidth&&(r?i.maxWidth=vn(o.maxWidth):s&&(i.maxWidth="")),mo(this._pane.style,i)}_getExactOverlayY(e,t,i){let r={top:"",bottom:""},s=this._getOverlayPoint(t,this._overlayRect,e);return this._isPushed&&(s=this._pushOverlayOnScreen(s,this._overlayRect,i)),"bottom"===e.overlayY?r.bottom=this._document.documentElement.clientHeight-(s.y+this._overlayRect.height)+"px":r.top=vn(s.y),r}_getExactOverlayX(e,t,i){let o,r={left:"",right:""},s=this._getOverlayPoint(t,this._overlayRect,e);return this._isPushed&&(s=this._pushOverlayOnScreen(s,this._overlayRect,i)),o=this._isRtl()?"end"===e.overlayX?"left":"right":"end"===e.overlayX?"right":"left","right"===o?r.right=this._document.documentElement.clientWidth-(s.x+this._overlayRect.width)+"px":r.left=vn(s.x),r}_getScrollVisibility(){const e=this._getOriginRect(),t=this._pane.getBoundingClientRect(),i=this._scrollables.map(r=>r.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:sR(e,i),isOriginOutsideView:by(e,i),isOverlayClipped:sR(t,i),isOverlayOutsideView:by(t,i)}}_subtractOverflows(e,...t){return t.reduce((i,r)=>i-Math.max(r,0),e)}_getNarrowedViewportRect(){const e=this._document.documentElement.clientWidth,t=this._document.documentElement.clientHeight,i=this._viewportRuler.getViewportScrollPosition();return{top:i.top+this._viewportMargin,left:i.left+this._viewportMargin,right:i.left+e-this._viewportMargin,bottom:i.top+t-this._viewportMargin,width:e-2*this._viewportMargin,height:t-2*this._viewportMargin}}_isRtl(){return"rtl"===this._overlayRef.getDirection()}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(e,t){return"x"===t?null==e.offsetX?this._offsetX:e.offsetX:null==e.offsetY?this._offsetY:e.offsetY}_validatePositions(){}_addPanelClasses(e){this._pane&&Cf(e).forEach(t=>{""!==t&&-1===this._appliedPanelClasses.indexOf(t)&&(this._appliedPanelClasses.push(t),this._pane.classList.add(t))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(e=>{this._pane.classList.remove(e)}),this._appliedPanelClasses=[])}_getOriginRect(){const e=this._origin;if(e instanceof mi)return e.nativeElement.getBoundingClientRect();if(e instanceof Element)return e.getBoundingClientRect();const t=e.width||0,i=e.height||0;return{top:e.y,bottom:e.y+i,left:e.x,right:e.x+t,height:i,width:t}}}function mo(n,e){for(let t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n}function cR(n){if("number"!=typeof n&&null!=n){const[e,t]=n.split(ej);return t&&"px"!==t?null:parseFloat(e)}return n||null}function uR(n){return{top:Math.floor(n.top),right:Math.floor(n.right),bottom:Math.floor(n.bottom),left:Math.floor(n.left),width:Math.floor(n.width),height:Math.floor(n.height)}}const dR="cdk-global-overlay-wrapper";class nj{constructor(){this._cssPosition="static",this._topOffset="",this._bottomOffset="",this._alignItems="",this._xPosition="",this._xOffset="",this._width="",this._height="",this._isDisposed=!1}attach(e){const t=e.getConfig();this._overlayRef=e,this._width&&!t.width&&e.updateSize({width:this._width}),this._height&&!t.height&&e.updateSize({height:this._height}),e.hostElement.classList.add(dR),this._isDisposed=!1}top(e=""){return this._bottomOffset="",this._topOffset=e,this._alignItems="flex-start",this}left(e=""){return this._xOffset=e,this._xPosition="left",this}bottom(e=""){return this._topOffset="",this._bottomOffset=e,this._alignItems="flex-end",this}right(e=""){return this._xOffset=e,this._xPosition="right",this}start(e=""){return this._xOffset=e,this._xPosition="start",this}end(e=""){return this._xOffset=e,this._xPosition="end",this}width(e=""){return this._overlayRef?this._overlayRef.updateSize({width:e}):this._width=e,this}height(e=""){return this._overlayRef?this._overlayRef.updateSize({height:e}):this._height=e,this}centerHorizontally(e=""){return this.left(e),this._xPosition="center",this}centerVertically(e=""){return this.top(e),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;const e=this._overlayRef.overlayElement.style,t=this._overlayRef.hostElement.style,i=this._overlayRef.getConfig(),{width:r,height:s,maxWidth:o,maxHeight:a}=i,l=!("100%"!==r&&"100vw"!==r||o&&"100%"!==o&&"100vw"!==o),c=!("100%"!==s&&"100vh"!==s||a&&"100%"!==a&&"100vh"!==a),u=this._xPosition,d=this._xOffset,h="rtl"===this._overlayRef.getConfig().direction;let f="",p="",_="";l?_="flex-start":"center"===u?(_="center",h?p=d:f=d):h?"left"===u||"end"===u?(_="flex-end",f=d):("right"===u||"start"===u)&&(_="flex-start",p=d):"left"===u||"start"===u?(_="flex-start",f=d):("right"===u||"end"===u)&&(_="flex-end",p=d),e.position=this._cssPosition,e.marginLeft=l?"0":f,e.marginTop=c?"0":this._topOffset,e.marginBottom=this._bottomOffset,e.marginRight=l?"0":p,t.justifyContent=_,t.alignItems=c?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;const e=this._overlayRef.overlayElement.style,t=this._overlayRef.hostElement,i=t.style;t.classList.remove(dR),i.justifyContent=i.alignItems=e.marginTop=e.marginBottom=e.marginLeft=e.marginRight=e.position="",this._overlayRef=null,this._isDisposed=!0}}let ij=(()=>{class n{constructor(t,i,r,s){this._viewportRuler=t,this._document=i,this._platform=r,this._overlayContainer=s}global(){return new nj}flexibleConnectedTo(t){return new tj(t,this._viewportRuler,this._document,this._platform,this._overlayContainer)}}return n.\u0275fac=function(t){return new(t||n)(te(JD),te(Nt),te(Dr),te(wy))},n.\u0275prov=Ee({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),rj=0,Ff=(()=>{class n{constructor(t,i,r,s,o,a,l,c,u,d,h,f){this.scrollStrategies=t,this._overlayContainer=i,this._componentFactoryResolver=r,this._positionBuilder=s,this._keyboardDispatcher=o,this._injector=a,this._ngZone=l,this._document=c,this._directionality=u,this._location=d,this._outsideClickDispatcher=h,this._animationsModuleType=f}create(t){const i=this._createHostElement(),r=this._createPaneElement(i),s=this._createPortalOutlet(r),o=new oR(t);return o.direction=o.direction||this._directionality.value,new xy(s,i,r,o,this._ngZone,this._keyboardDispatcher,this._document,this._location,this._outsideClickDispatcher,"NoopAnimations"===this._animationsModuleType)}position(){return this._positionBuilder}_createPaneElement(t){const i=this._document.createElement("div");return i.id="cdk-overlay-"+rj++,i.classList.add("cdk-overlay-pane"),t.appendChild(i),i}_createHostElement(){const t=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(t),t}_createPortalOutlet(t){return this._appRef||(this._appRef=this._injector.get(lo)),new $5(t,this._componentFactoryResolver,this._appRef,this._injector,this._document)}}return n.\u0275fac=function(t){return new(t||n)(te(Z5),te(wy),te(Ea),te(ij),te(J5),te(gi),te(Et),te(Nt),te(py),te(hf),te(Q5),te(z2,8))},n.\u0275prov=Ee({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const aj={provide:new Ce("cdk-connected-overlay-scroll-strategy"),deps:[Ff],useFactory:function oj(n){return()=>n.scrollStrategies.reposition()}};let lj=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=li({type:n}),n.\u0275inj=Yn({providers:[Ff,aj],imports:[my,yy,eR,eR]}),n})();function Sy(n){return new Ht(e=>{oi(n()).subscribe(e)})}function cj(n,e){}class My{constructor(){this.role="dialog",this.panelClass="",this.hasBackdrop=!0,this.backdropClass="",this.disableClose=!1,this.width="",this.height="",this.data=null,this.ariaDescribedBy=null,this.ariaLabelledBy=null,this.ariaLabel=null,this.ariaModal=!0,this.autoFocus="first-tabbable",this.restoreFocus=!0,this.closeOnNavigation=!0,this.closeOnDestroy=!0,this.closeOnOverlayDetachments=!0}}let uj=(()=>{class n extends vy{constructor(t,i,r,s,o,a,l,c){super(),this._elementRef=t,this._focusTrapFactory=i,this._config=s,this._interactivityChecker=o,this._ngZone=a,this._overlayRef=l,this._focusMonitor=c,this._elementFocusedBeforeDialogWasOpened=null,this._closeInteractionType=null,this.attachDomPortal=u=>{this._portalOutlet.hasAttached();const d=this._portalOutlet.attachDomPortal(u);return this._contentAttached(),d},this._ariaLabelledBy=this._config.ariaLabelledBy||null,this._document=r}_contentAttached(){this._initializeFocusTrap(),this._handleBackdropClicks(),this._captureInitialFocus()}_captureInitialFocus(){this._trapFocus()}ngOnDestroy(){this._restoreFocus()}attachComponentPortal(t){this._portalOutlet.hasAttached();const i=this._portalOutlet.attachComponentPortal(t);return this._contentAttached(),i}attachTemplatePortal(t){this._portalOutlet.hasAttached();const i=this._portalOutlet.attachTemplatePortal(t);return this._contentAttached(),i}_recaptureFocus(){this._containsFocus()||this._trapFocus()}_forceFocus(t,i){this._interactivityChecker.isFocusable(t)||(t.tabIndex=-1,this._ngZone.runOutsideAngular(()=>{const r=()=>{t.removeEventListener("blur",r),t.removeEventListener("mousedown",r),t.removeAttribute("tabindex")};t.addEventListener("blur",r),t.addEventListener("mousedown",r)})),t.focus(i)}_focusByCssSelector(t,i){let r=this._elementRef.nativeElement.querySelector(t);r&&this._forceFocus(r,i)}_trapFocus(){const t=this._elementRef.nativeElement;switch(this._config.autoFocus){case!1:case"dialog":this._containsFocus()||t.focus();break;case!0:case"first-tabbable":this._focusTrap.focusInitialElementWhenReady().then(i=>{i||this._focusDialogContainer()});break;case"first-heading":this._focusByCssSelector('h1, h2, h3, h4, h5, h6, [role="heading"]');break;default:this._focusByCssSelector(this._config.autoFocus)}}_restoreFocus(){const t=this._config.restoreFocus;let i=null;if("string"==typeof t?i=this._document.querySelector(t):"boolean"==typeof t?i=t?this._elementFocusedBeforeDialogWasOpened:null:t&&(i=t),this._config.restoreFocus&&i&&"function"==typeof i.focus){const r=ay(),s=this._elementRef.nativeElement;(!r||r===this._document.body||r===s||s.contains(r))&&(this._focusMonitor?(this._focusMonitor.focusVia(i,this._closeInteractionType),this._closeInteractionType=null):i.focus())}this._focusTrap&&this._focusTrap.destroy()}_focusDialogContainer(){this._elementRef.nativeElement.focus&&this._elementRef.nativeElement.focus()}_containsFocus(){const t=this._elementRef.nativeElement,i=ay();return t===i||t.contains(i)}_initializeFocusTrap(){this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement),this._document&&(this._elementFocusedBeforeDialogWasOpened=ay())}_handleBackdropClicks(){this._overlayRef.backdropClick().subscribe(()=>{this._config.disableClose&&this._recaptureFocus()})}}return n.\u0275fac=function(t){return new(t||n)(De(mi),De(l5),De(Nt,8),De(My),De(GD),De(Et),De(xy),De(g5))},n.\u0275cmp=qs({type:n,selectors:[["cdk-dialog-container"]],viewQuery:function(t,i){if(1&t&&LC(nR,7),2&t){let r;av(r=function lv(){return function DH(n,e){return n[vr].queries[e].queryList}(ie(),Gx())}())&&(i._portalOutlet=r.first)}},hostAttrs:["tabindex","-1",1,"cdk-dialog-container"],hostVars:6,hostBindings:function(t,i){2&t&&Uh("id",i._config.id||null)("role",i._config.role)("aria-modal",i._config.ariaModal)("aria-labelledby",i._config.ariaLabel?null:i._ariaLabelledBy)("aria-label",i._config.ariaLabel)("aria-describedby",i._config.ariaDescribedBy||null)},features:[Oh],decls:1,vars:0,consts:[["cdkPortalOutlet",""]],template:function(t,i){1&t&&zh(0,cj,0,0,"ng-template",0)},dependencies:[nR],styles:[".cdk-dialog-container{display:block;width:100%;height:100%;min-height:inherit;max-height:inherit}"],encapsulation:2}),n})();class kf{constructor(e,t){this.overlayRef=e,this.config=t,this.closed=new zt,this.disableClose=t.disableClose,this.backdropClick=e.backdropClick(),this.keydownEvents=e.keydownEvents(),this.outsidePointerEvents=e.outsidePointerEvents(),this.id=t.id,this.keydownEvents.subscribe(i=>{27===i.keyCode&&!this.disableClose&&!function A4(n,...e){return e.length?e.some(t=>n[t]):n.altKey||n.shiftKey||n.ctrlKey||n.metaKey}(i)&&(i.preventDefault(),this.close(void 0,{focusOrigin:"keyboard"}))}),this.backdropClick.subscribe(()=>{this.disableClose||this.close(void 0,{focusOrigin:"mouse"})}),this._detachSubscription=e.detachments().subscribe(()=>{!1!==t.closeOnOverlayDetachments&&this.close()})}close(e,t){if(this.containerInstance){const i=this.closed;this.containerInstance._closeInteractionType=t?.focusOrigin||"program",this._detachSubscription.unsubscribe(),this.overlayRef.dispose(),i.next(e),i.complete(),this.componentInstance=this.containerInstance=null}}updatePosition(){return this.overlayRef.updatePosition(),this}updateSize(e="",t=""){return this.overlayRef.updateSize({width:e,height:t}),this}addPanelClass(e){return this.overlayRef.addPanelClass(e),this}removePanelClass(e){return this.overlayRef.removePanelClass(e),this}}const hR=new Ce("DialogScrollStrategy"),fR=new Ce("DialogData"),dj=new Ce("DefaultDialogConfig"),fj={provide:hR,deps:[Ff],useFactory:function hj(n){return()=>n.scrollStrategies.block()}};let pj=0,Ey=(()=>{class n{get openDialogs(){return this._parentDialog?this._parentDialog.openDialogs:this._openDialogsAtThisLevel}get afterOpened(){return this._parentDialog?this._parentDialog.afterOpened:this._afterOpenedAtThisLevel}constructor(t,i,r,s,o,a){this._overlay=t,this._injector=i,this._defaultOptions=r,this._parentDialog=s,this._overlayContainer=o,this._openDialogsAtThisLevel=[],this._afterAllClosedAtThisLevel=new zt,this._afterOpenedAtThisLevel=new zt,this._ariaHiddenElements=new Map,this.afterAllClosed=Sy(()=>this.openDialogs.length?this._getAfterAllClosed():this._getAfterAllClosed().pipe(dy(void 0))),this._scrollStrategy=a}open(t,i){(i={...this._defaultOptions||new My,...i}).id=i.id||"cdk-dialog-"+pj++,i.id&&this.getDialogById(i.id);const s=this._getOverlayConfig(i),o=this._overlay.create(s),a=new kf(o,i),l=this._attachContainer(o,a,i);return a.containerInstance=l,this._attachDialogContent(t,a,l,i),this.openDialogs.length||this._hideNonDialogContentFromAssistiveTechnology(),this.openDialogs.push(a),a.closed.subscribe(()=>this._removeOpenDialog(a,!0)),this.afterOpened.next(a),a}closeAll(){Ay(this.openDialogs,t=>t.close())}getDialogById(t){return this.openDialogs.find(i=>i.id===t)}ngOnDestroy(){Ay(this._openDialogsAtThisLevel,t=>{!1===t.config.closeOnDestroy&&this._removeOpenDialog(t,!1)}),Ay(this._openDialogsAtThisLevel,t=>t.close()),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete(),this._openDialogsAtThisLevel=[]}_getOverlayConfig(t){const i=new oR({positionStrategy:t.positionStrategy||this._overlay.position().global().centerHorizontally().centerVertically(),scrollStrategy:t.scrollStrategy||this._scrollStrategy(),panelClass:t.panelClass,hasBackdrop:t.hasBackdrop,direction:t.direction,minWidth:t.minWidth,minHeight:t.minHeight,maxWidth:t.maxWidth,maxHeight:t.maxHeight,width:t.width,height:t.height,disposeOnNavigation:t.closeOnNavigation});return t.backdropClass&&(i.backdropClass=t.backdropClass),i}_attachContainer(t,i,r){const s=r.injector||r.viewContainerRef?.injector,o=[{provide:My,useValue:r},{provide:kf,useValue:i},{provide:xy,useValue:t}];let a;r.container?"function"==typeof r.container?a=r.container:(a=r.container.type,o.push(...r.container.providers(r))):a=uj;const l=new _y(a,r.viewContainerRef,gi.create({parent:s||this._injector,providers:o}),r.componentFactoryResolver);return t.attach(l).instance}_attachDialogContent(t,i,r,s){if(t instanceof Tr){const o=this._createInjector(s,i,r,void 0);let a={$implicit:s.data,dialogRef:i};s.templateContext&&(a={...a,..."function"==typeof s.templateContext?s.templateContext():s.templateContext}),r.attachTemplatePortal(new tR(t,null,a,o))}else{const o=this._createInjector(s,i,r,this._injector),a=r.attachComponentPortal(new _y(t,s.viewContainerRef,o,s.componentFactoryResolver));i.componentInstance=a.instance}}_createInjector(t,i,r,s){const o=t.injector||t.viewContainerRef?.injector,a=[{provide:fR,useValue:t.data},{provide:kf,useValue:i}];return t.providers&&("function"==typeof t.providers?a.push(...t.providers(i,t,r)):a.push(...t.providers)),t.direction&&(!o||!o.get(py,null,{optional:!0}))&&a.push({provide:py,useValue:{value:t.direction,change:$e()}}),gi.create({parent:o||s,providers:a})}_removeOpenDialog(t,i){const r=this.openDialogs.indexOf(t);r>-1&&(this.openDialogs.splice(r,1),this.openDialogs.length||(this._ariaHiddenElements.forEach((s,o)=>{s?o.setAttribute("aria-hidden",s):o.removeAttribute("aria-hidden")}),this._ariaHiddenElements.clear(),i&&this._getAfterAllClosed().next()))}_hideNonDialogContentFromAssistiveTechnology(){const t=this._overlayContainer.getContainerElement();if(t.parentElement){const i=t.parentElement.children;for(let r=i.length-1;r>-1;r--){const s=i[r];s!==t&&"SCRIPT"!==s.nodeName&&"STYLE"!==s.nodeName&&!s.hasAttribute("aria-live")&&(this._ariaHiddenElements.set(s,s.getAttribute("aria-hidden")),s.setAttribute("aria-hidden","true"))}}}_getAfterAllClosed(){const t=this._parentDialog;return t?t._getAfterAllClosed():this._afterAllClosedAtThisLevel}}return n.\u0275fac=function(t){return new(t||n)(te(Ff),te(gi),te(dj,8),te(n,12),te(wy),te(hR))},n.\u0275prov=Ee({token:n,factory:n.\u0275fac}),n})();function Ay(n,e){let t=n.length;for(;t--;)e(n[t])}let mj=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=li({type:n}),n.\u0275inj=Yn({providers:[Ey,fj],imports:[lj,yy,v5,yy]}),n})();function pR(n){n||(function VM(n){if(!Kw()&&!function ON(){return ia}())throw new he(-203,!1)}(),n=_e(Ih));const e=new Ht(t=>n.onDestroy(t.next.bind(t)));return t=>t.pipe(Af(e))}class Hf{constructor(e){this.dialog=e}open(e){return this.dialog.open(bR,{data:e,disableClose:!0})}}function Aj(n,e){if(1&n){const t=function FE(){return ie()}();Ba(0,"li")(1,"button",2),qh("click",function(){const s=function kx(n){return qe.lFrame.contextLView=n,n[an]}(t).$implicit;return function Ux(n){return qe.lFrame.contextLView=null,n}(L_(2).dialogRef.close(s))}),B_(2),Va()()}if(2&n){const t=e.$implicit;Ta(2),Kh(t.label)}}function Cj(n,e){if(1&n&&(jh(0),Ba(1,"menu"),zh(2,Aj,3,1,"li",1),Va(),$h()),2&n){const t=e.ngIf,i=L_();Ta(1),function wA(n,e,t,i,r){Ar(Pa(ie(),n,e,t,i,r))}("--x: ",t.dy/20,"deg; --y: ",t.dx/20,"deg"),Ta(1),Gh("ngForOf",i.data.options)}}let bR=(()=>{var n=new WeakMap,e=new WeakSet;class t{get element(){return this.elementRef.nativeElement}constructor(s,o,a,l){Un(this,e),Ye(this,n,{writable:!0,value:void 0}),this.destroyRef=s,this.elementRef=o,this.dialogRef=a,this.data=l,He(this,n,new si({dx:0,dy:0})),this.angle$=W(this,n).asObservable()}ngOnInit(){const{matches:s}=window.matchMedia("(prefers-reduced-motion: no-preference)");s&&Lf(window,"mousemove").pipe(pR(this.destroyRef)).subscribe(({clientX:o,clientY:a})=>{W(this,n).next(qt(this,e,i).call(this,o,a))})}}function i(r,s){const o=this.elementRef.nativeElement.getBoundingClientRect(),{x:a,y:l,width:c,height:u}=o;return{dx:r-(a+.5*c),dy:s-(l+.5*u)}}return t.\u0275fac=function(s){return new(s||t)(De(Ih),De(mi),De(kf),De(fR))},t.\u0275cmp=qs({type:t,selectors:[["ng-component"]],standalone:!0,features:[aC([{provide:Hf,deps:[Ey]}]),Z_],decls:4,vars:4,consts:[[4,"ngIf"],[4,"ngFor","ngForOf"],[3,"click"]],template:function(s,o){1&s&&(Ba(0,"p"),B_(1),Va(),zh(2,Cj,3,5,"ng-container",0),function wC(n,e){const t=Mt();let i;const r=n+mt;t.firstCreatePass?(i=function rH(n,e){if(e)for(let t=e.length-1;t>=0;t--){const i=e[t];if(n===i.name)return i}}(e,t.pipeRegistry),t.data[r]=i,i.onDestroy&&(t.destroyHooks??=[]).push(r,i.onDestroy)):i=t.data[r];const s=i.factory||(i.factory=Ks(i.type)),o=ai(De);try{const a=Zd(!1),l=s();return Zd(a),function UB(n,e,t,i){t>=n.data.length&&(n.data[t]=null,n.blueprint[t]=null),e[t]=i}(t,ie(),r,l),l}finally{ai(o)}}(3,"async")),2&s&&(Ta(1),Kh(o.data.message),Ta(1),Gh("ngIf",xC(3,2,o.angle$)))},dependencies:[tD,QT,rD,mj],styles:['[_nghost-%COMP%]{--ui-menu-theme: var(--theme, hsl(180 100% 50%));--ui-menu-theme-bg: var(--theme-bg, hsl(180 100% 50% / 25%));--ui-menu-theme-bg-hover: var(--theme-bg-hover, hsl(180 100% 50% / 40%));--ui-menu-theme-text: var(--theme-text, white);--ui-menu-theme-shadow: var(--theme-shadow, hsl(180 100% 10% / 25%));--distance: 1px;--_max-rotateY: 10deg;--_max-rotateX: 15deg;--_btn-bg: var(--ui-menu-theme-bg);--_btn-bg-hover: var(--ui-menu-theme-bg-hover);--_btn-text: var(--ui-menu-theme-text);--_btn-text-shadow: var(--ui-menu-theme-shadow);--_bounce-ease: cubic-bezier(.5, 1.75, .75, 1.25);display:block;font-size:min(5vmin,3rem);font-family:Audiowide;color:var(--ui-menu-theme-text)}[_nghost-%COMP%] > p[_ngcontent-%COMP%]{margin:20px}[_nghost-%COMP%]   menu[_ngcontent-%COMP%]{margin:0;display:flex;flex-direction:column;align-items:flex-start;gap:2.5vh;transform-style:preserve-3d;transform:rotateY(clamp(var(--_max-rotateY) * -1,var(--y),var(--_max-rotateY))) rotateX(clamp(var(--_max-rotateX) * -1,var(--x),var(--_max-rotateX)))}[_nghost-%COMP%]   menu[_ngcontent-%COMP%]:focus{outline:none}@media (prefers-reduced-motion){[_nghost-%COMP%]   menu[_ngcontent-%COMP%]{will-change:transform;transition:transform .1s ease;animation:_ngcontent-%COMP%_rotate-y 5s ease-in-out infinite}}@media (prefers-color-scheme: dark){[_nghost-%COMP%]   menu[_ngcontent-%COMP%]{--ui-menu-theme: var(--theme-dark, hsl(176, 100%, 50%));--ui-menu-theme-bg: var(--theme-bg-dark, hsl(255 53% 71% / 25%));--ui-menu-theme-bg-hover: var( --theme-bg-hover-dark, hsl(255 53% 50% / 40%) );--ui-menu-theme-shadow: var(--theme-shadow-dark, hsl(255 53% 10% / 25%))}}@media (dynamic-range: high){@supports (color: color(display-p3 0 0 0)){[_nghost-%COMP%]   menu[_ngcontent-%COMP%]{--ui-menu-theme: color(display-p3 .4 0 .9)}}}[_nghost-%COMP%]   menu[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{display:inline-flex;position:relative;transform-style:preserve-3d}[_nghost-%COMP%]   menu[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{cursor:pointer;-webkit-appearance:none;appearance:none;outline:none;border:none;-webkit-tap-highlight-color:transparent;background-color:var(--_btn-bg);color:var(--_btn-text);text-shadow:0 1px 1px var(--_btn-text-shadow);font-size:min(5vmin,3rem);font-family:Audiowide;padding-block:.75ch;padding-inline:2ch;border-radius:5px 20px;transform:translateZ(var(--distance));transform-style:preserve-3d}[_nghost-%COMP%]   menu[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:is(:hover, [_ngcontent-%COMP%]:focus-visible):not(:active){--distance: 15px;background-color:var(--_btn-bg-hover)}@media (prefers-reduced-motion){[_nghost-%COMP%]   menu[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:is(:hover, [_ngcontent-%COMP%]:focus-visible):not(:active){--distance: 3vmax;transition-timing-function:var(--_bounce-ease);transition-duration:.4s}[_nghost-%COMP%]   menu[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:is(:hover, [_ngcontent-%COMP%]:focus-visible):not(:active):after{transition-duration:.5s}[_nghost-%COMP%]   menu[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:is(:hover, [_ngcontent-%COMP%]:focus-visible):not(:active):before{transition-duration:.3s}}[_nghost-%COMP%]   menu[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:after, [_nghost-%COMP%]   menu[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:before{content:"";opacity:.8;position:absolute;inset:0;border:1px solid var(--ui-menu-theme);border-radius:5px 20px;transform:translateZ(calc(var(--distance) / 3))}@media (prefers-reduced-motion){[_nghost-%COMP%]   menu[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:after, [_nghost-%COMP%]   menu[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:before{transition:transform .1s ease-out}}[_nghost-%COMP%]   menu[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:before{border-width:3px;transform:translateZ(calc(var(--distance) / 3 * -1))}@media (prefers-color-scheme: dark){[_nghost-%COMP%]   menu[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:before{box-shadow:0 0 25px var(--ui-menu-theme),inset 0 0 25px var(--ui-menu-theme)}}@media (prefers-reduced-motion){[_nghost-%COMP%]   menu[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{will-change:transform;transition:transform .2s ease,background-color .5s ease}}@keyframes _ngcontent-%COMP%_rotate-y{50%{transform:rotateY(15deg) rotateX(-6deg)}}'],changeDetection:0}),t})();const zf=ac(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function uu(n,e){const t=wt(n)?n:()=>n,i=r=>r.error(t());return new Ht(e?r=>e.schedule(i,0,r):i)}function Iy(){return on((n,e)=>{let t=null;n._refCount++;const i=Kt(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount)return void(t=null);const r=n._connection,s=t;t=null,r&&(!s||r===s)&&r.unsubscribe(),e.unsubscribe()});n.subscribe(i),i.closed||(t=n.connect())})}class wR extends Ht{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,Aw(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new Bn;const t=this.getSubject();e.add(this.source.subscribe(Kt(t,void 0,()=>{this._teardown(),t.complete()},i=>{this._teardown(),t.error(i)},()=>this._teardown()))),e.closed&&(this._connection=null,e=Bn.EMPTY)}return e}refCount(){return Iy()(this)}}function Gf(n){return on((e,t)=>{let i=!1;e.subscribe(Kt(t,r=>{i=!0,t.next(r)},()=>{i||t.next(n),t.complete()}))})}function xR(n=Dj){return on((e,t)=>{let i=!1;e.subscribe(Kt(t,r=>{i=!0,t.next(r)},()=>i?t.complete():t.error(n())))})}function Dj(){return new zf}function go(n,e){const t=arguments.length>=2;return i=>i.pipe(n?nr((r,s)=>n(r,s,i)):xs,Rr(1),t?Gf(e):xR(()=>new zf))}function du(n,e){return wt(e)?Tn(n,e,1):Tn(n,1)}function ei(n,e,t){const i=wt(n)||e||t?{next:n,error:e,complete:t}:n;return i?on((r,s)=>{var o;null===(o=i.subscribe)||void 0===o||o.call(i);let a=!0;r.subscribe(Kt(s,l=>{var c;null===(c=i.next)||void 0===c||c.call(i,l),s.next(l)},()=>{var l;a=!1,null===(l=i.complete)||void 0===l||l.call(i),s.complete()},l=>{var c;a=!1,null===(c=i.error)||void 0===c||c.call(i,l),s.error(l)},()=>{var l,c;a&&(null===(l=i.unsubscribe)||void 0===l||l.call(i)),null===(c=i.finalize)||void 0===c||c.call(i)}))}):xs}function _o(n){return on((e,t)=>{let s,i=null,r=!1;i=e.subscribe(Kt(t,void 0,void 0,o=>{s=oi(n(o,_o(n)(e))),i?(i.unsubscribe(),i=null,s.subscribe(t)):r=!0})),r&&(i.unsubscribe(),i=null,s.subscribe(t))})}function Py(n){return n<=0?()=>pr:on((e,t)=>{let i=[];e.subscribe(Kt(t,r=>{i.push(r),n<i.length&&i.shift()},()=>{for(const r of i)t.next(r);t.complete()},void 0,()=>{i=null}))})}function Ly(n){return on((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}const at="primary",hu=Symbol("RouteTitle");class Oj{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function Ka(n){return new Oj(n)}function Nj(n,e,t){const i=t.path.split("/");if(i.length>n.length||"full"===t.pathMatch&&(e.hasChildren()||i.length<n.length))return null;const r={};for(let s=0;s<i.length;s++){const o=i[s],a=n[s];if(o.startsWith(":"))r[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:n.slice(0,i.length),posParams:r}}function Pr(n,e){const t=n?Object.keys(n):void 0,i=e?Object.keys(e):void 0;if(!t||!i||t.length!=i.length)return!1;let r;for(let s=0;s<t.length;s++)if(r=t[s],!SR(n[r],e[r]))return!1;return!0}function SR(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;const t=[...n].sort(),i=[...e].sort();return t.every((r,s)=>i[s]===r)}return n===e}function MR(n){return n.length>0?n[n.length-1]:null}function Ps(n){return function Tj(n){return!!n&&(n instanceof Ht||wt(n.lift)&&wt(n.subscribe))}(n)?n:Xh(n)?Nn(Promise.resolve(n)):$e(n)}const kj={exact:function CR(n,e,t){if(!vo(n.segments,e.segments)||!Wf(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(const i in e.children)if(!n.children[i]||!CR(n.children[i],e.children[i],t))return!1;return!0},subset:TR},ER={exact:function Uj(n,e){return Pr(n,e)},subset:function Bj(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>SR(n[t],e[t]))},ignored:()=>!0};function AR(n,e,t){return kj[t.paths](n.root,e.root,t.matrixParams)&&ER[t.queryParams](n.queryParams,e.queryParams)&&!("exact"===t.fragment&&n.fragment!==e.fragment)}function TR(n,e,t){return DR(n,e,e.segments,t)}function DR(n,e,t,i){if(n.segments.length>t.length){const r=n.segments.slice(0,t.length);return!(!vo(r,t)||e.hasChildren()||!Wf(r,t,i))}if(n.segments.length===t.length){if(!vo(n.segments,t)||!Wf(n.segments,t,i))return!1;for(const r in e.children)if(!n.children[r]||!TR(n.children[r],e.children[r],i))return!1;return!0}{const r=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!!(vo(n.segments,r)&&Wf(n.segments,r,i)&&n.children[at])&&DR(n.children[at],e,s,i)}}function Wf(n,e,t){return e.every((i,r)=>ER[t](n[r].parameters,i.parameters))}class Ja{constructor(e=new Lt([],{}),t={},i=null){this.root=e,this.queryParams=t,this.fragment=i}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Ka(this.queryParams)),this._queryParamMap}toString(){return zj.serialize(this)}}class Lt{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Object.values(t).forEach(i=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return jf(this)}}class fu{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=Ka(this.parameters)),this._parameterMap}toString(){return PR(this)}}function vo(n,e){return n.length===e.length&&n.every((t,i)=>t.path===e[i].path)}let pu=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ee({token:n,factory:function(){return new Oy},providedIn:"root"}),n})();class Oy{parse(e){const t=new Qj(e);return new Ja(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){const t=`/${mu(e.root,!0)}`,i=function jj(n){const e=Object.keys(n).map(t=>{const i=n[t];return Array.isArray(i)?i.map(r=>`${$f(t)}=${$f(r)}`).join("&"):`${$f(t)}=${$f(i)}`}).filter(t=>!!t);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${t}${i}${"string"==typeof e.fragment?`#${function Gj(n){return encodeURI(n)}(e.fragment)}`:""}`}}const zj=new Oy;function jf(n){return n.segments.map(e=>PR(e)).join("/")}function mu(n,e){if(!n.hasChildren())return jf(n);if(e){const t=n.children[at]?mu(n.children[at],!1):"",i=[];return Object.entries(n.children).forEach(([r,s])=>{r!==at&&i.push(`${r}:${mu(s,!1)}`)}),i.length>0?`${t}(${i.join("//")})`:t}{const t=function Hj(n,e){let t=[];return Object.entries(n.children).forEach(([i,r])=>{i===at&&(t=t.concat(e(r,i)))}),Object.entries(n.children).forEach(([i,r])=>{i!==at&&(t=t.concat(e(r,i)))}),t}(n,(i,r)=>r===at?[mu(n.children[at],!1)]:[`${r}:${mu(i,!1)}`]);return 1===Object.keys(n.children).length&&null!=n.children[at]?`${jf(n)}/${t[0]}`:`${jf(n)}/(${t.join("//")})`}}function RR(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function $f(n){return RR(n).replace(/%3B/gi,";")}function Ny(n){return RR(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Xf(n){return decodeURIComponent(n)}function IR(n){return Xf(n.replace(/\+/g,"%20"))}function PR(n){return`${Ny(n.path)}${function Wj(n){return Object.keys(n).map(e=>`;${Ny(e)}=${Ny(n[e])}`).join("")}(n.parameters)}`}const $j=/^[^\/()?;#]+/;function Fy(n){const e=n.match($j);return e?e[0]:""}const Xj=/^[^\/()?;=#]+/,Yj=/^[^=?&#]+/,Kj=/^[^&#]+/;class Qj{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Lt([],{}):new Lt([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(i[at]=new Lt(e,t)),i}parseSegment(){const e=Fy(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new he(4009,!1);return this.capture(e),new fu(Xf(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=function qj(n){const e=n.match(Xj);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const r=Fy(this.remaining);r&&(i=r,this.capture(i))}e[Xf(t)]=Xf(i)}parseQueryParam(e){const t=function Zj(n){const e=n.match(Yj);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const o=function Jj(n){const e=n.match(Kj);return e?e[0]:""}(this.remaining);o&&(i=o,this.capture(i))}const r=IR(t),s=IR(i);if(e.hasOwnProperty(r)){let o=e[r];Array.isArray(o)||(o=[o],e[r]=o),o.push(s)}else e[r]=s}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const i=Fy(this.remaining),r=this.remaining[i.length];if("/"!==r&&")"!==r&&";"!==r)throw new he(4010,!1);let s;i.indexOf(":")>-1?(s=i.slice(0,i.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=at);const o=this.parseChildren();t[s]=1===Object.keys(o).length?o[at]:new Lt([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new he(4011,!1)}}function LR(n){return n.segments.length>0?new Lt([],{[at]:n}):n}function OR(n){const e={};for(const i of Object.keys(n.children)){const s=OR(n.children[i]);if(i===at&&0===s.segments.length&&s.hasChildren())for(const[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[i]=s)}return function e8(n){if(1===n.numberOfChildren&&n.children[at]){const e=n.children[at];return new Lt(n.segments.concat(e.segments),e.children)}return n}(new Lt(n.segments,e))}function yo(n){return n instanceof Ja}function NR(n){let e;const r=LR(function t(s){const o={};for(const l of s.children){const c=t(l);o[l.outlet]=c}const a=new Lt(s.url,o);return s===n&&(e=a),a}(n.root));return e??r}function FR(n,e,t,i){let r=n;for(;r.parent;)r=r.parent;if(0===e.length)return ky(r,r,r,t,i);const s=function n8(n){if("string"==typeof n[0]&&1===n.length&&"/"===n[0])return new UR(!0,0,n);let e=0,t=!1;const i=n.reduce((r,s,o)=>{if("object"==typeof s&&null!=s){if(s.outlets){const a={};return Object.entries(s.outlets).forEach(([l,c])=>{a[l]="string"==typeof c?c.split("/"):c}),[...r,{outlets:a}]}if(s.segmentPath)return[...r,s.segmentPath]}return"string"!=typeof s?[...r,s]:0===o?(s.split("/").forEach((a,l)=>{0==l&&"."===a||(0==l&&""===a?t=!0:".."===a?e++:""!=a&&r.push(a))}),r):[...r,s]},[]);return new UR(t,e,i)}(e);if(s.toRoot())return ky(r,r,new Lt([],{}),t,i);const o=function i8(n,e,t){if(n.isAbsolute)return new Yf(e,!0,0);if(!t)return new Yf(e,!1,NaN);if(null===t.parent)return new Yf(t,!0,0);const i=qf(n.commands[0])?0:1;return function r8(n,e,t){let i=n,r=e,s=t;for(;s>r;){if(s-=r,i=i.parent,!i)throw new he(4005,!1);r=i.segments.length}return new Yf(i,!1,r-s)}(t,t.segments.length-1+i,n.numberOfDoubleDots)}(s,r,n),a=o.processChildren?_u(o.segmentGroup,o.index,s.commands):BR(o.segmentGroup,o.index,s.commands);return ky(r,o.segmentGroup,a,t,i)}function qf(n){return"object"==typeof n&&null!=n&&!n.outlets&&!n.segmentPath}function gu(n){return"object"==typeof n&&null!=n&&n.outlets}function ky(n,e,t,i,r){let o,s={};i&&Object.entries(i).forEach(([l,c])=>{s[l]=Array.isArray(c)?c.map(u=>`${u}`):`${c}`}),o=n===e?t:kR(n,e,t);const a=LR(OR(o));return new Ja(a,s,r)}function kR(n,e,t){const i={};return Object.entries(n.children).forEach(([r,s])=>{i[r]=s===e?t:kR(s,e,t)}),new Lt(n.segments,i)}class UR{constructor(e,t,i){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=i,e&&i.length>0&&qf(i[0]))throw new he(4003,!1);const r=i.find(gu);if(r&&r!==MR(i))throw new he(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class Yf{constructor(e,t,i){this.segmentGroup=e,this.processChildren=t,this.index=i}}function BR(n,e,t){if(n||(n=new Lt([],{})),0===n.segments.length&&n.hasChildren())return _u(n,e,t);const i=function o8(n,e,t){let i=0,r=e;const s={match:!1,pathIndex:0,commandIndex:0};for(;r<n.segments.length;){if(i>=t.length)return s;const o=n.segments[r],a=t[i];if(gu(a))break;const l=`${a}`,c=i<t.length-1?t[i+1]:null;if(r>0&&void 0===l)break;if(l&&c&&"object"==typeof c&&void 0===c.outlets){if(!HR(l,c,o))return s;i+=2}else{if(!HR(l,{},o))return s;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}(n,e,t),r=t.slice(i.commandIndex);if(i.match&&i.pathIndex<n.segments.length){const s=new Lt(n.segments.slice(0,i.pathIndex),{});return s.children[at]=new Lt(n.segments.slice(i.pathIndex),n.children),_u(s,0,r)}return i.match&&0===r.length?new Lt(n.segments,{}):i.match&&!n.hasChildren()?Uy(n,e,t):i.match?_u(n,0,r):Uy(n,e,t)}function _u(n,e,t){if(0===t.length)return new Lt(n.segments,{});{const i=function s8(n){return gu(n[0])?n[0].outlets:{[at]:n}}(t),r={};if(!i[at]&&n.children[at]&&1===n.numberOfChildren&&0===n.children[at].segments.length){const s=_u(n.children[at],e,t);return new Lt(n.segments,s.children)}return Object.entries(i).forEach(([s,o])=>{"string"==typeof o&&(o=[o]),null!==o&&(r[s]=BR(n.children[s],e,o))}),Object.entries(n.children).forEach(([s,o])=>{void 0===i[s]&&(r[s]=o)}),new Lt(n.segments,r)}}function Uy(n,e,t){const i=n.segments.slice(0,e);let r=0;for(;r<t.length;){const s=t[r];if(gu(s)){const l=a8(s.outlets);return new Lt(i,l)}if(0===r&&qf(t[0])){i.push(new fu(n.segments[e].path,VR(t[0]))),r++;continue}const o=gu(s)?s.outlets[at]:`${s}`,a=r<t.length-1?t[r+1]:null;o&&a&&qf(a)?(i.push(new fu(o,VR(a))),r+=2):(i.push(new fu(o,{})),r++)}return new Lt(i,{})}function a8(n){const e={};return Object.entries(n).forEach(([t,i])=>{"string"==typeof i&&(i=[i]),null!==i&&(e[t]=Uy(new Lt([],{}),0,i))}),e}function VR(n){const e={};return Object.entries(n).forEach(([t,i])=>e[t]=`${i}`),e}function HR(n,e,t){return n==t.path&&Pr(e,t.parameters)}const vu="imperative";class Lr{constructor(e,t){this.id=e,this.url=t}}class By extends Lr{constructor(e,t,i="imperative",r=null){super(e,t),this.type=0,this.navigationTrigger=i,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class bo extends Lr{constructor(e,t,i){super(e,t),this.urlAfterRedirects=i,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class Zf extends Lr{constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class yu extends Lr{constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r,this.type=16}}class Vy extends Lr{constructor(e,t,i,r){super(e,t),this.error=i,this.target=r,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class l8 extends Lr{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class c8 extends Lr{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class u8 extends Lr{constructor(e,t,i,r,s){super(e,t),this.urlAfterRedirects=i,this.state=r,this.shouldActivate=s,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class d8 extends Lr{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class h8 extends Lr{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class f8{constructor(e){this.route=e,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class p8{constructor(e){this.route=e,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class m8{constructor(e){this.snapshot=e,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class g8{constructor(e){this.snapshot=e,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class _8{constructor(e){this.snapshot=e,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class v8{constructor(e){this.snapshot=e,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class zR{constructor(e,t,i){this.routerEvent=e,this.position=t,this.anchor=i,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class y8{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new bu,this.attachRef=null}}let bu=(()=>{class n{constructor(){this.contexts=new Map}onChildOutletCreated(t,i){const r=this.getOrCreateContext(t);r.outlet=i,this.contexts.set(t,r)}onChildOutletDestroyed(t){const i=this.getContext(t);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let i=this.getContext(t);return i||(i=new y8,this.contexts.set(t,i)),i}getContext(t){return this.contexts.get(t)||null}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ee({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class GR{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=Hy(e,this._root);return t?t.children.map(i=>i.value):[]}firstChild(e){const t=Hy(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=zy(e,this._root);return t.length<2?[]:t[t.length-2].children.map(r=>r.value).filter(r=>r!==e)}pathFromRoot(e){return zy(e,this._root).map(t=>t.value)}}function Hy(n,e){if(n===e.value)return e;for(const t of e.children){const i=Hy(n,t);if(i)return i}return null}function zy(n,e){if(n===e.value)return[e];for(const t of e.children){const i=zy(n,t);if(i.length)return i.unshift(e),i}return[]}class is{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function Qa(n){const e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}class WR extends GR{constructor(e,t){super(e),this.snapshot=t,Gy(this,e)}toString(){return this.snapshot.toString()}}function jR(n,e){const t=function b8(n,e){const o=new Kf([],{},{},"",{},at,e,null,{});return new XR("",new is(o,[]))}(0,e),i=new si([new fu("",{})]),r=new si({}),s=new si({}),o=new si({}),a=new si(""),l=new el(i,r,o,a,s,at,e,t.root);return l.snapshot=t.root,new WR(new is(l,[]),t)}class el{constructor(e,t,i,r,s,o,a,l){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=i,this.fragmentSubject=r,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=l,this.title=this.dataSubject?.pipe(Ot(c=>c[hu]))??$e(void 0),this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(Ot(e=>Ka(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(Ot(e=>Ka(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function $R(n,e="emptyOnly"){const t=n.pathFromRoot;let i=0;if("always"!==e)for(i=t.length-1;i>=1;){const r=t[i],s=t[i-1];if(r.routeConfig&&""===r.routeConfig.path)i--;else{if(s.component)break;i--}}return function w8(n){return n.reduce((e,t)=>({params:{...e.params,...t.params},data:{...e.data,...t.data},resolve:{...t.data,...e.resolve,...t.routeConfig?.data,...t._resolvedData}}),{params:{},data:{},resolve:{}})}(t.slice(i))}class Kf{get title(){return this.data?.[hu]}constructor(e,t,i,r,s,o,a,l,c){this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=s,this.outlet=o,this.component=a,this.routeConfig=l,this._resolve=c}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=Ka(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Ka(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(i=>i.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class XR extends GR{constructor(e,t){super(t),this.url=e,Gy(this,t)}toString(){return qR(this._root)}}function Gy(n,e){e.value._routerState=n,e.children.forEach(t=>Gy(n,t))}function qR(n){const e=n.children.length>0?` { ${n.children.map(qR).join(", ")} } `:"";return`${n.value}${e}`}function Wy(n){if(n.snapshot){const e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,Pr(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),Pr(e.params,t.params)||n.paramsSubject.next(t.params),function Fj(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!Pr(n[t],e[t]))return!1;return!0}(e.url,t.url)||n.urlSubject.next(t.url),Pr(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function jy(n,e){const t=Pr(n.params,e.params)&&function Vj(n,e){return vo(n,e)&&n.every((t,i)=>Pr(t.parameters,e[i].parameters))}(n.url,e.url);return t&&!(!n.parent!=!e.parent)&&(!n.parent||jy(n.parent,e.parent))}let $y=(()=>{class n{constructor(){this.activated=null,this._activatedRoute=null,this.name=at,this.activateEvents=new kn,this.deactivateEvents=new kn,this.attachEvents=new kn,this.detachEvents=new kn,this.parentContexts=_e(bu),this.location=_e(Vi),this.changeDetector=_e(Mv),this.environmentInjector=_e(Kr),this.inputBinder=_e(Jf,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(t){if(t.name){const{firstChange:i,previousValue:r}=t.name;if(i)return;this.isTrackedInParentContexts(r)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(r)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new he(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new he(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new he(4012,!1);this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,i){this.activated=t,this._activatedRoute=i,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,i){if(this.isActivated)throw new he(4013,!1);this._activatedRoute=t;const r=this.location,o=t.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,l=new x8(t,a,r.injector);this.activated=r.createComponent(o,{index:r.length,injector:l,environmentInjector:i??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=Vn({type:n,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Js]}),n})();class x8{constructor(e,t,i){this.route=e,this.childContexts=t,this.parent=i}get(e,t){return e===el?this.route:e===bu?this.childContexts:this.parent.get(e,t)}}const Jf=new Ce("");let YR=(()=>{class n{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(t){this.unsubscribeFromRouteData(t),this.subscribeToRouteData(t)}unsubscribeFromRouteData(t){this.outletDataSubscriptions.get(t)?.unsubscribe(),this.outletDataSubscriptions.delete(t)}subscribeToRouteData(t){const{activatedRoute:i}=t,r=Df([i.queryParams,i.params,i.data]).pipe(mr(([s,o,a],l)=>(a={...s,...o,...a},0===l?$e(a):Promise.resolve(a)))).subscribe(s=>{if(!t.isActivated||!t.activatedComponentRef||t.activatedRoute!==i||null===i.component)return void this.unsubscribeFromRouteData(t);const o=function Gz(n){const e=Rt(n);if(!e)return null;const t=new zc(e);return{get selector(){return t.selector},get type(){return t.componentType},get inputs(){return t.inputs},get outputs(){return t.outputs},get ngContentSelectors(){return t.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}(i.component);if(o)for(const{templateName:a}of o.inputs)t.activatedComponentRef.setInput(a,s[a]);else this.unsubscribeFromRouteData(t)});this.outletDataSubscriptions.set(t,r)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ee({token:n,factory:n.\u0275fac}),n})();function wu(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){const i=t.value;i._futureSnapshot=e.value;const r=function M8(n,e,t){return e.children.map(i=>{for(const r of t.children)if(n.shouldReuseRoute(i.value,r.value.snapshot))return wu(n,i,r);return wu(n,i)})}(n,e,t);return new is(i,r)}{if(n.shouldAttach(e.value)){const s=n.retrieve(e.value);if(null!==s){const o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>wu(n,a)),o}}const i=function E8(n){return new el(new si(n.url),new si(n.params),new si(n.queryParams),new si(n.fragment),new si(n.data),n.outlet,n.component,n)}(e.value),r=e.children.map(s=>wu(n,s));return new is(i,r)}}const Xy="ngNavigationCancelingError";function ZR(n,e){const{redirectTo:t,navigationBehaviorOptions:i}=yo(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,r=KR(!1,0,e);return r.url=t,r.navigationBehaviorOptions=i,r}function KR(n,e,t){const i=new Error("NavigationCancelingError: "+(n||""));return i[Xy]=!0,i.cancellationCode=e,t&&(i.url=t),i}function JR(n){return QR(n)&&yo(n.url)}function QR(n){return n&&n[Xy]}let eI=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=qs({type:n,selectors:[["ng-component"]],standalone:!0,features:[Z_],decls:1,vars:0,template:function(t,i){1&t&&Wh(0,"router-outlet")},dependencies:[$y],encapsulation:2}),n})();function qy(n){const e=n.children&&n.children.map(qy),t=e?{...n,children:e}:{...n};return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==at&&(t.component=eI),t}function ir(n){return n.outlet||at}function xu(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){const t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}class P8{constructor(e,t,i,r,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=i,this.forwardEvent=r,this.inputBindingEnabled=s}activate(e){const t=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,i,e),Wy(this.futureState.root),this.activateChildRoutes(t,i,e)}deactivateChildRoutes(e,t,i){const r=Qa(t);e.children.forEach(s=>{const o=s.value.outlet;this.deactivateRoutes(s,r[o],i),delete r[o]}),Object.values(r).forEach(s=>{this.deactivateRouteAndItsChildren(s,i)})}deactivateRoutes(e,t,i){const r=e.value,s=t?t.value:null;if(r===s)if(r.component){const o=i.getContext(r.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,i);else s&&this.deactivateRouteAndItsChildren(t,i)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,s=Qa(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],r);if(i&&i.outlet){const o=i.outlet.detach(),a=i.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){const i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,s=Qa(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],r);i&&(i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated()),i.attachRef=null,i.route=null)}activateChildRoutes(e,t,i){const r=Qa(t);e.children.forEach(s=>{this.activateRoutes(s,r[s.value.outlet],i),this.forwardEvent(new v8(s.value.snapshot))}),e.children.length&&this.forwardEvent(new g8(e.value.snapshot))}activateRoutes(e,t,i){const r=e.value,s=t?t.value:null;if(Wy(r),r===s)if(r.component){const o=i.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,i);else if(r.component){const o=i.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const a=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),Wy(a.route.value),this.activateChildRoutes(e,null,o.children)}else{const a=xu(r.snapshot);o.attachRef=null,o.route=r,o.injector=a,o.outlet&&o.outlet.activateWith(r,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,i)}}class tI{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class Qf{constructor(e,t){this.component=e,this.route=t}}function L8(n,e,t){const i=n._root;return Su(i,e?e._root:null,t,[i.value])}function tl(n,e){const t=Symbol(),i=e.get(n,t);return i===t?"function"!=typeof n||function TN(n){return null!==Rd(n)}(n)?e.get(n):n:i}function Su(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=Qa(e);return n.children.forEach(o=>{(function N8(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=n.value,o=e?e.value:null,a=t?t.getContext(n.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){const l=function F8(n,e,t){if("function"==typeof t)return t(n,e);switch(t){case"pathParamsChange":return!vo(n.url,e.url);case"pathParamsOrQueryParamsChange":return!vo(n.url,e.url)||!Pr(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!jy(n,e)||!Pr(n.queryParams,e.queryParams);default:return!jy(n,e)}}(o,s,s.routeConfig.runGuardsAndResolvers);l?r.canActivateChecks.push(new tI(i)):(s.data=o.data,s._resolvedData=o._resolvedData),Su(n,e,s.component?a?a.children:null:t,i,r),l&&a&&a.outlet&&a.outlet.isActivated&&r.canDeactivateChecks.push(new Qf(a.outlet.component,o))}else o&&Mu(e,a,r),r.canActivateChecks.push(new tI(i)),Su(n,null,s.component?a?a.children:null:t,i,r)})(o,s[o.value.outlet],t,i.concat([o.value]),r),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>Mu(a,t.getContext(o),r)),r}function Mu(n,e,t){const i=Qa(n),r=n.value;Object.entries(i).forEach(([s,o])=>{Mu(o,r.component?e?e.children.getContext(s):null:e,t)}),t.canDeactivateChecks.push(new Qf(r.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,r))}function Eu(n){return"function"==typeof n}function nI(n){return n instanceof zf||"EmptyError"===n?.name}const ep=Symbol("INITIAL_VALUE");function nl(){return mr(n=>Df(n.map(e=>e.pipe(Rr(1),dy(ep)))).pipe(Ot(e=>{for(const t of e)if(!0!==t){if(t===ep)return ep;if(!1===t||t instanceof Ja)return t}return!0}),nr(e=>e!==ep),Rr(1)))}function iI(n){return function PO(...n){return Sw(n)}(ei(e=>{if(yo(e))throw ZR(0,e)}),Ot(e=>!0===e))}class tp{constructor(e){this.segmentGroup=e||null}}class rI{constructor(e){this.urlTree=e}}function il(n){return uu(new tp(n))}function sI(n){return uu(new rI(n))}class n${constructor(e,t){this.urlSerializer=e,this.urlTree=t}noMatchError(e){return new he(4002,!1)}lineralizeSegments(e,t){let i=[],r=t.root;for(;;){if(i=i.concat(r.segments),0===r.numberOfChildren)return $e(i);if(r.numberOfChildren>1||!r.children[at])return uu(new he(4e3,!1));r=r.children[at]}}applyRedirectCommands(e,t,i){return this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,i)}applyRedirectCreateUrlTree(e,t,i,r){const s=this.createSegmentGroup(e,t.root,i,r);return new Ja(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const i={};return Object.entries(e).forEach(([r,s])=>{if("string"==typeof s&&s.startsWith(":")){const a=s.substring(1);i[r]=t[a]}else i[r]=s}),i}createSegmentGroup(e,t,i,r){const s=this.createSegments(e,t.segments,i,r);let o={};return Object.entries(t.children).forEach(([a,l])=>{o[a]=this.createSegmentGroup(e,l,i,r)}),new Lt(s,o)}createSegments(e,t,i,r){return t.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,r):this.findOrReturn(s,i))}findPosParam(e,t,i){const r=i[t.path.substring(1)];if(!r)throw new he(4001,!1);return r}findOrReturn(e,t){let i=0;for(const r of t){if(r.path===e.path)return t.splice(i),r;i++}return e}}const Yy={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function i$(n,e,t,i,r){const s=Zy(n,e,t);return s.matched?(i=function A8(n,e){return n.providers&&!n._injector&&(n._injector=Y_(n.providers,e,`Route: ${n.path}`)),n._injector??e}(e,i),function Q8(n,e,t,i){const r=e.canMatch;return r&&0!==r.length?$e(r.map(o=>{const a=tl(o,n);return Ps(function z8(n){return n&&Eu(n.canMatch)}(a)?a.canMatch(e,t):n.runInContext(()=>a(e,t)))})).pipe(nl(),iI()):$e(!0)}(i,e,t).pipe(Ot(o=>!0===o?s:{...Yy}))):$e(s)}function Zy(n,e,t){if(""===e.path)return"full"===e.pathMatch&&(n.hasChildren()||t.length>0)?{...Yy}:{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};const r=(e.matcher||Nj)(t,n,e);if(!r)return{...Yy};const s={};Object.entries(r.posParams??{}).forEach(([a,l])=>{s[a]=l.path});const o=r.consumed.length>0?{...s,...r.consumed[r.consumed.length-1].parameters}:s;return{matched:!0,consumedSegments:r.consumed,remainingSegments:t.slice(r.consumed.length),parameters:o,positionalParamSegments:r.posParams??{}}}function oI(n,e,t,i){return t.length>0&&function o$(n,e,t){return t.some(i=>np(n,e,i)&&ir(i)!==at)}(n,t,i)?{segmentGroup:new Lt(e,s$(i,new Lt(t,n.children))),slicedSegments:[]}:0===t.length&&function a$(n,e,t){return t.some(i=>np(n,e,i))}(n,t,i)?{segmentGroup:new Lt(n.segments,r$(n,0,t,i,n.children)),slicedSegments:t}:{segmentGroup:new Lt(n.segments,n.children),slicedSegments:t}}function r$(n,e,t,i,r){const s={};for(const o of i)if(np(n,t,o)&&!r[ir(o)]){const a=new Lt([],{});s[ir(o)]=a}return{...r,...s}}function s$(n,e){const t={};t[at]=e;for(const i of n)if(""===i.path&&ir(i)!==at){const r=new Lt([],{});t[ir(i)]=r}return t}function np(n,e,t){return(!(n.hasChildren()||e.length>0)||"full"!==t.pathMatch)&&""===t.path}class d${constructor(e,t,i,r,s,o,a){this.injector=e,this.configLoader=t,this.rootComponentType=i,this.config=r,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.allowRedirects=!0,this.applyRedirects=new n$(this.urlSerializer,this.urlTree)}noMatchError(e){return new he(4002,!1)}recognize(){const e=oI(this.urlTree.root,[],[],this.config).segmentGroup;return this.processSegmentGroup(this.injector,this.config,e,at).pipe(_o(t=>{if(t instanceof rI)return this.allowRedirects=!1,this.urlTree=t.urlTree,this.match(t.urlTree);throw t instanceof tp?this.noMatchError(t):t}),Ot(t=>{const i=new Kf([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},at,this.rootComponentType,null,{}),r=new is(i,t),s=new XR("",r),o=function t8(n,e,t=null,i=null){return FR(NR(n),e,t,i)}(i,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),this.inheritParamsAndData(s._root),{state:s,tree:o}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e.root,at).pipe(_o(i=>{throw i instanceof tp?this.noMatchError(i):i}))}inheritParamsAndData(e){const t=e.value,i=$R(t,this.paramsInheritanceStrategy);t.params=Object.freeze(i.params),t.data=Object.freeze(i.data),e.children.forEach(r=>this.inheritParamsAndData(r))}processSegmentGroup(e,t,i,r){return 0===i.segments.length&&i.hasChildren()?this.processChildren(e,t,i):this.processSegment(e,t,i,i.segments,r,!0)}processChildren(e,t,i){const r=[];for(const s of Object.keys(i.children))"primary"===s?r.unshift(s):r.push(s);return Nn(r).pipe(du(s=>{const o=i.children[s],a=function R8(n,e){const t=n.filter(i=>ir(i)===e);return t.push(...n.filter(i=>ir(i)!==e)),t}(t,s);return this.processSegmentGroup(e,a,o,s)}),function Ij(n,e){return on(function Rj(n,e,t,i,r){return(s,o)=>{let a=t,l=e,c=0;s.subscribe(Kt(o,u=>{const d=c++;l=a?n(l,u,d):(a=!0,u),i&&o.next(l)},r&&(()=>{a&&o.next(l),o.complete()})))}}(n,e,arguments.length>=2,!0))}((s,o)=>(s.push(...o),s)),Gf(null),function Pj(n,e){const t=arguments.length>=2;return i=>i.pipe(n?nr((r,s)=>n(r,s,i)):xs,Py(1),t?Gf(e):xR(()=>new zf))}(),Tn(s=>{if(null===s)return il(i);const o=aI(s);return function h$(n){n.sort((e,t)=>e.value.outlet===at?-1:t.value.outlet===at?1:e.value.outlet.localeCompare(t.value.outlet))}(o),$e(o)}))}processSegment(e,t,i,r,s,o){return Nn(t).pipe(du(a=>this.processSegmentAgainstRoute(a._injector??e,t,a,i,r,s,o).pipe(_o(l=>{if(l instanceof tp)return $e(null);throw l}))),go(a=>!!a),_o(a=>{if(nI(a))return function c$(n,e,t){return 0===e.length&&!n.children[t]}(i,r,s)?$e([]):il(i);throw a}))}processSegmentAgainstRoute(e,t,i,r,s,o,a){return function l$(n,e,t,i){return!!(ir(n)===i||i!==at&&np(e,t,n))&&("**"===n.path||Zy(e,n,t).matched)}(i,r,s,o)?void 0===i.redirectTo?this.matchSegmentAgainstRoute(e,r,i,s,o,a):a&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,r,t,i,s,o):il(r):il(r)}expandSegmentAgainstRouteUsingRedirect(e,t,i,r,s,o){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,i,r,o):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,i,r,s,o)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,t,i,r){const s=this.applyRedirects.applyRedirectCommands([],i.redirectTo,{});return i.redirectTo.startsWith("/")?sI(s):this.applyRedirects.lineralizeSegments(i,s).pipe(Tn(o=>{const a=new Lt(o,{});return this.processSegment(e,t,a,o,r,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,t,i,r,s,o){const{matched:a,consumedSegments:l,remainingSegments:c,positionalParamSegments:u}=Zy(t,r,s);if(!a)return il(t);const d=this.applyRedirects.applyRedirectCommands(l,r.redirectTo,u);return r.redirectTo.startsWith("/")?sI(d):this.applyRedirects.lineralizeSegments(r,d).pipe(Tn(h=>this.processSegment(e,i,t,h.concat(c),o,!1)))}matchSegmentAgainstRoute(e,t,i,r,s,o){let a;if("**"===i.path){const l=r.length>0?MR(r).parameters:{};a=$e({snapshot:new Kf(r,l,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,lI(i),ir(i),i.component??i._loadedComponent??null,i,cI(i)),consumedSegments:[],remainingSegments:[]}),t.children={}}else a=i$(t,i,r,e).pipe(Ot(({matched:l,consumedSegments:c,remainingSegments:u,parameters:d})=>l?{snapshot:new Kf(c,d,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,lI(i),ir(i),i.component??i._loadedComponent??null,i,cI(i)),consumedSegments:c,remainingSegments:u}:null));return a.pipe(mr(l=>null===l?il(t):this.getChildConfig(e=i._injector??e,i,r).pipe(mr(({routes:c})=>{const u=i._loadedInjector??e,{snapshot:d,consumedSegments:h,remainingSegments:f}=l,{segmentGroup:p,slicedSegments:_}=oI(t,h,f,c);if(0===_.length&&p.hasChildren())return this.processChildren(u,c,p).pipe(Ot(m=>null===m?null:[new is(d,m)]));if(0===c.length&&0===_.length)return $e([new is(d,[])]);const g=ir(i)===s;return this.processSegment(u,c,p,_,g?at:s,!0).pipe(Ot(m=>[new is(d,m)]))}))))}getChildConfig(e,t,i){return t.children?$e({routes:t.children,injector:e}):t.loadChildren?void 0!==t._loadedRoutes?$e({routes:t._loadedRoutes,injector:t._loadedInjector}):function J8(n,e,t,i){const r=e.canLoad;return void 0===r||0===r.length?$e(!0):$e(r.map(o=>{const a=tl(o,n);return Ps(function U8(n){return n&&Eu(n.canLoad)}(a)?a.canLoad(e,t):n.runInContext(()=>a(e,t)))})).pipe(nl(),iI())}(e,t,i).pipe(Tn(r=>r?this.configLoader.loadChildren(e,t).pipe(ei(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):function t$(n){return uu(KR(!1,3))}())):$e({routes:[],injector:e})}}function f$(n){const e=n.value.routeConfig;return e&&""===e.path}function aI(n){const e=[],t=new Set;for(const i of n){if(!f$(i)){e.push(i);continue}const r=e.find(s=>i.value.routeConfig===s.value.routeConfig);void 0!==r?(r.children.push(...i.children),t.add(r)):e.push(i)}for(const i of t){const r=aI(i.children);e.push(new is(i.value,r))}return e.filter(i=>!t.has(i))}function lI(n){return n.data||{}}function cI(n){return n.resolve||{}}function uI(n){return"string"==typeof n.title||null===n.title}function Ky(n){return mr(e=>{const t=n(e);return t?Nn(t).pipe(Ot(()=>e)):$e(e)})}const rl=new Ce("ROUTES");let Jy=(()=>{class n{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=_e(nT)}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return $e(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);const i=Ps(t.loadComponent()).pipe(Ot(dI),ei(s=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=s}),Ly(()=>{this.componentLoaders.delete(t)})),r=new wR(i,()=>new zt).pipe(Iy());return this.componentLoaders.set(t,r),r}loadChildren(t,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return $e({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);const s=this.loadModuleFactoryOrRoutes(i.loadChildren).pipe(Ot(a=>{this.onLoadEndListener&&this.onLoadEndListener(i);let l,c;return Array.isArray(a)?c=a:(l=a.create(t).injector,c=l.get(rl,[],Ge.Self|Ge.Optional).flat()),{routes:c.map(qy),injector:l}}),Ly(()=>{this.childrenLoaders.delete(i)})),o=new wR(s,()=>new zt).pipe(Iy());return this.childrenLoaders.set(i,o),o}loadModuleFactoryOrRoutes(t){return Ps(t()).pipe(Ot(dI),Tn(i=>i instanceof lC||Array.isArray(i)?$e(i):Nn(this.compiler.compileModuleAsync(i))))}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ee({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function dI(n){return function b$(n){return n&&"object"==typeof n&&"default"in n}(n)?n.default:n}let ip=(()=>{class n{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.lastSuccessfulNavigation=null,this.events=new zt,this.configLoader=_e(Jy),this.environmentInjector=_e(Kr),this.urlSerializer=_e(pu),this.rootContexts=_e(bu),this.inputBindingEnabled=null!==_e(Jf,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>$e(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=r=>this.events.next(new p8(r)),this.configLoader.onLoadStartListener=r=>this.events.next(new f8(r))}complete(){this.transitions?.complete()}handleNavigationRequest(t){const i=++this.navigationId;this.transitions?.next({...this.transitions.value,...t,id:i})}setupNavigations(t){return this.transitions=new si({id:0,currentUrlTree:t.currentUrlTree,currentRawUrl:t.currentUrlTree,extractedUrl:t.urlHandlingStrategy.extract(t.currentUrlTree),urlAfterRedirects:t.urlHandlingStrategy.extract(t.currentUrlTree),rawUrl:t.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:vu,restoredState:null,currentSnapshot:t.routerState.snapshot,targetSnapshot:null,currentRouterState:t.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(nr(i=>0!==i.id),Ot(i=>({...i,extractedUrl:t.urlHandlingStrategy.extract(i.rawUrl)})),mr(i=>{let r=!1,s=!1;return $e(i).pipe(ei(o=>{this.currentNavigation={id:o.id,initialUrl:o.rawUrl,extractedUrl:o.extractedUrl,trigger:o.source,extras:o.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),mr(o=>{const a=t.browserUrlTree.toString(),l=!t.navigated||o.extractedUrl.toString()!==a||a!==t.currentUrlTree.toString();if(!l&&"reload"!==(o.extras.onSameUrlNavigation??t.onSameUrlNavigation)){const u="";return this.events.next(new yu(o.id,t.serializeUrl(i.rawUrl),u,0)),t.rawUrlTree=o.rawUrl,o.resolve(null),pr}if(t.urlHandlingStrategy.shouldProcessUrl(o.rawUrl))return hI(o.source)&&(t.browserUrlTree=o.extractedUrl),$e(o).pipe(mr(u=>{const d=this.transitions?.getValue();return this.events.next(new By(u.id,this.urlSerializer.serialize(u.extractedUrl),u.source,u.restoredState)),d!==this.transitions?.getValue()?pr:Promise.resolve(u)}),function p$(n,e,t,i,r,s){return Tn(o=>function u$(n,e,t,i,r,s,o="emptyOnly"){return new d$(n,e,t,i,r,o,s).recognize()}(n,e,t,i,o.extractedUrl,r,s).pipe(Ot(({state:a,tree:l})=>({...o,targetSnapshot:a,urlAfterRedirects:l}))))}(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,t.paramsInheritanceStrategy),ei(u=>{if(i.targetSnapshot=u.targetSnapshot,i.urlAfterRedirects=u.urlAfterRedirects,this.currentNavigation={...this.currentNavigation,finalUrl:u.urlAfterRedirects},"eager"===t.urlUpdateStrategy){if(!u.extras.skipLocationChange){const h=t.urlHandlingStrategy.merge(u.urlAfterRedirects,u.rawUrl);t.setBrowserUrl(h,u)}t.browserUrlTree=u.urlAfterRedirects}const d=new l8(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(d)}));if(l&&t.urlHandlingStrategy.shouldProcessUrl(t.rawUrlTree)){const{id:u,extractedUrl:d,source:h,restoredState:f,extras:p}=o,_=new By(u,this.urlSerializer.serialize(d),h,f);this.events.next(_);const g=jR(0,this.rootComponentType).snapshot;return $e(i={...o,targetSnapshot:g,urlAfterRedirects:d,extras:{...p,skipLocationChange:!1,replaceUrl:!1}})}{const u="";return this.events.next(new yu(o.id,t.serializeUrl(i.extractedUrl),u,1)),t.rawUrlTree=o.rawUrl,o.resolve(null),pr}}),ei(o=>{const a=new c8(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects),o.targetSnapshot);this.events.next(a)}),Ot(o=>i={...o,guards:L8(o.targetSnapshot,o.currentSnapshot,this.rootContexts)}),function W8(n,e){return Tn(t=>{const{targetSnapshot:i,currentSnapshot:r,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return 0===o.length&&0===s.length?$e({...t,guardsResult:!0}):function j8(n,e,t,i){return Nn(n).pipe(Tn(r=>function K8(n,e,t,i,r){const s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return s&&0!==s.length?$e(s.map(a=>{const l=xu(e)??r,c=tl(a,l);return Ps(function H8(n){return n&&Eu(n.canDeactivate)}(c)?c.canDeactivate(n,e,t,i):l.runInContext(()=>c(n,e,t,i))).pipe(go())})).pipe(nl()):$e(!0)}(r.component,r.route,t,e,i)),go(r=>!0!==r,!0))}(o,i,r,n).pipe(Tn(a=>a&&function k8(n){return"boolean"==typeof n}(a)?function $8(n,e,t,i){return Nn(e).pipe(du(r=>Rf(function q8(n,e){return null!==n&&e&&e(new m8(n)),$e(!0)}(r.route.parent,i),function X8(n,e){return null!==n&&e&&e(new _8(n)),$e(!0)}(r.route,i),function Z8(n,e,t){const i=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>function O8(n){const e=n.routeConfig?n.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:n,guards:e}:null}(o)).filter(o=>null!==o).map(o=>Sy(()=>$e(o.guards.map(l=>{const c=xu(o.node)??t,u=tl(l,c);return Ps(function V8(n){return n&&Eu(n.canActivateChild)}(u)?u.canActivateChild(i,n):c.runInContext(()=>u(i,n))).pipe(go())})).pipe(nl())));return $e(s).pipe(nl())}(n,r.path,t),function Y8(n,e,t){const i=e.routeConfig?e.routeConfig.canActivate:null;if(!i||0===i.length)return $e(!0);const r=i.map(s=>Sy(()=>{const o=xu(e)??t,a=tl(s,o);return Ps(function B8(n){return n&&Eu(n.canActivate)}(a)?a.canActivate(e,n):o.runInContext(()=>a(e,n))).pipe(go())}));return $e(r).pipe(nl())}(n,r.route,t))),go(r=>!0!==r,!0))}(i,s,n,e):$e(a)),Ot(a=>({...t,guardsResult:a})))})}(this.environmentInjector,o=>this.events.next(o)),ei(o=>{if(i.guardsResult=o.guardsResult,yo(o.guardsResult))throw ZR(0,o.guardsResult);const a=new u8(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects),o.targetSnapshot,!!o.guardsResult);this.events.next(a)}),nr(o=>!!o.guardsResult||(t.restoreHistory(o),this.cancelNavigationTransition(o,"",3),!1)),Ky(o=>{if(o.guards.canActivateChecks.length)return $e(o).pipe(ei(a=>{const l=new d8(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);this.events.next(l)}),mr(a=>{let l=!1;return $e(a).pipe(function m$(n,e){return Tn(t=>{const{targetSnapshot:i,guards:{canActivateChecks:r}}=t;if(!r.length)return $e(t);let s=0;return Nn(r).pipe(du(o=>function g$(n,e,t,i){const r=n.routeConfig,s=n._resolve;return void 0!==r?.title&&!uI(r)&&(s[hu]=r.title),function _$(n,e,t,i){const r=function v$(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}(n);if(0===r.length)return $e({});const s={};return Nn(r).pipe(Tn(o=>function y$(n,e,t,i){const r=xu(e)??i,s=tl(n,r);return Ps(s.resolve?s.resolve(e,t):r.runInContext(()=>s(e,t)))}(n[o],e,t,i).pipe(go(),ei(a=>{s[o]=a}))),Py(1),function Lj(n){return Ot(()=>n)}(s),_o(o=>nI(o)?pr:uu(o)))}(s,n,e,i).pipe(Ot(o=>(n._resolvedData=o,n.data=$R(n,t).resolve,r&&uI(r)&&(n.data[hu]=r.title),null)))}(o.route,i,n,e)),ei(()=>s++),Py(1),Tn(o=>s===r.length?$e(t):pr))})}(t.paramsInheritanceStrategy,this.environmentInjector),ei({next:()=>l=!0,complete:()=>{l||(t.restoreHistory(a),this.cancelNavigationTransition(a,"",2))}}))}),ei(a=>{const l=new h8(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);this.events.next(l)}))}),Ky(o=>{const a=l=>{const c=[];l.routeConfig?.loadComponent&&!l.routeConfig._loadedComponent&&c.push(this.configLoader.loadComponent(l.routeConfig).pipe(ei(u=>{l.component=u}),Ot(()=>{})));for(const u of l.children)c.push(...a(u));return c};return Df(a(o.targetSnapshot.root)).pipe(Gf(),Rr(1))}),Ky(()=>this.afterPreactivation()),Ot(o=>{const a=function S8(n,e,t){const i=wu(n,e._root,t?t._root:void 0);return new WR(i,e)}(t.routeReuseStrategy,o.targetSnapshot,o.currentRouterState);return i={...o,targetRouterState:a}}),ei(o=>{t.currentUrlTree=o.urlAfterRedirects,t.rawUrlTree=t.urlHandlingStrategy.merge(o.urlAfterRedirects,o.rawUrl),t.routerState=o.targetRouterState,"deferred"===t.urlUpdateStrategy&&(o.extras.skipLocationChange||t.setBrowserUrl(t.rawUrlTree,o),t.browserUrlTree=o.urlAfterRedirects)}),((n,e,t,i)=>Ot(r=>(new P8(e,r.targetRouterState,r.currentRouterState,t,i).activate(n),r)))(this.rootContexts,t.routeReuseStrategy,o=>this.events.next(o),this.inputBindingEnabled),Rr(1),ei({next:o=>{r=!0,this.lastSuccessfulNavigation=this.currentNavigation,t.navigated=!0,this.events.next(new bo(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(t.currentUrlTree))),t.titleStrategy?.updateTitle(o.targetRouterState.snapshot),o.resolve(!0)},complete:()=>{r=!0}}),Ly(()=>{r||s||this.cancelNavigationTransition(i,"",1),this.currentNavigation?.id===i.id&&(this.currentNavigation=null)}),_o(o=>{if(s=!0,QR(o)){JR(o)||(t.navigated=!0,t.restoreHistory(i,!0));const a=new Zf(i.id,this.urlSerializer.serialize(i.extractedUrl),o.message,o.cancellationCode);if(this.events.next(a),JR(o)){const l=t.urlHandlingStrategy.merge(o.url,t.rawUrlTree),c={skipLocationChange:i.extras.skipLocationChange,replaceUrl:"eager"===t.urlUpdateStrategy||hI(i.source)};t.scheduleNavigation(l,vu,null,c,{resolve:i.resolve,reject:i.reject,promise:i.promise})}else i.resolve(!1)}else{t.restoreHistory(i,!0);const a=new Vy(i.id,this.urlSerializer.serialize(i.extractedUrl),o,i.targetSnapshot??void 0);this.events.next(a);try{i.resolve(t.errorHandler(o))}catch(l){i.reject(l)}}return pr}))}))}cancelNavigationTransition(t,i,r){const s=new Zf(t.id,this.urlSerializer.serialize(t.extractedUrl),i,r);this.events.next(s),t.resolve(!1)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ee({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function hI(n){return n!==vu}let fI=(()=>{class n{buildTitle(t){let i,r=t.root;for(;void 0!==r;)i=this.getResolvedTitleForRoute(r)??i,r=r.children.find(s=>s.outlet===at);return i}getResolvedTitleForRoute(t){return t.data[hu]}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ee({token:n,factory:function(){return _e(w$)},providedIn:"root"}),n})(),w$=(()=>{class n extends fI{constructor(t){super(),this.title=t}updateTitle(t){const i=this.buildTitle(t);void 0!==i&&this.title.setTitle(i)}}return n.\u0275fac=function(t){return new(t||n)(te(AD))},n.\u0275prov=Ee({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),x$=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ee({token:n,factory:function(){return _e(M$)},providedIn:"root"}),n})();class S${shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}let M$=(()=>{class n extends S${}return n.\u0275fac=function(){let e;return function(i){return(e||(e=function cS(n){return jr(()=>{const e=n.prototype.constructor,t=e[$r]||xg(e),i=Object.prototype;let r=Object.getPrototypeOf(n.prototype).constructor;for(;r&&r!==i;){const s=r[$r]||xg(r);if(s&&s!==t)return s;r=Object.getPrototypeOf(r)}return s=>new s})}(n)))(i||n)}}(),n.\u0275prov=Ee({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const rp=new Ce("",{providedIn:"root",factory:()=>({})});let E$=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ee({token:n,factory:function(){return _e(A$)},providedIn:"root"}),n})(),A$=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,i){return t}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ee({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var Ri=(()=>((Ri=Ri||{})[Ri.COMPLETE=0]="COMPLETE",Ri[Ri.FAILED=1]="FAILED",Ri[Ri.REDIRECTING=2]="REDIRECTING",Ri))();function pI(n,e){n.events.pipe(nr(t=>t instanceof bo||t instanceof Zf||t instanceof Vy||t instanceof yu),Ot(t=>t instanceof bo||t instanceof yu?Ri.COMPLETE:t instanceof Zf&&(0===t.code||1===t.code)?Ri.REDIRECTING:Ri.FAILED),nr(t=>t!==Ri.REDIRECTING),Rr(1)).subscribe(()=>{e()})}function C$(n){throw n}function T$(n,e,t){return e.parse("/")}const D$={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},R$={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let vi=(()=>{class n{get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){if("computed"===this.canceledNavigationResolution)return this.location.getState()?.\u0275routerPageId}get events(){return this.navigationTransitions.events}constructor(){this.disposed=!1,this.currentPageId=0,this.console=_e(eT),this.isNgZoneEnabled=!1,this.options=_e(rp,{optional:!0})||{},this.pendingTasks=_e(tT),this.errorHandler=this.options.errorHandler||C$,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||T$,this.navigated=!1,this.lastSuccessfulId=-1,this.urlHandlingStrategy=_e(E$),this.routeReuseStrategy=_e(x$),this.titleStrategy=_e(fI),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=_e(rl,{optional:!0})?.flat()??[],this.navigationTransitions=_e(ip),this.urlSerializer=_e(pu),this.location=_e(hf),this.componentInputBindingEnabled=!!_e(Jf,{optional:!0}),this.isNgZoneEnabled=_e(Et)instanceof Et&&Et.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new Ja,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=jR(0,null),this.navigationTransitions.setupNavigations(this).subscribe(t=>{this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId??0},t=>{this.console.warn(`Unhandled Navigation Error: ${t}`)})}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const t=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),vu,t)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{const i="popstate"===t.type?"popstate":"hashchange";"popstate"===i&&setTimeout(()=>{this.navigateToSyncWithBrowser(t.url,i,t.state)},0)}))}navigateToSyncWithBrowser(t,i,r){const s={replaceUrl:!0},o=r?.navigationId?r:null;if(r){const l={...r};delete l.navigationId,delete l.\u0275routerPageId,0!==Object.keys(l).length&&(s.state=l)}const a=this.parseUrl(t);this.scheduleNavigation(a,i,o,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(qy),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(t,i={}){const{relativeTo:r,queryParams:s,fragment:o,queryParamsHandling:a,preserveFragment:l}=i,c=l?this.currentUrlTree.fragment:o;let d,u=null;switch(a){case"merge":u={...this.currentUrlTree.queryParams,...s};break;case"preserve":u=this.currentUrlTree.queryParams;break;default:u=s||null}null!==u&&(u=this.removeEmptyProps(u));try{d=NR(r?r.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof t[0]||!t[0].startsWith("/"))&&(t=[]),d=this.currentUrlTree.root}return FR(d,t,u,c??null)}navigateByUrl(t,i={skipLocationChange:!1}){const r=yo(t)?t:this.parseUrl(t),s=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(s,vu,null,i)}navigate(t,i={skipLocationChange:!1}){return function I$(n){for(let e=0;e<n.length;e++)if(null==n[e])throw new he(4008,!1)}(t),this.navigateByUrl(this.createUrlTree(t,i),i)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let i;try{i=this.urlSerializer.parse(t)}catch(r){i=this.malformedUriErrorHandler(r,this.urlSerializer,t)}return i}isActive(t,i){let r;if(r=!0===i?{...D$}:!1===i?{...R$}:i,yo(t))return AR(this.currentUrlTree,t,r);const s=this.parseUrl(t);return AR(this.currentUrlTree,s,r)}removeEmptyProps(t){return Object.keys(t).reduce((i,r)=>{const s=t[r];return null!=s&&(i[r]=s),i},{})}scheduleNavigation(t,i,r,s,o){if(this.disposed)return Promise.resolve(!1);let a,l,c;o?(a=o.resolve,l=o.reject,c=o.promise):c=new Promise((d,h)=>{a=d,l=h});const u=this.pendingTasks.add();return pI(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(u))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:s,resolve:a,reject:l,promise:c,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),c.catch(d=>Promise.reject(d))}setBrowserUrl(t,i){const r=this.urlSerializer.serialize(t);if(this.location.isCurrentPathEqualTo(r)||i.extras.replaceUrl){const o={...i.extras.state,...this.generateNgRouterState(i.id,this.browserPageId)};this.location.replaceState(r,"",o)}else{const s={...i.extras.state,...this.generateNgRouterState(i.id,(this.browserPageId??0)+1)};this.location.go(r,"",s)}}restoreHistory(t,i=!1){if("computed"===this.canceledNavigationResolution){const s=this.currentPageId-(this.browserPageId??this.currentPageId);0!==s?this.location.historyGo(s):this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===s&&(this.resetState(t),this.browserUrlTree=t.currentUrlTree,this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(i&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=t.currentRouterState,this.currentUrlTree=t.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,i){return"computed"===this.canceledNavigationResolution?{navigationId:t,\u0275routerPageId:i}:{navigationId:t}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ee({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class mI{}let O$=(()=>{class n{constructor(t,i,r,s,o){this.router=t,this.injector=r,this.preloadingStrategy=s,this.loader=o}setUpPreloading(){this.subscription=this.router.events.pipe(nr(t=>t instanceof bo),du(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,i){const r=[];for(const s of i){s.providers&&!s._injector&&(s._injector=Y_(s.providers,t,`Route: ${s.path}`));const o=s._injector??t,a=s._loadedInjector??o;(s.loadChildren&&!s._loadedRoutes&&void 0===s.canLoad||s.loadComponent&&!s._loadedComponent)&&r.push(this.preloadConfig(o,s)),(s.children||s._loadedRoutes)&&r.push(this.processRoutes(a,s.children??s._loadedRoutes))}return Nn(r).pipe(na())}preloadConfig(t,i){return this.preloadingStrategy.preload(i,()=>{let r;r=i.loadChildren&&void 0===i.canLoad?this.loader.loadChildren(t,i):$e(null);const s=r.pipe(Tn(o=>null===o?$e(void 0):(i._loadedRoutes=o.routes,i._loadedInjector=o.injector,this.processRoutes(o.injector??t,o.routes))));return i.loadComponent&&!i._loadedComponent?Nn([s,this.loader.loadComponent(i)]).pipe(na()):s})}}return n.\u0275fac=function(t){return new(t||n)(te(vi),te(nT),te(Kr),te(mI),te(Jy))},n.\u0275prov=Ee({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const e0=new Ce("");let gI=(()=>{class n{constructor(t,i,r,s,o={}){this.urlSerializer=t,this.transitions=i,this.viewportScroller=r,this.zone=s,this.options=o,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},o.scrollPositionRestoration=o.scrollPositionRestoration||"disabled",o.anchorScrolling=o.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof By?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof bo?(this.lastId=t.id,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.urlAfterRedirects).fragment)):t instanceof yu&&0===t.code&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof zR&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,i){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new zR(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,i))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}}return n.\u0275fac=function(t){!function $M(){throw new Error("invalid")}()},n.\u0275prov=Ee({token:n,factory:n.\u0275fac}),n})();function rs(n,e){return{\u0275kind:n,\u0275providers:e}}function vI(){const n=_e(gi);return e=>{const t=n.get(lo);if(e!==t.components[0])return;const i=n.get(vi),r=n.get(yI);1===n.get(t0)&&i.initialNavigation(),n.get(bI,null,Ge.Optional)?.setUpPreloading(),n.get(e0,null,Ge.Optional)?.init(),i.resetRootComponentType(t.componentTypes[0]),r.closed||(r.next(),r.complete(),r.unsubscribe())}}const yI=new Ce("",{factory:()=>new zt}),t0=new Ce("",{providedIn:"root",factory:()=>1}),bI=new Ce("");function U$(n){return rs(0,[{provide:bI,useExisting:O$},{provide:mI,useExisting:n}])}const wI=new Ce("ROUTER_FORROOT_GUARD"),V$=[hf,{provide:pu,useClass:Oy},vi,bu,{provide:el,useFactory:function _I(n){return n.routerState.root},deps:[vi]},Jy,[]];function H$(){return new fT("Router",vi)}let z$=(()=>{class n{constructor(t){}static forRoot(t,i){return{ngModule:n,providers:[V$,[],{provide:rl,multi:!0,useValue:t},{provide:wI,useFactory:$$,deps:[[vi,new nh,new ih]]},{provide:rp,useValue:i||{}},i?.useHash?{provide:uo,useClass:qz}:{provide:uo,useClass:HT},{provide:e0,useFactory:()=>{const n=_e(fW),e=_e(Et),t=_e(rp),i=_e(ip),r=_e(pu);return t.scrollOffset&&n.setOffset(t.scrollOffset),new gI(r,i,n,e,t)}},i?.preloadingStrategy?U$(i.preloadingStrategy).\u0275providers:[],{provide:fT,multi:!0,useFactory:H$},i?.initialNavigation?X$(i):[],i?.bindToComponentInputs?rs(8,[YR,{provide:Jf,useExisting:YR}]).\u0275providers:[],[{provide:xI,useFactory:vI},{provide:xv,multi:!0,useExisting:xI}]]}}static forChild(t){return{ngModule:n,providers:[{provide:rl,multi:!0,useValue:t}]}}}return n.\u0275fac=function(t){return new(t||n)(te(wI,8))},n.\u0275mod=li({type:n}),n.\u0275inj=Yn({}),n})();function $$(n){return"guarded"}function X$(n){return["disabled"===n.initialNavigation?rs(3,[{provide:pv,multi:!0,useFactory:()=>{const e=_e(vi);return()=>{e.setUpLocationChangeListener()}}},{provide:t0,useValue:2}]).\u0275providers:[],"enabledBlocking"===n.initialNavigation?rs(2,[{provide:t0,useValue:0},{provide:pv,multi:!0,deps:[gi],useFactory:e=>{const t=e.get($z,Promise.resolve());return()=>t.then(()=>new Promise(i=>{const r=e.get(vi),s=e.get(yI);pI(r,()=>{i(!0)}),e.get(ip).afterPreactivation=()=>(i(!0),s.closed?$e(void 0):s),r.initialNavigation()}))}}]).\u0275providers:[]]}const xI=new Ce("");function SI(n,e,t,i,r,s,o){try{var a=n[s](o),l=a.value}catch(c){return void t(c)}a.done?e(l):Promise.resolve(l).then(i,r)}function sp(n){return function(){var e=this,t=arguments;return new Promise(function(i,r){var s=n.apply(e,t);function o(l){SI(s,i,r,o,a,"next",l)}function a(l){SI(s,i,r,o,a,"throw",l)}o(void 0)})}}const EI=1,K$=2,ss=3,op=0,_6=1,v6=2,as=0,y6=1,b6=2,w6=3,x6=4,S6=5,wo=301,xo=302,Au=306,So=1e3,$n=1001,dn=1003,Qt=1006,ls=1008,Os=1009,Ns=1014,cs=1015,Du=1016,Mo=1020,Gi=1023,Eo=1026,cl=1027,Ru=2300,ul=2301,dl=2400,hl=2401,Ao=3001,Ze="srgb",rr="srgb-linear",h1="display-p3",f1="300 es",us=2e3;class Fs{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const i=this._listeners;void 0===i[e]&&(i[e]=[]),-1===i[e].indexOf(t)&&i[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const i=this._listeners;return void 0!==i[e]&&-1!==i[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const r=this._listeners[e];if(void 0!==r){const s=r.indexOf(t);-1!==s&&r.splice(s,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const i=this._listeners[e.type];if(void 0!==i){e.target=this;const r=i.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}}const Xn=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];const Do=Math.PI/180,fl=180/Math.PI;function Ii(){const n=4294967295*Math.random()|0,e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(Xn[255&n]+Xn[n>>8&255]+Xn[n>>16&255]+Xn[n>>24&255]+"-"+Xn[255&e]+Xn[e>>8&255]+"-"+Xn[e>>16&15|64]+Xn[e>>24&255]+"-"+Xn[63&t|128]+Xn[t>>8&255]+"-"+Xn[t>>16&255]+Xn[t>>24&255]+Xn[255&i]+Xn[i>>8&255]+Xn[i>>16&255]+Xn[i>>24&255]).toLowerCase()}function en(n,e,t){return Math.max(e,Math.min(t,n))}function v0(n,e){return(n%e+e)%e}function Iu(n,e,t){return(1-t)*n+t*e}function y0(n){return 0==(n&n-1)&&0!==n}function m1(n){return Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function fp(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}function Pi(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return n/4294967295;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int32Array:return Math.max(n/2147483647,-1);case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function ut(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return Math.round(4294967295*n);case Uint16Array:return Math.round(65535*n);case Uint8Array:return Math.round(255*n);case Int32Array:return Math.round(2147483647*n);case Int16Array:return Math.round(32767*n);case Int8Array:return Math.round(127*n);default:throw new Error("Invalid component type.")}}const lX_radToDeg=function oX(n){return n*fl};class K{constructor(e=0,t=0){K.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,i=this.y,r=e.elements;return this.x=r[0]*t+r[3]*i+r[6],this.y=r[1]*t+r[4]*i+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(en(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y;return t*t+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const i=Math.cos(t),r=Math.sin(t),s=this.x-e.x,o=this.y-e.y;return this.x=s*i-o*r+e.x,this.y=s*r+o*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class ft{constructor(e,t,i,r,s,o,a,l,c){ft.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==e&&this.set(e,t,i,r,s,o,a,l,c)}set(e,t,i,r,s,o,a,l,c){const u=this.elements;return u[0]=e,u[1]=r,u[2]=a,u[3]=t,u[4]=s,u[5]=l,u[6]=i,u[7]=o,u[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[3],l=i[6],c=i[1],u=i[4],d=i[7],h=i[2],f=i[5],p=i[8],_=r[0],g=r[3],m=r[6],v=r[1],y=r[4],b=r[7],w=r[2],S=r[5],C=r[8];return s[0]=o*_+a*v+l*w,s[3]=o*g+a*y+l*S,s[6]=o*m+a*b+l*C,s[1]=c*_+u*v+d*w,s[4]=c*g+u*y+d*S,s[7]=c*m+u*b+d*C,s[2]=h*_+f*v+p*w,s[5]=h*g+f*y+p*S,s[8]=h*m+f*b+p*C,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8];return t*o*u-t*a*c-i*s*u+i*a*l+r*s*c-r*o*l}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],d=u*o-a*c,h=a*l-u*s,f=c*s-o*l,p=t*d+i*h+r*f;if(0===p)return this.set(0,0,0,0,0,0,0,0,0);const _=1/p;return e[0]=d*_,e[1]=(r*c-u*i)*_,e[2]=(a*i-r*o)*_,e[3]=h*_,e[4]=(u*t-r*l)*_,e[5]=(r*s-a*t)*_,e[6]=f*_,e[7]=(i*l-c*t)*_,e[8]=(o*t-i*s)*_,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,r,s,o,a){const l=Math.cos(s),c=Math.sin(s);return this.set(i*l,i*c,-i*(l*o+c*a)+o+e,-r*c,r*l,-r*(-c*o+l*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(b0.makeScale(e,t)),this}rotate(e){return this.premultiply(b0.makeRotation(-e)),this}translate(e,t){return this.premultiply(b0.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,i,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<9;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}const b0=new ft;function g1(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}function Pu(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;const _1={};function Lu(n){n in _1||(_1[n]=!0,console.warn(n))}function ml(n){return n<.04045?.0773993808*n:Math.pow(.9478672986*n+.0521327014,2.4)}function w0(n){return n<.0031308?12.92*n:1.055*Math.pow(n,.41666)-.055}const uX=(new ft).fromArray([.8224621,.0331941,.0170827,.177538,.9668058,.0723974,-1e-7,1e-7,.9105199]),dX=(new ft).fromArray([1.2249401,-.0420569,-.0196376,-.2249404,1.0420571,-.0786361,1e-7,0,1.0982735]),pX={[rr]:n=>n,[Ze]:n=>n.convertSRGBToLinear(),[h1]:function hX(n){return n.convertSRGBToLinear().applyMatrix3(dX)}},mX={[rr]:n=>n,[Ze]:n=>n.convertLinearToSRGB(),[h1]:function fX(n){return n.applyMatrix3(uX).convertLinearToSRGB()}},sr={enabled:!0,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(n){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!n},get workingColorSpace(){return rr},set workingColorSpace(n){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(n,e,t){if(!1===this.enabled||e===t||!e||!t)return n;const i=pX[e],r=mX[t];if(void 0===i||void 0===r)throw new Error(`Unsupported color space conversion, "${e}" to "${t}".`);return r(i(n))},fromWorkingColorSpace:function(n,e){return this.convert(n,this.workingColorSpace,e)},toWorkingColorSpace:function(n,e){return this.convert(n,e,this.workingColorSpace)}};let gl;class v1{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===gl&&(gl=Pu("canvas")),gl.width=e.width,gl.height=e.height;const i=gl.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),t=gl}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=Pu("canvas");t.width=e.width,t.height=e.height;const i=t.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const r=i.getImageData(0,0,e.width,e.height),s=r.data;for(let o=0;o<s.length;o++)s[o]=255*ml(s[o]/255);return i.putImageData(r,0,0),t}if(e.data){const t=e.data.slice(0);for(let i=0;i<t.length;i++)t[i]=t instanceof Uint8Array||t instanceof Uint8ClampedArray?Math.floor(255*ml(t[i]/255)):ml(t[i]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let gX=0;class _l{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:gX++}),this.uuid=Ii(),this.data=e,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const i={uuid:this.uuid,url:""},r=this.data;if(null!==r){let s;if(Array.isArray(r)){s=[];for(let o=0,a=r.length;o<a;o++)s.push(x0(r[o].isDataTexture?r[o].image:r[o]))}else s=x0(r);i.url=s}return t||(e.images[this.uuid]=i),i}}function x0(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?v1.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let _X=0,or=(()=>{class n extends Fs{constructor(t=n.DEFAULT_IMAGE,i=n.DEFAULT_MAPPING,r=$n,s=$n,o=Qt,a=ls,l=Gi,c=Os,u=n.DEFAULT_ANISOTROPY,d=""){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:_X++}),this.uuid=Ii(),this.name="",this.source=new _l(t),this.mipmaps=[],this.mapping=i,this.channel=0,this.wrapS=r,this.wrapT=s,this.magFilter=o,this.minFilter=a,this.anisotropy=u,this.format=l,this.internalFormat=null,this.type=c,this.offset=new K(0,0),this.repeat=new K(1,1),this.center=new K(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new ft,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,"string"==typeof d?this.colorSpace=d:(Lu("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=d===Ao?Ze:""),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t=null){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.channel=t.channel,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.colorSpace=t.colorSpace,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const i=void 0===t||"string"==typeof t;if(!i&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const r={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),i||(t.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case So:t.x=t.x-Math.floor(t.x);break;case $n:t.x=t.x<0?0:1;break;case 1002:t.x=1===Math.abs(Math.floor(t.x)%2)?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case So:t.y=t.y-Math.floor(t.y);break;case $n:t.y=t.y<0?0:1;break;case 1002:t.y=1===Math.abs(Math.floor(t.y)%2)?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return Lu("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===Ze?Ao:3e3}set encoding(t){Lu("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=t===Ao?Ze:""}}return n.DEFAULT_IMAGE=null,n.DEFAULT_MAPPING=300,n.DEFAULT_ANISOTROPY=1,n})();class Ft{constructor(e=0,t=0,i=0,r=1){Ft.prototype.isVector4=!0,this.x=e,this.y=t,this.z=i,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,i,r){return this.x=e,this.y=t,this.z=i,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=this.w,o=e.elements;return this.x=o[0]*t+o[4]*i+o[8]*r+o[12]*s,this.y=o[1]*t+o[5]*i+o[9]*r+o[13]*s,this.z=o[2]*t+o[6]*i+o[10]*r+o[14]*s,this.w=o[3]*t+o[7]*i+o[11]*r+o[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,i,r,s;const l=e.elements,c=l[0],u=l[4],d=l[8],h=l[1],f=l[5],p=l[9],_=l[2],g=l[6],m=l[10];if(Math.abs(u-h)<.01&&Math.abs(d-_)<.01&&Math.abs(p-g)<.01){if(Math.abs(u+h)<.1&&Math.abs(d+_)<.1&&Math.abs(p+g)<.1&&Math.abs(c+f+m-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const y=(c+1)/2,b=(f+1)/2,w=(m+1)/2,S=(u+h)/4,C=(d+_)/4,I=(p+g)/4;return y>b&&y>w?y<.01?(i=0,r=.707106781,s=.707106781):(i=Math.sqrt(y),r=S/i,s=C/i):b>w?b<.01?(i=.707106781,r=0,s=.707106781):(r=Math.sqrt(b),i=S/r,s=I/r):w<.01?(i=.707106781,r=.707106781,s=0):(s=Math.sqrt(w),i=C/s,r=I/s),this.set(i,r,s,t),this}let v=Math.sqrt((g-p)*(g-p)+(d-_)*(d-_)+(h-u)*(h-u));return Math.abs(v)<.001&&(v=1),this.x=(g-p)/v,this.y=(d-_)/v,this.z=(h-u)/v,this.w=Math.acos((c+f+m-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this.w=e.w+(t.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class Ro extends Fs{constructor(e=1,t=1,i={}){super(),this.isWebGLRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new Ft(0,0,e,t),this.scissorTest=!1,this.viewport=new Ft(0,0,e,t);const r={width:e,height:t,depth:1};void 0!==i.encoding&&(Lu("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),i.colorSpace=i.encoding===Ao?Ze:""),this.texture=new or(r,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=void 0!==i.generateMipmaps&&i.generateMipmaps,this.texture.internalFormat=void 0!==i.internalFormat?i.internalFormat:null,this.texture.minFilter=void 0!==i.minFilter?i.minFilter:Qt,this.depthBuffer=void 0===i.depthBuffer||i.depthBuffer,this.stencilBuffer=void 0!==i.stencilBuffer&&i.stencilBuffer,this.depthTexture=void 0!==i.depthTexture?i.depthTexture:null,this.samples=void 0!==i.samples?i.samples:0}setSize(e,t,i=1){(this.width!==e||this.height!==t||this.depth!==i)&&(this.width=e,this.height=t,this.depth=i,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=i,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new _l(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class S0 extends or{constructor(e=null,t=1,i=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=dn,this.minFilter=dn,this.wrapR=$n,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class y1 extends or{constructor(e=null,t=1,i=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=dn,this.minFilter=dn,this.wrapR=$n,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class tn{constructor(e=0,t=0,i=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=i,this._w=r}static slerpFlat(e,t,i,r,s,o,a){let l=i[r+0],c=i[r+1],u=i[r+2],d=i[r+3];const h=s[o+0],f=s[o+1],p=s[o+2],_=s[o+3];if(0===a)return e[t+0]=l,e[t+1]=c,e[t+2]=u,void(e[t+3]=d);if(1===a)return e[t+0]=h,e[t+1]=f,e[t+2]=p,void(e[t+3]=_);if(d!==_||l!==h||c!==f||u!==p){let g=1-a;const m=l*h+c*f+u*p+d*_,v=m>=0?1:-1,y=1-m*m;if(y>Number.EPSILON){const w=Math.sqrt(y),S=Math.atan2(w,m*v);g=Math.sin(g*S)/w,a=Math.sin(a*S)/w}const b=a*v;if(l=l*g+h*b,c=c*g+f*b,u=u*g+p*b,d=d*g+_*b,g===1-a){const w=1/Math.sqrt(l*l+c*c+u*u+d*d);l*=w,c*=w,u*=w,d*=w}}e[t]=l,e[t+1]=c,e[t+2]=u,e[t+3]=d}static multiplyQuaternionsFlat(e,t,i,r,s,o){const a=i[r],l=i[r+1],c=i[r+2],u=i[r+3],d=s[o],h=s[o+1],f=s[o+2],p=s[o+3];return e[t]=a*p+u*d+l*f-c*h,e[t+1]=l*p+u*h+c*d-a*f,e[t+2]=c*p+u*f+a*h-l*d,e[t+3]=u*p-a*d-l*h-c*f,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,r){return this._x=e,this._y=t,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){const i=e._x,r=e._y,s=e._z,o=e._order,a=Math.cos,l=Math.sin,c=a(i/2),u=a(r/2),d=a(s/2),h=l(i/2),f=l(r/2),p=l(s/2);switch(o){case"XYZ":this._x=h*u*d+c*f*p,this._y=c*f*d-h*u*p,this._z=c*u*p+h*f*d,this._w=c*u*d-h*f*p;break;case"YXZ":this._x=h*u*d+c*f*p,this._y=c*f*d-h*u*p,this._z=c*u*p-h*f*d,this._w=c*u*d+h*f*p;break;case"ZXY":this._x=h*u*d-c*f*p,this._y=c*f*d+h*u*p,this._z=c*u*p+h*f*d,this._w=c*u*d-h*f*p;break;case"ZYX":this._x=h*u*d-c*f*p,this._y=c*f*d+h*u*p,this._z=c*u*p-h*f*d,this._w=c*u*d+h*f*p;break;case"YZX":this._x=h*u*d+c*f*p,this._y=c*f*d+h*u*p,this._z=c*u*p-h*f*d,this._w=c*u*d-h*f*p;break;case"XZY":this._x=h*u*d-c*f*p,this._y=c*f*d-h*u*p,this._z=c*u*p+h*f*d,this._w=c*u*d+h*f*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return!1!==t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const i=t/2,r=Math.sin(i);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,i=t[0],r=t[4],s=t[8],o=t[1],a=t[5],l=t[9],c=t[2],u=t[6],d=t[10],h=i+a+d;if(h>0){const f=.5/Math.sqrt(h+1);this._w=.25/f,this._x=(u-l)*f,this._y=(s-c)*f,this._z=(o-r)*f}else if(i>a&&i>d){const f=2*Math.sqrt(1+i-a-d);this._w=(u-l)/f,this._x=.25*f,this._y=(r+o)/f,this._z=(s+c)/f}else if(a>d){const f=2*Math.sqrt(1+a-i-d);this._w=(s-c)/f,this._x=(r+o)/f,this._y=.25*f,this._z=(l+u)/f}else{const f=2*Math.sqrt(1+d-i-a);this._w=(o-r)/f,this._x=(s+c)/f,this._y=(l+u)/f,this._z=.25*f}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(en(this.dot(e),-1,1)))}rotateTowards(e,t){const i=this.angleTo(e);if(0===i)return this;const r=Math.min(1,t/i);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const i=e._x,r=e._y,s=e._z,o=e._w,a=t._x,l=t._y,c=t._z,u=t._w;return this._x=i*u+o*a+r*c-s*l,this._y=r*u+o*l+s*a-i*c,this._z=s*u+o*c+i*l-r*a,this._w=o*u-i*a-r*l-s*c,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const i=this._x,r=this._y,s=this._z,o=this._w;let a=o*e._w+i*e._x+r*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=i,this._y=r,this._z=s,this;const l=1-a*a;if(l<=Number.EPSILON){const f=1-t;return this._w=f*o+t*this._w,this._x=f*i+t*this._x,this._y=f*r+t*this._y,this._z=f*s+t*this._z,this.normalize(),this._onChangeCallback(),this}const c=Math.sqrt(l),u=Math.atan2(c,a),d=Math.sin((1-t)*u)/c,h=Math.sin(t*u)/c;return this._w=o*d+this._w*h,this._x=i*d+this._x*h,this._y=r*d+this._y*h,this._z=s*d+this._z*h,this._onChangeCallback(),this}slerpQuaternions(e,t,i){return this.copy(e).slerp(t,i)}random(){const e=Math.random(),t=Math.sqrt(1-e),i=Math.sqrt(e),r=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(t*Math.cos(r),i*Math.sin(s),i*Math.cos(s),t*Math.sin(r))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class T{constructor(e=0,t=0,i=0){T.prototype.isVector3=!0,this.x=e,this.y=t,this.z=i}set(e,t,i){return void 0===i&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(b1.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(b1.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[3]*i+s[6]*r,this.y=s[1]*t+s[4]*i+s[7]*r,this.z=s[2]*t+s[5]*i+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=e.elements,o=1/(s[3]*t+s[7]*i+s[11]*r+s[15]);return this.x=(s[0]*t+s[4]*i+s[8]*r+s[12])*o,this.y=(s[1]*t+s[5]*i+s[9]*r+s[13])*o,this.z=(s[2]*t+s[6]*i+s[10]*r+s[14])*o,this}applyQuaternion(e){const t=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z,l=e.w,c=l*t+o*r-a*i,u=l*i+a*t-s*r,d=l*r+s*i-o*t,h=-s*t-o*i-a*r;return this.x=c*l+h*-s+u*-a-d*-o,this.y=u*l+h*-o+d*-s-c*-a,this.z=d*l+h*-a+c*-o-u*-s,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[4]*i+s[8]*r,this.y=s[1]*t+s[5]*i+s[9]*r,this.z=s[2]*t+s[6]*i+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const i=e.x,r=e.y,s=e.z,o=t.x,a=t.y,l=t.z;return this.x=r*l-s*a,this.y=s*o-i*l,this.z=i*a-r*o,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return M0.copy(this).projectOnVector(e),this.sub(M0)}reflect(e){return this.sub(M0.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(en(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return t*t+i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){const r=Math.sin(t)*e;return this.x=r*Math.sin(i),this.y=Math.cos(t)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=2*(Math.random()-.5),t=Math.random()*Math.PI*2,i=Math.sqrt(1-e**2);return this.x=i*Math.cos(t),this.y=i*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const M0=new T,b1=new tn;class Nr{constructor(e=new T(1/0,1/0,1/0),t=new T(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t+=3)this.expandByPoint(hs.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,i=e.count;t<i;t++)this.expandByPoint(hs.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=hs.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){if(e.updateWorldMatrix(!1,!1),void 0!==e.boundingBox)null===e.boundingBox&&e.computeBoundingBox(),vl.copy(e.boundingBox),vl.applyMatrix4(e.matrixWorld),this.union(vl);else{const r=e.geometry;if(void 0!==r)if(t&&void 0!==r.attributes&&void 0!==r.attributes.position){const s=r.attributes.position;for(let o=0,a=s.count;o<a;o++)hs.fromBufferAttribute(s,o).applyMatrix4(e.matrixWorld),this.expandByPoint(hs)}else null===r.boundingBox&&r.computeBoundingBox(),vl.copy(r.boundingBox),vl.applyMatrix4(e.matrixWorld),this.union(vl)}const i=e.children;for(let r=0,s=i.length;r<s;r++)this.expandByObject(i[r],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,hs),hs.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Ou),pp.subVectors(this.max,Ou),yl.subVectors(e.a,Ou),bl.subVectors(e.b,Ou),wl.subVectors(e.c,Ou),ks.subVectors(bl,yl),Us.subVectors(wl,bl),Io.subVectors(yl,wl);let t=[0,-ks.z,ks.y,0,-Us.z,Us.y,0,-Io.z,Io.y,ks.z,0,-ks.x,Us.z,0,-Us.x,Io.z,0,-Io.x,-ks.y,ks.x,0,-Us.y,Us.x,0,-Io.y,Io.x,0];return!(!E0(t,yl,bl,wl,pp)||(t=[1,0,0,0,1,0,0,0,1],!E0(t,yl,bl,wl,pp)))&&(mp.crossVectors(ks,Us),t=[mp.x,mp.y,mp.z],E0(t,yl,bl,wl,pp))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,hs).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=.5*this.getSize(hs).length()),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(ds[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),ds[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),ds[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),ds[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),ds[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),ds[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),ds[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),ds[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(ds)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const ds=[new T,new T,new T,new T,new T,new T,new T,new T],hs=new T,vl=new Nr,yl=new T,bl=new T,wl=new T,ks=new T,Us=new T,Io=new T,Ou=new T,pp=new T,mp=new T,Po=new T;function E0(n,e,t,i,r){for(let s=0,o=n.length-3;s<=o;s+=3){Po.fromArray(n,s);const a=r.x*Math.abs(Po.x)+r.y*Math.abs(Po.y)+r.z*Math.abs(Po.z),l=e.dot(Po),c=t.dot(Po),u=i.dot(Po);if(Math.max(-Math.max(l,c,u),Math.min(l,c,u))>a)return!1}return!0}const vX=new Nr,Nu=new T,A0=new T;class ar{constructor(e=new T,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const i=this.center;void 0!==t?i.copy(t):vX.setFromPoints(e).getCenter(i);let r=0;for(let s=0,o=e.length;s<o;s++)r=Math.max(r,i.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const i=this.center.distanceToSquared(e);return t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Nu.subVectors(e,this.center);const t=Nu.lengthSq();if(t>this.radius*this.radius){const i=Math.sqrt(t),r=.5*(i-this.radius);this.center.addScaledVector(Nu,r/i),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(A0.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Nu.copy(e.center).add(A0)),this.expandByPoint(Nu.copy(e.center).sub(A0))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const fs=new T,C0=new T,gp=new T,Bs=new T,T0=new T,_p=new T,D0=new T;class Fu{constructor(e=new T,t=new T(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,fs)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=fs.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(fs.copy(this.origin).addScaledVector(this.direction,t),fs.distanceToSquared(e))}distanceSqToSegment(e,t,i,r){C0.copy(e).add(t).multiplyScalar(.5),gp.copy(t).sub(e).normalize(),Bs.copy(this.origin).sub(C0);const s=.5*e.distanceTo(t),o=-this.direction.dot(gp),a=Bs.dot(this.direction),l=-Bs.dot(gp),c=Bs.lengthSq(),u=Math.abs(1-o*o);let d,h,f,p;if(u>0)if(d=o*l-a,h=o*a-l,p=s*u,d>=0)if(h>=-p)if(h<=p){const _=1/u;d*=_,h*=_,f=d*(d+o*h+2*a)+h*(o*d+h+2*l)+c}else h=s,d=Math.max(0,-(o*h+a)),f=-d*d+h*(h+2*l)+c;else h=-s,d=Math.max(0,-(o*h+a)),f=-d*d+h*(h+2*l)+c;else h<=-p?(d=Math.max(0,-(-o*s+a)),h=d>0?-s:Math.min(Math.max(-s,-l),s),f=-d*d+h*(h+2*l)+c):h<=p?(d=0,h=Math.min(Math.max(-s,-l),s),f=h*(h+2*l)+c):(d=Math.max(0,-(o*s+a)),h=d>0?s:Math.min(Math.max(-s,-l),s),f=-d*d+h*(h+2*l)+c);else h=o>0?-s:s,d=Math.max(0,-(o*h+a)),f=-d*d+h*(h+2*l)+c;return i&&i.copy(this.origin).addScaledVector(this.direction,d),r&&r.copy(C0).addScaledVector(gp,h),f}intersectSphere(e,t){fs.subVectors(e.center,this.origin);const i=fs.dot(this.direction),r=fs.dot(fs)-i*i,s=e.radius*e.radius;if(r>s)return null;const o=Math.sqrt(s-r),a=i-o,l=i+o;return l<0?null:this.at(a<0?l:a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null}intersectPlane(e,t){const i=this.distanceToPlane(e);return null===i?null:this.at(i,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let i,r,s,o,a,l;const c=1/this.direction.x,u=1/this.direction.y,d=1/this.direction.z,h=this.origin;return c>=0?(i=(e.min.x-h.x)*c,r=(e.max.x-h.x)*c):(i=(e.max.x-h.x)*c,r=(e.min.x-h.x)*c),u>=0?(s=(e.min.y-h.y)*u,o=(e.max.y-h.y)*u):(s=(e.max.y-h.y)*u,o=(e.min.y-h.y)*u),i>o||s>r||((s>i||isNaN(i))&&(i=s),(o<r||isNaN(r))&&(r=o),d>=0?(a=(e.min.z-h.z)*d,l=(e.max.z-h.z)*d):(a=(e.max.z-h.z)*d,l=(e.min.z-h.z)*d),i>l||a>r)||((a>i||i!=i)&&(i=a),(l<r||r!=r)&&(r=l),r<0)?null:this.at(i>=0?i:r,t)}intersectsBox(e){return null!==this.intersectBox(e,fs)}intersectTriangle(e,t,i,r,s){T0.subVectors(t,e),_p.subVectors(i,e),D0.crossVectors(T0,_p);let a,o=this.direction.dot(D0);if(o>0){if(r)return null;a=1}else{if(!(o<0))return null;a=-1,o=-o}Bs.subVectors(this.origin,e);const l=a*this.direction.dot(_p.crossVectors(Bs,_p));if(l<0)return null;const c=a*this.direction.dot(T0.cross(Bs));if(c<0||l+c>o)return null;const u=-a*Bs.dot(D0);return u<0?null:this.at(u/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class et{constructor(e,t,i,r,s,o,a,l,c,u,d,h,f,p,_,g){et.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==e&&this.set(e,t,i,r,s,o,a,l,c,u,d,h,f,p,_,g)}set(e,t,i,r,s,o,a,l,c,u,d,h,f,p,_,g){const m=this.elements;return m[0]=e,m[4]=t,m[8]=i,m[12]=r,m[1]=s,m[5]=o,m[9]=a,m[13]=l,m[2]=c,m[6]=u,m[10]=d,m[14]=h,m[3]=f,m[7]=p,m[11]=_,m[15]=g,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new et).fromArray(this.elements)}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this}copyPosition(e){const t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,i=e.elements,r=1/xl.setFromMatrixColumn(e,0).length(),s=1/xl.setFromMatrixColumn(e,1).length(),o=1/xl.setFromMatrixColumn(e,2).length();return t[0]=i[0]*r,t[1]=i[1]*r,t[2]=i[2]*r,t[3]=0,t[4]=i[4]*s,t[5]=i[5]*s,t[6]=i[6]*s,t[7]=0,t[8]=i[8]*o,t[9]=i[9]*o,t[10]=i[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,i=e.x,r=e.y,s=e.z,o=Math.cos(i),a=Math.sin(i),l=Math.cos(r),c=Math.sin(r),u=Math.cos(s),d=Math.sin(s);if("XYZ"===e.order){const h=o*u,f=o*d,p=a*u,_=a*d;t[0]=l*u,t[4]=-l*d,t[8]=c,t[1]=f+p*c,t[5]=h-_*c,t[9]=-a*l,t[2]=_-h*c,t[6]=p+f*c,t[10]=o*l}else if("YXZ"===e.order){const h=l*u,f=l*d,p=c*u,_=c*d;t[0]=h+_*a,t[4]=p*a-f,t[8]=o*c,t[1]=o*d,t[5]=o*u,t[9]=-a,t[2]=f*a-p,t[6]=_+h*a,t[10]=o*l}else if("ZXY"===e.order){const h=l*u,f=l*d,p=c*u,_=c*d;t[0]=h-_*a,t[4]=-o*d,t[8]=p+f*a,t[1]=f+p*a,t[5]=o*u,t[9]=_-h*a,t[2]=-o*c,t[6]=a,t[10]=o*l}else if("ZYX"===e.order){const h=o*u,f=o*d,p=a*u,_=a*d;t[0]=l*u,t[4]=p*c-f,t[8]=h*c+_,t[1]=l*d,t[5]=_*c+h,t[9]=f*c-p,t[2]=-c,t[6]=a*l,t[10]=o*l}else if("YZX"===e.order){const h=o*l,f=o*c,p=a*l,_=a*c;t[0]=l*u,t[4]=_-h*d,t[8]=p*d+f,t[1]=d,t[5]=o*u,t[9]=-a*u,t[2]=-c*u,t[6]=f*d+p,t[10]=h-_*d}else if("XZY"===e.order){const h=o*l,f=o*c,p=a*l,_=a*c;t[0]=l*u,t[4]=-d,t[8]=c*u,t[1]=h*d+_,t[5]=o*u,t[9]=f*d-p,t[2]=p*d-f,t[6]=a*u,t[10]=_*d+h}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(yX,e,bX)}lookAt(e,t,i){const r=this.elements;return Li.subVectors(e,t),0===Li.lengthSq()&&(Li.z=1),Li.normalize(),Vs.crossVectors(i,Li),0===Vs.lengthSq()&&(1===Math.abs(i.z)?Li.x+=1e-4:Li.z+=1e-4,Li.normalize(),Vs.crossVectors(i,Li)),Vs.normalize(),vp.crossVectors(Li,Vs),r[0]=Vs.x,r[4]=vp.x,r[8]=Li.x,r[1]=Vs.y,r[5]=vp.y,r[9]=Li.y,r[2]=Vs.z,r[6]=vp.z,r[10]=Li.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[4],l=i[8],c=i[12],u=i[1],d=i[5],h=i[9],f=i[13],p=i[2],_=i[6],g=i[10],m=i[14],v=i[3],y=i[7],b=i[11],w=i[15],S=r[0],C=r[4],I=r[8],x=r[12],E=r[1],B=r[5],Y=r[9],N=r[13],F=r[2],H=r[6],ne=r[10],X=r[14],Q=r[3],re=r[7],ae=r[11],U=r[15];return s[0]=o*S+a*E+l*F+c*Q,s[4]=o*C+a*B+l*H+c*re,s[8]=o*I+a*Y+l*ne+c*ae,s[12]=o*x+a*N+l*X+c*U,s[1]=u*S+d*E+h*F+f*Q,s[5]=u*C+d*B+h*H+f*re,s[9]=u*I+d*Y+h*ne+f*ae,s[13]=u*x+d*N+h*X+f*U,s[2]=p*S+_*E+g*F+m*Q,s[6]=p*C+_*B+g*H+m*re,s[10]=p*I+_*Y+g*ne+m*ae,s[14]=p*x+_*N+g*X+m*U,s[3]=v*S+y*E+b*F+w*Q,s[7]=v*C+y*B+b*H+w*re,s[11]=v*I+y*Y+b*ne+w*ae,s[15]=v*x+y*N+b*X+w*U,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[4],r=e[8],s=e[12],o=e[1],a=e[5],l=e[9],c=e[13],u=e[2],d=e[6],h=e[10],f=e[14];return e[3]*(+s*l*d-r*c*d-s*a*h+i*c*h+r*a*f-i*l*f)+e[7]*(+t*l*f-t*c*h+s*o*h-r*o*f+r*c*u-s*l*u)+e[11]*(+t*c*d-t*a*f-s*o*d+i*o*f+s*a*u-i*c*u)+e[15]*(-r*a*u-t*l*d+t*a*h+r*o*d-i*o*h+i*l*u)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,i){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=i),this}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],d=e[9],h=e[10],f=e[11],p=e[12],_=e[13],g=e[14],m=e[15],v=d*g*c-_*h*c+_*l*f-a*g*f-d*l*m+a*h*m,y=p*h*c-u*g*c-p*l*f+o*g*f+u*l*m-o*h*m,b=u*_*c-p*d*c+p*a*f-o*_*f-u*a*m+o*d*m,w=p*d*l-u*_*l-p*a*h+o*_*h+u*a*g-o*d*g,S=t*v+i*y+r*b+s*w;if(0===S)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const C=1/S;return e[0]=v*C,e[1]=(_*h*s-d*g*s-_*r*f+i*g*f+d*r*m-i*h*m)*C,e[2]=(a*g*s-_*l*s+_*r*c-i*g*c-a*r*m+i*l*m)*C,e[3]=(d*l*s-a*h*s-d*r*c+i*h*c+a*r*f-i*l*f)*C,e[4]=y*C,e[5]=(u*g*s-p*h*s+p*r*f-t*g*f-u*r*m+t*h*m)*C,e[6]=(p*l*s-o*g*s-p*r*c+t*g*c+o*r*m-t*l*m)*C,e[7]=(o*h*s-u*l*s+u*r*c-t*h*c-o*r*f+t*l*f)*C,e[8]=b*C,e[9]=(p*d*s-u*_*s-p*i*f+t*_*f+u*i*m-t*d*m)*C,e[10]=(o*_*s-p*a*s+p*i*c-t*_*c-o*i*m+t*a*m)*C,e[11]=(u*a*s-o*d*s-u*i*c+t*d*c+o*i*f-t*a*f)*C,e[12]=w*C,e[13]=(u*_*r-p*d*r+p*i*h-t*_*h-u*i*g+t*d*g)*C,e[14]=(p*a*r-o*_*r-p*i*l+t*_*l+o*i*g-t*a*g)*C,e[15]=(o*d*r-u*a*r+u*i*l-t*d*l-o*i*h+t*a*h)*C,this}scale(e){const t=this.elements,i=e.x,r=e.y,s=e.z;return t[0]*=i,t[4]*=r,t[8]*=s,t[1]*=i,t[5]*=r,t[9]*=s,t[2]*=i,t[6]*=r,t[10]*=s,t[3]*=i,t[7]*=r,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))}makeTranslation(e,t,i){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const i=Math.cos(t),r=Math.sin(t),s=1-i,o=e.x,a=e.y,l=e.z,c=s*o,u=s*a;return this.set(c*o+i,c*a-r*l,c*l+r*a,0,c*a+r*l,u*a+i,u*l-r*o,0,c*l-r*a,u*l+r*o,s*l*l+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,t,i,r,s,o){return this.set(1,i,s,0,e,1,o,0,t,r,1,0,0,0,0,1),this}compose(e,t,i){const r=this.elements,s=t._x,o=t._y,a=t._z,l=t._w,c=s+s,u=o+o,d=a+a,h=s*c,f=s*u,p=s*d,_=o*u,g=o*d,m=a*d,v=l*c,y=l*u,b=l*d,w=i.x,S=i.y,C=i.z;return r[0]=(1-(_+m))*w,r[1]=(f+b)*w,r[2]=(p-y)*w,r[3]=0,r[4]=(f-b)*S,r[5]=(1-(h+m))*S,r[6]=(g+v)*S,r[7]=0,r[8]=(p+y)*C,r[9]=(g-v)*C,r[10]=(1-(h+_))*C,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,i){const r=this.elements;let s=xl.set(r[0],r[1],r[2]).length();const o=xl.set(r[4],r[5],r[6]).length(),a=xl.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],lr.copy(this);const c=1/s,u=1/o,d=1/a;return lr.elements[0]*=c,lr.elements[1]*=c,lr.elements[2]*=c,lr.elements[4]*=u,lr.elements[5]*=u,lr.elements[6]*=u,lr.elements[8]*=d,lr.elements[9]*=d,lr.elements[10]*=d,t.setFromRotationMatrix(lr),i.x=s,i.y=o,i.z=a,this}makePerspective(e,t,i,r,s,o,a=us){const l=this.elements,c=2*s/(t-e),u=2*s/(i-r),d=(t+e)/(t-e),h=(i+r)/(i-r);let f,p;if(a===us)f=-(o+s)/(o-s),p=-2*o*s/(o-s);else{if(2001!==a)throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);f=-o/(o-s),p=-o*s/(o-s)}return l[0]=c,l[4]=0,l[8]=d,l[12]=0,l[1]=0,l[5]=u,l[9]=h,l[13]=0,l[2]=0,l[6]=0,l[10]=f,l[14]=p,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(e,t,i,r,s,o,a=us){const l=this.elements,c=1/(t-e),u=1/(i-r),d=1/(o-s),h=(t+e)*c,f=(i+r)*u;let p,_;if(a===us)p=(o+s)*d,_=-2*d;else{if(2001!==a)throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);p=s*d,_=-1*d}return l[0]=2*c,l[4]=0,l[8]=0,l[12]=-h,l[1]=0,l[5]=2*u,l[9]=0,l[13]=-f,l[2]=0,l[6]=0,l[10]=_,l[14]=-p,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<16;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<16;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}}const xl=new T,lr=new et,yX=new T(0,0,0),bX=new T(1,1,1),Vs=new T,vp=new T,Li=new T,w1=new et,x1=new tn;let wX=(()=>{class n{constructor(t=0,i=0,r=0,s=n.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=i,this._z=r,this._order=s}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,i,r,s=this._order){return this._x=t,this._y=i,this._z=r,this._order=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,i=this._order,r=!0){const s=t.elements,o=s[0],a=s[4],l=s[8],c=s[1],u=s[5],d=s[9],h=s[2],f=s[6],p=s[10];switch(i){case"XYZ":this._y=Math.asin(en(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-d,p),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(f,u),this._z=0);break;case"YXZ":this._x=Math.asin(-en(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(l,p),this._z=Math.atan2(c,u)):(this._y=Math.atan2(-h,o),this._z=0);break;case"ZXY":this._x=Math.asin(en(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(-h,p),this._z=Math.atan2(-a,u)):(this._y=0,this._z=Math.atan2(c,o));break;case"ZYX":this._y=Math.asin(-en(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(f,p),this._z=Math.atan2(c,o)):(this._x=0,this._z=Math.atan2(-a,u));break;case"YZX":this._z=Math.asin(en(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-d,u),this._y=Math.atan2(-h,o)):(this._x=0,this._y=Math.atan2(l,p));break;case"XZY":this._z=Math.asin(-en(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(f,u),this._y=Math.atan2(l,o)):(this._x=Math.atan2(-d,p),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+i)}return this._order=i,!0===r&&this._onChangeCallback(),this}setFromQuaternion(t,i,r){return w1.makeRotationFromQuaternion(t),this.setFromRotationMatrix(w1,i,r)}setFromVector3(t,i=this._order){return this.set(t.x,t.y,t.z,i)}reorder(t){return x1.setFromEuler(this),this.setFromQuaternion(x1,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],i=0){return t[i]=this._x,t[i+1]=this._y,t[i+2]=this._z,t[i+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}return n.DEFAULT_ORDER="XYZ",n})();class R0{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return 0!=(this.mask&e.mask)}isEnabled(e){return 0!=(this.mask&(1<<e|0))}}let xX=0;const S1=new T,Sl=new tn,ps=new et,yp=new T,ku=new T,SX=new T,MX=new tn,M1=new T(1,0,0),E1=new T(0,1,0),A1=new T(0,0,1),EX={type:"added"},C1={type:"removed"};let Rn=(()=>{class n extends Fs{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:xX++}),this.uuid=Ii(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=n.DEFAULT_UP.clone();const t=new T,i=new wX,r=new tn,s=new T(1,1,1);i._onChange(function o(){r.setFromEuler(i,!1)}),r._onChange(function a(){i.setFromQuaternion(r,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:i},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new et},normalMatrix:{value:new ft}}),this.matrix=new et,this.matrixWorld=new et,this.matrixAutoUpdate=n.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=n.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new R0,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,i){this.quaternion.setFromAxisAngle(t,i)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,i){return Sl.setFromAxisAngle(t,i),this.quaternion.multiply(Sl),this}rotateOnWorldAxis(t,i){return Sl.setFromAxisAngle(t,i),this.quaternion.premultiply(Sl),this}rotateX(t){return this.rotateOnAxis(M1,t)}rotateY(t){return this.rotateOnAxis(E1,t)}rotateZ(t){return this.rotateOnAxis(A1,t)}translateOnAxis(t,i){return S1.copy(t).applyQuaternion(this.quaternion),this.position.add(S1.multiplyScalar(i)),this}translateX(t){return this.translateOnAxis(M1,t)}translateY(t){return this.translateOnAxis(E1,t)}translateZ(t){return this.translateOnAxis(A1,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(ps.copy(this.matrixWorld).invert())}lookAt(t,i,r){t.isVector3?yp.copy(t):yp.set(t,i,r);const s=this.parent;this.updateWorldMatrix(!0,!1),ku.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?ps.lookAt(ku,yp,this.up):ps.lookAt(yp,ku,this.up),this.quaternion.setFromRotationMatrix(ps),s&&(ps.extractRotation(s.matrixWorld),Sl.setFromRotationMatrix(ps),this.quaternion.premultiply(Sl.invert()))}add(t){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.add(arguments[i]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(EX)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const i=this.children.indexOf(t);return-1!==i&&(t.parent=null,this.children.splice(i,1),t.dispatchEvent(C1)),this}removeFromParent(){const t=this.parent;return null!==t&&t.remove(this),this}clear(){for(let t=0;t<this.children.length;t++){const i=this.children[t];i.parent=null,i.dispatchEvent(C1)}return this.children.length=0,this}attach(t){return this.updateWorldMatrix(!0,!1),ps.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),ps.multiply(t.parent.matrixWorld)),t.applyMatrix4(ps),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,i){if(this[t]===i)return this;for(let r=0,s=this.children.length;r<s;r++){const a=this.children[r].getObjectByProperty(t,i);if(void 0!==a)return a}}getObjectsByProperty(t,i){let r=[];this[t]===i&&r.push(this);for(let s=0,o=this.children.length;s<o;s++){const a=this.children[s].getObjectsByProperty(t,i);a.length>0&&(r=r.concat(a))}return r}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(ku,t,SX),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(ku,MX,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const i=this.matrixWorld.elements;return t.set(i[8],i[9],i[10]).normalize()}raycast(){}traverse(t){t(this);const i=this.children;for(let r=0,s=i.length;r<s;r++)i[r].traverse(t)}traverseVisible(t){if(!1===this.visible)return;t(this);const i=this.children;for(let r=0,s=i.length;r<s;r++)i[r].traverseVisible(t)}traverseAncestors(t){const i=this.parent;null!==i&&(t(i),i.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const i=this.children;for(let r=0,s=i.length;r<s;r++){const o=i[r];(!0===o.matrixWorldAutoUpdate||!0===t)&&o.updateMatrixWorld(t)}}updateWorldMatrix(t,i){const r=this.parent;if(!0===t&&null!==r&&!0===r.matrixWorldAutoUpdate&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===i){const s=this.children;for(let o=0,a=s.length;o<a;o++){const l=s[o];!0===l.matrixWorldAutoUpdate&&l.updateWorldMatrix(!1,!0)}}}toJSON(t){const i=void 0===t||"string"==typeof t,r={};i&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const s={};function o(l,c){return void 0===l[c.uuid]&&(l[c.uuid]=c.toJSON(t)),c.uuid}if(s.uuid=this.uuid,s.type=this.type,""!==this.name&&(s.name=this.name),!0===this.castShadow&&(s.castShadow=!0),!0===this.receiveShadow&&(s.receiveShadow=!0),!1===this.visible&&(s.visible=!1),!1===this.frustumCulled&&(s.frustumCulled=!1),0!==this.renderOrder&&(s.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(s.userData=this.userData),s.layers=this.layers.mask,s.matrix=this.matrix.toArray(),s.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(s.matrixAutoUpdate=!1),this.isInstancedMesh&&(s.type="InstancedMesh",s.count=this.count,s.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(s.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?s.background=this.background.toJSON():this.background.isTexture&&(s.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(s.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){s.geometry=o(t.geometries,this.geometry);const l=this.geometry.parameters;if(void 0!==l&&void 0!==l.shapes){const c=l.shapes;if(Array.isArray(c))for(let u=0,d=c.length;u<d;u++)o(t.shapes,c[u]);else o(t.shapes,c)}}if(this.isSkinnedMesh&&(s.bindMode=this.bindMode,s.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(o(t.skeletons,this.skeleton),s.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const l=[];for(let c=0,u=this.material.length;c<u;c++)l.push(o(t.materials,this.material[c]));s.material=l}else s.material=o(t.materials,this.material);if(this.children.length>0){s.children=[];for(let l=0;l<this.children.length;l++)s.children.push(this.children[l].toJSON(t).object)}if(this.animations.length>0){s.animations=[];for(let l=0;l<this.animations.length;l++)s.animations.push(o(t.animations,this.animations[l]))}if(i){const l=a(t.geometries),c=a(t.materials),u=a(t.textures),d=a(t.images),h=a(t.shapes),f=a(t.skeletons),p=a(t.animations),_=a(t.nodes);l.length>0&&(r.geometries=l),c.length>0&&(r.materials=c),u.length>0&&(r.textures=u),d.length>0&&(r.images=d),h.length>0&&(r.shapes=h),f.length>0&&(r.skeletons=f),p.length>0&&(r.animations=p),_.length>0&&(r.nodes=_)}return r.object=s,r;function a(l){const c=[];for(const u in l){const d=l[u];delete d.metadata,c.push(d)}return c}}clone(t){return(new this.constructor).copy(this,t)}copy(t,i=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.animations=t.animations,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===i)for(let r=0;r<t.children.length;r++)this.add(t.children[r].clone());return this}}return n.DEFAULT_UP=new T(0,1,0),n.DEFAULT_MATRIX_AUTO_UPDATE=!0,n.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0,n})();const cr=new T,ms=new T,I0=new T,gs=new T,Ml=new T,El=new T,T1=new T,P0=new T,L0=new T,O0=new T;let bp=!1;class Oi{constructor(e=new T,t=new T,i=new T){this.a=e,this.b=t,this.c=i}static getNormal(e,t,i,r){r.subVectors(i,t),cr.subVectors(e,t),r.cross(cr);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,t,i,r,s){cr.subVectors(r,t),ms.subVectors(i,t),I0.subVectors(e,t);const o=cr.dot(cr),a=cr.dot(ms),l=cr.dot(I0),c=ms.dot(ms),u=ms.dot(I0),d=o*c-a*a;if(0===d)return s.set(-2,-1,-1);const h=1/d,f=(c*l-a*u)*h,p=(o*u-a*l)*h;return s.set(1-f-p,p,f)}static containsPoint(e,t,i,r){return this.getBarycoord(e,t,i,r,gs),gs.x>=0&&gs.y>=0&&gs.x+gs.y<=1}static getUV(e,t,i,r,s,o,a,l){return!1===bp&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),bp=!0),this.getInterpolation(e,t,i,r,s,o,a,l)}static getInterpolation(e,t,i,r,s,o,a,l){return this.getBarycoord(e,t,i,r,gs),l.setScalar(0),l.addScaledVector(s,gs.x),l.addScaledVector(o,gs.y),l.addScaledVector(a,gs.z),l}static isFrontFacing(e,t,i,r){return cr.subVectors(i,t),ms.subVectors(e,t),cr.cross(ms).dot(r)<0}set(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this}setFromPointsAndIndices(e,t,i,r){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,i,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,r),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return cr.subVectors(this.c,this.b),ms.subVectors(this.a,this.b),.5*cr.cross(ms).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Oi.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Oi.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,i,r,s){return!1===bp&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),bp=!0),Oi.getInterpolation(e,this.a,this.b,this.c,t,i,r,s)}getInterpolation(e,t,i,r,s){return Oi.getInterpolation(e,this.a,this.b,this.c,t,i,r,s)}containsPoint(e){return Oi.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Oi.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const i=this.a,r=this.b,s=this.c;let o,a;Ml.subVectors(r,i),El.subVectors(s,i),P0.subVectors(e,i);const l=Ml.dot(P0),c=El.dot(P0);if(l<=0&&c<=0)return t.copy(i);L0.subVectors(e,r);const u=Ml.dot(L0),d=El.dot(L0);if(u>=0&&d<=u)return t.copy(r);const h=l*d-u*c;if(h<=0&&l>=0&&u<=0)return o=l/(l-u),t.copy(i).addScaledVector(Ml,o);O0.subVectors(e,s);const f=Ml.dot(O0),p=El.dot(O0);if(p>=0&&f<=p)return t.copy(s);const _=f*c-l*p;if(_<=0&&c>=0&&p<=0)return a=c/(c-p),t.copy(i).addScaledVector(El,a);const g=u*p-f*d;if(g<=0&&d-u>=0&&f-p>=0)return T1.subVectors(s,r),a=(d-u)/(d-u+(f-p)),t.copy(r).addScaledVector(T1,a);const m=1/(g+_+h);return o=_*m,a=h*m,t.copy(i).addScaledVector(Ml,o).addScaledVector(El,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let AX=0;class ur extends Fs{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:AX++}),this.uuid=Ii(),this.name="",this.type="Material",this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=7680,this.stencilZFail=7680,this.stencilZPass=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const i=e[t];if(void 0===i){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const r=this[t];void 0!==r?r&&r.isColor?r.set(i):r&&r.isVector3&&i&&i.isVector3?r.copy(i):this[t]=i:console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`)}}toJSON(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});const i={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};function r(s){const o=[];for(const a in s){const l=s[a];delete l.metadata,o.push(l)}return o}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),void 0!==this.roughness&&(i.roughness=this.roughness),void 0!==this.metalness&&(i.metalness=this.metalness),void 0!==this.sheen&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(i.shininess=this.shininess),void 0!==this.clearcoat&&(i.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.iridescence&&(i.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(i.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),void 0!==this.anisotropy&&(i.anisotropy=this.anisotropy),void 0!==this.anisotropyRotation&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(i.combine=this.combine)),void 0!==this.envMapIntensity&&(i.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(i.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(i.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(i.size=this.size),null!==this.shadowSide&&(i.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(i.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(i.blending=this.blending),0!==this.side&&(i.side=this.side),this.vertexColors&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),!0===this.transparent&&(i.transparent=this.transparent),i.depthFunc=this.depthFunc,i.depthTest=this.depthTest,i.depthWrite=this.depthWrite,i.colorWrite=this.colorWrite,i.stencilWrite=this.stencilWrite,i.stencilWriteMask=this.stencilWriteMask,i.stencilFunc=this.stencilFunc,i.stencilRef=this.stencilRef,i.stencilFuncMask=this.stencilFuncMask,i.stencilFail=this.stencilFail,i.stencilZFail=this.stencilZFail,i.stencilZPass=this.stencilZPass,void 0!==this.rotation&&0!==this.rotation&&(i.rotation=this.rotation),!0===this.polygonOffset&&(i.polygonOffset=!0),0!==this.polygonOffsetFactor&&(i.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(i.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(i.linewidth=this.linewidth),void 0!==this.dashSize&&(i.dashSize=this.dashSize),void 0!==this.gapSize&&(i.gapSize=this.gapSize),void 0!==this.scale&&(i.scale=this.scale),!0===this.dithering&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),!0===this.alphaHash&&(i.alphaHash=this.alphaHash),!0===this.alphaToCoverage&&(i.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(i.premultipliedAlpha=this.premultipliedAlpha),!0===this.forceSinglePass&&(i.forceSinglePass=this.forceSinglePass),!0===this.wireframe&&(i.wireframe=this.wireframe),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(i.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(i.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(i.flatShading=this.flatShading),!1===this.visible&&(i.visible=!1),!1===this.toneMapped&&(i.toneMapped=!1),!1===this.fog&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData),t){const s=r(e.textures),o=r(e.images);s.length>0&&(i.textures=s),o.length>0&&(i.images=o)}return i}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let i=null;if(null!==t){const r=t.length;i=new Array(r);for(let s=0;s!==r;++s)i[s]=t[s].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}const D1={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},dr={h:0,s:0,l:0},wp={h:0,s:0,l:0};function N0(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+6*(e-n)*t:t<.5?e:t<2/3?n+6*(e-n)*(2/3-t):n}class be{constructor(e,t,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,i)}set(e,t,i){if(void 0===t&&void 0===i){const r=e;r&&r.isColor?this.copy(r):"number"==typeof r?this.setHex(r):"string"==typeof r&&this.setStyle(r)}else this.setRGB(e,t,i);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Ze){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,sr.toWorkingColorSpace(this,t),this}setRGB(e,t,i,r=sr.workingColorSpace){return this.r=e,this.g=t,this.b=i,sr.toWorkingColorSpace(this,r),this}setHSL(e,t,i,r=sr.workingColorSpace){if(e=v0(e,1),t=en(t,0,1),i=en(i,0,1),0===t)this.r=this.g=this.b=i;else{const s=i<=.5?i*(1+t):i+t-i*t,o=2*i-s;this.r=N0(o,s,e+1/3),this.g=N0(o,s,e),this.b=N0(o,s,e-1/3)}return sr.toWorkingColorSpace(this,r),this}setStyle(e,t=Ze){function i(s){void 0!==s&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const a=r[2];switch(r[1]){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,t);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,t);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=r[1],o=s.length;if(3===o)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,t);if(6===o)return this.setHex(parseInt(s,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=Ze){const i=D1[e.toLowerCase()];return void 0!==i?this.setHex(i,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=ml(e.r),this.g=ml(e.g),this.b=ml(e.b),this}copyLinearToSRGB(e){return this.r=w0(e.r),this.g=w0(e.g),this.b=w0(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Ze){return sr.fromWorkingColorSpace(qn.copy(this),e),65536*Math.round(en(255*qn.r,0,255))+256*Math.round(en(255*qn.g,0,255))+Math.round(en(255*qn.b,0,255))}getHexString(e=Ze){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=sr.workingColorSpace){sr.fromWorkingColorSpace(qn.copy(this),t);const i=qn.r,r=qn.g,s=qn.b,o=Math.max(i,r,s),a=Math.min(i,r,s);let l,c;const u=(a+o)/2;if(a===o)l=0,c=0;else{const d=o-a;switch(c=u<=.5?d/(o+a):d/(2-o-a),o){case i:l=(r-s)/d+(r<s?6:0);break;case r:l=(s-i)/d+2;break;case s:l=(i-r)/d+4}l/=6}return e.h=l,e.s=c,e.l=u,e}getRGB(e,t=sr.workingColorSpace){return sr.fromWorkingColorSpace(qn.copy(this),t),e.r=qn.r,e.g=qn.g,e.b=qn.b,e}getStyle(e=Ze){sr.fromWorkingColorSpace(qn.copy(this),e);const t=qn.r,i=qn.g,r=qn.b;return e!==Ze?`color(${e} ${t.toFixed(3)} ${i.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(255*t)},${Math.round(255*i)},${Math.round(255*r)})`}offsetHSL(e,t,i){return this.getHSL(dr),dr.h+=e,dr.s+=t,dr.l+=i,this.setHSL(dr.h,dr.s,dr.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,i){return this.r=e.r+(t.r-e.r)*i,this.g=e.g+(t.g-e.g)*i,this.b=e.b+(t.b-e.b)*i,this}lerpHSL(e,t){this.getHSL(dr),e.getHSL(wp);const i=Iu(dr.h,wp.h,t),r=Iu(dr.s,wp.s,t),s=Iu(dr.l,wp.l,t);return this.setHSL(i,r,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,i=this.g,r=this.b,s=e.elements;return this.r=s[0]*t+s[3]*i+s[6]*r,this.g=s[1]*t+s[4]*i+s[7]*r,this.b=s[2]*t+s[5]*i+s[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const qn=new be;be.NAMES=D1;class bi extends ur{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new be(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=op,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const yn=new T,xp=new K;class Gt{constructor(e,t,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=i,this.usage=35044,this.updateRange={offset:0,count:-1},this.gpuType=cs,this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,i){e*=this.itemSize,i*=t.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=t.array[i+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,i=this.count;t<i;t++)xp.fromBufferAttribute(this,t),xp.applyMatrix3(e),this.setXY(t,xp.x,xp.y);else if(3===this.itemSize)for(let t=0,i=this.count;t<i;t++)yn.fromBufferAttribute(this,t),yn.applyMatrix3(e),this.setXYZ(t,yn.x,yn.y,yn.z);return this}applyMatrix4(e){for(let t=0,i=this.count;t<i;t++)yn.fromBufferAttribute(this,t),yn.applyMatrix4(e),this.setXYZ(t,yn.x,yn.y,yn.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)yn.fromBufferAttribute(this,t),yn.applyNormalMatrix(e),this.setXYZ(t,yn.x,yn.y,yn.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)yn.fromBufferAttribute(this,t),yn.transformDirection(e),this.setXYZ(t,yn.x,yn.y,yn.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Pi(t,this.array)),t}setX(e,t){return this.normalized&&(t=ut(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Pi(t,this.array)),t}setY(e,t){return this.normalized&&(t=ut(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Pi(t,this.array)),t}setZ(e,t){return this.normalized&&(t=ut(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Pi(t,this.array)),t}setW(e,t){return this.normalized&&(t=ut(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=ut(t,this.array),i=ut(i,this.array)),this.array[e+0]=t,this.array[e+1]=i,this}setXYZ(e,t,i,r){return e*=this.itemSize,this.normalized&&(t=ut(t,this.array),i=ut(i,this.array),r=ut(r,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this}setXYZW(e,t,i,r,s){return e*=this.itemSize,this.normalized&&(t=ut(t,this.array),i=ut(i,this.array),r=ut(r,this.array),s=ut(s,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),35044!==this.usage&&(e.usage=this.usage),(0!==this.updateRange.offset||-1!==this.updateRange.count)&&(e.updateRange=this.updateRange),e}}class R1 extends Gt{constructor(e,t,i){super(new Uint16Array(e),t,i)}}class I1 extends Gt{constructor(e,t,i){super(new Uint32Array(e),t,i)}}class Ne extends Gt{constructor(e,t,i){super(new Float32Array(e),t,i)}}let TX=0;const Wi=new et,F0=new Rn,Al=new T,Ni=new Nr,Bu=new Nr,In=new T;class pt extends Fs{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:TX++}),this.uuid=Ii(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return this.index=Array.isArray(e)?new(g1(e)?I1:R1)(e,1):e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,i=0){this.groups.push({start:e,count:t,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const i=this.attributes.normal;if(void 0!==i){const s=(new ft).getNormalMatrix(e);i.applyNormalMatrix(s),i.needsUpdate=!0}const r=this.attributes.tangent;return void 0!==r&&(r.transformDirection(e),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return Wi.makeRotationFromQuaternion(e),this.applyMatrix4(Wi),this}rotateX(e){return Wi.makeRotationX(e),this.applyMatrix4(Wi),this}rotateY(e){return Wi.makeRotationY(e),this.applyMatrix4(Wi),this}rotateZ(e){return Wi.makeRotationZ(e),this.applyMatrix4(Wi),this}translate(e,t,i){return Wi.makeTranslation(e,t,i),this.applyMatrix4(Wi),this}scale(e,t,i){return Wi.makeScale(e,t,i),this.applyMatrix4(Wi),this}lookAt(e){return F0.lookAt(e),F0.updateMatrix(),this.applyMatrix4(F0.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Al).negate(),this.translate(Al.x,Al.y,Al.z),this}setFromPoints(e){const t=[];for(let i=0,r=e.length;i<r;i++){const s=e[i];t.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new Ne(t,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new Nr);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new T(-1/0,-1/0,-1/0),new T(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let i=0,r=t.length;i<r;i++)Ni.setFromBufferAttribute(t[i]),this.morphTargetsRelative?(In.addVectors(this.boundingBox.min,Ni.min),this.boundingBox.expandByPoint(In),In.addVectors(this.boundingBox.max,Ni.max),this.boundingBox.expandByPoint(In)):(this.boundingBox.expandByPoint(Ni.min),this.boundingBox.expandByPoint(Ni.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new ar);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new T,1/0);if(e){const i=this.boundingSphere.center;if(Ni.setFromBufferAttribute(e),t)for(let s=0,o=t.length;s<o;s++)Bu.setFromBufferAttribute(t[s]),this.morphTargetsRelative?(In.addVectors(Ni.min,Bu.min),Ni.expandByPoint(In),In.addVectors(Ni.max,Bu.max),Ni.expandByPoint(In)):(Ni.expandByPoint(Bu.min),Ni.expandByPoint(Bu.max));Ni.getCenter(i);let r=0;for(let s=0,o=e.count;s<o;s++)In.fromBufferAttribute(e,s),r=Math.max(r,i.distanceToSquared(In));if(t)for(let s=0,o=t.length;s<o;s++){const a=t[s],l=this.morphTargetsRelative;for(let c=0,u=a.count;c<u;c++)In.fromBufferAttribute(a,c),l&&(Al.fromBufferAttribute(e,c),In.add(Al)),r=Math.max(r,i.distanceToSquared(In))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const i=e.array,r=t.position.array,s=t.normal.array,o=t.uv.array,a=r.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new Gt(new Float32Array(4*a),4));const l=this.getAttribute("tangent").array,c=[],u=[];for(let E=0;E<a;E++)c[E]=new T,u[E]=new T;const d=new T,h=new T,f=new T,p=new K,_=new K,g=new K,m=new T,v=new T;function y(E,B,Y){d.fromArray(r,3*E),h.fromArray(r,3*B),f.fromArray(r,3*Y),p.fromArray(o,2*E),_.fromArray(o,2*B),g.fromArray(o,2*Y),h.sub(d),f.sub(d),_.sub(p),g.sub(p);const N=1/(_.x*g.y-g.x*_.y);isFinite(N)&&(m.copy(h).multiplyScalar(g.y).addScaledVector(f,-_.y).multiplyScalar(N),v.copy(f).multiplyScalar(_.x).addScaledVector(h,-g.x).multiplyScalar(N),c[E].add(m),c[B].add(m),c[Y].add(m),u[E].add(v),u[B].add(v),u[Y].add(v))}let b=this.groups;0===b.length&&(b=[{start:0,count:i.length}]);for(let E=0,B=b.length;E<B;++E){const Y=b[E],N=Y.start;for(let H=N,ne=N+Y.count;H<ne;H+=3)y(i[H+0],i[H+1],i[H+2])}const w=new T,S=new T,C=new T,I=new T;function x(E){C.fromArray(s,3*E),I.copy(C);const B=c[E];w.copy(B),w.sub(C.multiplyScalar(C.dot(B))).normalize(),S.crossVectors(I,B);const N=S.dot(u[E])<0?-1:1;l[4*E]=w.x,l[4*E+1]=w.y,l[4*E+2]=w.z,l[4*E+3]=N}for(let E=0,B=b.length;E<B;++E){const Y=b[E],N=Y.start;for(let H=N,ne=N+Y.count;H<ne;H+=3)x(i[H+0]),x(i[H+1]),x(i[H+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let i=this.getAttribute("normal");if(void 0===i)i=new Gt(new Float32Array(3*t.count),3),this.setAttribute("normal",i);else for(let h=0,f=i.count;h<f;h++)i.setXYZ(h,0,0,0);const r=new T,s=new T,o=new T,a=new T,l=new T,c=new T,u=new T,d=new T;if(e)for(let h=0,f=e.count;h<f;h+=3){const p=e.getX(h+0),_=e.getX(h+1),g=e.getX(h+2);r.fromBufferAttribute(t,p),s.fromBufferAttribute(t,_),o.fromBufferAttribute(t,g),u.subVectors(o,s),d.subVectors(r,s),u.cross(d),a.fromBufferAttribute(i,p),l.fromBufferAttribute(i,_),c.fromBufferAttribute(i,g),a.add(u),l.add(u),c.add(u),i.setXYZ(p,a.x,a.y,a.z),i.setXYZ(_,l.x,l.y,l.z),i.setXYZ(g,c.x,c.y,c.z)}else for(let h=0,f=t.count;h<f;h+=3)r.fromBufferAttribute(t,h+0),s.fromBufferAttribute(t,h+1),o.fromBufferAttribute(t,h+2),u.subVectors(o,s),d.subVectors(r,s),u.cross(d),i.setXYZ(h+0,u.x,u.y,u.z),i.setXYZ(h+1,u.x,u.y,u.z),i.setXYZ(h+2,u.x,u.y,u.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,i=e.count;t<i;t++)In.fromBufferAttribute(e,t),In.normalize(),e.setXYZ(t,In.x,In.y,In.z)}toNonIndexed(){function e(a,l){const c=a.array,u=a.itemSize,d=a.normalized,h=new c.constructor(l.length*u);let f=0,p=0;for(let _=0,g=l.length;_<g;_++){f=a.isInterleavedBufferAttribute?l[_]*a.data.stride+a.offset:l[_]*u;for(let m=0;m<u;m++)h[p++]=c[f++]}return new Gt(h,u,d)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new pt,i=this.index.array,r=this.attributes;for(const a in r){const c=e(r[a],i);t.setAttribute(a,c)}const s=this.morphAttributes;for(const a in s){const l=[],c=s[a];for(let u=0,d=c.length;u<d;u++){const f=e(c[u],i);l.push(f)}t.morphAttributes[a]=l}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,l=o.length;a<l;a++){const c=o[a];t.addGroup(c.start,c.count,c.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const l=this.parameters;for(const c in l)void 0!==l[c]&&(e[c]=l[c]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const i=this.attributes;for(const l in i)e.data.attributes[l]=i[l].toJSON(e.data);const r={};let s=!1;for(const l in this.morphAttributes){const c=this.morphAttributes[l],u=[];for(let d=0,h=c.length;d<h;d++)u.push(c[d].toJSON(e.data));u.length>0&&(r[l]=u,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return null!==a&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const i=e.index;null!==i&&this.setIndex(i.clone(t));const r=e.attributes;for(const c in r)this.setAttribute(c,r[c].clone(t));const s=e.morphAttributes;for(const c in s){const u=[],d=s[c];for(let h=0,f=d.length;h<f;h++)u.push(d[h].clone(t));this.morphAttributes[c]=u}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let c=0,u=o.length;c<u;c++){const d=o[c];this.addGroup(d.start,d.count,d.materialIndex)}const a=e.boundingBox;null!==a&&(this.boundingBox=a.clone());const l=e.boundingSphere;return null!==l&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const P1=new et,Lo=new Fu,Sp=new ar,L1=new T,Cl=new T,Tl=new T,Dl=new T,k0=new T,Mp=new T,Ep=new K,Ap=new K,Cp=new K,O1=new T,N1=new T,F1=new T,Tp=new T,Dp=new T;class Pn extends Rn{constructor(e=new pt,t=new bi){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}getVertexPosition(e,t){const i=this.geometry,s=i.morphAttributes.position,o=i.morphTargetsRelative;t.fromBufferAttribute(i.attributes.position,e);const a=this.morphTargetInfluences;if(s&&a){Mp.set(0,0,0);for(let l=0,c=s.length;l<c;l++){const u=a[l];0!==u&&(k0.fromBufferAttribute(s[l],e),Mp.addScaledVector(o?k0:k0.sub(t),u))}t.add(Mp)}return t}raycast(e,t){const i=this.geometry,s=this.matrixWorld;void 0!==this.material&&(null===i.boundingSphere&&i.computeBoundingSphere(),Sp.copy(i.boundingSphere),Sp.applyMatrix4(s),Lo.copy(e.ray).recast(e.near),(!1!==Sp.containsPoint(Lo.origin)||!(null===Lo.intersectSphere(Sp,L1)||Lo.origin.distanceToSquared(L1)>(e.far-e.near)**2))&&(P1.copy(s).invert(),Lo.copy(e.ray).applyMatrix4(P1),(null===i.boundingBox||!1!==Lo.intersectsBox(i.boundingBox))&&this._computeIntersections(e,t,Lo)))}_computeIntersections(e,t,i){let r;const s=this.geometry,o=this.material,a=s.index,l=s.attributes.position,c=s.attributes.uv,u=s.attributes.uv1,d=s.attributes.normal,h=s.groups,f=s.drawRange;if(null!==a)if(Array.isArray(o))for(let p=0,_=h.length;p<_;p++){const g=h[p],m=o[g.materialIndex];for(let b=Math.max(g.start,f.start),w=Math.min(a.count,Math.min(g.start+g.count,f.start+f.count));b<w;b+=3)r=Rp(this,m,e,i,c,u,d,a.getX(b),a.getX(b+1),a.getX(b+2)),r&&(r.faceIndex=Math.floor(b/3),r.face.materialIndex=g.materialIndex,t.push(r))}else for(let g=Math.max(0,f.start),m=Math.min(a.count,f.start+f.count);g<m;g+=3)r=Rp(this,o,e,i,c,u,d,a.getX(g),a.getX(g+1),a.getX(g+2)),r&&(r.faceIndex=Math.floor(g/3),t.push(r));else if(void 0!==l)if(Array.isArray(o))for(let p=0,_=h.length;p<_;p++){const g=h[p],m=o[g.materialIndex];for(let b=Math.max(g.start,f.start),w=Math.min(l.count,Math.min(g.start+g.count,f.start+f.count));b<w;b+=3)r=Rp(this,m,e,i,c,u,d,b,b+1,b+2),r&&(r.faceIndex=Math.floor(b/3),r.face.materialIndex=g.materialIndex,t.push(r))}else for(let g=Math.max(0,f.start),m=Math.min(l.count,f.start+f.count);g<m;g+=3)r=Rp(this,o,e,i,c,u,d,g,g+1,g+2),r&&(r.faceIndex=Math.floor(g/3),t.push(r))}}function Rp(n,e,t,i,r,s,o,a,l,c){n.getVertexPosition(a,Cl),n.getVertexPosition(l,Tl),n.getVertexPosition(c,Dl);const u=function DX(n,e,t,i,r,s,o,a){let l;if(l=1===e.side?i.intersectTriangle(o,s,r,!0,a):i.intersectTriangle(r,s,o,0===e.side,a),null===l)return null;Dp.copy(a),Dp.applyMatrix4(n.matrixWorld);const c=t.ray.origin.distanceTo(Dp);return c<t.near||c>t.far?null:{distance:c,point:Dp.clone(),object:n}}(n,e,t,i,Cl,Tl,Dl,Tp);if(u){r&&(Ep.fromBufferAttribute(r,a),Ap.fromBufferAttribute(r,l),Cp.fromBufferAttribute(r,c),u.uv=Oi.getInterpolation(Tp,Cl,Tl,Dl,Ep,Ap,Cp,new K)),s&&(Ep.fromBufferAttribute(s,a),Ap.fromBufferAttribute(s,l),Cp.fromBufferAttribute(s,c),u.uv1=Oi.getInterpolation(Tp,Cl,Tl,Dl,Ep,Ap,Cp,new K),u.uv2=u.uv1),o&&(O1.fromBufferAttribute(o,a),N1.fromBufferAttribute(o,l),F1.fromBufferAttribute(o,c),u.normal=Oi.getInterpolation(Tp,Cl,Tl,Dl,O1,N1,F1,new T),u.normal.dot(i.direction)>0&&u.normal.multiplyScalar(-1));const d={a,b:l,c,normal:new T,materialIndex:0};Oi.getNormal(Cl,Tl,Dl,d.normal),u.face=d}return u}class Rl extends pt{constructor(e=1,t=1,i=1,r=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:r,heightSegments:s,depthSegments:o};const a=this;r=Math.floor(r),s=Math.floor(s),o=Math.floor(o);const l=[],c=[],u=[],d=[];let h=0,f=0;function p(_,g,m,v,y,b,w,S,C,I,x){const E=b/C,B=w/I,Y=b/2,N=w/2,F=S/2,H=C+1,ne=I+1;let X=0,Q=0;const re=new T;for(let ae=0;ae<ne;ae++){const U=ae*B-N;for(let J=0;J<H;J++)re[_]=(J*E-Y)*v,re[g]=U*y,re[m]=F,c.push(re.x,re.y,re.z),re[_]=0,re[g]=0,re[m]=S>0?1:-1,u.push(re.x,re.y,re.z),d.push(J/C),d.push(1-ae/I),X+=1}for(let ae=0;ae<I;ae++)for(let U=0;U<C;U++){const fe=h+U+H*(ae+1),me=h+(U+1)+H*(ae+1),ve=h+(U+1)+H*ae;l.push(h+U+H*ae,fe,ve),l.push(fe,me,ve),Q+=6}a.addGroup(f,Q,x),f+=Q,h+=X}p("z","y","x",-1,-1,i,t,e,o,s,0),p("z","y","x",1,-1,i,t,-e,o,s,1),p("x","z","y",1,1,e,i,t,r,o,2),p("x","z","y",1,-1,e,i,-t,r,o,3),p("x","y","z",1,-1,e,t,i,r,s,4),p("x","y","z",-1,-1,e,t,-i,r,s,5),this.setIndex(l),this.setAttribute("position",new Ne(c,3)),this.setAttribute("normal",new Ne(u,3)),this.setAttribute("uv",new Ne(d,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Rl(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Il(n){const e={};for(const t in n){e[t]={};for(const i in n[t]){const r=n[t][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][i]=null):e[t][i]=r.clone():e[t][i]=Array.isArray(r)?r.slice():r}}return e}function ti(n){const e={};for(let t=0;t<n.length;t++){const i=Il(n[t]);for(const r in i)e[r]=i[r]}return e}function k1(n){return null===n.getRenderTarget()?n.outputColorSpace:rr}const IX={clone:Il,merge:ti};class Hs extends ur{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Il(e.uniforms),this.uniformsGroups=function RX(n){const e=[];for(let t=0;t<n.length;t++)e.push(n[t].clone());return e}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const o=this.uniforms[r].value;t.uniforms[r]=o&&o.isTexture?{type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?{type:"c",value:o.getHex()}:o&&o.isVector2?{type:"v2",value:o.toArray()}:o&&o.isVector3?{type:"v3",value:o.toArray()}:o&&o.isVector4?{type:"v4",value:o.toArray()}:o&&o.isMatrix3?{type:"m3",value:o.toArray()}:o&&o.isMatrix4?{type:"m4",value:o.toArray()}:{value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const i={};for(const r in this.extensions)!0===this.extensions[r]&&(i[r]=!0);return Object.keys(i).length>0&&(t.extensions=i),t}}class U0 extends Rn{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new et,this.projectionMatrix=new et,this.projectionMatrixInverse=new et,this.coordinateSystem=us}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}class hn extends U0{constructor(e=50,t=1,i=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*fl*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*Do*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*fl*Math.atan(Math.tan(.5*Do*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,i,r,s,o){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*Do*this.fov)/this.zoom,i=2*t,r=this.aspect*i,s=-.5*r;const o=this.view;if(null!==this.view&&this.view.enabled){const l=o.fullWidth,c=o.fullHeight;s+=o.offsetX*r/l,t-=o.offsetY*i/c,r*=o.width/l,i*=o.height/c}const a=this.filmOffset;0!==a&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,t,t-i,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}class OX extends Rn{constructor(e,t,i){super(),this.type="CubeCamera",this.renderTarget=i,this.coordinateSystem=null;const r=new hn(-90,1,e,t);r.layers=this.layers,this.add(r);const s=new hn(-90,1,e,t);s.layers=this.layers,this.add(s);const o=new hn(-90,1,e,t);o.layers=this.layers,this.add(o);const a=new hn(-90,1,e,t);a.layers=this.layers,this.add(a);const l=new hn(-90,1,e,t);l.layers=this.layers,this.add(l);const c=new hn(-90,1,e,t);c.layers=this.layers,this.add(c)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[i,r,s,o,a,l]=t;for(const c of t)this.remove(c);if(e===us)i.up.set(0,1,0),i.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),a.up.set(0,1,0),a.lookAt(0,0,1),l.up.set(0,1,0),l.lookAt(0,0,-1);else{if(2001!==e)throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);i.up.set(0,-1,0),i.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),a.up.set(0,-1,0),a.lookAt(0,0,1),l.up.set(0,-1,0),l.lookAt(0,0,-1)}for(const c of t)this.add(c),c.updateMatrixWorld()}update(e,t){null===this.parent&&this.updateMatrixWorld();const i=this.renderTarget;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[r,s,o,a,l,c]=this.children,u=e.getRenderTarget(),d=e.toneMapping,h=e.xr.enabled;e.toneMapping=as,e.xr.enabled=!1;const f=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0),e.render(t,r),e.setRenderTarget(i,1),e.render(t,s),e.setRenderTarget(i,2),e.render(t,o),e.setRenderTarget(i,3),e.render(t,a),e.setRenderTarget(i,4),e.render(t,l),i.texture.generateMipmaps=f,e.setRenderTarget(i,5),e.render(t,c),e.setRenderTarget(u),e.toneMapping=d,e.xr.enabled=h,i.texture.needsPMREMUpdate=!0}}class Ip extends or{constructor(e,t,i,r,s,o,a,l,c,u){super(e=void 0!==e?e:[],t=void 0!==t?t:wo,i,r,s,o,a,l,c,u),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class NX extends Ro{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const i={width:e,height:e,depth:1},r=[i,i,i,i,i,i];void 0!==t.encoding&&(Lu("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),t.colorSpace=t.encoding===Ao?Ze:""),this.texture=new Ip(r,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:Qt}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const i_uniforms={tEquirect:{value:null}},i_vertexShader="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",i_fragmentShader="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",r=new Rl(5,5,5),s=new Hs({name:"CubemapFromEquirect",uniforms:Il(i_uniforms),vertexShader:i_vertexShader,fragmentShader:i_fragmentShader,side:1,blending:0});s.uniforms.tEquirect.value=t;const o=new Pn(r,s),a=t.minFilter;return t.minFilter===ls&&(t.minFilter=Qt),new OX(1,10,this).update(e,o),t.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,i,r){const s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,i,r);e.setRenderTarget(s)}}const B0=new T,FX=new T,kX=new ft;class Oo{constructor(e=new T(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,i,r){return this.normal.set(e,t,i),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,i){const r=B0.subVectors(i,t).cross(FX.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const i=e.delta(B0),r=this.normal.dot(i);if(0===r)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:t.copy(e.start).addScaledVector(i,s)}intersectsLine(e){const t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const i=t||kX.getNormalMatrix(e),r=this.coplanarPoint(B0).applyMatrix4(e),s=this.normal.applyMatrix3(i).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const No=new ar,Pp=new T;class V0{constructor(e=new Oo,t=new Oo,i=new Oo,r=new Oo,s=new Oo,o=new Oo){this.planes=[e,t,i,r,s,o]}set(e,t,i,r,s,o){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(i),a[3].copy(r),a[4].copy(s),a[5].copy(o),this}copy(e){const t=this.planes;for(let i=0;i<6;i++)t[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e,t=us){const i=this.planes,r=e.elements,s=r[0],o=r[1],a=r[2],l=r[3],c=r[4],u=r[5],d=r[6],h=r[7],f=r[8],p=r[9],_=r[10],g=r[11],m=r[12],v=r[13],y=r[14],b=r[15];if(i[0].setComponents(l-s,h-c,g-f,b-m).normalize(),i[1].setComponents(l+s,h+c,g+f,b+m).normalize(),i[2].setComponents(l+o,h+u,g+p,b+v).normalize(),i[3].setComponents(l-o,h-u,g-p,b-v).normalize(),i[4].setComponents(l-a,h-d,g-_,b-y).normalize(),t===us)i[5].setComponents(l+a,h+d,g+_,b+y).normalize();else{if(2001!==t)throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);i[5].setComponents(a,d,_,y).normalize()}return this}intersectsObject(e){if(void 0!==e.boundingSphere)null===e.boundingSphere&&e.computeBoundingSphere(),No.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;null===t.boundingSphere&&t.computeBoundingSphere(),No.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(No)}intersectsSprite(e){return No.center.set(0,0,0),No.radius=.7071067811865476,No.applyMatrix4(e.matrixWorld),this.intersectsSphere(No)}intersectsSphere(e){const t=this.planes,i=e.center,r=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(i)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let i=0;i<6;i++){const r=t[i];if(Pp.x=r.normal.x>0?e.max.x:e.min.x,Pp.y=r.normal.y>0?e.max.y:e.min.y,Pp.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(Pp)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function U1(){let n=null,e=!1,t=null,i=null;function r(s,o){t(s,o),i=n.requestAnimationFrame(r)}return{start:function(){!0!==e&&null!==t&&(i=n.requestAnimationFrame(r),e=!0)},stop:function(){n.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){n=s}}}function UX(n,e){const t=e.isWebGL2,i=new WeakMap;return{get:function o(c){return c.isInterleavedBufferAttribute&&(c=c.data),i.get(c)},remove:function a(c){c.isInterleavedBufferAttribute&&(c=c.data);const u=i.get(c);u&&(n.deleteBuffer(u.buffer),i.delete(c))},update:function l(c,u){if(c.isGLBufferAttribute){const h=i.get(c);return void((!h||h.version<c.version)&&i.set(c,{buffer:c.buffer,type:c.type,bytesPerElement:c.elementSize,version:c.version}))}c.isInterleavedBufferAttribute&&(c=c.data);const d=i.get(c);void 0===d?i.set(c,function r(c,u){const d=c.array,h=c.usage,f=n.createBuffer();let p;if(n.bindBuffer(u,f),n.bufferData(u,d,h),c.onUploadCallback(),d instanceof Float32Array)p=n.FLOAT;else if(d instanceof Uint16Array)if(c.isFloat16BufferAttribute){if(!t)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");p=n.HALF_FLOAT}else p=n.UNSIGNED_SHORT;else if(d instanceof Int16Array)p=n.SHORT;else if(d instanceof Uint32Array)p=n.UNSIGNED_INT;else if(d instanceof Int32Array)p=n.INT;else if(d instanceof Int8Array)p=n.BYTE;else if(d instanceof Uint8Array)p=n.UNSIGNED_BYTE;else{if(!(d instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+d);p=n.UNSIGNED_BYTE}return{buffer:f,type:p,bytesPerElement:d.BYTES_PER_ELEMENT,version:c.version}}(c,u)):d.version<c.version&&(function s(c,u,d){const h=u.array,f=u.updateRange;n.bindBuffer(d,c),-1===f.count?n.bufferSubData(d,0,h):(t?n.bufferSubData(d,f.offset*h.BYTES_PER_ELEMENT,h,f.offset,f.count):n.bufferSubData(d,f.offset*h.BYTES_PER_ELEMENT,h.subarray(f.offset,f.offset+f.count)),f.count=-1),u.onUploadCallback()}(d.buffer,c,u),d.version=c.version)}}}class Lp extends pt{constructor(e=1,t=1,i=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:r};const s=e/2,o=t/2,a=Math.floor(i),l=Math.floor(r),c=a+1,u=l+1,d=e/a,h=t/l,f=[],p=[],_=[],g=[];for(let m=0;m<u;m++){const v=m*h-o;for(let y=0;y<c;y++)p.push(y*d-s,-v,0),_.push(0,0,1),g.push(y/a),g.push(1-m/l)}for(let m=0;m<l;m++)for(let v=0;v<a;v++){const b=v+c*(m+1),w=v+1+c*(m+1),S=v+1+c*m;f.push(v+c*m,b,S),f.push(b,w,S)}this.setIndex(f),this.setAttribute("position",new Ne(p,3)),this.setAttribute("normal",new Ne(_,3)),this.setAttribute("uv",new Ne(g,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Lp(e.width,e.height,e.widthSegments,e.heightSegments)}}const dt={alphahash_fragment:"#ifdef USE_ALPHAHASH\n\tif ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;\n#endif",alphahash_pars_fragment:"#ifdef USE_ALPHAHASH\n\tconst float ALPHA_HASH_SCALE = 0.05;\n\tfloat hash2D( vec2 value ) {\n\t\treturn fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );\n\t}\n\tfloat hash3D( vec3 value ) {\n\t\treturn hash2D( vec2( hash2D( value.xy ), value.z ) );\n\t}\n\tfloat getAlphaHashThreshold( vec3 position ) {\n\t\tfloat maxDeriv = max(\n\t\t\tlength( dFdx( position.xyz ) ),\n\t\t\tlength( dFdy( position.xyz ) )\n\t\t);\n\t\tfloat pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );\n\t\tvec2 pixScales = vec2(\n\t\t\texp2( floor( log2( pixScale ) ) ),\n\t\t\texp2( ceil( log2( pixScale ) ) )\n\t\t);\n\t\tvec2 alpha = vec2(\n\t\t\thash3D( floor( pixScales.x * position.xyz ) ),\n\t\t\thash3D( floor( pixScales.y * position.xyz ) )\n\t\t);\n\t\tfloat lerpFactor = fract( log2( pixScale ) );\n\t\tfloat x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;\n\t\tfloat a = min( lerpFactor, 1.0 - lerpFactor );\n\t\tvec3 cases = vec3(\n\t\t\tx * x / ( 2.0 * a * ( 1.0 - a ) ),\n\t\t\t( x - 0.5 * a ) / ( 1.0 - a ),\n\t\t\t1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )\n\t\t);\n\t\tfloat threshold = ( x < ( 1.0 - a ) )\n\t\t\t? ( ( x < a ) ? cases.x : cases.y )\n\t\t\t: cases.z;\n\t\treturn clamp( threshold , 1.0e-6, 1.0 );\n\t}\n#endif",alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );\n#ifdef USE_ALPHAHASH\n\tvPosition = vec3( position );\n#endif",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n} // validated",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\t return vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat R21 = R12;\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vBumpMapUv );\n\t\tvec2 dSTdy = dFdy( vBumpMapUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = dFdx( surf_pos.xyz );\n\t\tvec3 vSigmaY = dFdy( surf_pos.xyz );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\n#ifdef USE_ALPHAHASH\n\tvarying vec3 vPosition;\n#endif\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat luminance( const in vec3 rgb ) {\n\tconst vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );\n\treturn dot( weights, rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_v0 0.339\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_v1 0.276\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_v4 0.046\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_v5 0.016\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_v6 0.0038\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",colorspace_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment:"vec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#ifdef USE_ENVMAP\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\t#ifdef USE_ANISOTROPY\n\t\tvec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {\n\t\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\t\tvec3 bentNormal = cross( bitangent, viewDir );\n\t\t\t\tbentNormal = normalize( cross( bentNormal, bitangent ) );\n\t\t\t\tbentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );\n\t\t\t\treturn getIBLRadiance( viewDir, bentNormal, roughness );\n\t\t\t#else\n\t\t\t\treturn vec3( 0.0 );\n\t\t\t#endif\n\t\t}\n\t#endif\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( LEGACY_LIGHTS )\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#else\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef USE_SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULAR_COLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n\t\t#endif\n\t\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\t#ifdef USE_ANISOTROPYMAP\n\t\tmat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );\n\t\tvec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;\n\t\tvec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;\n\t#else\n\t\tvec2 anisotropyV = anisotropyVector;\n\t#endif\n\tmaterial.anisotropy = length( anisotropyV );\n\tanisotropyV /= material.anisotropy;\n\tmaterial.anisotropy = saturate( material.anisotropy );\n\tmaterial.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );\n\tmaterial.anisotropyT = tbn[ 0 ] * anisotropyV.x - tbn[ 1 ] * anisotropyV.y;\n\tmaterial.anisotropyB = tbn[ 1 ] * anisotropyV.x + tbn[ 0 ] * anisotropyV.y;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat anisotropy;\n\t\tfloat alphaT;\n\t\tvec3 anisotropyT;\n\t\tvec3 anisotropyB;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n\tfloat V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n\t\tfloat gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n\t\tfloat gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n\t\tfloat v = 0.5 / ( gv + gl );\n\t\treturn saturate(v);\n\t}\n\tfloat D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n\t\tfloat a2 = alphaT * alphaB;\n\t\thighp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n\t\thighp float v2 = dot( v, v );\n\t\tfloat w2 = a2 / v2;\n\t\treturn RECIPROCAL_PI * a2 * pow2 ( w2 );\n\t}\n#endif\n#ifdef USE_CLEARCOAT\n\tvec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n\t\tvec3 f0 = material.clearcoatF0;\n\t\tfloat f90 = material.clearcoatF90;\n\t\tfloat roughness = material.clearcoatRoughness;\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 f0 = material.specularColor;\n\tfloat f90 = material.specularF90;\n\tfloat roughness = material.roughness;\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t#ifdef USE_IRIDESCENCE\n\t\tF = mix( F, material.iridescenceFresnel, material.iridescence );\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat dotTL = dot( material.anisotropyT, lightDir );\n\t\tfloat dotTV = dot( material.anisotropyT, viewDir );\n\t\tfloat dotTH = dot( material.anisotropyT, halfDir );\n\t\tfloat dotBL = dot( material.anisotropyB, lightDir );\n\t\tfloat dotBV = dot( material.anisotropyB, viewDir );\n\t\tfloat dotBH = dot( material.anisotropyB, halfDir );\n\t\tfloat V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n\t\tfloat D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n\t#else\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t#endif\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometry.viewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\t#ifdef USE_ANISOTROPY\n\t\tradiance += getIBLAnisotropyRadiance( geometry.viewDir, geometry.normal, material.roughness, material.anisotropyB, material.anisotropy );\n\t#else\n\t\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, vMapUv );\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t#if defined( USE_POINTS_UV )\n\t\tvec2 uv = vUv;\n\t#else\n\t\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n\tvarying vec2 vUv;\n#else\n\t#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t\tuniform mat3 uvTransform;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal *= faceDirection;\n\t#endif\n#endif\n#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn = getTangentFrame( - vViewPosition, normal,\n\t\t#if defined( USE_NORMALMAP )\n\t\t\tvNormalMapUv\n\t\t#elif defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tvClearcoatNormalMapUv\n\t\t#else\n\t\t\tvUv\n\t\t#endif\n\t\t);\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn[0] *= faceDirection;\n\t\ttbn[1] *= faceDirection;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn2[0] *= faceDirection;\n\t\ttbn2[1] *= faceDirection;\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n\tnormal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n\tvec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\tnormal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )\n\tmat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( uv.st );\n\t\tvec2 st1 = dFdy( uv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n\t\treturn mat3( T * scale, B * scale, N );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\tclearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",opaque_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec2 packDepthToRG( in highp float v ) {\n\treturn packDepthToRGBA( v ).yx;\n}\nfloat unpackRGToDepth( const in highp vec2 v ) {\n\treturn unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * depth - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tuniform int boneTextureSize;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tfloat j = i * 4.0;\n\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\ty = dy * ( y + 0.5 );\n\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\treturn bone;\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn saturate( toneMappingExposure * color );\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmitted = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn vec3( 1.0 );\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 attenuatedColor = transmittance * transmittedLight.rgb;\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\tfloat transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n\t}\n#endif",uv_pars_fragment:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_pars_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tuniform mat3 mapTransform;\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform mat3 alphaMapTransform;\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tuniform mat3 lightMapTransform;\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tuniform mat3 aoMapTransform;\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tuniform mat3 bumpMapTransform;\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tuniform mat3 normalMapTransform;\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tuniform mat3 displacementMapTransform;\n\tvarying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tuniform mat3 emissiveMapTransform;\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tuniform mat3 metalnessMapTransform;\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tuniform mat3 roughnessMapTransform;\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tuniform mat3 anisotropyMapTransform;\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tuniform mat3 clearcoatMapTransform;\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform mat3 clearcoatNormalMapTransform;\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform mat3 clearcoatRoughnessMapTransform;\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tuniform mat3 sheenColorMapTransform;\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tuniform mat3 sheenRoughnessMapTransform;\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tuniform mat3 iridescenceMapTransform;\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform mat3 iridescenceThicknessMapTransform;\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tuniform mat3 specularMapTransform;\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tuniform mat3 specularColorMapTransform;\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tuniform mat3 specularIntensityMapTransform;\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n\tvMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n\tvAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n\tvLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n\tvAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n\tvBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n\tvNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tvDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n\tvMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n\tvSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tvTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n\tvThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef USE_SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULAR_COLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\tuniform vec2 anisotropyVector;\n\t#ifdef USE_ANISOTROPYMAP\n\t\tuniform sampler2D anisotropyMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\nvoid main() {\n\t#ifdef USE_POINTS_UV\n\t\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\t#endif\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}"},ye={common:{diffuse:{value:new be(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new ft},alphaMap:{value:null},alphaMapTransform:{value:new ft},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new ft}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new ft}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new ft}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new ft},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new ft},normalScale:{value:new K(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new ft},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new ft}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new ft}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new ft}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new be(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new be(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new ft},alphaTest:{value:0},uvTransform:{value:new ft}},sprite:{diffuse:{value:new be(16777215)},opacity:{value:1},center:{value:new K(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new ft},alphaMap:{value:null},alphaMapTransform:{value:new ft},alphaTest:{value:0}}},Fr={basic:{uniforms:ti([ye.common,ye.specularmap,ye.envmap,ye.aomap,ye.lightmap,ye.fog]),vertexShader:dt.meshbasic_vert,fragmentShader:dt.meshbasic_frag},lambert:{uniforms:ti([ye.common,ye.specularmap,ye.envmap,ye.aomap,ye.lightmap,ye.emissivemap,ye.bumpmap,ye.normalmap,ye.displacementmap,ye.fog,ye.lights,{emissive:{value:new be(0)}}]),vertexShader:dt.meshlambert_vert,fragmentShader:dt.meshlambert_frag},phong:{uniforms:ti([ye.common,ye.specularmap,ye.envmap,ye.aomap,ye.lightmap,ye.emissivemap,ye.bumpmap,ye.normalmap,ye.displacementmap,ye.fog,ye.lights,{emissive:{value:new be(0)},specular:{value:new be(1118481)},shininess:{value:30}}]),vertexShader:dt.meshphong_vert,fragmentShader:dt.meshphong_frag},standard:{uniforms:ti([ye.common,ye.envmap,ye.aomap,ye.lightmap,ye.emissivemap,ye.bumpmap,ye.normalmap,ye.displacementmap,ye.roughnessmap,ye.metalnessmap,ye.fog,ye.lights,{emissive:{value:new be(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:dt.meshphysical_vert,fragmentShader:dt.meshphysical_frag},toon:{uniforms:ti([ye.common,ye.aomap,ye.lightmap,ye.emissivemap,ye.bumpmap,ye.normalmap,ye.displacementmap,ye.gradientmap,ye.fog,ye.lights,{emissive:{value:new be(0)}}]),vertexShader:dt.meshtoon_vert,fragmentShader:dt.meshtoon_frag},matcap:{uniforms:ti([ye.common,ye.bumpmap,ye.normalmap,ye.displacementmap,ye.fog,{matcap:{value:null}}]),vertexShader:dt.meshmatcap_vert,fragmentShader:dt.meshmatcap_frag},points:{uniforms:ti([ye.points,ye.fog]),vertexShader:dt.points_vert,fragmentShader:dt.points_frag},dashed:{uniforms:ti([ye.common,ye.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:dt.linedashed_vert,fragmentShader:dt.linedashed_frag},depth:{uniforms:ti([ye.common,ye.displacementmap]),vertexShader:dt.depth_vert,fragmentShader:dt.depth_frag},normal:{uniforms:ti([ye.common,ye.bumpmap,ye.normalmap,ye.displacementmap,{opacity:{value:1}}]),vertexShader:dt.meshnormal_vert,fragmentShader:dt.meshnormal_frag},sprite:{uniforms:ti([ye.sprite,ye.fog]),vertexShader:dt.sprite_vert,fragmentShader:dt.sprite_frag},background:{uniforms:{uvTransform:{value:new ft},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:dt.background_vert,fragmentShader:dt.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:dt.backgroundCube_vert,fragmentShader:dt.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:dt.cube_vert,fragmentShader:dt.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:dt.equirect_vert,fragmentShader:dt.equirect_frag},distanceRGBA:{uniforms:ti([ye.common,ye.displacementmap,{referencePosition:{value:new T},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:dt.distanceRGBA_vert,fragmentShader:dt.distanceRGBA_frag},shadow:{uniforms:ti([ye.lights,ye.fog,{color:{value:new be(0)},opacity:{value:1}}]),vertexShader:dt.shadow_vert,fragmentShader:dt.shadow_frag}};Fr.physical={uniforms:ti([Fr.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new ft},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new ft},clearcoatNormalScale:{value:new K(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new ft},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new ft},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new ft},sheen:{value:0},sheenColor:{value:new be(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new ft},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new ft},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new ft},transmissionSamplerSize:{value:new K},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new ft},attenuationDistance:{value:0},attenuationColor:{value:new be(0)},specularColor:{value:new be(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new ft},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new ft},anisotropyVector:{value:new K},anisotropyMap:{value:null},anisotropyMapTransform:{value:new ft}}]),vertexShader:dt.meshphysical_vert,fragmentShader:dt.meshphysical_frag};const Op={r:0,b:0,g:0};function F9(n,e,t,i,r,s,o){const a=new be(0);let c,u,l=!0===s?0:1,d=null,h=0,f=null;function _(g,m){g.getRGB(Op,k1(n)),i.buffers.color.setClear(Op.r,Op.g,Op.b,m,o)}return{getClearColor:function(){return a},setClearColor:function(g,m=1){a.set(g),l=m,_(a,l)},getClearAlpha:function(){return l},setClearAlpha:function(g){l=g,_(a,l)},render:function p(g,m){let v=!1,y=!0===m.isScene?m.background:null;switch(y&&y.isTexture&&(y=(m.backgroundBlurriness>0?t:e).get(y)),null===y?_(a,l):y&&y.isColor&&(_(y,1),v=!0),n.xr.getEnvironmentBlendMode()){case"opaque":v=!0;break;case"additive":i.buffers.color.setClear(0,0,0,1,o),v=!0;break;case"alpha-blend":i.buffers.color.setClear(0,0,0,0,o),v=!0}(n.autoClear||v)&&n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil),y&&(y.isCubeTexture||y.mapping===Au)?(void 0===u&&(u=new Pn(new Rl(1,1,1),new Hs({name:"BackgroundCubeMaterial",uniforms:Il(Fr.backgroundCube.uniforms),vertexShader:Fr.backgroundCube.vertexShader,fragmentShader:Fr.backgroundCube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),u.geometry.deleteAttribute("uv"),u.onBeforeRender=function(S,C,I){this.matrixWorld.copyPosition(I.matrixWorld)},Object.defineProperty(u.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(u)),u.material.uniforms.envMap.value=y,u.material.uniforms.flipEnvMap.value=y.isCubeTexture&&!1===y.isRenderTargetTexture?-1:1,u.material.uniforms.backgroundBlurriness.value=m.backgroundBlurriness,u.material.uniforms.backgroundIntensity.value=m.backgroundIntensity,u.material.toneMapped=y.colorSpace!==Ze,(d!==y||h!==y.version||f!==n.toneMapping)&&(u.material.needsUpdate=!0,d=y,h=y.version,f=n.toneMapping),u.layers.enableAll(),g.unshift(u,u.geometry,u.material,0,0,null)):y&&y.isTexture&&(void 0===c&&(c=new Pn(new Lp(2,2),new Hs({name:"BackgroundMaterial",uniforms:Il(Fr.background.uniforms),vertexShader:Fr.background.vertexShader,fragmentShader:Fr.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(c)),c.material.uniforms.t2D.value=y,c.material.uniforms.backgroundIntensity.value=m.backgroundIntensity,c.material.toneMapped=y.colorSpace!==Ze,!0===y.matrixAutoUpdate&&y.updateMatrix(),c.material.uniforms.uvTransform.value.copy(y.matrix),(d!==y||h!==y.version||f!==n.toneMapping)&&(c.material.needsUpdate=!0,d=y,h=y.version,f=n.toneMapping),c.layers.enableAll(),g.unshift(c,c.geometry,c.material,0,0,null))}}}function k9(n,e,t,i){const r=n.getParameter(n.MAX_VERTEX_ATTRIBS),s=i.isWebGL2?null:e.get("OES_vertex_array_object"),o=i.isWebGL2||null!==s,a={},l=g(null);let c=l,u=!1;function f(F){return i.isWebGL2?n.bindVertexArray(F):s.bindVertexArrayOES(F)}function p(F){return i.isWebGL2?n.deleteVertexArray(F):s.deleteVertexArrayOES(F)}function g(F){const H=[],ne=[],X=[];for(let Q=0;Q<r;Q++)H[Q]=0,ne[Q]=0,X[Q]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:H,enabledAttributes:ne,attributeDivisors:X,object:F,attributes:{},index:null}}function y(){const F=c.newAttributes;for(let H=0,ne=F.length;H<ne;H++)F[H]=0}function b(F){w(F,0)}function w(F,H){const X=c.enabledAttributes,Q=c.attributeDivisors;c.newAttributes[F]=1,0===X[F]&&(n.enableVertexAttribArray(F),X[F]=1),Q[F]!==H&&((i.isWebGL2?n:e.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](F,H),Q[F]=H)}function S(){const F=c.newAttributes,H=c.enabledAttributes;for(let ne=0,X=H.length;ne<X;ne++)H[ne]!==F[ne]&&(n.disableVertexAttribArray(ne),H[ne]=0)}function C(F,H,ne,X,Q,re,ae){!0===ae?n.vertexAttribIPointer(F,H,ne,Q,re):n.vertexAttribPointer(F,H,ne,X,Q,re)}function Y(){N(),u=!0,c!==l&&(c=l,f(c.object))}function N(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:function d(F,H,ne,X,Q){let re=!1;if(o){const ae=function _(F,H,ne){const X=!0===ne.wireframe;let Q=a[F.id];void 0===Q&&(Q={},a[F.id]=Q);let re=Q[H.id];void 0===re&&(re={},Q[H.id]=re);let ae=re[X];return void 0===ae&&(ae=g(function h(){return i.isWebGL2?n.createVertexArray():s.createVertexArrayOES()}()),re[X]=ae),ae}(X,ne,H);c!==ae&&(c=ae,f(c.object)),re=function m(F,H,ne,X){const Q=c.attributes,re=H.attributes;let ae=0;const U=ne.getAttributes();for(const J in U)if(U[J].location>=0){const me=Q[J];let ve=re[J];if(void 0===ve&&("instanceMatrix"===J&&F.instanceMatrix&&(ve=F.instanceMatrix),"instanceColor"===J&&F.instanceColor&&(ve=F.instanceColor)),void 0===me||me.attribute!==ve||ve&&me.data!==ve.data)return!0;ae++}return c.attributesNum!==ae||c.index!==X}(F,X,ne,Q),re&&function v(F,H,ne,X){const Q={},re=H.attributes;let ae=0;const U=ne.getAttributes();for(const J in U)if(U[J].location>=0){let me=re[J];void 0===me&&("instanceMatrix"===J&&F.instanceMatrix&&(me=F.instanceMatrix),"instanceColor"===J&&F.instanceColor&&(me=F.instanceColor));const ve={};ve.attribute=me,me&&me.data&&(ve.data=me.data),Q[J]=ve,ae++}c.attributes=Q,c.attributesNum=ae,c.index=X}(F,X,ne,Q)}else{const ae=!0===H.wireframe;(c.geometry!==X.id||c.program!==ne.id||c.wireframe!==ae)&&(c.geometry=X.id,c.program=ne.id,c.wireframe=ae,re=!0)}null!==Q&&t.update(Q,n.ELEMENT_ARRAY_BUFFER),(re||u)&&(u=!1,function I(F,H,ne,X){if(!1===i.isWebGL2&&(F.isInstancedMesh||X.isInstancedBufferGeometry)&&null===e.get("ANGLE_instanced_arrays"))return;y();const Q=X.attributes,re=ne.getAttributes(),ae=H.defaultAttributeValues;for(const U in re){const J=re[U];if(J.location>=0){let fe=Q[U];if(void 0===fe&&("instanceMatrix"===U&&F.instanceMatrix&&(fe=F.instanceMatrix),"instanceColor"===U&&F.instanceColor&&(fe=F.instanceColor)),void 0!==fe){const me=fe.normalized,ve=fe.itemSize,Te=t.get(fe);if(void 0===Te)continue;const Ue=Te.buffer,Fe=Te.type,yt=Te.bytesPerElement,St=!0===i.isWebGL2&&(Fe===n.INT||Fe===n.UNSIGNED_INT||1013===fe.gpuType);if(fe.isInterleavedBufferAttribute){const ze=fe.data,L=ze.stride,pe=fe.offset;if(ze.isInstancedInterleavedBuffer){for(let ee=0;ee<J.locationSize;ee++)w(J.location+ee,ze.meshPerAttribute);!0!==F.isInstancedMesh&&void 0===X._maxInstanceCount&&(X._maxInstanceCount=ze.meshPerAttribute*ze.count)}else for(let ee=0;ee<J.locationSize;ee++)b(J.location+ee);n.bindBuffer(n.ARRAY_BUFFER,Ue);for(let ee=0;ee<J.locationSize;ee++)C(J.location+ee,ve/J.locationSize,Fe,me,L*yt,(pe+ve/J.locationSize*ee)*yt,St)}else{if(fe.isInstancedBufferAttribute){for(let ze=0;ze<J.locationSize;ze++)w(J.location+ze,fe.meshPerAttribute);!0!==F.isInstancedMesh&&void 0===X._maxInstanceCount&&(X._maxInstanceCount=fe.meshPerAttribute*fe.count)}else for(let ze=0;ze<J.locationSize;ze++)b(J.location+ze);n.bindBuffer(n.ARRAY_BUFFER,Ue);for(let ze=0;ze<J.locationSize;ze++)C(J.location+ze,ve/J.locationSize,Fe,me,ve*yt,ve/J.locationSize*ze*yt,St)}}else if(void 0!==ae){const me=ae[U];if(void 0!==me)switch(me.length){case 2:n.vertexAttrib2fv(J.location,me);break;case 3:n.vertexAttrib3fv(J.location,me);break;case 4:n.vertexAttrib4fv(J.location,me);break;default:n.vertexAttrib1fv(J.location,me)}}}}S()}(F,H,ne,X),null!==Q&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t.get(Q).buffer))},reset:Y,resetDefaultState:N,dispose:function x(){Y();for(const F in a){const H=a[F];for(const ne in H){const X=H[ne];for(const Q in X)p(X[Q].object),delete X[Q];delete H[ne]}delete a[F]}},releaseStatesOfGeometry:function E(F){if(void 0===a[F.id])return;const H=a[F.id];for(const ne in H){const X=H[ne];for(const Q in X)p(X[Q].object),delete X[Q];delete H[ne]}delete a[F.id]},releaseStatesOfProgram:function B(F){for(const H in a){const ne=a[H];if(void 0===ne[F.id])continue;const X=ne[F.id];for(const Q in X)p(X[Q].object),delete X[Q];delete ne[F.id]}},initAttributes:y,enableAttribute:b,disableUnusedAttributes:S}}function U9(n,e,t,i){const r=i.isWebGL2;let s;this.setMode=function o(c){s=c},this.render=function a(c,u){n.drawArrays(s,c,u),t.update(u,s,1)},this.renderInstances=function l(c,u,d){if(0===d)return;let h,f;if(r)h=n,f="drawArraysInstanced";else if(h=e.get("ANGLE_instanced_arrays"),f="drawArraysInstancedANGLE",null===h)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");h[f](s,c,u,d),t.update(u,s,d)}}function B9(n,e,t){let i;function s(C){if("highp"===C){if(n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).precision>0)return"highp";C="mediump"}return"mediump"===C&&n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const o=typeof WebGL2RenderingContext<"u"&&"WebGL2RenderingContext"===n.constructor.name;let a=void 0!==t.precision?t.precision:"highp";const l=s(a);l!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",l,"instead."),a=l);const c=o||e.has("WEBGL_draw_buffers"),u=!0===t.logarithmicDepthBuffer,d=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS),h=n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS),f=n.getParameter(n.MAX_TEXTURE_SIZE),p=n.getParameter(n.MAX_CUBE_MAP_TEXTURE_SIZE),_=n.getParameter(n.MAX_VERTEX_ATTRIBS),g=n.getParameter(n.MAX_VERTEX_UNIFORM_VECTORS),m=n.getParameter(n.MAX_VARYING_VECTORS),v=n.getParameter(n.MAX_FRAGMENT_UNIFORM_VECTORS),y=h>0,b=o||e.has("OES_texture_float");return{isWebGL2:o,drawBuffers:c,getMaxAnisotropy:function r(){if(void 0!==i)return i;if(!0===e.has("EXT_texture_filter_anisotropic")){const C=e.get("EXT_texture_filter_anisotropic");i=n.getParameter(C.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i},getMaxPrecision:s,precision:a,logarithmicDepthBuffer:u,maxTextures:d,maxVertexTextures:h,maxTextureSize:f,maxCubemapSize:p,maxAttributes:_,maxVertexUniforms:g,maxVaryings:m,maxFragmentUniforms:v,vertexTextures:y,floatFragmentTextures:b,floatVertexTextures:y&&b,maxSamples:o?n.getParameter(n.MAX_SAMPLES):0}}function V9(n){const e=this;let t=null,i=0,r=!1,s=!1;const o=new Oo,a=new ft,l={value:null,needsUpdate:!1};function u(d,h,f,p){const _=null!==d?d.length:0;let g=null;if(0!==_){if(g=l.value,!0!==p||null===g){const m=f+4*_,v=h.matrixWorldInverse;a.getNormalMatrix(v),(null===g||g.length<m)&&(g=new Float32Array(m));for(let y=0,b=f;y!==_;++y,b+=4)o.copy(d[y]).applyMatrix4(v,a),o.normal.toArray(g,b),g[b+3]=o.constant}l.value=g,l.needsUpdate=!0}return e.numPlanes=_,e.numIntersection=0,g}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(d,h){const f=0!==d.length||h||0!==i||r;return r=h,i=d.length,f},this.beginShadows=function(){s=!0,u(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(d,h){t=u(d,h,0)},this.setState=function(d,h,f){const p=d.clippingPlanes,_=d.clipIntersection,g=d.clipShadows,m=n.get(d);if(!r||null===p||0===p.length||s&&!g)s?u(null):function c(){l.value!==t&&(l.value=t,l.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}();else{const v=s?0:i,y=4*v;let b=m.clippingState||null;l.value=b,b=u(p,h,y,f);for(let w=0;w!==y;++w)b[w]=t[w];m.clippingState=b,this.numIntersection=_?this.numPlanes:0,this.numPlanes+=v}}}function H9(n){let e=new WeakMap;function t(o,a){return 303===a?o.mapping=wo:304===a&&(o.mapping=xo),o}function r(o){const a=o.target;a.removeEventListener("dispose",r);const l=e.get(a);void 0!==l&&(e.delete(a),l.dispose())}return{get:function i(o){if(o&&o.isTexture&&!1===o.isRenderTargetTexture){const a=o.mapping;if(303===a||304===a){if(e.has(o))return t(e.get(o).texture,o.mapping);{const l=o.image;if(l&&l.height>0){const c=new NX(l.height/2);return c.fromEquirectangularTexture(n,o),e.set(o,c),o.addEventListener("dispose",r),t(c.texture,o.mapping)}return null}}}return o},dispose:function s(){e=new WeakMap}}}class Np extends U0{constructor(e=-1,t=1,i=1,r=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=r,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,i,r,s,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=i-e,o=i+e,a=r+t,l=r-t;if(null!==this.view&&this.view.enabled){const c=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=c*this.view.offsetX,o=s+c*this.view.width,a-=u*this.view.offsetY,l=a-u*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,l,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}const B1=[.125,.215,.35,.446,.526,.582],H0=new Np,V1=new be;let z0=null;const ko=(1+Math.sqrt(5))/2,Nl=1/ko,H1=[new T(1,1,1),new T(-1,1,1),new T(1,1,-1),new T(-1,1,-1),new T(0,ko,Nl),new T(0,ko,-Nl),new T(Nl,0,ko),new T(-Nl,0,ko),new T(ko,Nl,0),new T(-ko,Nl,0)];class z1{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,i=.1,r=100){z0=this._renderer.getRenderTarget(),this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,i,r,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=j1(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=W1(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(z0),e.scissorTest=!1,Fp(e,0,0,e.width,e.height)}_fromTexture(e,t){this._setSize(e.mapping===wo||e.mapping===xo?0===e.image.length?16:e.image[0].width||e.image[0].image.width:e.image.width/4),z0=this._renderer.getRenderTarget();const i=t||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,i={magFilter:Qt,minFilter:Qt,generateMipmaps:!1,type:Du,format:Gi,colorSpace:rr,depthBuffer:!1},r=G1(e,t,i);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=G1(e,t,i);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function z9(n){const e=[],t=[],i=[];let r=n;const s=n-4+1+B1.length;for(let o=0;o<s;o++){const a=Math.pow(2,r);t.push(a);let l=1/a;o>n-4?l=B1[o-n+4-1]:0===o&&(l=0),i.push(l);const c=1/(a-2),u=-c,d=1+c,h=[u,u,d,u,d,d,u,u,d,d,u,d],f=6,p=6,_=3,g=2,m=1,v=new Float32Array(_*p*f),y=new Float32Array(g*p*f),b=new Float32Array(m*p*f);for(let S=0;S<f;S++){const C=S%3*2/3-1,I=S>2?0:-1;v.set([C,I,0,C+2/3,I,0,C+2/3,I+1,0,C,I,0,C+2/3,I+1,0,C,I+1,0],_*p*S),y.set(h,g*p*S),b.set([S,S,S,S,S,S],m*p*S)}const w=new pt;w.setAttribute("position",new Gt(v,_)),w.setAttribute("uv",new Gt(y,g)),w.setAttribute("faceIndex",new Gt(b,m)),e.push(w),r>4&&r--}return{lodPlanes:e,sizeLods:t,sigmas:i}}(s)),this._blurMaterial=function G9(n,e,t){const i=new Float32Array(20),r=new T(0,1,0);return new Hs({name:"SphericalGaussianBlur",defines:{n:20,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}(s,e,t)}return r}_compileMaterial(e){const t=new Pn(this._lodPlanes[0],e);this._renderer.compile(t,H0)}_sceneToCubeUV(e,t,i,r){const a=new hn(90,1,t,i),l=[1,-1,1,1,1,1],c=[1,1,1,-1,-1,-1],u=this._renderer,d=u.autoClear,h=u.toneMapping;u.getClearColor(V1),u.toneMapping=as,u.autoClear=!1;const f=new bi({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1}),p=new Pn(new Rl,f);let _=!1;const g=e.background;g?g.isColor&&(f.color.copy(g),e.background=null,_=!0):(f.color.copy(V1),_=!0);for(let m=0;m<6;m++){const v=m%3;0===v?(a.up.set(0,l[m],0),a.lookAt(c[m],0,0)):1===v?(a.up.set(0,0,l[m]),a.lookAt(0,c[m],0)):(a.up.set(0,l[m],0),a.lookAt(0,0,c[m]));const y=this._cubeSize;Fp(r,v*y,m>2?y:0,y,y),u.setRenderTarget(r),_&&u.render(p,a),u.render(e,a)}p.geometry.dispose(),p.material.dispose(),u.toneMapping=h,u.autoClear=d,e.background=g}_textureToCubeUV(e,t){const i=this._renderer,r=e.mapping===wo||e.mapping===xo;r?(null===this._cubemapMaterial&&(this._cubemapMaterial=j1()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=W1());const s=r?this._cubemapMaterial:this._equirectMaterial,o=new Pn(this._lodPlanes[0],s);s.uniforms.envMap.value=e;const l=this._cubeSize;Fp(t,0,0,3*l,2*l),i.setRenderTarget(t),i.render(o,H0)}_applyPMREM(e){const t=this._renderer,i=t.autoClear;t.autoClear=!1;for(let r=1;r<this._lodPlanes.length;r++){const s=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]);this._blur(e,r-1,r,s,H1[(r-1)%H1.length])}t.autoClear=i}_blur(e,t,i,r,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,i,r,"latitudinal",s),this._halfBlur(o,e,i,i,r,"longitudinal",s)}_halfBlur(e,t,i,r,s,o,a){const l=this._renderer,c=this._blurMaterial;"latitudinal"!==o&&"longitudinal"!==o&&console.error("blur direction must be either latitudinal or longitudinal!");const d=new Pn(this._lodPlanes[r],c),h=c.uniforms,f=this._sizeLods[i]-1,p=isFinite(s)?Math.PI/(2*f):2*Math.PI/39,_=s/p,g=isFinite(s)?1+Math.floor(3*_):20;g>20&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${g} samples when the maximum is set to 20`);const m=[];let v=0;for(let C=0;C<20;++C){const I=C/_,x=Math.exp(-I*I/2);m.push(x),0===C?v+=x:C<g&&(v+=2*x)}for(let C=0;C<m.length;C++)m[C]=m[C]/v;h.envMap.value=e.texture,h.samples.value=g,h.weights.value=m,h.latitudinal.value="latitudinal"===o,a&&(h.poleAxis.value=a);const{_lodMax:y}=this;h.dTheta.value=p,h.mipInt.value=y-i;const b=this._sizeLods[r];Fp(t,3*b*(r>y-4?r-y+4:0),4*(this._cubeSize-b),3*b,2*b),l.setRenderTarget(t),l.render(d,H0)}}function G1(n,e,t){const i=new Ro(n,e,t);return i.texture.mapping=Au,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function Fp(n,e,t,i,r){n.viewport.set(e,t,i,r),n.scissor.set(e,t,i,r)}function W1(){return new Hs({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function j1(){return new Hs({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function W9(n){let e=new WeakMap,t=null;function s(a){const l=a.target;l.removeEventListener("dispose",s);const c=e.get(l);void 0!==c&&(e.delete(l),c.dispose())}return{get:function i(a){if(a&&a.isTexture){const l=a.mapping,c=303===l||304===l,u=l===wo||l===xo;if(c||u){if(a.isRenderTargetTexture&&!0===a.needsPMREMUpdate){a.needsPMREMUpdate=!1;let d=e.get(a);return null===t&&(t=new z1(n)),d=c?t.fromEquirectangular(a,d):t.fromCubemap(a,d),e.set(a,d),d.texture}if(e.has(a))return e.get(a).texture;{const d=a.image;if(c&&d&&d.height>0||u&&d&&function r(a){let l=0;for(let u=0;u<6;u++)void 0!==a[u]&&l++;return 6===l}(d)){null===t&&(t=new z1(n));const h=c?t.fromEquirectangular(a):t.fromCubemap(a);return e.set(a,h),a.addEventListener("dispose",s),h.texture}return null}}}return a},dispose:function o(){e=new WeakMap,null!==t&&(t.dispose(),t=null)}}}function j9(n){const e={};function t(i){if(void 0!==e[i])return e[i];let r;switch(i){case"WEBGL_depth_texture":r=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=n.getExtension(i)}return e[i]=r,r}return{has:function(i){return null!==t(i)},init:function(i){i.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(i){const r=t(i);return null===r&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),r}}}function $9(n,e,t,i){const r={},s=new WeakMap;function o(d){const h=d.target;null!==h.index&&e.remove(h.index);for(const p in h.attributes)e.remove(h.attributes[p]);for(const p in h.morphAttributes){const _=h.morphAttributes[p];for(let g=0,m=_.length;g<m;g++)e.remove(_[g])}h.removeEventListener("dispose",o),delete r[h.id];const f=s.get(h);f&&(e.remove(f),s.delete(h)),i.releaseStatesOfGeometry(h),!0===h.isInstancedBufferGeometry&&delete h._maxInstanceCount,t.memory.geometries--}function c(d){const h=[],f=d.index,p=d.attributes.position;let _=0;if(null!==f){const v=f.array;_=f.version;for(let y=0,b=v.length;y<b;y+=3){const w=v[y+0],S=v[y+1],C=v[y+2];h.push(w,S,S,C,C,w)}}else{_=p.version;for(let y=0,b=p.array.length/3-1;y<b;y+=3){const w=y+0,S=y+1,C=y+2;h.push(w,S,S,C,C,w)}}const g=new(g1(h)?I1:R1)(h,1);g.version=_;const m=s.get(d);m&&e.remove(m),s.set(d,g)}return{get:function a(d,h){return!0===r[h.id]||(h.addEventListener("dispose",o),r[h.id]=!0,t.memory.geometries++),h},update:function l(d){const h=d.attributes;for(const p in h)e.update(h[p],n.ARRAY_BUFFER);const f=d.morphAttributes;for(const p in f){const _=f[p];for(let g=0,m=_.length;g<m;g++)e.update(_[g],n.ARRAY_BUFFER)}},getWireframeAttribute:function u(d){const h=s.get(d);if(h){const f=d.index;null!==f&&h.version<f.version&&c(d)}else c(d);return s.get(d)}}}function X9(n,e,t,i){const r=i.isWebGL2;let s,a,l;this.setMode=function o(h){s=h},this.setIndex=function c(h){a=h.type,l=h.bytesPerElement},this.render=function u(h,f){n.drawElements(s,f,a,h*l),t.update(f,s,1)},this.renderInstances=function d(h,f,p){if(0===p)return;let _,g;if(r)_=n,g="drawElementsInstanced";else if(_=e.get("ANGLE_instanced_arrays"),g="drawElementsInstancedANGLE",null===_)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");_[g](s,f,a,h*l,p),t.update(f,s,p)}}function q9(n){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function r(){t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function i(s,o,a){switch(t.calls++,o){case n.TRIANGLES:t.triangles+=a*(s/3);break;case n.LINES:t.lines+=a*(s/2);break;case n.LINE_STRIP:t.lines+=a*(s-1);break;case n.LINE_LOOP:t.lines+=a*s;break;case n.POINTS:t.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o)}}}}function Y9(n,e){return n[0]-e[0]}function Z9(n,e){return Math.abs(e[1])-Math.abs(n[1])}function K9(n,e,t){const i={},r=new Float32Array(8),s=new WeakMap,o=new Ft,a=[];for(let c=0;c<8;c++)a[c]=[c,0];return{update:function l(c,u,d){const h=c.morphTargetInfluences;if(!0===e.isWebGL2){const f=u.morphAttributes.position||u.morphAttributes.normal||u.morphAttributes.color,p=void 0!==f?f.length:0;let _=s.get(u);if(void 0===_||_.count!==p){let F=function(){Y.dispose(),s.delete(u),u.removeEventListener("dispose",F)};void 0!==_&&_.texture.dispose();const v=void 0!==u.morphAttributes.position,y=void 0!==u.morphAttributes.normal,b=void 0!==u.morphAttributes.color,w=u.morphAttributes.position||[],S=u.morphAttributes.normal||[],C=u.morphAttributes.color||[];let I=0;!0===v&&(I=1),!0===y&&(I=2),!0===b&&(I=3);let x=u.attributes.position.count*I,E=1;x>e.maxTextureSize&&(E=Math.ceil(x/e.maxTextureSize),x=e.maxTextureSize);const B=new Float32Array(x*E*4*p),Y=new S0(B,x,E,p);Y.type=cs,Y.needsUpdate=!0;const N=4*I;for(let H=0;H<p;H++){const ne=w[H],X=S[H],Q=C[H],re=x*E*4*H;for(let ae=0;ae<ne.count;ae++){const U=ae*N;!0===v&&(o.fromBufferAttribute(ne,ae),B[re+U+0]=o.x,B[re+U+1]=o.y,B[re+U+2]=o.z,B[re+U+3]=0),!0===y&&(o.fromBufferAttribute(X,ae),B[re+U+4]=o.x,B[re+U+5]=o.y,B[re+U+6]=o.z,B[re+U+7]=0),!0===b&&(o.fromBufferAttribute(Q,ae),B[re+U+8]=o.x,B[re+U+9]=o.y,B[re+U+10]=o.z,B[re+U+11]=4===Q.itemSize?o.w:1)}}_={count:p,texture:Y,size:new K(x,E)},s.set(u,_),u.addEventListener("dispose",F)}let g=0;for(let v=0;v<h.length;v++)g+=h[v];const m=u.morphTargetsRelative?1:1-g;d.getUniforms().setValue(n,"morphTargetBaseInfluence",m),d.getUniforms().setValue(n,"morphTargetInfluences",h),d.getUniforms().setValue(n,"morphTargetsTexture",_.texture,t),d.getUniforms().setValue(n,"morphTargetsTextureSize",_.size)}else{const f=void 0===h?0:h.length;let p=i[u.id];if(void 0===p||p.length!==f){p=[];for(let y=0;y<f;y++)p[y]=[y,0];i[u.id]=p}for(let y=0;y<f;y++){const b=p[y];b[0]=y,b[1]=h[y]}p.sort(Z9);for(let y=0;y<8;y++)y<f&&p[y][1]?(a[y][0]=p[y][0],a[y][1]=p[y][1]):(a[y][0]=Number.MAX_SAFE_INTEGER,a[y][1]=0);a.sort(Y9);const _=u.morphAttributes.position,g=u.morphAttributes.normal;let m=0;for(let y=0;y<8;y++){const b=a[y],w=b[0],S=b[1];w!==Number.MAX_SAFE_INTEGER&&S?(_&&u.getAttribute("morphTarget"+y)!==_[w]&&u.setAttribute("morphTarget"+y,_[w]),g&&u.getAttribute("morphNormal"+y)!==g[w]&&u.setAttribute("morphNormal"+y,g[w]),r[y]=S,m+=S):(_&&!0===u.hasAttribute("morphTarget"+y)&&u.deleteAttribute("morphTarget"+y),g&&!0===u.hasAttribute("morphNormal"+y)&&u.deleteAttribute("morphNormal"+y),r[y]=0)}const v=u.morphTargetsRelative?1:1-m;d.getUniforms().setValue(n,"morphTargetBaseInfluence",v),d.getUniforms().setValue(n,"morphTargetInfluences",r)}}}}function J9(n,e,t,i){let r=new WeakMap;function a(l){const c=l.target;c.removeEventListener("dispose",a),t.remove(c.instanceMatrix),null!==c.instanceColor&&t.remove(c.instanceColor)}return{update:function s(l){const c=i.render.frame,d=e.get(l,l.geometry);if(r.get(d)!==c&&(e.update(d),r.set(d,c)),l.isInstancedMesh&&(!1===l.hasEventListener("dispose",a)&&l.addEventListener("dispose",a),r.get(l)!==c&&(t.update(l.instanceMatrix,n.ARRAY_BUFFER),null!==l.instanceColor&&t.update(l.instanceColor,n.ARRAY_BUFFER),r.set(l,c))),l.isSkinnedMesh){const h=l.skeleton;r.get(h)!==c&&(h.update(),r.set(h,c))}return d},dispose:function o(){r=new WeakMap}}}const $1=new or,X1=new S0,q1=new y1,Y1=new Ip,Z1=[],K1=[],J1=new Float32Array(16),Q1=new Float32Array(9),eP=new Float32Array(4);function Fl(n,e,t){const i=n[0];if(i<=0||i>0)return n;const r=e*t;let s=Z1[r];if(void 0===s&&(s=new Float32Array(r),Z1[r]=s),0!==e){i.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=t,n[o].toArray(s,a)}return s}function An(n,e){if(n.length!==e.length)return!1;for(let t=0,i=n.length;t<i;t++)if(n[t]!==e[t])return!1;return!0}function Cn(n,e){for(let t=0,i=e.length;t<i;t++)n[t]=e[t]}function kp(n,e){let t=K1[e];void 0===t&&(t=new Int32Array(e),K1[e]=t);for(let i=0;i!==e;++i)t[i]=n.allocateTextureUnit();return t}function Q9(n,e){const t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function eY(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(An(t,e))return;n.uniform2fv(this.addr,e),Cn(t,e)}}function tY(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(void 0!==e.r)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(An(t,e))return;n.uniform3fv(this.addr,e),Cn(t,e)}}function nY(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(An(t,e))return;n.uniform4fv(this.addr,e),Cn(t,e)}}function iY(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(An(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),Cn(t,e)}else{if(An(t,i))return;eP.set(i),n.uniformMatrix2fv(this.addr,!1,eP),Cn(t,i)}}function rY(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(An(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),Cn(t,e)}else{if(An(t,i))return;Q1.set(i),n.uniformMatrix3fv(this.addr,!1,Q1),Cn(t,i)}}function sY(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(An(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),Cn(t,e)}else{if(An(t,i))return;J1.set(i),n.uniformMatrix4fv(this.addr,!1,J1),Cn(t,i)}}function oY(n,e){const t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function aY(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(An(t,e))return;n.uniform2iv(this.addr,e),Cn(t,e)}}function lY(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(An(t,e))return;n.uniform3iv(this.addr,e),Cn(t,e)}}function cY(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(An(t,e))return;n.uniform4iv(this.addr,e),Cn(t,e)}}function uY(n,e){const t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function dY(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(An(t,e))return;n.uniform2uiv(this.addr,e),Cn(t,e)}}function hY(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(An(t,e))return;n.uniform3uiv(this.addr,e),Cn(t,e)}}function fY(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(An(t,e))return;n.uniform4uiv(this.addr,e),Cn(t,e)}}function pY(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2D(e||$1,r)}function mY(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture3D(e||q1,r)}function gY(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTextureCube(e||Y1,r)}function _Y(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2DArray(e||X1,r)}function yY(n,e){n.uniform1fv(this.addr,e)}function bY(n,e){const t=Fl(e,this.size,2);n.uniform2fv(this.addr,t)}function wY(n,e){const t=Fl(e,this.size,3);n.uniform3fv(this.addr,t)}function xY(n,e){const t=Fl(e,this.size,4);n.uniform4fv(this.addr,t)}function SY(n,e){const t=Fl(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function MY(n,e){const t=Fl(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function EY(n,e){const t=Fl(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function AY(n,e){n.uniform1iv(this.addr,e)}function CY(n,e){n.uniform2iv(this.addr,e)}function TY(n,e){n.uniform3iv(this.addr,e)}function DY(n,e){n.uniform4iv(this.addr,e)}function RY(n,e){n.uniform1uiv(this.addr,e)}function IY(n,e){n.uniform2uiv(this.addr,e)}function PY(n,e){n.uniform3uiv(this.addr,e)}function LY(n,e){n.uniform4uiv(this.addr,e)}function OY(n,e,t){const i=this.cache,r=e.length,s=kp(t,r);An(i,s)||(n.uniform1iv(this.addr,s),Cn(i,s));for(let o=0;o!==r;++o)t.setTexture2D(e[o]||$1,s[o])}function NY(n,e,t){const i=this.cache,r=e.length,s=kp(t,r);An(i,s)||(n.uniform1iv(this.addr,s),Cn(i,s));for(let o=0;o!==r;++o)t.setTexture3D(e[o]||q1,s[o])}function FY(n,e,t){const i=this.cache,r=e.length,s=kp(t,r);An(i,s)||(n.uniform1iv(this.addr,s),Cn(i,s));for(let o=0;o!==r;++o)t.setTextureCube(e[o]||Y1,s[o])}function kY(n,e,t){const i=this.cache,r=e.length,s=kp(t,r);An(i,s)||(n.uniform1iv(this.addr,s),Cn(i,s));for(let o=0;o!==r;++o)t.setTexture2DArray(e[o]||X1,s[o])}class BY{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.setValue=function vY(n){switch(n){case 5126:return Q9;case 35664:return eY;case 35665:return tY;case 35666:return nY;case 35674:return iY;case 35675:return rY;case 35676:return sY;case 5124:case 35670:return oY;case 35667:case 35671:return aY;case 35668:case 35672:return lY;case 35669:case 35673:return cY;case 5125:return uY;case 36294:return dY;case 36295:return hY;case 36296:return fY;case 35678:case 36198:case 36298:case 36306:case 35682:return pY;case 35679:case 36299:case 36307:return mY;case 35680:case 36300:case 36308:case 36293:return gY;case 36289:case 36303:case 36311:case 36292:return _Y}}(t.type)}}class VY{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.size=t.size,this.setValue=function UY(n){switch(n){case 5126:return yY;case 35664:return bY;case 35665:return wY;case 35666:return xY;case 35674:return SY;case 35675:return MY;case 35676:return EY;case 5124:case 35670:return AY;case 35667:case 35671:return CY;case 35668:case 35672:return TY;case 35669:case 35673:return DY;case 5125:return RY;case 36294:return IY;case 36295:return PY;case 36296:return LY;case 35678:case 36198:case 36298:case 36306:case 35682:return OY;case 35679:case 36299:case 36307:return NY;case 35680:case 36300:case 36308:case 36293:return FY;case 36289:case 36303:case 36311:case 36292:return kY}}(t.type)}}class HY{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,i){const r=this.seq;for(let s=0,o=r.length;s!==o;++s){const a=r[s];a.setValue(e,t[a.id],i)}}}const W0=/(\w+)(\])?(\[|\.)?/g;function tP(n,e){n.seq.push(e),n.map[e.id]=e}function zY(n,e,t){const i=n.name,r=i.length;for(W0.lastIndex=0;;){const s=W0.exec(i);let a=s[1];const c=s[3];if("]"===s[2]&&(a|=0),void 0===c||"["===c&&W0.lastIndex+2===r){tP(t,void 0===c?new BY(a,n,e):new VY(a,n,e));break}{let d=t.map[a];void 0===d&&(d=new HY(a),tP(t,d)),t=d}}}class Up{constructor(e,t){this.seq=[],this.map={};const i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let r=0;r<i;++r){const s=e.getActiveUniform(t,r);zY(s,e.getUniformLocation(t,s.name),this)}}setValue(e,t,i,r){const s=this.map[t];void 0!==s&&s.setValue(e,i,r)}setOptional(e,t,i){const r=t[i];void 0!==r&&this.setValue(e,i,r)}static upload(e,t,i,r){for(let s=0,o=t.length;s!==o;++s){const a=t[s],l=i[a.id];!1!==l.needsUpdate&&a.setValue(e,l.value,r)}}static seqWithValue(e,t){const i=[];for(let r=0,s=e.length;r!==s;++r){const o=e[r];o.id in t&&i.push(o)}return i}}function nP(n,e,t){const i=n.createShader(e);return n.shaderSource(i,t),n.compileShader(i),i}let GY=0;function iP(n,e,t){const i=n.getShaderParameter(e,n.COMPILE_STATUS),r=n.getShaderInfoLog(e).trim();if(i&&""===r)return"";const s=/ERROR: 0:(\d+)/.exec(r);if(s){const o=parseInt(s[1]);return t.toUpperCase()+"\n\n"+r+"\n\n"+function WY(n,e){const t=n.split("\n"),i=[],r=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let o=r;o<s;o++){const a=o+1;i.push(`${a===e?">":" "} ${a}: ${t[o]}`)}return i.join("\n")}(n.getShaderSource(e),o)}return r}function $Y(n,e){const t=function jY(n){switch(n){case rr:return["Linear","( value )"];case Ze:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",n),["Linear","( value )"]}}(e);return"vec4 "+n+"( vec4 value ) { return LinearTo"+t[0]+t[1]+"; }"}function XY(n,e){let t;switch(e){case y6:t="Linear";break;case b6:t="Reinhard";break;case w6:t="OptimizedCineon";break;case x6:t="ACESFilmic";break;case S6:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function Vu(n){return""!==n}function rP(n,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function sP(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const KY=/^[ \t]*#include +<([\w\d./]+)>/gm;function j0(n){return n.replace(KY,QY)}const JY=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);function QY(n,e){let t=dt[e];if(void 0===t){const i=JY.get(e);if(void 0===i)throw new Error("Can not resolve #include <"+e+">");t=dt[i],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,i)}return j0(t)}const e7=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function oP(n){return n.replace(e7,t7)}function t7(n,e,t,i){let r="";for(let s=parseInt(e);s<parseInt(t);s++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function aP(n){let e="precision "+n.precision+" float;\nprecision "+n.precision+" int;";return"highp"===n.precision?e+="\n#define HIGH_PRECISION":"mediump"===n.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===n.precision&&(e+="\n#define LOW_PRECISION"),e}function a7(n,e,t,i){const r=n.getContext(),s=t.defines;let o=t.vertexShader,a=t.fragmentShader;const l=function n7(n){let e="SHADOWMAP_TYPE_BASIC";return n.shadowMapType===EI?e="SHADOWMAP_TYPE_PCF":n.shadowMapType===K$?e="SHADOWMAP_TYPE_PCF_SOFT":n.shadowMapType===ss&&(e="SHADOWMAP_TYPE_VSM"),e}(t),c=function i7(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case wo:case xo:e="ENVMAP_TYPE_CUBE";break;case Au:e="ENVMAP_TYPE_CUBE_UV"}return e}(t),u=function r7(n){let e="ENVMAP_MODE_REFLECTION";return n.envMap&&n.envMapMode===xo&&(e="ENVMAP_MODE_REFRACTION"),e}(t),d=function s7(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case op:e="ENVMAP_BLENDING_MULTIPLY";break;case _6:e="ENVMAP_BLENDING_MIX";break;case v6:e="ENVMAP_BLENDING_ADD"}return e}(t),h=function o7(n){const e=n.envMapCubeUVHeight;if(null===e)return null;const t=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:i,maxMip:t}}(t),f=t.isWebGL2?"":function qY(n){return[n.extensionDerivatives||n.envMapCubeUVHeight||n.bumpMap||n.normalMapTangentSpace||n.clearcoatNormalMap||n.flatShading||"physical"===n.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(n.extensionFragDepth||n.logarithmicDepthBuffer)&&n.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",n.extensionDrawBuffers&&n.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(n.extensionShaderTextureLOD||n.envMap||n.transmission)&&n.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Vu).join("\n")}(t),p=function YY(n){const e=[];for(const t in n){const i=n[t];!1!==i&&e.push("#define "+t+" "+i)}return e.join("\n")}(s),_=r.createProgram();let g,m,v=t.glslVersion?"#version "+t.glslVersion+"\n":"";t.isRawShaderMaterial?(g=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p].filter(Vu).join("\n"),g.length>0&&(g+="\n"),m=[f,"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p].filter(Vu).join("\n"),m.length>0&&(m+="\n")):(g=[aP(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+u:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&!1===t.flatShading?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&!1===t.flatShading?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","\tattribute vec2 uv1;","#endif","#ifdef USE_UV2","\tattribute vec2 uv2;","#endif","#ifdef USE_UV3","\tattribute vec2 uv3;","#endif","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Vu).join("\n"),m=[f,aP(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+c:"",t.envMap?"#define "+u:"",t.envMap?"#define "+d:"",h?"#define CUBEUV_TEXEL_WIDTH "+h.texelWidth:"",h?"#define CUBEUV_TEXEL_HEIGHT "+h.texelHeight:"",h?"#define CUBEUV_MAX_MIP "+h.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&!1===t.flatShading?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==as?"#define TONE_MAPPING":"",t.toneMapping!==as?dt.tonemapping_pars_fragment:"",t.toneMapping!==as?XY("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",dt.colorspace_pars_fragment,$Y("linearToOutputTexel",t.outputColorSpace),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"","\n"].filter(Vu).join("\n")),o=j0(o),o=rP(o,t),o=sP(o,t),a=j0(a),a=rP(a,t),a=sP(a,t),o=oP(o),a=oP(a),t.isWebGL2&&!0!==t.isRawShaderMaterial&&(v="#version 300 es\n",g=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+g,m=["#define varying in",t.glslVersion===f1?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===f1?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+m);const b=v+m+a,w=nP(r,r.VERTEX_SHADER,v+g+o),S=nP(r,r.FRAGMENT_SHADER,b);if(r.attachShader(_,w),r.attachShader(_,S),void 0!==t.index0AttributeName?r.bindAttribLocation(_,0,t.index0AttributeName):!0===t.morphTargets&&r.bindAttribLocation(_,0,"position"),r.linkProgram(_),n.debug.checkShaderErrors){const x=r.getProgramInfoLog(_).trim(),E=r.getShaderInfoLog(w).trim(),B=r.getShaderInfoLog(S).trim();let Y=!0,N=!0;if(!1===r.getProgramParameter(_,r.LINK_STATUS))if(Y=!1,"function"==typeof n.debug.onShaderError)n.debug.onShaderError(r,_,w,S);else{const F=iP(r,w,"vertex"),H=iP(r,S,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(_,r.VALIDATE_STATUS)+"\n\nProgram Info Log: "+x+"\n"+F+"\n"+H)}else""!==x?console.warn("THREE.WebGLProgram: Program Info Log:",x):(""===E||""===B)&&(N=!1);N&&(this.diagnostics={runnable:Y,programLog:x,vertexShader:{log:E,prefix:g},fragmentShader:{log:B,prefix:m}})}let C,I;return r.deleteShader(w),r.deleteShader(S),this.getUniforms=function(){return void 0===C&&(C=new Up(r,_)),C},this.getAttributes=function(){return void 0===I&&(I=function ZY(n,e){const t={},i=n.getProgramParameter(e,n.ACTIVE_ATTRIBUTES);for(let r=0;r<i;r++){const s=n.getActiveAttrib(e,r),o=s.name;let a=1;s.type===n.FLOAT_MAT2&&(a=2),s.type===n.FLOAT_MAT3&&(a=3),s.type===n.FLOAT_MAT4&&(a=4),t[o]={type:s.type,location:n.getAttribLocation(e,o),locationSize:a}}return t}(r,_)),I},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(_),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=GY++,this.cacheKey=e,this.usedTimes=1,this.program=_,this.vertexShader=w,this.fragmentShader=S,this}let l7=0;class c7{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const i=e.fragmentShader,r=this._getShaderStage(e.vertexShader),s=this._getShaderStage(i),o=this._getShaderCacheForMaterial(e);return!1===o.has(r)&&(o.add(r),r.usedTimes++),!1===o.has(s)&&(o.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const i of t)i.usedTimes--,0===i.usedTimes&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let i=t.get(e);return void 0===i&&(i=new Set,t.set(e,i)),i}_getShaderStage(e){const t=this.shaderCache;let i=t.get(e);return void 0===i&&(i=new u7(e),t.set(e,i)),i}}class u7{constructor(e){this.id=l7++,this.code=e,this.usedTimes=0}}function d7(n,e,t,i,r,s,o){const a=new R0,l=new c7,c=[],u=r.isWebGL2,d=r.logarithmicDepthBuffer,h=r.vertexTextures;let f=r.precision;const p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function _(x){return 0===x?"uv":`uv${x}`}return{getParameters:function g(x,E,B,Y,N){const F=Y.fog,H=N.geometry,X=(x.isMeshStandardMaterial?t:e).get(x.envMap||(x.isMeshStandardMaterial?Y.environment:null)),Q=X&&X.mapping===Au?X.image.height:null,re=p[x.type];null!==x.precision&&(f=r.getMaxPrecision(x.precision),f!==x.precision&&console.warn("THREE.WebGLProgram.getParameters:",x.precision,"not supported, using",f,"instead."));const ae=H.morphAttributes.position||H.morphAttributes.normal||H.morphAttributes.color,U=void 0!==ae?ae.length:0;let fe,me,ve,Te,J=0;if(void 0!==H.morphAttributes.position&&(J=1),void 0!==H.morphAttributes.normal&&(J=2),void 0!==H.morphAttributes.color&&(J=3),re){const zr=Fr[re];fe=zr.vertexShader,me=zr.fragmentShader}else fe=x.vertexShader,me=x.fragmentShader,l.update(x),ve=l.getVertexShaderID(x),Te=l.getFragmentShaderID(x);const Ue=n.getRenderTarget(),Fe=!0===N.isInstancedMesh,yt=!!x.map,ze=!!X,L=!!x.aoMap,pe=!!x.lightMap,ee=!!x.bumpMap,de=!!x.normalMap,se=!!x.displacementMap,Be=!!x.emissiveMap,Ae=!!x.metalnessMap,Re=!!x.roughnessMap,Ke=x.anisotropy>0,_t=x.clearcoat>0,Wt=x.iridescence>0,R=x.sheen>0,M=x.transmission>0,j=Ke&&!!x.anisotropyMap,ue=_t&&!!x.clearcoatMap,ce=_t&&!!x.clearcoatNormalMap,P=_t&&!!x.clearcoatRoughnessMap,oe=Wt&&!!x.iridescenceMap,le=Wt&&!!x.iridescenceThicknessMap,z=R&&!!x.sheenColorMap,Le=R&&!!x.sheenRoughnessMap,Ve=!!x.specularMap,ke=!!x.specularColorMap,Oe=!!x.specularIntensityMap,Ie=M&&!!x.transmissionMap,Je=M&&!!x.thicknessMap,O=!!x.alphaMap,ge=!!x.extensions,Se=!!H.attributes.uv1,Tt=!!H.attributes.uv2,Zt=!!H.attributes.uv3;return{isWebGL2:u,shaderID:re,shaderType:x.type,shaderName:x.name,vertexShader:fe,fragmentShader:me,defines:x.defines,customVertexShaderID:ve,customFragmentShaderID:Te,isRawShaderMaterial:!0===x.isRawShaderMaterial,glslVersion:x.glslVersion,precision:f,instancing:Fe,instancingColor:Fe&&null!==N.instanceColor,supportsVertexTextures:h,outputColorSpace:null===Ue?n.outputColorSpace:!0===Ue.isXRRenderTarget?Ue.texture.colorSpace:rr,map:yt,matcap:!!x.matcap,envMap:ze,envMapMode:ze&&X.mapping,envMapCubeUVHeight:Q,aoMap:L,lightMap:pe,bumpMap:ee,normalMap:de,displacementMap:h&&se,emissiveMap:Be,normalMapObjectSpace:de&&1===x.normalMapType,normalMapTangentSpace:de&&0===x.normalMapType,metalnessMap:Ae,roughnessMap:Re,anisotropy:Ke,anisotropyMap:j,clearcoat:_t,clearcoatMap:ue,clearcoatNormalMap:ce,clearcoatRoughnessMap:P,iridescence:Wt,iridescenceMap:oe,iridescenceThicknessMap:le,sheen:R,sheenColorMap:z,sheenRoughnessMap:Le,specularMap:Ve,specularColorMap:ke,specularIntensityMap:Oe,transmission:M,transmissionMap:Ie,thicknessMap:Je,gradientMap:!!x.gradientMap,opaque:!1===x.transparent&&1===x.blending,alphaMap:O,alphaTest:x.alphaTest>0,alphaHash:!!x.alphaHash,combine:x.combine,mapUv:yt&&_(x.map.channel),aoMapUv:L&&_(x.aoMap.channel),lightMapUv:pe&&_(x.lightMap.channel),bumpMapUv:ee&&_(x.bumpMap.channel),normalMapUv:de&&_(x.normalMap.channel),displacementMapUv:se&&_(x.displacementMap.channel),emissiveMapUv:Be&&_(x.emissiveMap.channel),metalnessMapUv:Ae&&_(x.metalnessMap.channel),roughnessMapUv:Re&&_(x.roughnessMap.channel),anisotropyMapUv:j&&_(x.anisotropyMap.channel),clearcoatMapUv:ue&&_(x.clearcoatMap.channel),clearcoatNormalMapUv:ce&&_(x.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:P&&_(x.clearcoatRoughnessMap.channel),iridescenceMapUv:oe&&_(x.iridescenceMap.channel),iridescenceThicknessMapUv:le&&_(x.iridescenceThicknessMap.channel),sheenColorMapUv:z&&_(x.sheenColorMap.channel),sheenRoughnessMapUv:Le&&_(x.sheenRoughnessMap.channel),specularMapUv:Ve&&_(x.specularMap.channel),specularColorMapUv:ke&&_(x.specularColorMap.channel),specularIntensityMapUv:Oe&&_(x.specularIntensityMap.channel),transmissionMapUv:Ie&&_(x.transmissionMap.channel),thicknessMapUv:Je&&_(x.thicknessMap.channel),alphaMapUv:O&&_(x.alphaMap.channel),vertexTangents:!!H.attributes.tangent&&(de||Ke),vertexColors:x.vertexColors,vertexAlphas:!0===x.vertexColors&&!!H.attributes.color&&4===H.attributes.color.itemSize,vertexUv1s:Se,vertexUv2s:Tt,vertexUv3s:Zt,pointsUvs:!0===N.isPoints&&!!H.attributes.uv&&(yt||O),fog:!!F,useFog:!0===x.fog,fogExp2:F&&F.isFogExp2,flatShading:!0===x.flatShading,sizeAttenuation:!0===x.sizeAttenuation,logarithmicDepthBuffer:d,skinning:!0===N.isSkinnedMesh,morphTargets:void 0!==H.morphAttributes.position,morphNormals:void 0!==H.morphAttributes.normal,morphColors:void 0!==H.morphAttributes.color,morphTargetsCount:U,morphTextureStride:J,numDirLights:E.directional.length,numPointLights:E.point.length,numSpotLights:E.spot.length,numSpotLightMaps:E.spotLightMap.length,numRectAreaLights:E.rectArea.length,numHemiLights:E.hemi.length,numDirLightShadows:E.directionalShadowMap.length,numPointLightShadows:E.pointShadowMap.length,numSpotLightShadows:E.spotShadowMap.length,numSpotLightShadowsWithMaps:E.numSpotLightShadowsWithMaps,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:x.dithering,shadowMapEnabled:n.shadowMap.enabled&&B.length>0,shadowMapType:n.shadowMap.type,toneMapping:x.toneMapped?n.toneMapping:as,useLegacyLights:n.useLegacyLights,premultipliedAlpha:x.premultipliedAlpha,doubleSided:2===x.side,flipSided:1===x.side,useDepthPacking:x.depthPacking>=0,depthPacking:x.depthPacking||0,index0AttributeName:x.index0AttributeName,extensionDerivatives:ge&&!0===x.extensions.derivatives,extensionFragDepth:ge&&!0===x.extensions.fragDepth,extensionDrawBuffers:ge&&!0===x.extensions.drawBuffers,extensionShaderTextureLOD:ge&&!0===x.extensions.shaderTextureLOD,rendererExtensionFragDepth:u||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:u||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:u||i.has("EXT_shader_texture_lod"),customProgramCacheKey:x.customProgramCacheKey()}},getProgramCacheKey:function m(x){const E=[];if(x.shaderID?E.push(x.shaderID):(E.push(x.customVertexShaderID),E.push(x.customFragmentShaderID)),void 0!==x.defines)for(const B in x.defines)E.push(B),E.push(x.defines[B]);return!1===x.isRawShaderMaterial&&(function v(x,E){x.push(E.precision),x.push(E.outputColorSpace),x.push(E.envMapMode),x.push(E.envMapCubeUVHeight),x.push(E.mapUv),x.push(E.alphaMapUv),x.push(E.lightMapUv),x.push(E.aoMapUv),x.push(E.bumpMapUv),x.push(E.normalMapUv),x.push(E.displacementMapUv),x.push(E.emissiveMapUv),x.push(E.metalnessMapUv),x.push(E.roughnessMapUv),x.push(E.anisotropyMapUv),x.push(E.clearcoatMapUv),x.push(E.clearcoatNormalMapUv),x.push(E.clearcoatRoughnessMapUv),x.push(E.iridescenceMapUv),x.push(E.iridescenceThicknessMapUv),x.push(E.sheenColorMapUv),x.push(E.sheenRoughnessMapUv),x.push(E.specularMapUv),x.push(E.specularColorMapUv),x.push(E.specularIntensityMapUv),x.push(E.transmissionMapUv),x.push(E.thicknessMapUv),x.push(E.combine),x.push(E.fogExp2),x.push(E.sizeAttenuation),x.push(E.morphTargetsCount),x.push(E.morphAttributeCount),x.push(E.numDirLights),x.push(E.numPointLights),x.push(E.numSpotLights),x.push(E.numSpotLightMaps),x.push(E.numHemiLights),x.push(E.numRectAreaLights),x.push(E.numDirLightShadows),x.push(E.numPointLightShadows),x.push(E.numSpotLightShadows),x.push(E.numSpotLightShadowsWithMaps),x.push(E.shadowMapType),x.push(E.toneMapping),x.push(E.numClippingPlanes),x.push(E.numClipIntersection),x.push(E.depthPacking)}(E,x),function y(x,E){a.disableAll(),E.isWebGL2&&a.enable(0),E.supportsVertexTextures&&a.enable(1),E.instancing&&a.enable(2),E.instancingColor&&a.enable(3),E.matcap&&a.enable(4),E.envMap&&a.enable(5),E.normalMapObjectSpace&&a.enable(6),E.normalMapTangentSpace&&a.enable(7),E.clearcoat&&a.enable(8),E.iridescence&&a.enable(9),E.alphaTest&&a.enable(10),E.vertexColors&&a.enable(11),E.vertexAlphas&&a.enable(12),E.vertexUv1s&&a.enable(13),E.vertexUv2s&&a.enable(14),E.vertexUv3s&&a.enable(15),E.vertexTangents&&a.enable(16),E.anisotropy&&a.enable(17),x.push(a.mask),a.disableAll(),E.fog&&a.enable(0),E.useFog&&a.enable(1),E.flatShading&&a.enable(2),E.logarithmicDepthBuffer&&a.enable(3),E.skinning&&a.enable(4),E.morphTargets&&a.enable(5),E.morphNormals&&a.enable(6),E.morphColors&&a.enable(7),E.premultipliedAlpha&&a.enable(8),E.shadowMapEnabled&&a.enable(9),E.useLegacyLights&&a.enable(10),E.doubleSided&&a.enable(11),E.flipSided&&a.enable(12),E.useDepthPacking&&a.enable(13),E.dithering&&a.enable(14),E.transmission&&a.enable(15),E.sheen&&a.enable(16),E.opaque&&a.enable(17),E.pointsUvs&&a.enable(18),x.push(a.mask)}(E,x),E.push(n.outputColorSpace)),E.push(x.customProgramCacheKey),E.join()},getUniforms:function b(x){const E=p[x.type];let B;return B=E?IX.clone(Fr[E].uniforms):x.uniforms,B},acquireProgram:function w(x,E){let B;for(let Y=0,N=c.length;Y<N;Y++){const F=c[Y];if(F.cacheKey===E){B=F,++B.usedTimes;break}}return void 0===B&&(B=new a7(n,E,x,s),c.push(B)),B},releaseProgram:function S(x){if(0==--x.usedTimes){const E=c.indexOf(x);c[E]=c[c.length-1],c.pop(),x.destroy()}},releaseShaderCache:function C(x){l.remove(x)},programs:c,dispose:function I(){l.dispose()}}}function h7(){let n=new WeakMap;return{get:function e(s){let o=n.get(s);return void 0===o&&(o={},n.set(s,o)),o},remove:function t(s){n.delete(s)},update:function i(s,o,a){n.get(s)[o]=a},dispose:function r(){n=new WeakMap}}}function f7(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function lP(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function cP(){const n=[];let e=0;const t=[],i=[],r=[];function o(d,h,f,p,_,g){let m=n[e];return void 0===m?(m={id:d.id,object:d,geometry:h,material:f,groupOrder:p,renderOrder:d.renderOrder,z:_,group:g},n[e]=m):(m.id=d.id,m.object=d,m.geometry=h,m.material=f,m.groupOrder=p,m.renderOrder=d.renderOrder,m.z=_,m.group=g),e++,m}return{opaque:t,transmissive:i,transparent:r,init:function s(){e=0,t.length=0,i.length=0,r.length=0},push:function a(d,h,f,p,_,g){const m=o(d,h,f,p,_,g);f.transmission>0?i.push(m):!0===f.transparent?r.push(m):t.push(m)},unshift:function l(d,h,f,p,_,g){const m=o(d,h,f,p,_,g);f.transmission>0?i.unshift(m):!0===f.transparent?r.unshift(m):t.unshift(m)},finish:function u(){for(let d=e,h=n.length;d<h;d++){const f=n[d];if(null===f.id)break;f.id=null,f.object=null,f.geometry=null,f.material=null,f.group=null}},sort:function c(d,h){t.length>1&&t.sort(d||f7),i.length>1&&i.sort(h||lP),r.length>1&&r.sort(h||lP)}}}function p7(){let n=new WeakMap;return{get:function e(i,r){const s=n.get(i);let o;return void 0===s?(o=new cP,n.set(i,[o])):r>=s.length?(o=new cP,s.push(o)):o=s[r],o},dispose:function t(){n=new WeakMap}}}function m7(){const n={};return{get:function(e){if(void 0!==n[e.id])return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new T,color:new be};break;case"SpotLight":t={position:new T,direction:new T,color:new be,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new T,color:new be,distance:0,decay:0};break;case"HemisphereLight":t={direction:new T,skyColor:new be,groundColor:new be};break;case"RectAreaLight":t={color:new be,position:new T,halfWidth:new T,halfHeight:new T}}return n[e.id]=t,t}}}let _7=0;function v7(n,e){return(e.castShadow?2:0)-(n.castShadow?2:0)+(e.map?1:0)-(n.map?1:0)}function y7(n,e){const t=new m7,i=function g7(){const n={};return{get:function(e){if(void 0!==n[e.id])return n[e.id];let t;switch(e.type){case"DirectionalLight":case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new K};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new K,shadowCameraNear:1,shadowCameraFar:1e3}}return n[e.id]=t,t}}}(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let u=0;u<9;u++)r.probe.push(new T);const s=new T,o=new et,a=new et;return{setup:function l(u,d){let h=0,f=0,p=0;for(let B=0;B<9;B++)r.probe[B].set(0,0,0);let _=0,g=0,m=0,v=0,y=0,b=0,w=0,S=0,C=0,I=0;u.sort(v7);const x=!0===d?Math.PI:1;for(let B=0,Y=u.length;B<Y;B++){const N=u[B],F=N.color,H=N.intensity,ne=N.distance,X=N.shadow&&N.shadow.map?N.shadow.map.texture:null;if(N.isAmbientLight)h+=F.r*H*x,f+=F.g*H*x,p+=F.b*H*x;else if(N.isLightProbe)for(let Q=0;Q<9;Q++)r.probe[Q].addScaledVector(N.sh.coefficients[Q],H);else if(N.isDirectionalLight){const Q=t.get(N);if(Q.color.copy(N.color).multiplyScalar(N.intensity*x),N.castShadow){const re=N.shadow,ae=i.get(N);ae.shadowBias=re.bias,ae.shadowNormalBias=re.normalBias,ae.shadowRadius=re.radius,ae.shadowMapSize=re.mapSize,r.directionalShadow[_]=ae,r.directionalShadowMap[_]=X,r.directionalShadowMatrix[_]=N.shadow.matrix,b++}r.directional[_]=Q,_++}else if(N.isSpotLight){const Q=t.get(N);Q.position.setFromMatrixPosition(N.matrixWorld),Q.color.copy(F).multiplyScalar(H*x),Q.distance=ne,Q.coneCos=Math.cos(N.angle),Q.penumbraCos=Math.cos(N.angle*(1-N.penumbra)),Q.decay=N.decay,r.spot[m]=Q;const re=N.shadow;if(N.map&&(r.spotLightMap[C]=N.map,C++,re.updateMatrices(N),N.castShadow&&I++),r.spotLightMatrix[m]=re.matrix,N.castShadow){const ae=i.get(N);ae.shadowBias=re.bias,ae.shadowNormalBias=re.normalBias,ae.shadowRadius=re.radius,ae.shadowMapSize=re.mapSize,r.spotShadow[m]=ae,r.spotShadowMap[m]=X,S++}m++}else if(N.isRectAreaLight){const Q=t.get(N);Q.color.copy(F).multiplyScalar(H),Q.halfWidth.set(.5*N.width,0,0),Q.halfHeight.set(0,.5*N.height,0),r.rectArea[v]=Q,v++}else if(N.isPointLight){const Q=t.get(N);if(Q.color.copy(N.color).multiplyScalar(N.intensity*x),Q.distance=N.distance,Q.decay=N.decay,N.castShadow){const re=N.shadow,ae=i.get(N);ae.shadowBias=re.bias,ae.shadowNormalBias=re.normalBias,ae.shadowRadius=re.radius,ae.shadowMapSize=re.mapSize,ae.shadowCameraNear=re.camera.near,ae.shadowCameraFar=re.camera.far,r.pointShadow[g]=ae,r.pointShadowMap[g]=X,r.pointShadowMatrix[g]=N.shadow.matrix,w++}r.point[g]=Q,g++}else if(N.isHemisphereLight){const Q=t.get(N);Q.skyColor.copy(N.color).multiplyScalar(H*x),Q.groundColor.copy(N.groundColor).multiplyScalar(H*x),r.hemi[y]=Q,y++}}v>0&&(e.isWebGL2||!0===n.has("OES_texture_float_linear")?(r.rectAreaLTC1=ye.LTC_FLOAT_1,r.rectAreaLTC2=ye.LTC_FLOAT_2):!0===n.has("OES_texture_half_float_linear")?(r.rectAreaLTC1=ye.LTC_HALF_1,r.rectAreaLTC2=ye.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=h,r.ambient[1]=f,r.ambient[2]=p;const E=r.hash;(E.directionalLength!==_||E.pointLength!==g||E.spotLength!==m||E.rectAreaLength!==v||E.hemiLength!==y||E.numDirectionalShadows!==b||E.numPointShadows!==w||E.numSpotShadows!==S||E.numSpotMaps!==C)&&(r.directional.length=_,r.spot.length=m,r.rectArea.length=v,r.point.length=g,r.hemi.length=y,r.directionalShadow.length=b,r.directionalShadowMap.length=b,r.pointShadow.length=w,r.pointShadowMap.length=w,r.spotShadow.length=S,r.spotShadowMap.length=S,r.directionalShadowMatrix.length=b,r.pointShadowMatrix.length=w,r.spotLightMatrix.length=S+C-I,r.spotLightMap.length=C,r.numSpotLightShadowsWithMaps=I,E.directionalLength=_,E.pointLength=g,E.spotLength=m,E.rectAreaLength=v,E.hemiLength=y,E.numDirectionalShadows=b,E.numPointShadows=w,E.numSpotShadows=S,E.numSpotMaps=C,r.version=_7++)},setupView:function c(u,d){let h=0,f=0,p=0,_=0,g=0;const m=d.matrixWorldInverse;for(let v=0,y=u.length;v<y;v++){const b=u[v];if(b.isDirectionalLight){const w=r.directional[h];w.direction.setFromMatrixPosition(b.matrixWorld),s.setFromMatrixPosition(b.target.matrixWorld),w.direction.sub(s),w.direction.transformDirection(m),h++}else if(b.isSpotLight){const w=r.spot[p];w.position.setFromMatrixPosition(b.matrixWorld),w.position.applyMatrix4(m),w.direction.setFromMatrixPosition(b.matrixWorld),s.setFromMatrixPosition(b.target.matrixWorld),w.direction.sub(s),w.direction.transformDirection(m),p++}else if(b.isRectAreaLight){const w=r.rectArea[_];w.position.setFromMatrixPosition(b.matrixWorld),w.position.applyMatrix4(m),a.identity(),o.copy(b.matrixWorld),o.premultiply(m),a.extractRotation(o),w.halfWidth.set(.5*b.width,0,0),w.halfHeight.set(0,.5*b.height,0),w.halfWidth.applyMatrix4(a),w.halfHeight.applyMatrix4(a),_++}else if(b.isPointLight){const w=r.point[f];w.position.setFromMatrixPosition(b.matrixWorld),w.position.applyMatrix4(m),f++}else if(b.isHemisphereLight){const w=r.hemi[g];w.direction.setFromMatrixPosition(b.matrixWorld),w.direction.transformDirection(m),g++}}},state:r}}function uP(n,e){const t=new y7(n,e),i=[],r=[];return{init:function s(){i.length=0,r.length=0},state:{lightsArray:i,shadowsArray:r,lights:t},setupLights:function l(d){t.setup(i,d)},setupLightsView:function c(d){t.setupView(i,d)},pushLight:function o(d){i.push(d)},pushShadow:function a(d){r.push(d)}}}function b7(n,e){let t=new WeakMap;return{get:function i(s,o=0){const a=t.get(s);let l;return void 0===a?(l=new uP(n,e),t.set(s,[l])):o>=a.length?(l=new uP(n,e),a.push(l)):l=a[o],l},dispose:function r(){t=new WeakMap}}}class dP extends ur{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class hP extends ur{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}function S7(n,e,t){let i=new V0;const r=new K,s=new K,o=new Ft,a=new dP({depthPacking:3201}),l=new hP,c={},u=t.maxTextureSize,d={0:1,1:0,2:2},h=new Hs({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new K},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),f=h.clone();f.defines.HORIZONTAL_PASS=1;const p=new pt;p.setAttribute("position",new Gt(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const _=new Pn(p,h),g=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=EI;let m=this.type;function v(w,S){const C=e.update(_);h.defines.VSM_SAMPLES!==w.blurSamples&&(h.defines.VSM_SAMPLES=w.blurSamples,f.defines.VSM_SAMPLES=w.blurSamples,h.needsUpdate=!0,f.needsUpdate=!0),null===w.mapPass&&(w.mapPass=new Ro(r.x,r.y)),h.uniforms.shadow_pass.value=w.map.texture,h.uniforms.resolution.value=w.mapSize,h.uniforms.radius.value=w.radius,n.setRenderTarget(w.mapPass),n.clear(),n.renderBufferDirect(S,null,C,h,_,null),f.uniforms.shadow_pass.value=w.mapPass.texture,f.uniforms.resolution.value=w.mapSize,f.uniforms.radius.value=w.radius,n.setRenderTarget(w.map),n.clear(),n.renderBufferDirect(S,null,C,f,_,null)}function y(w,S,C,I){let x=null;const E=!0===C.isPointLight?w.customDistanceMaterial:w.customDepthMaterial;if(void 0!==E)x=E;else if(x=!0===C.isPointLight?l:a,n.localClippingEnabled&&!0===S.clipShadows&&Array.isArray(S.clippingPlanes)&&0!==S.clippingPlanes.length||S.displacementMap&&0!==S.displacementScale||S.alphaMap&&S.alphaTest>0||S.map&&S.alphaTest>0){const B=x.uuid,Y=S.uuid;let N=c[B];void 0===N&&(N={},c[B]=N);let F=N[Y];void 0===F&&(F=x.clone(),N[Y]=F),x=F}return x.visible=S.visible,x.wireframe=S.wireframe,x.side=I===ss?null!==S.shadowSide?S.shadowSide:S.side:null!==S.shadowSide?S.shadowSide:d[S.side],x.alphaMap=S.alphaMap,x.alphaTest=S.alphaTest,x.map=S.map,x.clipShadows=S.clipShadows,x.clippingPlanes=S.clippingPlanes,x.clipIntersection=S.clipIntersection,x.displacementMap=S.displacementMap,x.displacementScale=S.displacementScale,x.displacementBias=S.displacementBias,x.wireframeLinewidth=S.wireframeLinewidth,x.linewidth=S.linewidth,!0===C.isPointLight&&!0===x.isMeshDistanceMaterial&&(n.properties.get(x).light=C),x}function b(w,S,C,I,x){if(!1===w.visible)return;if(w.layers.test(S.layers)&&(w.isMesh||w.isLine||w.isPoints)&&(w.castShadow||w.receiveShadow&&x===ss)&&(!w.frustumCulled||i.intersectsObject(w))){w.modelViewMatrix.multiplyMatrices(C.matrixWorldInverse,w.matrixWorld);const Y=e.update(w),N=w.material;if(Array.isArray(N)){const F=Y.groups;for(let H=0,ne=F.length;H<ne;H++){const X=F[H],Q=N[X.materialIndex];if(Q&&Q.visible){const re=y(w,Q,I,x);n.renderBufferDirect(C,null,Y,re,w,X)}}}else if(N.visible){const F=y(w,N,I,x);n.renderBufferDirect(C,null,Y,F,w,null)}}const B=w.children;for(let Y=0,N=B.length;Y<N;Y++)b(B[Y],S,C,I,x)}this.render=function(w,S,C){if(!1===g.enabled||!1===g.autoUpdate&&!1===g.needsUpdate||0===w.length)return;const I=n.getRenderTarget(),x=n.getActiveCubeFace(),E=n.getActiveMipmapLevel(),B=n.state;B.setBlending(0),B.buffers.color.setClear(1,1,1,1),B.buffers.depth.setTest(!0),B.setScissorTest(!1);const Y=m!==ss&&this.type===ss,N=m===ss&&this.type!==ss;for(let F=0,H=w.length;F<H;F++){const ne=w[F],X=ne.shadow;if(void 0===X){console.warn("THREE.WebGLShadowMap:",ne,"has no shadow.");continue}if(!1===X.autoUpdate&&!1===X.needsUpdate)continue;r.copy(X.mapSize);const Q=X.getFrameExtents();if(r.multiply(Q),s.copy(X.mapSize),(r.x>u||r.y>u)&&(r.x>u&&(s.x=Math.floor(u/Q.x),r.x=s.x*Q.x,X.mapSize.x=s.x),r.y>u&&(s.y=Math.floor(u/Q.y),r.y=s.y*Q.y,X.mapSize.y=s.y)),null===X.map||!0===Y||!0===N){const ae=this.type!==ss?{minFilter:dn,magFilter:dn}:{};null!==X.map&&X.map.dispose(),X.map=new Ro(r.x,r.y,ae),X.map.texture.name=ne.name+".shadowMap",X.camera.updateProjectionMatrix()}n.setRenderTarget(X.map),n.clear();const re=X.getViewportCount();for(let ae=0;ae<re;ae++){const U=X.getViewport(ae);o.set(s.x*U.x,s.y*U.y,s.x*U.z,s.y*U.w),B.viewport(o),X.updateMatrices(ne,ae),i=X.getFrustum(),b(S,C,X.camera,ne,this.type)}!0!==X.isPointLightShadow&&this.type===ss&&v(X,C),X.needsUpdate=!1}m=this.type,g.needsUpdate=!1,n.setRenderTarget(I,x,E)}}function M7(n,e,t){const i=t.isWebGL2,a=new function r(){let O=!1;const we=new Ft;let G=null;const ge=new Ft(0,0,0,0);return{setMask:function(Se){G!==Se&&!O&&(n.colorMask(Se,Se,Se,Se),G=Se)},setLocked:function(Se){O=Se},setClear:function(Se,Tt,Zt,Ln,zr){!0===zr&&(Se*=Ln,Tt*=Ln,Zt*=Ln),we.set(Se,Tt,Zt,Ln),!1===ge.equals(we)&&(n.clearColor(Se,Tt,Zt,Ln),ge.copy(we))},reset:function(){O=!1,G=null,ge.set(-1,0,0,0)}}},l=new function s(){let O=!1,we=null,G=null,ge=null;return{setTest:function(Se){Se?Ue(n.DEPTH_TEST):Fe(n.DEPTH_TEST)},setMask:function(Se){we!==Se&&!O&&(n.depthMask(Se),we=Se)},setFunc:function(Se){if(G!==Se){switch(Se){case 0:n.depthFunc(n.NEVER);break;case 1:n.depthFunc(n.ALWAYS);break;case 2:n.depthFunc(n.LESS);break;case 3:default:n.depthFunc(n.LEQUAL);break;case 4:n.depthFunc(n.EQUAL);break;case 5:n.depthFunc(n.GEQUAL);break;case 6:n.depthFunc(n.GREATER);break;case 7:n.depthFunc(n.NOTEQUAL)}G=Se}},setLocked:function(Se){O=Se},setClear:function(Se){ge!==Se&&(n.clearDepth(Se),ge=Se)},reset:function(){O=!1,we=null,G=null,ge=null}}},c=new function o(){let O=!1,we=null,G=null,ge=null,Se=null,Tt=null,Zt=null,Ln=null,zr=null;return{setTest:function(rn){O||(rn?Ue(n.STENCIL_TEST):Fe(n.STENCIL_TEST))},setMask:function(rn){we!==rn&&!O&&(n.stencilMask(rn),we=rn)},setFunc:function(rn,Gr,ii){(G!==rn||ge!==Gr||Se!==ii)&&(n.stencilFunc(rn,Gr,ii),G=rn,ge=Gr,Se=ii)},setOp:function(rn,Gr,ii){(Tt!==rn||Zt!==Gr||Ln!==ii)&&(n.stencilOp(rn,Gr,ii),Tt=rn,Zt=Gr,Ln=ii)},setLocked:function(rn){O=rn},setClear:function(rn){zr!==rn&&(n.clearStencil(rn),zr=rn)},reset:function(){O=!1,we=null,G=null,ge=null,Se=null,Tt=null,Zt=null,Ln=null,zr=null}}},u=new WeakMap,d=new WeakMap;let h={},f={},p=new WeakMap,_=[],g=null,m=!1,v=null,y=null,b=null,w=null,S=null,C=null,I=null,x=!1,E=null,B=null,Y=null,N=null,F=null;const H=n.getParameter(n.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let ne=!1,X=0;const Q=n.getParameter(n.VERSION);-1!==Q.indexOf("WebGL")?(X=parseFloat(/^WebGL (\d)/.exec(Q)[1]),ne=X>=1):-1!==Q.indexOf("OpenGL ES")&&(X=parseFloat(/^OpenGL ES (\d)/.exec(Q)[1]),ne=X>=2);let re=null,ae={};const U=n.getParameter(n.SCISSOR_BOX),J=n.getParameter(n.VIEWPORT),fe=(new Ft).fromArray(U),me=(new Ft).fromArray(J);function ve(O,we,G,ge){const Se=new Uint8Array(4),Tt=n.createTexture();n.bindTexture(O,Tt),n.texParameteri(O,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(O,n.TEXTURE_MAG_FILTER,n.NEAREST);for(let Zt=0;Zt<G;Zt++)!i||O!==n.TEXTURE_3D&&O!==n.TEXTURE_2D_ARRAY?n.texImage2D(we+Zt,0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,Se):n.texImage3D(we,0,n.RGBA,1,1,ge,0,n.RGBA,n.UNSIGNED_BYTE,Se);return Tt}const Te={};function Ue(O){!0!==h[O]&&(n.enable(O),h[O]=!0)}function Fe(O){!1!==h[O]&&(n.disable(O),h[O]=!1)}Te[n.TEXTURE_2D]=ve(n.TEXTURE_2D,n.TEXTURE_2D,1),Te[n.TEXTURE_CUBE_MAP]=ve(n.TEXTURE_CUBE_MAP,n.TEXTURE_CUBE_MAP_POSITIVE_X,6),i&&(Te[n.TEXTURE_2D_ARRAY]=ve(n.TEXTURE_2D_ARRAY,n.TEXTURE_2D_ARRAY,1,1),Te[n.TEXTURE_3D]=ve(n.TEXTURE_3D,n.TEXTURE_3D,1,1)),a.setClear(0,0,0,1),l.setClear(1),c.setClear(0),Ue(n.DEPTH_TEST),l.setFunc(3),se(!1),Be(1),Ue(n.CULL_FACE),ee(0);const L={100:n.FUNC_ADD,101:n.FUNC_SUBTRACT,102:n.FUNC_REVERSE_SUBTRACT};if(i)L[103]=n.MIN,L[104]=n.MAX;else{const O=e.get("EXT_blend_minmax");null!==O&&(L[103]=O.MIN_EXT,L[104]=O.MAX_EXT)}const pe={200:n.ZERO,201:n.ONE,202:n.SRC_COLOR,204:n.SRC_ALPHA,210:n.SRC_ALPHA_SATURATE,208:n.DST_COLOR,206:n.DST_ALPHA,203:n.ONE_MINUS_SRC_COLOR,205:n.ONE_MINUS_SRC_ALPHA,209:n.ONE_MINUS_DST_COLOR,207:n.ONE_MINUS_DST_ALPHA};function ee(O,we,G,ge,Se,Tt,Zt,Ln){if(0!==O){if(!1===m&&(Ue(n.BLEND),m=!0),5===O)Se=Se||we,Tt=Tt||G,Zt=Zt||ge,(we!==y||Se!==S)&&(n.blendEquationSeparate(L[we],L[Se]),y=we,S=Se),(G!==b||ge!==w||Tt!==C||Zt!==I)&&(n.blendFuncSeparate(pe[G],pe[ge],pe[Tt],pe[Zt]),b=G,w=ge,C=Tt,I=Zt),v=O,x=!1;else if(O!==v||Ln!==x){if((100!==y||100!==S)&&(n.blendEquation(n.FUNC_ADD),y=100,S=100),Ln)switch(O){case 1:n.blendFuncSeparate(n.ONE,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case 2:n.blendFunc(n.ONE,n.ONE);break;case 3:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case 4:n.blendFuncSeparate(n.ZERO,n.SRC_COLOR,n.ZERO,n.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",O)}else switch(O){case 1:n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case 2:n.blendFunc(n.SRC_ALPHA,n.ONE);break;case 3:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case 4:n.blendFunc(n.ZERO,n.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",O)}b=null,w=null,C=null,I=null,v=O,x=Ln}}else!0===m&&(Fe(n.BLEND),m=!1)}function se(O){E!==O&&(n.frontFace(O?n.CW:n.CCW),E=O)}function Be(O){0!==O?(Ue(n.CULL_FACE),O!==B&&n.cullFace(1===O?n.BACK:2===O?n.FRONT:n.FRONT_AND_BACK)):Fe(n.CULL_FACE),B=O}function Re(O,we,G){O?(Ue(n.POLYGON_OFFSET_FILL),(N!==we||F!==G)&&(n.polygonOffset(we,G),N=we,F=G)):Fe(n.POLYGON_OFFSET_FILL)}return{buffers:{color:a,depth:l,stencil:c},enable:Ue,disable:Fe,bindFramebuffer:function yt(O,we){return f[O]!==we&&(n.bindFramebuffer(O,we),f[O]=we,i&&(O===n.DRAW_FRAMEBUFFER&&(f[n.FRAMEBUFFER]=we),O===n.FRAMEBUFFER&&(f[n.DRAW_FRAMEBUFFER]=we)),!0)},drawBuffers:function St(O,we){let G=_,ge=!1;if(O)if(G=p.get(we),void 0===G&&(G=[],p.set(we,G)),O.isWebGLMultipleRenderTargets){const Se=O.texture;if(G.length!==Se.length||G[0]!==n.COLOR_ATTACHMENT0){for(let Tt=0,Zt=Se.length;Tt<Zt;Tt++)G[Tt]=n.COLOR_ATTACHMENT0+Tt;G.length=Se.length,ge=!0}}else G[0]!==n.COLOR_ATTACHMENT0&&(G[0]=n.COLOR_ATTACHMENT0,ge=!0);else G[0]!==n.BACK&&(G[0]=n.BACK,ge=!0);ge&&(t.isWebGL2?n.drawBuffers(G):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(G))},useProgram:function ze(O){return g!==O&&(n.useProgram(O),g=O,!0)},setBlending:ee,setMaterial:function de(O,we){2===O.side?Fe(n.CULL_FACE):Ue(n.CULL_FACE);let G=1===O.side;we&&(G=!G),se(G),1===O.blending&&!1===O.transparent?ee(0):ee(O.blending,O.blendEquation,O.blendSrc,O.blendDst,O.blendEquationAlpha,O.blendSrcAlpha,O.blendDstAlpha,O.premultipliedAlpha),l.setFunc(O.depthFunc),l.setTest(O.depthTest),l.setMask(O.depthWrite),a.setMask(O.colorWrite);const ge=O.stencilWrite;c.setTest(ge),ge&&(c.setMask(O.stencilWriteMask),c.setFunc(O.stencilFunc,O.stencilRef,O.stencilFuncMask),c.setOp(O.stencilFail,O.stencilZFail,O.stencilZPass)),Re(O.polygonOffset,O.polygonOffsetFactor,O.polygonOffsetUnits),!0===O.alphaToCoverage?Ue(n.SAMPLE_ALPHA_TO_COVERAGE):Fe(n.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:se,setCullFace:Be,setLineWidth:function Ae(O){O!==Y&&(ne&&n.lineWidth(O),Y=O)},setPolygonOffset:Re,setScissorTest:function Ke(O){O?Ue(n.SCISSOR_TEST):Fe(n.SCISSOR_TEST)},activeTexture:function _t(O){void 0===O&&(O=n.TEXTURE0+H-1),re!==O&&(n.activeTexture(O),re=O)},bindTexture:function Wt(O,we,G){void 0===G&&(G=null===re?n.TEXTURE0+H-1:re);let ge=ae[G];void 0===ge&&(ge={type:void 0,texture:void 0},ae[G]=ge),(ge.type!==O||ge.texture!==we)&&(re!==G&&(n.activeTexture(G),re=G),n.bindTexture(O,we||Te[O]),ge.type=O,ge.texture=we)},unbindTexture:function R(){const O=ae[re];void 0!==O&&void 0!==O.type&&(n.bindTexture(O.type,null),O.type=void 0,O.texture=void 0)},compressedTexImage2D:function M(){try{n.compressedTexImage2D.apply(n,arguments)}catch(O){console.error("THREE.WebGLState:",O)}},compressedTexImage3D:function j(){try{n.compressedTexImage3D.apply(n,arguments)}catch(O){console.error("THREE.WebGLState:",O)}},texImage2D:function Le(){try{n.texImage2D.apply(n,arguments)}catch(O){console.error("THREE.WebGLState:",O)}},texImage3D:function Ve(){try{n.texImage3D.apply(n,arguments)}catch(O){console.error("THREE.WebGLState:",O)}},updateUBOMapping:function Ie(O,we){let G=d.get(we);void 0===G&&(G=new WeakMap,d.set(we,G));let ge=G.get(O);void 0===ge&&(ge=n.getUniformBlockIndex(we,O.name),G.set(O,ge))},uniformBlockBinding:function Je(O,we){const ge=d.get(we).get(O);u.get(we)!==ge&&(n.uniformBlockBinding(we,ge,O.__bindingPointIndex),u.set(we,ge))},texStorage2D:function le(){try{n.texStorage2D.apply(n,arguments)}catch(O){console.error("THREE.WebGLState:",O)}},texStorage3D:function z(){try{n.texStorage3D.apply(n,arguments)}catch(O){console.error("THREE.WebGLState:",O)}},texSubImage2D:function ue(){try{n.texSubImage2D.apply(n,arguments)}catch(O){console.error("THREE.WebGLState:",O)}},texSubImage3D:function ce(){try{n.texSubImage3D.apply(n,arguments)}catch(O){console.error("THREE.WebGLState:",O)}},compressedTexSubImage2D:function P(){try{n.compressedTexSubImage2D.apply(n,arguments)}catch(O){console.error("THREE.WebGLState:",O)}},compressedTexSubImage3D:function oe(){try{n.compressedTexSubImage3D.apply(n,arguments)}catch(O){console.error("THREE.WebGLState:",O)}},scissor:function ke(O){!1===fe.equals(O)&&(n.scissor(O.x,O.y,O.z,O.w),fe.copy(O))},viewport:function Oe(O){!1===me.equals(O)&&(n.viewport(O.x,O.y,O.z,O.w),me.copy(O))},reset:function bt(){n.disable(n.BLEND),n.disable(n.CULL_FACE),n.disable(n.DEPTH_TEST),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SCISSOR_TEST),n.disable(n.STENCIL_TEST),n.disable(n.SAMPLE_ALPHA_TO_COVERAGE),n.blendEquation(n.FUNC_ADD),n.blendFunc(n.ONE,n.ZERO),n.blendFuncSeparate(n.ONE,n.ZERO,n.ONE,n.ZERO),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(n.LESS),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(n.ALWAYS,0,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.KEEP),n.clearStencil(0),n.cullFace(n.BACK),n.frontFace(n.CCW),n.polygonOffset(0,0),n.activeTexture(n.TEXTURE0),n.bindFramebuffer(n.FRAMEBUFFER,null),!0===i&&(n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),n.bindFramebuffer(n.READ_FRAMEBUFFER,null)),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),h={},re=null,ae={},f={},p=new WeakMap,_=[],g=null,m=!1,v=null,y=null,b=null,w=null,S=null,C=null,I=null,x=!1,E=null,B=null,Y=null,N=null,F=null,fe.set(0,0,n.canvas.width,n.canvas.height),me.set(0,0,n.canvas.width,n.canvas.height),a.reset(),l.reset(),c.reset()}}}function E7(n,e,t,i,r,s,o){const a=r.isWebGL2,l=r.maxTextures,c=r.maxCubemapSize,u=r.maxTextureSize,d=r.maxSamples,h=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,f=!(typeof navigator>"u")&&/OculusBrowser/g.test(navigator.userAgent),p=new WeakMap;let _;const g=new WeakMap;let m=!1;try{m=typeof OffscreenCanvas<"u"&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch{}function v(R,M){return m?new OffscreenCanvas(R,M):Pu("canvas")}function y(R,M,j,ue){let ce=1;if((R.width>ue||R.height>ue)&&(ce=ue/Math.max(R.width,R.height)),ce<1||!0===M){if(typeof HTMLImageElement<"u"&&R instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&R instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&R instanceof ImageBitmap){const P=M?fp:Math.floor,oe=P(ce*R.width),le=P(ce*R.height);void 0===_&&(_=v(oe,le));const z=j?v(oe,le):_;return z.width=oe,z.height=le,z.getContext("2d").drawImage(R,0,0,oe,le),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+R.width+"x"+R.height+") to ("+oe+"x"+le+")."),z}return"data"in R&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+R.width+"x"+R.height+")."),R}return R}function b(R){return y0(R.width)&&y0(R.height)}function S(R,M){return R.generateMipmaps&&M&&R.minFilter!==dn&&R.minFilter!==Qt}function C(R){n.generateMipmap(R)}function I(R,M,j,ue,ce=!1){if(!1===a)return M;if(null!==R){if(void 0!==n[R])return n[R];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+R+"'")}let P=M;return M===n.RED&&(j===n.FLOAT&&(P=n.R32F),j===n.HALF_FLOAT&&(P=n.R16F),j===n.UNSIGNED_BYTE&&(P=n.R8)),M===n.RG&&(j===n.FLOAT&&(P=n.RG32F),j===n.HALF_FLOAT&&(P=n.RG16F),j===n.UNSIGNED_BYTE&&(P=n.RG8)),M===n.RGBA&&(j===n.FLOAT&&(P=n.RGBA32F),j===n.HALF_FLOAT&&(P=n.RGBA16F),j===n.UNSIGNED_BYTE&&(P=ue===Ze&&!1===ce?n.SRGB8_ALPHA8:n.RGBA8),j===n.UNSIGNED_SHORT_4_4_4_4&&(P=n.RGBA4),j===n.UNSIGNED_SHORT_5_5_5_1&&(P=n.RGB5_A1)),(P===n.R16F||P===n.R32F||P===n.RG16F||P===n.RG32F||P===n.RGBA16F||P===n.RGBA32F)&&e.get("EXT_color_buffer_float"),P}function x(R,M,j){return!0===S(R,j)||R.isFramebufferTexture&&R.minFilter!==dn&&R.minFilter!==Qt?Math.log2(Math.max(M.width,M.height))+1:void 0!==R.mipmaps&&R.mipmaps.length>0?R.mipmaps.length:R.isCompressedTexture&&Array.isArray(R.image)?M.mipmaps.length:1}function E(R){return R===dn||1004===R||1005===R?n.NEAREST:n.LINEAR}function B(R){const M=R.target;M.removeEventListener("dispose",B),function N(R){const M=i.get(R);if(void 0===M.__webglInit)return;const j=R.source,ue=g.get(j);if(ue){const ce=ue[M.__cacheKey];ce.usedTimes--,0===ce.usedTimes&&F(R),0===Object.keys(ue).length&&g.delete(j)}i.remove(R)}(M),M.isVideoTexture&&p.delete(M)}function Y(R){const M=R.target;M.removeEventListener("dispose",Y),function H(R){const M=R.texture,j=i.get(R),ue=i.get(M);if(void 0!==ue.__webglTexture&&(n.deleteTexture(ue.__webglTexture),o.memory.textures--),R.depthTexture&&R.depthTexture.dispose(),R.isWebGLCubeRenderTarget)for(let ce=0;ce<6;ce++)n.deleteFramebuffer(j.__webglFramebuffer[ce]),j.__webglDepthbuffer&&n.deleteRenderbuffer(j.__webglDepthbuffer[ce]);else{if(n.deleteFramebuffer(j.__webglFramebuffer),j.__webglDepthbuffer&&n.deleteRenderbuffer(j.__webglDepthbuffer),j.__webglMultisampledFramebuffer&&n.deleteFramebuffer(j.__webglMultisampledFramebuffer),j.__webglColorRenderbuffer)for(let ce=0;ce<j.__webglColorRenderbuffer.length;ce++)j.__webglColorRenderbuffer[ce]&&n.deleteRenderbuffer(j.__webglColorRenderbuffer[ce]);j.__webglDepthRenderbuffer&&n.deleteRenderbuffer(j.__webglDepthRenderbuffer)}if(R.isWebGLMultipleRenderTargets)for(let ce=0,P=M.length;ce<P;ce++){const oe=i.get(M[ce]);oe.__webglTexture&&(n.deleteTexture(oe.__webglTexture),o.memory.textures--),i.remove(M[ce])}i.remove(M),i.remove(R)}(M)}function F(R){const M=i.get(R);n.deleteTexture(M.__webglTexture),delete g.get(R.source)[M.__cacheKey],o.memory.textures--}let ne=0;function ae(R,M){const j=i.get(R);if(R.isVideoTexture&&function _t(R){const M=o.render.frame;p.get(R)!==M&&(p.set(R,M),R.update())}(R),!1===R.isRenderTargetTexture&&R.version>0&&j.__version!==R.version){const ue=R.image;if(null===ue)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==ue.complete)return void yt(j,R,M);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}t.bindTexture(n.TEXTURE_2D,j.__webglTexture,n.TEXTURE0+M)}const me={[So]:n.REPEAT,[$n]:n.CLAMP_TO_EDGE,1002:n.MIRRORED_REPEAT},ve={[dn]:n.NEAREST,1004:n.NEAREST_MIPMAP_NEAREST,1005:n.NEAREST_MIPMAP_LINEAR,[Qt]:n.LINEAR,1007:n.LINEAR_MIPMAP_NEAREST,[ls]:n.LINEAR_MIPMAP_LINEAR},Te={512:n.NEVER,519:n.ALWAYS,513:n.LESS,515:n.LEQUAL,514:n.EQUAL,518:n.GEQUAL,516:n.GREATER,517:n.NOTEQUAL};function Ue(R,M,j){if(j?(n.texParameteri(R,n.TEXTURE_WRAP_S,me[M.wrapS]),n.texParameteri(R,n.TEXTURE_WRAP_T,me[M.wrapT]),(R===n.TEXTURE_3D||R===n.TEXTURE_2D_ARRAY)&&n.texParameteri(R,n.TEXTURE_WRAP_R,me[M.wrapR]),n.texParameteri(R,n.TEXTURE_MAG_FILTER,ve[M.magFilter]),n.texParameteri(R,n.TEXTURE_MIN_FILTER,ve[M.minFilter])):(n.texParameteri(R,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(R,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),(R===n.TEXTURE_3D||R===n.TEXTURE_2D_ARRAY)&&n.texParameteri(R,n.TEXTURE_WRAP_R,n.CLAMP_TO_EDGE),(M.wrapS!==$n||M.wrapT!==$n)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),n.texParameteri(R,n.TEXTURE_MAG_FILTER,E(M.magFilter)),n.texParameteri(R,n.TEXTURE_MIN_FILTER,E(M.minFilter)),M.minFilter!==dn&&M.minFilter!==Qt&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),M.compareFunction&&(n.texParameteri(R,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE),n.texParameteri(R,n.TEXTURE_COMPARE_FUNC,Te[M.compareFunction])),!0===e.has("EXT_texture_filter_anisotropic")){const ue=e.get("EXT_texture_filter_anisotropic");if(M.magFilter===dn||1005!==M.minFilter&&M.minFilter!==ls||M.type===cs&&!1===e.has("OES_texture_float_linear")||!1===a&&M.type===Du&&!1===e.has("OES_texture_half_float_linear"))return;(M.anisotropy>1||i.get(M).__currentAnisotropy)&&(n.texParameterf(R,ue.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(M.anisotropy,r.getMaxAnisotropy())),i.get(M).__currentAnisotropy=M.anisotropy)}}function Fe(R,M){let j=!1;void 0===R.__webglInit&&(R.__webglInit=!0,M.addEventListener("dispose",B));const ue=M.source;let ce=g.get(ue);void 0===ce&&(ce={},g.set(ue,ce));const P=function re(R){const M=[];return M.push(R.wrapS),M.push(R.wrapT),M.push(R.wrapR||0),M.push(R.magFilter),M.push(R.minFilter),M.push(R.anisotropy),M.push(R.internalFormat),M.push(R.format),M.push(R.type),M.push(R.generateMipmaps),M.push(R.premultiplyAlpha),M.push(R.flipY),M.push(R.unpackAlignment),M.push(R.colorSpace),M.join()}(M);if(P!==R.__cacheKey){void 0===ce[P]&&(ce[P]={texture:n.createTexture(),usedTimes:0},o.memory.textures++,j=!0),ce[P].usedTimes++;const oe=ce[R.__cacheKey];void 0!==oe&&(ce[R.__cacheKey].usedTimes--,0===oe.usedTimes&&F(M)),R.__cacheKey=P,R.__webglTexture=ce[P].texture}return j}function yt(R,M,j){let ue=n.TEXTURE_2D;(M.isDataArrayTexture||M.isCompressedArrayTexture)&&(ue=n.TEXTURE_2D_ARRAY),M.isData3DTexture&&(ue=n.TEXTURE_3D);const ce=Fe(R,M),P=M.source;t.bindTexture(ue,R.__webglTexture,n.TEXTURE0+j);const oe=i.get(P);if(P.version!==oe.__version||!0===ce){t.activeTexture(n.TEXTURE0+j),n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,M.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,M.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,M.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,n.NONE);const le=function w(R){return!a&&(R.wrapS!==$n||R.wrapT!==$n||R.minFilter!==dn&&R.minFilter!==Qt)}(M)&&!1===b(M.image);let z=y(M.image,le,!1,u);z=Wt(M,z);const Le=b(z)||a,Ve=s.convert(M.format,M.colorSpace);let Ie,ke=s.convert(M.type),Oe=I(M.internalFormat,Ve,ke,M.colorSpace);Ue(ue,M,Le);const Je=M.mipmaps,bt=a&&!0!==M.isVideoTexture,O=void 0===oe.__version||!0===ce,we=x(M,z,Le);if(M.isDepthTexture)Oe=n.DEPTH_COMPONENT,a?Oe=M.type===cs?n.DEPTH_COMPONENT32F:M.type===Ns?n.DEPTH_COMPONENT24:M.type===Mo?n.DEPTH24_STENCIL8:n.DEPTH_COMPONENT16:M.type===cs&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),M.format===Eo&&Oe===n.DEPTH_COMPONENT&&1012!==M.type&&M.type!==Ns&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),M.type=Ns,ke=s.convert(M.type)),M.format===cl&&Oe===n.DEPTH_COMPONENT&&(Oe=n.DEPTH_STENCIL,M.type!==Mo&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),M.type=Mo,ke=s.convert(M.type))),O&&(bt?t.texStorage2D(n.TEXTURE_2D,1,Oe,z.width,z.height):t.texImage2D(n.TEXTURE_2D,0,Oe,z.width,z.height,0,Ve,ke,null));else if(M.isDataTexture)if(Je.length>0&&Le){bt&&O&&t.texStorage2D(n.TEXTURE_2D,we,Oe,Je[0].width,Je[0].height);for(let G=0,ge=Je.length;G<ge;G++)Ie=Je[G],bt?t.texSubImage2D(n.TEXTURE_2D,G,0,0,Ie.width,Ie.height,Ve,ke,Ie.data):t.texImage2D(n.TEXTURE_2D,G,Oe,Ie.width,Ie.height,0,Ve,ke,Ie.data);M.generateMipmaps=!1}else bt?(O&&t.texStorage2D(n.TEXTURE_2D,we,Oe,z.width,z.height),t.texSubImage2D(n.TEXTURE_2D,0,0,0,z.width,z.height,Ve,ke,z.data)):t.texImage2D(n.TEXTURE_2D,0,Oe,z.width,z.height,0,Ve,ke,z.data);else if(M.isCompressedTexture)if(M.isCompressedArrayTexture){bt&&O&&t.texStorage3D(n.TEXTURE_2D_ARRAY,we,Oe,Je[0].width,Je[0].height,z.depth);for(let G=0,ge=Je.length;G<ge;G++)Ie=Je[G],M.format!==Gi?null!==Ve?bt?t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,G,0,0,0,Ie.width,Ie.height,z.depth,Ve,Ie.data,0,0):t.compressedTexImage3D(n.TEXTURE_2D_ARRAY,G,Oe,Ie.width,Ie.height,z.depth,0,Ie.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):bt?t.texSubImage3D(n.TEXTURE_2D_ARRAY,G,0,0,0,Ie.width,Ie.height,z.depth,Ve,ke,Ie.data):t.texImage3D(n.TEXTURE_2D_ARRAY,G,Oe,Ie.width,Ie.height,z.depth,0,Ve,ke,Ie.data)}else{bt&&O&&t.texStorage2D(n.TEXTURE_2D,we,Oe,Je[0].width,Je[0].height);for(let G=0,ge=Je.length;G<ge;G++)Ie=Je[G],M.format!==Gi?null!==Ve?bt?t.compressedTexSubImage2D(n.TEXTURE_2D,G,0,0,Ie.width,Ie.height,Ve,Ie.data):t.compressedTexImage2D(n.TEXTURE_2D,G,Oe,Ie.width,Ie.height,0,Ie.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):bt?t.texSubImage2D(n.TEXTURE_2D,G,0,0,Ie.width,Ie.height,Ve,ke,Ie.data):t.texImage2D(n.TEXTURE_2D,G,Oe,Ie.width,Ie.height,0,Ve,ke,Ie.data)}else if(M.isDataArrayTexture)bt?(O&&t.texStorage3D(n.TEXTURE_2D_ARRAY,we,Oe,z.width,z.height,z.depth),t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,0,z.width,z.height,z.depth,Ve,ke,z.data)):t.texImage3D(n.TEXTURE_2D_ARRAY,0,Oe,z.width,z.height,z.depth,0,Ve,ke,z.data);else if(M.isData3DTexture)bt?(O&&t.texStorage3D(n.TEXTURE_3D,we,Oe,z.width,z.height,z.depth),t.texSubImage3D(n.TEXTURE_3D,0,0,0,0,z.width,z.height,z.depth,Ve,ke,z.data)):t.texImage3D(n.TEXTURE_3D,0,Oe,z.width,z.height,z.depth,0,Ve,ke,z.data);else if(M.isFramebufferTexture){if(O)if(bt)t.texStorage2D(n.TEXTURE_2D,we,Oe,z.width,z.height);else{let G=z.width,ge=z.height;for(let Se=0;Se<we;Se++)t.texImage2D(n.TEXTURE_2D,Se,Oe,G,ge,0,Ve,ke,null),G>>=1,ge>>=1}}else if(Je.length>0&&Le){bt&&O&&t.texStorage2D(n.TEXTURE_2D,we,Oe,Je[0].width,Je[0].height);for(let G=0,ge=Je.length;G<ge;G++)Ie=Je[G],bt?t.texSubImage2D(n.TEXTURE_2D,G,0,0,Ve,ke,Ie):t.texImage2D(n.TEXTURE_2D,G,Oe,Ve,ke,Ie);M.generateMipmaps=!1}else bt?(O&&t.texStorage2D(n.TEXTURE_2D,we,Oe,z.width,z.height),t.texSubImage2D(n.TEXTURE_2D,0,0,0,Ve,ke,z)):t.texImage2D(n.TEXTURE_2D,0,Oe,Ve,ke,z);S(M,Le)&&C(ue),oe.__version=P.version,M.onUpdate&&M.onUpdate(M)}R.__version=M.version}function ze(R,M,j,ue,ce){const P=s.convert(j.format,j.colorSpace),oe=s.convert(j.type),le=I(j.internalFormat,P,oe,j.colorSpace);i.get(M).__hasExternalTextures||(ce===n.TEXTURE_3D||ce===n.TEXTURE_2D_ARRAY?t.texImage3D(ce,0,le,M.width,M.height,M.depth,0,P,oe,null):t.texImage2D(ce,0,le,M.width,M.height,0,P,oe,null)),t.bindFramebuffer(n.FRAMEBUFFER,R),Ke(M)?h.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,ue,ce,i.get(j).__webglTexture,0,Re(M)):(ce===n.TEXTURE_2D||ce>=n.TEXTURE_CUBE_MAP_POSITIVE_X&&ce<=n.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&n.framebufferTexture2D(n.FRAMEBUFFER,ue,ce,i.get(j).__webglTexture,0),t.bindFramebuffer(n.FRAMEBUFFER,null)}function L(R,M,j){if(n.bindRenderbuffer(n.RENDERBUFFER,R),M.depthBuffer&&!M.stencilBuffer){let ue=n.DEPTH_COMPONENT16;if(j||Ke(M)){const ce=M.depthTexture;ce&&ce.isDepthTexture&&(ce.type===cs?ue=n.DEPTH_COMPONENT32F:ce.type===Ns&&(ue=n.DEPTH_COMPONENT24));const P=Re(M);Ke(M)?h.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,P,ue,M.width,M.height):n.renderbufferStorageMultisample(n.RENDERBUFFER,P,ue,M.width,M.height)}else n.renderbufferStorage(n.RENDERBUFFER,ue,M.width,M.height);n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,R)}else if(M.depthBuffer&&M.stencilBuffer){const ue=Re(M);j&&!1===Ke(M)?n.renderbufferStorageMultisample(n.RENDERBUFFER,ue,n.DEPTH24_STENCIL8,M.width,M.height):Ke(M)?h.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,ue,n.DEPTH24_STENCIL8,M.width,M.height):n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,M.width,M.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,R)}else{const ue=!0===M.isWebGLMultipleRenderTargets?M.texture:[M.texture];for(let ce=0;ce<ue.length;ce++){const P=ue[ce],oe=s.convert(P.format,P.colorSpace),le=s.convert(P.type),z=I(P.internalFormat,oe,le,P.colorSpace),Le=Re(M);j&&!1===Ke(M)?n.renderbufferStorageMultisample(n.RENDERBUFFER,Le,z,M.width,M.height):Ke(M)?h.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,Le,z,M.width,M.height):n.renderbufferStorage(n.RENDERBUFFER,z,M.width,M.height)}}n.bindRenderbuffer(n.RENDERBUFFER,null)}function ee(R){const M=i.get(R),j=!0===R.isWebGLCubeRenderTarget;if(R.depthTexture&&!M.__autoAllocateDepthBuffer){if(j)throw new Error("target.depthTexture not supported in Cube render targets");!function pe(R,M){if(M&&M.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(n.FRAMEBUFFER,R),!M.depthTexture||!M.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(M.depthTexture).__webglTexture||M.depthTexture.image.width!==M.width||M.depthTexture.image.height!==M.height)&&(M.depthTexture.image.width=M.width,M.depthTexture.image.height=M.height,M.depthTexture.needsUpdate=!0),ae(M.depthTexture,0);const ue=i.get(M.depthTexture).__webglTexture,ce=Re(M);if(M.depthTexture.format===Eo)Ke(M)?h.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,ue,0,ce):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,ue,0);else{if(M.depthTexture.format!==cl)throw new Error("Unknown depthTexture format");Ke(M)?h.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,ue,0,ce):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,ue,0)}}(M.__webglFramebuffer,R)}else if(j){M.__webglDepthbuffer=[];for(let ue=0;ue<6;ue++)t.bindFramebuffer(n.FRAMEBUFFER,M.__webglFramebuffer[ue]),M.__webglDepthbuffer[ue]=n.createRenderbuffer(),L(M.__webglDepthbuffer[ue],R,!1)}else t.bindFramebuffer(n.FRAMEBUFFER,M.__webglFramebuffer),M.__webglDepthbuffer=n.createRenderbuffer(),L(M.__webglDepthbuffer,R,!1);t.bindFramebuffer(n.FRAMEBUFFER,null)}function Re(R){return Math.min(d,R.samples)}function Ke(R){const M=i.get(R);return a&&R.samples>0&&!0===e.has("WEBGL_multisampled_render_to_texture")&&!1!==M.__useRenderToTexture}function Wt(R,M){const j=R.colorSpace,ue=R.format,ce=R.type;return!0===R.isCompressedTexture||1035===R.format||j!==rr&&""!==j&&(j===Ze?!1===a?!0===e.has("EXT_sRGB")&&ue===Gi?(R.format=1035,R.minFilter=Qt,R.generateMipmaps=!1):M=v1.sRGBToLinear(M):(ue!==Gi||ce!==Os)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",j)),M}this.allocateTextureUnit=function Q(){const R=ne;return R>=l&&console.warn("THREE.WebGLTextures: Trying to use "+R+" texture units while this GPU supports only "+l),ne+=1,R},this.resetTextureUnits=function X(){ne=0},this.setTexture2D=ae,this.setTexture2DArray=function U(R,M){const j=i.get(R);R.version>0&&j.__version!==R.version?yt(j,R,M):t.bindTexture(n.TEXTURE_2D_ARRAY,j.__webglTexture,n.TEXTURE0+M)},this.setTexture3D=function J(R,M){const j=i.get(R);R.version>0&&j.__version!==R.version?yt(j,R,M):t.bindTexture(n.TEXTURE_3D,j.__webglTexture,n.TEXTURE0+M)},this.setTextureCube=function fe(R,M){const j=i.get(R);R.version>0&&j.__version!==R.version?function St(R,M,j){if(6!==M.image.length)return;const ue=Fe(R,M),ce=M.source;t.bindTexture(n.TEXTURE_CUBE_MAP,R.__webglTexture,n.TEXTURE0+j);const P=i.get(ce);if(ce.version!==P.__version||!0===ue){t.activeTexture(n.TEXTURE0+j),n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,M.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,M.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,M.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,n.NONE);const oe=M.isCompressedTexture||M.image[0].isCompressedTexture,le=M.image[0]&&M.image[0].isDataTexture,z=[];for(let G=0;G<6;G++)z[G]=oe||le?le?M.image[G].image:M.image[G]:y(M.image[G],!1,!0,c),z[G]=Wt(M,z[G]);const Le=z[0],Ve=b(Le)||a,ke=s.convert(M.format,M.colorSpace),Oe=s.convert(M.type),Ie=I(M.internalFormat,ke,Oe,M.colorSpace),Je=a&&!0!==M.isVideoTexture,bt=void 0===P.__version||!0===ue;let we,O=x(M,Le,Ve);if(Ue(n.TEXTURE_CUBE_MAP,M,Ve),oe){Je&&bt&&t.texStorage2D(n.TEXTURE_CUBE_MAP,O,Ie,Le.width,Le.height);for(let G=0;G<6;G++){we=z[G].mipmaps;for(let ge=0;ge<we.length;ge++){const Se=we[ge];M.format!==Gi?null!==ke?Je?t.compressedTexSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+G,ge,0,0,Se.width,Se.height,ke,Se.data):t.compressedTexImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+G,ge,Ie,Se.width,Se.height,0,Se.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Je?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+G,ge,0,0,Se.width,Se.height,ke,Oe,Se.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+G,ge,Ie,Se.width,Se.height,0,ke,Oe,Se.data)}}}else{we=M.mipmaps,Je&&bt&&(we.length>0&&O++,t.texStorage2D(n.TEXTURE_CUBE_MAP,O,Ie,z[0].width,z[0].height));for(let G=0;G<6;G++)if(le){Je?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+G,0,0,0,z[G].width,z[G].height,ke,Oe,z[G].data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+G,0,Ie,z[G].width,z[G].height,0,ke,Oe,z[G].data);for(let ge=0;ge<we.length;ge++){const Tt=we[ge].image[G].image;Je?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+G,ge+1,0,0,Tt.width,Tt.height,ke,Oe,Tt.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+G,ge+1,Ie,Tt.width,Tt.height,0,ke,Oe,Tt.data)}}else{Je?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+G,0,0,0,ke,Oe,z[G]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+G,0,Ie,ke,Oe,z[G]);for(let ge=0;ge<we.length;ge++){const Se=we[ge];Je?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+G,ge+1,0,0,ke,Oe,Se.image[G]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+G,ge+1,Ie,ke,Oe,Se.image[G])}}}S(M,Ve)&&C(n.TEXTURE_CUBE_MAP),P.__version=ce.version,M.onUpdate&&M.onUpdate(M)}R.__version=M.version}(j,R,M):t.bindTexture(n.TEXTURE_CUBE_MAP,j.__webglTexture,n.TEXTURE0+M)},this.rebindTextures=function de(R,M,j){const ue=i.get(R);void 0!==M&&ze(ue.__webglFramebuffer,R,R.texture,n.COLOR_ATTACHMENT0,n.TEXTURE_2D),void 0!==j&&ee(R)},this.setupRenderTarget=function se(R){const M=R.texture,j=i.get(R),ue=i.get(M);R.addEventListener("dispose",Y),!0!==R.isWebGLMultipleRenderTargets&&(void 0===ue.__webglTexture&&(ue.__webglTexture=n.createTexture()),ue.__version=M.version,o.memory.textures++);const ce=!0===R.isWebGLCubeRenderTarget,P=!0===R.isWebGLMultipleRenderTargets,oe=b(R)||a;if(ce){j.__webglFramebuffer=[];for(let le=0;le<6;le++)j.__webglFramebuffer[le]=n.createFramebuffer()}else{if(j.__webglFramebuffer=n.createFramebuffer(),P)if(r.drawBuffers){const le=R.texture;for(let z=0,Le=le.length;z<Le;z++){const Ve=i.get(le[z]);void 0===Ve.__webglTexture&&(Ve.__webglTexture=n.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(a&&R.samples>0&&!1===Ke(R)){const le=P?M:[M];j.__webglMultisampledFramebuffer=n.createFramebuffer(),j.__webglColorRenderbuffer=[],t.bindFramebuffer(n.FRAMEBUFFER,j.__webglMultisampledFramebuffer);for(let z=0;z<le.length;z++){const Le=le[z];j.__webglColorRenderbuffer[z]=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,j.__webglColorRenderbuffer[z]);const Ve=s.convert(Le.format,Le.colorSpace),ke=s.convert(Le.type),Oe=I(Le.internalFormat,Ve,ke,Le.colorSpace,!0===R.isXRRenderTarget),Ie=Re(R);n.renderbufferStorageMultisample(n.RENDERBUFFER,Ie,Oe,R.width,R.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+z,n.RENDERBUFFER,j.__webglColorRenderbuffer[z])}n.bindRenderbuffer(n.RENDERBUFFER,null),R.depthBuffer&&(j.__webglDepthRenderbuffer=n.createRenderbuffer(),L(j.__webglDepthRenderbuffer,R,!0)),t.bindFramebuffer(n.FRAMEBUFFER,null)}}if(ce){t.bindTexture(n.TEXTURE_CUBE_MAP,ue.__webglTexture),Ue(n.TEXTURE_CUBE_MAP,M,oe);for(let le=0;le<6;le++)ze(j.__webglFramebuffer[le],R,M,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+le);S(M,oe)&&C(n.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(P){const le=R.texture;for(let z=0,Le=le.length;z<Le;z++){const Ve=le[z],ke=i.get(Ve);t.bindTexture(n.TEXTURE_2D,ke.__webglTexture),Ue(n.TEXTURE_2D,Ve,oe),ze(j.__webglFramebuffer,R,Ve,n.COLOR_ATTACHMENT0+z,n.TEXTURE_2D),S(Ve,oe)&&C(n.TEXTURE_2D)}t.unbindTexture()}else{let le=n.TEXTURE_2D;(R.isWebGL3DRenderTarget||R.isWebGLArrayRenderTarget)&&(a?le=R.isWebGL3DRenderTarget?n.TEXTURE_3D:n.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(le,ue.__webglTexture),Ue(le,M,oe),ze(j.__webglFramebuffer,R,M,n.COLOR_ATTACHMENT0,le),S(M,oe)&&C(le),t.unbindTexture()}R.depthBuffer&&ee(R)},this.updateRenderTargetMipmap=function Be(R){const M=b(R)||a,j=!0===R.isWebGLMultipleRenderTargets?R.texture:[R.texture];for(let ue=0,ce=j.length;ue<ce;ue++){const P=j[ue];if(S(P,M)){const oe=R.isWebGLCubeRenderTarget?n.TEXTURE_CUBE_MAP:n.TEXTURE_2D,le=i.get(P).__webglTexture;t.bindTexture(oe,le),C(oe),t.unbindTexture()}}},this.updateMultisampleRenderTarget=function Ae(R){if(a&&R.samples>0&&!1===Ke(R)){const M=R.isWebGLMultipleRenderTargets?R.texture:[R.texture],j=R.width,ue=R.height;let ce=n.COLOR_BUFFER_BIT;const P=[],oe=R.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,le=i.get(R),z=!0===R.isWebGLMultipleRenderTargets;if(z)for(let Le=0;Le<M.length;Le++)t.bindFramebuffer(n.FRAMEBUFFER,le.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+Le,n.RENDERBUFFER,null),t.bindFramebuffer(n.FRAMEBUFFER,le.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+Le,n.TEXTURE_2D,null,0);t.bindFramebuffer(n.READ_FRAMEBUFFER,le.__webglMultisampledFramebuffer),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,le.__webglFramebuffer);for(let Le=0;Le<M.length;Le++){P.push(n.COLOR_ATTACHMENT0+Le),R.depthBuffer&&P.push(oe);const Ve=void 0!==le.__ignoreDepthValues&&le.__ignoreDepthValues;if(!1===Ve&&(R.depthBuffer&&(ce|=n.DEPTH_BUFFER_BIT),R.stencilBuffer&&(ce|=n.STENCIL_BUFFER_BIT)),z&&n.framebufferRenderbuffer(n.READ_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,le.__webglColorRenderbuffer[Le]),!0===Ve&&(n.invalidateFramebuffer(n.READ_FRAMEBUFFER,[oe]),n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,[oe])),z){const ke=i.get(M[Le]).__webglTexture;n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,ke,0)}n.blitFramebuffer(0,0,j,ue,0,0,j,ue,ce,n.NEAREST),f&&n.invalidateFramebuffer(n.READ_FRAMEBUFFER,P)}if(t.bindFramebuffer(n.READ_FRAMEBUFFER,null),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),z)for(let Le=0;Le<M.length;Le++){t.bindFramebuffer(n.FRAMEBUFFER,le.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+Le,n.RENDERBUFFER,le.__webglColorRenderbuffer[Le]);const Ve=i.get(M[Le]).__webglTexture;t.bindFramebuffer(n.FRAMEBUFFER,le.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+Le,n.TEXTURE_2D,Ve,0)}t.bindFramebuffer(n.DRAW_FRAMEBUFFER,le.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=ee,this.setupFrameBufferTexture=ze,this.useMultisampledRTT=Ke}function A7(n,e,t){const i=t.isWebGL2;return{convert:function r(s,o=""){let a;if(s===Os)return n.UNSIGNED_BYTE;if(1017===s)return n.UNSIGNED_SHORT_4_4_4_4;if(1018===s)return n.UNSIGNED_SHORT_5_5_5_1;if(1010===s)return n.BYTE;if(1011===s)return n.SHORT;if(1012===s)return n.UNSIGNED_SHORT;if(1013===s)return n.INT;if(s===Ns)return n.UNSIGNED_INT;if(s===cs)return n.FLOAT;if(s===Du)return i?n.HALF_FLOAT:(a=e.get("OES_texture_half_float"),null!==a?a.HALF_FLOAT_OES:null);if(1021===s)return n.ALPHA;if(s===Gi)return n.RGBA;if(1024===s)return n.LUMINANCE;if(1025===s)return n.LUMINANCE_ALPHA;if(s===Eo)return n.DEPTH_COMPONENT;if(s===cl)return n.DEPTH_STENCIL;if(1035===s)return a=e.get("EXT_sRGB"),null!==a?a.SRGB_ALPHA_EXT:null;if(1028===s)return n.RED;if(1029===s)return n.RED_INTEGER;if(1030===s)return n.RG;if(1031===s)return n.RG_INTEGER;if(1033===s)return n.RGBA_INTEGER;if(33776===s||33777===s||33778===s||33779===s)if(o===Ze){if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),null===a)return null;if(33776===s)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(33777===s)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(33778===s)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(33779===s)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(a=e.get("WEBGL_compressed_texture_s3tc"),null===a)return null;if(33776===s)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===s)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===s)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===s)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===s||35841===s||35842===s||35843===s){if(a=e.get("WEBGL_compressed_texture_pvrtc"),null===a)return null;if(35840===s)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===s)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===s)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===s)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===s)return a=e.get("WEBGL_compressed_texture_etc1"),null!==a?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(37492===s||37496===s){if(a=e.get("WEBGL_compressed_texture_etc"),null===a)return null;if(37492===s)return o===Ze?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(37496===s)return o===Ze?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}if(37808===s||37809===s||37810===s||37811===s||37812===s||37813===s||37814===s||37815===s||37816===s||37817===s||37818===s||37819===s||37820===s||37821===s){if(a=e.get("WEBGL_compressed_texture_astc"),null===a)return null;if(37808===s)return o===Ze?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(37809===s)return o===Ze?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(37810===s)return o===Ze?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(37811===s)return o===Ze?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(37812===s)return o===Ze?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(37813===s)return o===Ze?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(37814===s)return o===Ze?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(37815===s)return o===Ze?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(37816===s)return o===Ze?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(37817===s)return o===Ze?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(37818===s)return o===Ze?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(37819===s)return o===Ze?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(37820===s)return o===Ze?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(37821===s)return o===Ze?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}if(36492===s){if(a=e.get("EXT_texture_compression_bptc"),null===a)return null;if(36492===s)return o===Ze?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT}if(36283===s||36284===s||36285===s||36286===s){if(a=e.get("EXT_texture_compression_rgtc"),null===a)return null;if(36492===s)return a.COMPRESSED_RED_RGTC1_EXT;if(36284===s)return a.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(36285===s)return a.COMPRESSED_RED_GREEN_RGTC2_EXT;if(36286===s)return a.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return s===Mo?i?n.UNSIGNED_INT_24_8:(a=e.get("WEBGL_depth_texture"),null!==a?a.UNSIGNED_INT_24_8_WEBGL:null):void 0!==n[s]?n[s]:null}}}class C7 extends hn{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class kr extends Rn{constructor(){super(),this.isGroup=!0,this.type="Group"}}const T7={type:"move"};class $0{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new kr,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new kr,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new T,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new T),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new kr,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new T,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new T),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const i of e.hand.values())this._getHandJoint(t,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,i){let r=null,s=null,o=null;const a=this._targetRay,l=this._grip,c=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(c&&e.hand){o=!0;for(const _ of e.hand.values()){const g=t.getJointPose(_,i),m=this._getHandJoint(c,_);null!==g&&(m.matrix.fromArray(g.transform.matrix),m.matrix.decompose(m.position,m.rotation,m.scale),m.matrixWorldNeedsUpdate=!0,m.jointRadius=g.radius),m.visible=null!==g}const h=c.joints["index-finger-tip"].position.distanceTo(c.joints["thumb-tip"].position),f=.02,p=.005;c.inputState.pinching&&h>f+p?(c.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!c.inputState.pinching&&h<=f-p&&(c.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==l&&e.gripSpace&&(s=t.getPose(e.gripSpace,i),null!==s&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));null!==a&&(r=t.getPose(e.targetRaySpace,i),null===r&&null!==s&&(r=s),null!==r&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(T7)))}return null!==a&&(a.visible=null!==r),null!==l&&(l.visible=null!==s),null!==c&&(c.visible=null!==o),this}_getHandJoint(e,t){if(void 0===e.joints[t.jointName]){const i=new kr;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[t.jointName]=i,e.add(i)}return e.joints[t.jointName]}}class D7 extends or{constructor(e,t,i,r,s,o,a,l,c,u){if((u=void 0!==u?u:Eo)!==Eo&&u!==cl)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===i&&u===Eo&&(i=Ns),void 0===i&&u===cl&&(i=Mo),super(null,r,s,o,a,l,u,i,c),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=void 0!==a?a:dn,this.minFilter=void 0!==l?l:dn,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return null!==this.compareFunction&&(t.compareFunction=this.compareFunction),t}}class R7 extends Fs{constructor(e,t){super();const i=this;let r=null,s=1,o=null,a="local-floor",l=1,c=null,u=null,d=null,h=null,f=null,p=null;const _=t.getContextAttributes();let g=null,m=null;const v=[],y=[],b=new hn;b.layers.enable(1),b.viewport=new Ft;const w=new hn;w.layers.enable(2),w.viewport=new Ft;const S=[b,w],C=new C7;C.layers.enable(1),C.layers.enable(2);let I=null,x=null;function E(U){const J=y.indexOf(U.inputSource);if(-1===J)return;const fe=v[J];void 0!==fe&&(fe.update(U.inputSource,U.frame,c||o),fe.dispatchEvent({type:U.type,data:U.inputSource}))}function B(){r.removeEventListener("select",E),r.removeEventListener("selectstart",E),r.removeEventListener("selectend",E),r.removeEventListener("squeeze",E),r.removeEventListener("squeezestart",E),r.removeEventListener("squeezeend",E),r.removeEventListener("end",B),r.removeEventListener("inputsourceschange",Y);for(let U=0;U<v.length;U++){const J=y[U];null!==J&&(y[U]=null,v[U].disconnect(J))}I=null,x=null,e.setRenderTarget(g),f=null,h=null,d=null,r=null,m=null,ae.stop(),i.isPresenting=!1,i.dispatchEvent({type:"sessionend"})}function Y(U){for(let J=0;J<U.removed.length;J++){const fe=U.removed[J],me=y.indexOf(fe);me>=0&&(y[me]=null,v[me].disconnect(fe))}for(let J=0;J<U.added.length;J++){const fe=U.added[J];let me=y.indexOf(fe);if(-1===me){for(let Te=0;Te<v.length;Te++){if(Te>=y.length){y.push(fe),me=Te;break}if(null===y[Te]){y[Te]=fe,me=Te;break}}if(-1===me)break}const ve=v[me];ve&&ve.connect(fe)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(U){let J=v[U];return void 0===J&&(J=new $0,v[U]=J),J.getTargetRaySpace()},this.getControllerGrip=function(U){let J=v[U];return void 0===J&&(J=new $0,v[U]=J),J.getGripSpace()},this.getHand=function(U){let J=v[U];return void 0===J&&(J=new $0,v[U]=J),J.getHandSpace()},this.setFramebufferScaleFactor=function(U){s=U,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(U){a=U,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return c||o},this.setReferenceSpace=function(U){c=U},this.getBaseLayer=function(){return null!==h?h:f},this.getBinding=function(){return d},this.getFrame=function(){return p},this.getSession=function(){return r},this.setSession=function(){var U=sp(function*(J){if(r=J,null!==r){if(g=e.getRenderTarget(),r.addEventListener("select",E),r.addEventListener("selectstart",E),r.addEventListener("selectend",E),r.addEventListener("squeeze",E),r.addEventListener("squeezestart",E),r.addEventListener("squeezeend",E),r.addEventListener("end",B),r.addEventListener("inputsourceschange",Y),!0!==_.xrCompatible&&(yield t.makeXRCompatible()),void 0===r.renderState.layers||!1===e.capabilities.isWebGL2)f=new XRWebGLLayer(r,t,{antialias:void 0!==r.renderState.layers||_.antialias,alpha:!0,depth:_.depth,stencil:_.stencil,framebufferScaleFactor:s}),r.updateRenderState({baseLayer:f}),m=new Ro(f.framebufferWidth,f.framebufferHeight,{format:Gi,type:Os,colorSpace:e.outputColorSpace,stencilBuffer:_.stencil});else{let fe=null,me=null,ve=null;_.depth&&(ve=_.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,fe=_.stencil?cl:Eo,me=_.stencil?Mo:Ns);const Te={colorFormat:t.RGBA8,depthFormat:ve,scaleFactor:s};d=new XRWebGLBinding(r,t),h=d.createProjectionLayer(Te),r.updateRenderState({layers:[h]}),m=new Ro(h.textureWidth,h.textureHeight,{format:Gi,type:Os,depthTexture:new D7(h.textureWidth,h.textureHeight,me,void 0,void 0,void 0,void 0,void 0,void 0,fe),stencilBuffer:_.stencil,colorSpace:e.outputColorSpace,samples:_.antialias?4:0}),e.properties.get(m).__ignoreDepthValues=h.ignoreDepthValues}m.isXRRenderTarget=!0,this.setFoveation(l),c=null,o=yield r.requestReferenceSpace(a),ae.setContext(r),ae.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}});return function(J){return U.apply(this,arguments)}}(),this.getEnvironmentBlendMode=function(){if(null!==r)return r.environmentBlendMode};const N=new T,F=new T;function ne(U,J){null===J?U.matrixWorld.copy(U.matrix):U.matrixWorld.multiplyMatrices(J.matrixWorld,U.matrix),U.matrixWorldInverse.copy(U.matrixWorld).invert()}this.updateCamera=function(U){if(null===r)return;C.near=w.near=b.near=U.near,C.far=w.far=b.far=U.far,(I!==C.near||x!==C.far)&&(r.updateRenderState({depthNear:C.near,depthFar:C.far}),I=C.near,x=C.far);const J=U.parent,fe=C.cameras;ne(C,J);for(let me=0;me<fe.length;me++)ne(fe[me],J);2===fe.length?function H(U,J,fe){N.setFromMatrixPosition(J.matrixWorld),F.setFromMatrixPosition(fe.matrixWorld);const me=N.distanceTo(F),ve=J.projectionMatrix.elements,Te=fe.projectionMatrix.elements,Ue=ve[14]/(ve[10]-1),Fe=ve[14]/(ve[10]+1),yt=(ve[9]+1)/ve[5],St=(ve[9]-1)/ve[5],ze=(ve[8]-1)/ve[0],L=(Te[8]+1)/Te[0],pe=Ue*ze,ee=Ue*L,de=me/(-ze+L),se=de*-ze;J.matrixWorld.decompose(U.position,U.quaternion,U.scale),U.translateX(se),U.translateZ(de),U.matrixWorld.compose(U.position,U.quaternion,U.scale),U.matrixWorldInverse.copy(U.matrixWorld).invert();const Be=Ue+de,Ae=Fe+de;U.projectionMatrix.makePerspective(pe-se,ee+(me-se),yt*Fe/Ae*Be,St*Fe/Ae*Be,Be,Ae),U.projectionMatrixInverse.copy(U.projectionMatrix).invert()}(C,b,w):C.projectionMatrix.copy(b.projectionMatrix),function X(U,J,fe){null===fe?U.matrix.copy(J.matrixWorld):(U.matrix.copy(fe.matrixWorld),U.matrix.invert(),U.matrix.multiply(J.matrixWorld)),U.matrix.decompose(U.position,U.quaternion,U.scale),U.updateMatrixWorld(!0);const me=U.children;for(let ve=0,Te=me.length;ve<Te;ve++)me[ve].updateMatrixWorld(!0);U.projectionMatrix.copy(J.projectionMatrix),U.projectionMatrixInverse.copy(J.projectionMatrixInverse),U.isPerspectiveCamera&&(U.fov=2*fl*Math.atan(1/U.projectionMatrix.elements[5]),U.zoom=1)}(U,C,J)},this.getCamera=function(){return C},this.getFoveation=function(){if(null!==h||null!==f)return l},this.setFoveation=function(U){l=U,null!==h&&(h.fixedFoveation=U),null!==f&&void 0!==f.fixedFoveation&&(f.fixedFoveation=U)};let Q=null;const ae=new U1;ae.setAnimationLoop(function re(U,J){if(u=J.getViewerPose(c||o),p=J,null!==u){const fe=u.views;null!==f&&(e.setRenderTargetFramebuffer(m,f.framebuffer),e.setRenderTarget(m));let me=!1;fe.length!==C.cameras.length&&(C.cameras.length=0,me=!0);for(let ve=0;ve<fe.length;ve++){const Te=fe[ve];let Ue=null;if(null!==f)Ue=f.getViewport(Te);else{const yt=d.getViewSubImage(h,Te);Ue=yt.viewport,0===ve&&(e.setRenderTargetTextures(m,yt.colorTexture,h.ignoreDepthValues?void 0:yt.depthStencilTexture),e.setRenderTarget(m))}let Fe=S[ve];void 0===Fe&&(Fe=new hn,Fe.layers.enable(ve),Fe.viewport=new Ft,S[ve]=Fe),Fe.matrix.fromArray(Te.transform.matrix),Fe.matrix.decompose(Fe.position,Fe.quaternion,Fe.scale),Fe.projectionMatrix.fromArray(Te.projectionMatrix),Fe.projectionMatrixInverse.copy(Fe.projectionMatrix).invert(),Fe.viewport.set(Ue.x,Ue.y,Ue.width,Ue.height),0===ve&&(C.matrix.copy(Fe.matrix),C.matrix.decompose(C.position,C.quaternion,C.scale)),!0===me&&C.cameras.push(Fe)}}for(let fe=0;fe<v.length;fe++){const me=y[fe],ve=v[fe];null!==me&&void 0!==ve&&ve.update(me,J,c||o)}Q&&Q(U,J),J.detectedPlanes&&i.dispatchEvent({type:"planesdetected",data:J}),p=null}),this.setAnimationLoop=function(U){Q=U},this.dispose=function(){}}}function I7(n,e){function t(g,m){!0===g.matrixAutoUpdate&&g.updateMatrix(),m.value.copy(g.matrix)}function s(g,m){g.opacity.value=m.opacity,m.color&&g.diffuse.value.copy(m.color),m.emissive&&g.emissive.value.copy(m.emissive).multiplyScalar(m.emissiveIntensity),m.map&&(g.map.value=m.map,t(m.map,g.mapTransform)),m.alphaMap&&(g.alphaMap.value=m.alphaMap,t(m.alphaMap,g.alphaMapTransform)),m.bumpMap&&(g.bumpMap.value=m.bumpMap,t(m.bumpMap,g.bumpMapTransform),g.bumpScale.value=m.bumpScale,1===m.side&&(g.bumpScale.value*=-1)),m.normalMap&&(g.normalMap.value=m.normalMap,t(m.normalMap,g.normalMapTransform),g.normalScale.value.copy(m.normalScale),1===m.side&&g.normalScale.value.negate()),m.displacementMap&&(g.displacementMap.value=m.displacementMap,t(m.displacementMap,g.displacementMapTransform),g.displacementScale.value=m.displacementScale,g.displacementBias.value=m.displacementBias),m.emissiveMap&&(g.emissiveMap.value=m.emissiveMap,t(m.emissiveMap,g.emissiveMapTransform)),m.specularMap&&(g.specularMap.value=m.specularMap,t(m.specularMap,g.specularMapTransform)),m.alphaTest>0&&(g.alphaTest.value=m.alphaTest);const v=e.get(m).envMap;if(v&&(g.envMap.value=v,g.flipEnvMap.value=v.isCubeTexture&&!1===v.isRenderTargetTexture?-1:1,g.reflectivity.value=m.reflectivity,g.ior.value=m.ior,g.refractionRatio.value=m.refractionRatio),m.lightMap){g.lightMap.value=m.lightMap;const y=!0===n.useLegacyLights?Math.PI:1;g.lightMapIntensity.value=m.lightMapIntensity*y,t(m.lightMap,g.lightMapTransform)}m.aoMap&&(g.aoMap.value=m.aoMap,g.aoMapIntensity.value=m.aoMapIntensity,t(m.aoMap,g.aoMapTransform))}return{refreshFogUniforms:function i(g,m){m.color.getRGB(g.fogColor.value,k1(n)),m.isFog?(g.fogNear.value=m.near,g.fogFar.value=m.far):m.isFogExp2&&(g.fogDensity.value=m.density)},refreshMaterialUniforms:function r(g,m,v,y,b){m.isMeshBasicMaterial||m.isMeshLambertMaterial?s(g,m):m.isMeshToonMaterial?(s(g,m),function d(g,m){m.gradientMap&&(g.gradientMap.value=m.gradientMap)}(g,m)):m.isMeshPhongMaterial?(s(g,m),function u(g,m){g.specular.value.copy(m.specular),g.shininess.value=Math.max(m.shininess,1e-4)}(g,m)):m.isMeshStandardMaterial?(s(g,m),function h(g,m){g.metalness.value=m.metalness,m.metalnessMap&&(g.metalnessMap.value=m.metalnessMap,t(m.metalnessMap,g.metalnessMapTransform)),g.roughness.value=m.roughness,m.roughnessMap&&(g.roughnessMap.value=m.roughnessMap,t(m.roughnessMap,g.roughnessMapTransform)),e.get(m).envMap&&(g.envMapIntensity.value=m.envMapIntensity)}(g,m),m.isMeshPhysicalMaterial&&function f(g,m,v){g.ior.value=m.ior,m.sheen>0&&(g.sheenColor.value.copy(m.sheenColor).multiplyScalar(m.sheen),g.sheenRoughness.value=m.sheenRoughness,m.sheenColorMap&&(g.sheenColorMap.value=m.sheenColorMap,t(m.sheenColorMap,g.sheenColorMapTransform)),m.sheenRoughnessMap&&(g.sheenRoughnessMap.value=m.sheenRoughnessMap,t(m.sheenRoughnessMap,g.sheenRoughnessMapTransform))),m.clearcoat>0&&(g.clearcoat.value=m.clearcoat,g.clearcoatRoughness.value=m.clearcoatRoughness,m.clearcoatMap&&(g.clearcoatMap.value=m.clearcoatMap,t(m.clearcoatMap,g.clearcoatMapTransform)),m.clearcoatRoughnessMap&&(g.clearcoatRoughnessMap.value=m.clearcoatRoughnessMap,t(m.clearcoatRoughnessMap,g.clearcoatRoughnessMapTransform)),m.clearcoatNormalMap&&(g.clearcoatNormalMap.value=m.clearcoatNormalMap,t(m.clearcoatNormalMap,g.clearcoatNormalMapTransform),g.clearcoatNormalScale.value.copy(m.clearcoatNormalScale),1===m.side&&g.clearcoatNormalScale.value.negate())),m.iridescence>0&&(g.iridescence.value=m.iridescence,g.iridescenceIOR.value=m.iridescenceIOR,g.iridescenceThicknessMinimum.value=m.iridescenceThicknessRange[0],g.iridescenceThicknessMaximum.value=m.iridescenceThicknessRange[1],m.iridescenceMap&&(g.iridescenceMap.value=m.iridescenceMap,t(m.iridescenceMap,g.iridescenceMapTransform)),m.iridescenceThicknessMap&&(g.iridescenceThicknessMap.value=m.iridescenceThicknessMap,t(m.iridescenceThicknessMap,g.iridescenceThicknessMapTransform))),m.transmission>0&&(g.transmission.value=m.transmission,g.transmissionSamplerMap.value=v.texture,g.transmissionSamplerSize.value.set(v.width,v.height),m.transmissionMap&&(g.transmissionMap.value=m.transmissionMap,t(m.transmissionMap,g.transmissionMapTransform)),g.thickness.value=m.thickness,m.thicknessMap&&(g.thicknessMap.value=m.thicknessMap,t(m.thicknessMap,g.thicknessMapTransform)),g.attenuationDistance.value=m.attenuationDistance,g.attenuationColor.value.copy(m.attenuationColor)),m.anisotropy>0&&(g.anisotropyVector.value.set(m.anisotropy*Math.cos(m.anisotropyRotation),m.anisotropy*Math.sin(m.anisotropyRotation)),m.anisotropyMap&&(g.anisotropyMap.value=m.anisotropyMap,t(m.anisotropyMap,g.anisotropyMapTransform))),g.specularIntensity.value=m.specularIntensity,g.specularColor.value.copy(m.specularColor),m.specularColorMap&&(g.specularColorMap.value=m.specularColorMap,t(m.specularColorMap,g.specularColorMapTransform)),m.specularIntensityMap&&(g.specularIntensityMap.value=m.specularIntensityMap,t(m.specularIntensityMap,g.specularIntensityMapTransform))}(g,m,b)):m.isMeshMatcapMaterial?(s(g,m),function p(g,m){m.matcap&&(g.matcap.value=m.matcap)}(g,m)):m.isMeshDepthMaterial?s(g,m):m.isMeshDistanceMaterial?(s(g,m),function _(g,m){const v=e.get(m).light;g.referencePosition.value.setFromMatrixPosition(v.matrixWorld),g.nearDistance.value=v.shadow.camera.near,g.farDistance.value=v.shadow.camera.far}(g,m)):m.isMeshNormalMaterial?s(g,m):m.isLineBasicMaterial?(function o(g,m){g.diffuse.value.copy(m.color),g.opacity.value=m.opacity,m.map&&(g.map.value=m.map,t(m.map,g.mapTransform))}(g,m),m.isLineDashedMaterial&&function a(g,m){g.dashSize.value=m.dashSize,g.totalSize.value=m.dashSize+m.gapSize,g.scale.value=m.scale}(g,m)):m.isPointsMaterial?function l(g,m,v,y){g.diffuse.value.copy(m.color),g.opacity.value=m.opacity,g.size.value=m.size*v,g.scale.value=.5*y,m.map&&(g.map.value=m.map,t(m.map,g.uvTransform)),m.alphaMap&&(g.alphaMap.value=m.alphaMap,t(m.alphaMap,g.alphaMapTransform)),m.alphaTest>0&&(g.alphaTest.value=m.alphaTest)}(g,m,v,y):m.isSpriteMaterial?function c(g,m){g.diffuse.value.copy(m.color),g.opacity.value=m.opacity,g.rotation.value=m.rotation,m.map&&(g.map.value=m.map,t(m.map,g.mapTransform)),m.alphaMap&&(g.alphaMap.value=m.alphaMap,t(m.alphaMap,g.alphaMapTransform)),m.alphaTest>0&&(g.alphaTest.value=m.alphaTest)}(g,m):m.isShadowMaterial?(g.color.value.copy(m.color),g.opacity.value=m.opacity):m.isShaderMaterial&&(m.uniformsNeedUpdate=!1)}}}function P7(n,e,t,i){let r={},s={},o=[];const a=t.isWebGL2?n.getParameter(n.MAX_UNIFORM_BUFFER_BINDINGS):0;function f(v,y,b){const w=v.value;if(void 0===b[y]){if("number"==typeof w)b[y]=w;else{const S=Array.isArray(w)?w:[w],C=[];for(let I=0;I<S.length;I++)C.push(S[I].clone());b[y]=C}return!0}if("number"==typeof w){if(b[y]!==w)return b[y]=w,!0}else{const S=Array.isArray(b[y])?b[y]:[b[y]],C=Array.isArray(w)?w:[w];for(let I=0;I<S.length;I++){const x=S[I];if(!1===x.equals(C[I]))return x.copy(C[I]),!0}}return!1}function _(v){const y={boundary:0,storage:0};return"number"==typeof v?(y.boundary=4,y.storage=4):v.isVector2?(y.boundary=8,y.storage=8):v.isVector3||v.isColor?(y.boundary=16,y.storage=12):v.isVector4?(y.boundary=16,y.storage=16):v.isMatrix3?(y.boundary=48,y.storage=48):v.isMatrix4?(y.boundary=64,y.storage=64):v.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",v),y}function g(v){const y=v.target;y.removeEventListener("dispose",g);const b=o.indexOf(y.__bindingPointIndex);o.splice(b,1),n.deleteBuffer(r[y.id]),delete r[y.id],delete s[y.id]}return{bind:function l(v,y){i.uniformBlockBinding(v,y.program)},update:function c(v,y){let b=r[v.id];void 0===b&&(function p(v){const y=v.uniforms;let b=0;let S=0;for(let C=0,I=y.length;C<I;C++){const x=y[C],E={boundary:0,storage:0},B=Array.isArray(x.value)?x.value:[x.value];for(let Y=0,N=B.length;Y<N;Y++){const H=_(B[Y]);E.boundary+=H.boundary,E.storage+=H.storage}x.__data=new Float32Array(E.storage/Float32Array.BYTES_PER_ELEMENT),x.__offset=b,C>0&&(S=b%16,0!==S&&16-S-E.boundary<0&&(b+=16-S,x.__offset=b)),b+=E.storage}S=b%16,S>0&&(b+=16-S),v.__size=b,v.__cache={}}(v),b=function u(v){const y=function d(){for(let v=0;v<a;v++)if(-1===o.indexOf(v))return o.push(v),v;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();v.__bindingPointIndex=y;const b=n.createBuffer(),w=v.__size,S=v.usage;return n.bindBuffer(n.UNIFORM_BUFFER,b),n.bufferData(n.UNIFORM_BUFFER,w,S),n.bindBuffer(n.UNIFORM_BUFFER,null),n.bindBufferBase(n.UNIFORM_BUFFER,y,b),b}(v),r[v.id]=b,v.addEventListener("dispose",g)),i.updateUBOMapping(v,y.program);const S=e.render.frame;s[v.id]!==S&&(function h(v){const b=v.uniforms,w=v.__cache;n.bindBuffer(n.UNIFORM_BUFFER,r[v.id]);for(let S=0,C=b.length;S<C;S++){const I=b[S];if(!0===f(I,S,w)){const x=I.__offset,E=Array.isArray(I.value)?I.value:[I.value];let B=0;for(let Y=0;Y<E.length;Y++){const N=E[Y],F=_(N);"number"==typeof N?(I.__data[0]=N,n.bufferSubData(n.UNIFORM_BUFFER,x+B,I.__data)):N.isMatrix3?(I.__data[0]=N.elements[0],I.__data[1]=N.elements[1],I.__data[2]=N.elements[2],I.__data[3]=N.elements[0],I.__data[4]=N.elements[3],I.__data[5]=N.elements[4],I.__data[6]=N.elements[5],I.__data[7]=N.elements[0],I.__data[8]=N.elements[6],I.__data[9]=N.elements[7],I.__data[10]=N.elements[8],I.__data[11]=N.elements[0]):(N.toArray(I.__data,B),B+=F.storage/Float32Array.BYTES_PER_ELEMENT)}n.bufferSubData(n.UNIFORM_BUFFER,x,I.__data)}}n.bindBuffer(n.UNIFORM_BUFFER,null)}(v),s[v.id]=S)},dispose:function m(){for(const v in r)n.deleteBuffer(r[v]);o=[],r={},s={}}}}function L7(){const n=Pu("canvas");return n.style.display="block",n}class Hu{constructor(e={}){const{canvas:t=L7(),context:i=null,depth:r=!0,stencil:s=!0,alpha:o=!1,antialias:a=!1,premultipliedAlpha:l=!0,preserveDrawingBuffer:c=!1,powerPreference:u="default",failIfMajorPerformanceCaveat:d=!1}=e;let h;this.isWebGLRenderer=!0,h=null!==i?i.getContextAttributes().alpha:o;const f=new Uint32Array(4),p=new Int32Array(4);let _=null,g=null;const m=[],v=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputColorSpace=Ze,this.useLegacyLights=!0,this.toneMapping=as,this.toneMappingExposure=1;const y=this;let b=!1,w=0,S=0,C=null,I=-1,x=null;const E=new Ft,B=new Ft;let Y=null;const N=new be(0);let F=0,H=t.width,ne=t.height,X=1,Q=null,re=null;const ae=new Ft(0,0,H,ne),U=new Ft(0,0,H,ne);let J=!1;const fe=new V0;let me=!1,ve=!1,Te=null;const Ue=new et,Fe=new K,yt=new T,St={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function ze(){return null===C?X:1}let ee,de,se,Be,Ae,Re,Ke,_t,Wt,R,M,j,ue,ce,P,oe,le,z,Le,Ve,ke,Oe,Ie,Je,L=i;function pe(D,V){for(let $=0;$<D.length;$++){const q=t.getContext(D[$],V);if(null!==q)return q}return null}try{const D={alpha:!0,depth:r,stencil:s,antialias:a,premultipliedAlpha:l,preserveDrawingBuffer:c,powerPreference:u,failIfMajorPerformanceCaveat:d};if("setAttribute"in t&&t.setAttribute("data-engine","three.js r154"),t.addEventListener("webglcontextlost",we,!1),t.addEventListener("webglcontextrestored",G,!1),t.addEventListener("webglcontextcreationerror",ge,!1),null===L){const V=["webgl2","webgl","experimental-webgl"];if(!0===y.isWebGL1Renderer&&V.shift(),L=pe(V,D),null===L)throw pe(V)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}typeof WebGLRenderingContext<"u"&&L instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),void 0===L.getShaderPrecisionFormat&&(L.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(D){throw console.error("THREE.WebGLRenderer: "+D.message),D}function bt(){ee=new j9(L),de=new B9(L,ee,e),ee.init(de),Oe=new A7(L,ee,de),se=new M7(L,ee,de),Be=new q9(L),Ae=new h7,Re=new E7(L,ee,se,Ae,de,Oe,Be),Ke=new H9(y),_t=new W9(y),Wt=new UX(L,de),Ie=new k9(L,ee,Wt,de),R=new $9(L,Wt,Be,Ie),M=new J9(L,R,Wt,Be),Le=new K9(L,de,Re),oe=new V9(Ae),j=new d7(y,Ke,_t,ee,de,Ie,oe),ue=new I7(y,Ae),ce=new p7,P=new b7(ee,de),z=new F9(y,Ke,_t,se,M,h,l),le=new S7(y,M,de),Je=new P7(L,Be,de,se),Ve=new U9(L,ee,Be,de),ke=new X9(L,ee,Be,de),Be.programs=j.programs,y.capabilities=de,y.extensions=ee,y.properties=Ae,y.renderLists=ce,y.shadowMap=le,y.state=se,y.info=Be}bt();const O=new R7(y,L);function we(D){D.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),b=!0}function G(){console.log("THREE.WebGLRenderer: Context Restored."),b=!1;const D=Be.autoReset,V=le.enabled,$=le.autoUpdate,k=le.needsUpdate,q=le.type;bt(),Be.autoReset=D,le.enabled=V,le.autoUpdate=$,le.needsUpdate=k,le.type=q}function ge(D){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",D.statusMessage)}function Se(D){const V=D.target;V.removeEventListener("dispose",Se),function Tt(D){(function Zt(D){const V=Ae.get(D).programs;void 0!==V&&(V.forEach(function($){j.releaseProgram($)}),D.isShaderMaterial&&j.releaseShaderCache(D))})(D),Ae.remove(D)}(V)}this.xr=O,this.getContext=function(){return L},this.getContextAttributes=function(){return L.getContextAttributes()},this.forceContextLoss=function(){const D=ee.get("WEBGL_lose_context");D&&D.loseContext()},this.forceContextRestore=function(){const D=ee.get("WEBGL_lose_context");D&&D.restoreContext()},this.getPixelRatio=function(){return X},this.setPixelRatio=function(D){void 0!==D&&(X=D,this.setSize(H,ne,!1))},this.getSize=function(D){return D.set(H,ne)},this.setSize=function(D,V,$=!0){O.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(H=D,ne=V,t.width=Math.floor(D*X),t.height=Math.floor(V*X),!0===$&&(t.style.width=D+"px",t.style.height=V+"px"),this.setViewport(0,0,D,V))},this.getDrawingBufferSize=function(D){return D.set(H*X,ne*X).floor()},this.setDrawingBufferSize=function(D,V,$){H=D,ne=V,X=$,t.width=Math.floor(D*$),t.height=Math.floor(V*$),this.setViewport(0,0,D,V)},this.getCurrentViewport=function(D){return D.copy(E)},this.getViewport=function(D){return D.copy(ae)},this.setViewport=function(D,V,$,k){D.isVector4?ae.set(D.x,D.y,D.z,D.w):ae.set(D,V,$,k),se.viewport(E.copy(ae).multiplyScalar(X).floor())},this.getScissor=function(D){return D.copy(U)},this.setScissor=function(D,V,$,k){D.isVector4?U.set(D.x,D.y,D.z,D.w):U.set(D,V,$,k),se.scissor(B.copy(U).multiplyScalar(X).floor())},this.getScissorTest=function(){return J},this.setScissorTest=function(D){se.setScissorTest(J=D)},this.setOpaqueSort=function(D){Q=D},this.setTransparentSort=function(D){re=D},this.getClearColor=function(D){return D.copy(z.getClearColor())},this.setClearColor=function(){z.setClearColor.apply(z,arguments)},this.getClearAlpha=function(){return z.getClearAlpha()},this.setClearAlpha=function(){z.setClearAlpha.apply(z,arguments)},this.clear=function(D=!0,V=!0,$=!0){let k=0;if(D){let q=!1;if(null!==C){const Pe=C.texture.format;q=1033===Pe||1031===Pe||1029===Pe}if(q){const Pe=C.texture.type,je=Pe===Os||Pe===Ns||1012===Pe||Pe===Mo||1017===Pe||1018===Pe,nt=z.getClearColor(),ot=z.getClearAlpha(),vt=nt.r,lt=nt.g,ht=nt.b;je?(f[0]=vt,f[1]=lt,f[2]=ht,f[3]=ot,L.clearBufferuiv(L.COLOR,0,f)):(p[0]=vt,p[1]=lt,p[2]=ht,p[3]=ot,L.clearBufferiv(L.COLOR,0,p))}else k|=L.COLOR_BUFFER_BIT}V&&(k|=L.DEPTH_BUFFER_BIT),$&&(k|=L.STENCIL_BUFFER_BIT),L.clear(k)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",we,!1),t.removeEventListener("webglcontextrestored",G,!1),t.removeEventListener("webglcontextcreationerror",ge,!1),ce.dispose(),P.dispose(),Ae.dispose(),Ke.dispose(),_t.dispose(),M.dispose(),Ie.dispose(),Je.dispose(),j.dispose(),O.dispose(),O.removeEventListener("sessionstart",rn),O.removeEventListener("sessionend",Gr),Te&&(Te.dispose(),Te=null),ii.stop()},this.renderBufferDirect=function(D,V,$,k,q,Pe){null===V&&(V=St);const je=q.isMesh&&q.matrixWorld.determinant()<0,nt=function FJ(D,V,$,k,q){!0!==V.isScene&&(V=St),Re.resetTextureUnits();const Pe=V.fog,nt=null===C?y.outputColorSpace:!0===C.isXRRenderTarget?C.texture.colorSpace:rr,ot=(k.isMeshStandardMaterial?_t:Ke).get(k.envMap||(k.isMeshStandardMaterial?V.environment:null)),vt=!0===k.vertexColors&&!!$.attributes.color&&4===$.attributes.color.itemSize,lt=!!$.attributes.tangent&&(!!k.normalMap||k.anisotropy>0),ht=!!$.morphAttributes.position,sn=!!$.morphAttributes.normal,pn=!!$.morphAttributes.color,fr=k.toneMapped?y.toneMapping:as,ws=$.morphAttributes.position||$.morphAttributes.normal||$.morphAttributes.color,bn=void 0!==ws?ws.length:0,At=Ae.get(k),mw=g.state.lights;!0!==me||!0!==ve&&D===x||oe.setState(k,D,D===x&&k.id===I);let On=!1;k.version===At.__version?(At.needsLights&&At.lightsStateVersion!==mw.state.version||At.outputColorSpace!==nt||q.isInstancedMesh&&!1===At.instancing||!q.isInstancedMesh&&!0===At.instancing||q.isSkinnedMesh&&!1===At.skinning||!q.isSkinnedMesh&&!0===At.skinning||At.envMap!==ot||!0===k.fog&&At.fog!==Pe||void 0!==At.numClippingPlanes&&(At.numClippingPlanes!==oe.numPlanes||At.numIntersection!==oe.numIntersection)||At.vertexAlphas!==vt||At.vertexTangents!==lt||At.morphTargets!==ht||At.morphNormals!==sn||At.morphColors!==pn||At.toneMapping!==fr||!0===de.isWebGL2&&At.morphTargetsCount!==bn)&&(On=!0):(On=!0,At.__version=k.version);let Qo=At.currentProgram;!0===On&&(Qo=Rm(k,V,q));let xO=!1,xd=!1,gw=!1;const ri=Qo.getUniforms(),ea=At.uniforms;if(se.useProgram(Qo.program)&&(xO=!0,xd=!0,gw=!0),k.id!==I&&(I=k.id,xd=!0),xO||x!==D){if(ri.setValue(L,"projectionMatrix",D.projectionMatrix),de.logarithmicDepthBuffer&&ri.setValue(L,"logDepthBufFC",2/(Math.log(D.far+1)/Math.LN2)),x!==D&&(x=D,xd=!0,gw=!0),k.isShaderMaterial||k.isMeshPhongMaterial||k.isMeshToonMaterial||k.isMeshStandardMaterial||k.envMap){const Fi=ri.map.cameraPosition;void 0!==Fi&&Fi.setValue(L,yt.setFromMatrixPosition(D.matrixWorld))}(k.isMeshPhongMaterial||k.isMeshToonMaterial||k.isMeshLambertMaterial||k.isMeshBasicMaterial||k.isMeshStandardMaterial||k.isShaderMaterial)&&ri.setValue(L,"isOrthographic",!0===D.isOrthographicCamera),(k.isMeshPhongMaterial||k.isMeshToonMaterial||k.isMeshLambertMaterial||k.isMeshBasicMaterial||k.isMeshStandardMaterial||k.isShaderMaterial||k.isShadowMaterial||q.isSkinnedMesh)&&ri.setValue(L,"viewMatrix",D.matrixWorldInverse)}if(q.isSkinnedMesh){ri.setOptional(L,q,"bindMatrix"),ri.setOptional(L,q,"bindMatrixInverse");const Fi=q.skeleton;Fi&&(de.floatVertexTextures?(null===Fi.boneTexture&&Fi.computeBoneTexture(),ri.setValue(L,"boneTexture",Fi.boneTexture,Re),ri.setValue(L,"boneTextureSize",Fi.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const _w=$.morphAttributes;if((void 0!==_w.position||void 0!==_w.normal||void 0!==_w.color&&!0===de.isWebGL2)&&Le.update(q,$,Qo),(xd||At.receiveShadow!==q.receiveShadow)&&(At.receiveShadow=q.receiveShadow,ri.setValue(L,"receiveShadow",q.receiveShadow)),k.isMeshGouraudMaterial&&null!==k.envMap&&(ea.envMap.value=ot,ea.flipEnvMap.value=ot.isCubeTexture&&!1===ot.isRenderTargetTexture?-1:1),xd&&(ri.setValue(L,"toneMappingExposure",y.toneMappingExposure),At.needsLights&&function kJ(D,V){D.ambientLightColor.needsUpdate=V,D.lightProbe.needsUpdate=V,D.directionalLights.needsUpdate=V,D.directionalLightShadows.needsUpdate=V,D.pointLights.needsUpdate=V,D.pointLightShadows.needsUpdate=V,D.spotLights.needsUpdate=V,D.spotLightShadows.needsUpdate=V,D.rectAreaLights.needsUpdate=V,D.hemisphereLights.needsUpdate=V}(ea,gw),Pe&&!0===k.fog&&ue.refreshFogUniforms(ea,Pe),ue.refreshMaterialUniforms(ea,k,X,ne,Te),Up.upload(L,At.uniformsList,ea,Re)),k.isShaderMaterial&&!0===k.uniformsNeedUpdate&&(Up.upload(L,At.uniformsList,ea,Re),k.uniformsNeedUpdate=!1),k.isSpriteMaterial&&ri.setValue(L,"center",q.center),ri.setValue(L,"modelViewMatrix",q.modelViewMatrix),ri.setValue(L,"normalMatrix",q.normalMatrix),ri.setValue(L,"modelMatrix",q.matrixWorld),k.isShaderMaterial||k.isRawShaderMaterial){const Fi=k.uniformsGroups;for(let vw=0,BJ=Fi.length;vw<BJ;vw++)if(de.isWebGL2){const SO=Fi[vw];Je.update(SO,Qo),Je.bind(SO,Qo)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return Qo}(D,V,$,k,q);se.setMaterial(k,je);let ot=$.index,vt=1;!0===k.wireframe&&(ot=R.getWireframeAttribute($),vt=2);const lt=$.drawRange,ht=$.attributes.position;let sn=lt.start*vt,pn=(lt.start+lt.count)*vt;null!==Pe&&(sn=Math.max(sn,Pe.start*vt),pn=Math.min(pn,(Pe.start+Pe.count)*vt)),null!==ot?(sn=Math.max(sn,0),pn=Math.min(pn,ot.count)):null!=ht&&(sn=Math.max(sn,0),pn=Math.min(pn,ht.count));const fr=pn-sn;if(fr<0||fr===1/0)return;Ie.setup(q,k,nt,$,ot);let ws,bn=Ve;if(null!==ot&&(ws=Wt.get(ot),bn=ke,bn.setIndex(ws)),q.isMesh)!0===k.wireframe?(se.setLineWidth(k.wireframeLinewidth*ze()),bn.setMode(L.LINES)):bn.setMode(L.TRIANGLES);else if(q.isLine){let At=k.linewidth;void 0===At&&(At=1),se.setLineWidth(At*ze()),bn.setMode(q.isLineSegments?L.LINES:q.isLineLoop?L.LINE_LOOP:L.LINE_STRIP)}else q.isPoints?bn.setMode(L.POINTS):q.isSprite&&bn.setMode(L.TRIANGLES);if(q.isInstancedMesh)bn.renderInstances(sn,fr,q.count);else if($.isInstancedBufferGeometry){const mw=Math.min($.instanceCount,void 0!==$._maxInstanceCount?$._maxInstanceCount:1/0);bn.renderInstances(sn,fr,mw)}else bn.render(sn,fr)},this.compile=function(D,V){function $(k,q,Pe){!0===k.transparent&&2===k.side&&!1===k.forceSinglePass?(k.side=1,k.needsUpdate=!0,Rm(k,q,Pe),k.side=0,k.needsUpdate=!0,Rm(k,q,Pe),k.side=2):Rm(k,q,Pe)}g=P.get(D),g.init(),v.push(g),D.traverseVisible(function(k){k.isLight&&k.layers.test(V.layers)&&(g.pushLight(k),k.castShadow&&g.pushShadow(k))}),g.setupLights(y.useLegacyLights),D.traverse(function(k){const q=k.material;if(q)if(Array.isArray(q))for(let Pe=0;Pe<q.length;Pe++)$(q[Pe],D,k);else $(q,D,k)}),v.pop(),g=null};let Ln=null;function rn(){ii.stop()}function Gr(){ii.start()}const ii=new U1;function vO(D,V,$,k){if(!1===D.visible)return;if(D.layers.test(V.layers))if(D.isGroup)$=D.renderOrder;else if(D.isLOD)!0===D.autoUpdate&&D.update(V);else if(D.isLight)g.pushLight(D),D.castShadow&&g.pushShadow(D);else if(D.isSprite){if(!D.frustumCulled||fe.intersectsSprite(D)){k&&yt.setFromMatrixPosition(D.matrixWorld).applyMatrix4(Ue);const je=M.update(D),nt=D.material;nt.visible&&_.push(D,je,nt,$,yt.z,null)}}else if((D.isMesh||D.isLine||D.isPoints)&&(!D.frustumCulled||fe.intersectsObject(D))){const je=M.update(D),nt=D.material;if(k&&(void 0!==D.boundingSphere?(null===D.boundingSphere&&D.computeBoundingSphere(),yt.copy(D.boundingSphere.center)):(null===je.boundingSphere&&je.computeBoundingSphere(),yt.copy(je.boundingSphere.center)),yt.applyMatrix4(D.matrixWorld).applyMatrix4(Ue)),Array.isArray(nt)){const ot=je.groups;for(let vt=0,lt=ot.length;vt<lt;vt++){const ht=ot[vt],sn=nt[ht.materialIndex];sn&&sn.visible&&_.push(D,je,sn,$,yt.z,ht)}}else nt.visible&&_.push(D,je,nt,$,yt.z,null)}const Pe=D.children;for(let je=0,nt=Pe.length;je<nt;je++)vO(Pe[je],V,$,k)}function yO(D,V,$,k){const q=D.opaque,Pe=D.transmissive,je=D.transparent;g.setupLightsView($),!0===me&&oe.setGlobalState(y.clippingPlanes,$),Pe.length>0&&function NJ(D,V,$,k){const q=de.isWebGL2;null===Te&&(Te=new Ro(1,1,{generateMipmaps:!0,type:ee.has("EXT_color_buffer_half_float")?Du:Os,minFilter:ls,samples:q?4:0})),y.getDrawingBufferSize(Fe),q?Te.setSize(Fe.x,Fe.y):Te.setSize(fp(Fe.x),fp(Fe.y));const Pe=y.getRenderTarget();y.setRenderTarget(Te),y.getClearColor(N),F=y.getClearAlpha(),F<1&&y.setClearColor(16777215,.5),y.clear();const je=y.toneMapping;y.toneMapping=as,Dm(D,$,k),Re.updateMultisampleRenderTarget(Te),Re.updateRenderTargetMipmap(Te);let nt=!1;for(let ot=0,vt=V.length;ot<vt;ot++){const lt=V[ot],ht=lt.object,sn=lt.geometry,pn=lt.material,fr=lt.group;if(2===pn.side&&ht.layers.test(k.layers)){const ws=pn.side;pn.side=1,pn.needsUpdate=!0,bO(ht,$,k,sn,pn,fr),pn.side=ws,pn.needsUpdate=!0,nt=!0}}!0===nt&&(Re.updateMultisampleRenderTarget(Te),Re.updateRenderTargetMipmap(Te)),y.setRenderTarget(Pe),y.setClearColor(N,F),y.toneMapping=je}(q,Pe,V,$),k&&se.viewport(E.copy(k)),q.length>0&&Dm(q,V,$),Pe.length>0&&Dm(Pe,V,$),je.length>0&&Dm(je,V,$),se.buffers.depth.setTest(!0),se.buffers.depth.setMask(!0),se.buffers.color.setMask(!0),se.setPolygonOffset(!1)}function Dm(D,V,$){const k=!0===V.isScene?V.overrideMaterial:null;for(let q=0,Pe=D.length;q<Pe;q++){const je=D[q],nt=je.object,ot=je.geometry,vt=null===k?je.material:k,lt=je.group;nt.layers.test($.layers)&&bO(nt,V,$,ot,vt,lt)}}function bO(D,V,$,k,q,Pe){D.onBeforeRender(y,V,$,k,q,Pe),D.modelViewMatrix.multiplyMatrices($.matrixWorldInverse,D.matrixWorld),D.normalMatrix.getNormalMatrix(D.modelViewMatrix),q.onBeforeRender(y,V,$,k,D,Pe),!0===q.transparent&&2===q.side&&!1===q.forceSinglePass?(q.side=1,q.needsUpdate=!0,y.renderBufferDirect($,V,k,q,D,Pe),q.side=0,q.needsUpdate=!0,y.renderBufferDirect($,V,k,q,D,Pe),q.side=2):y.renderBufferDirect($,V,k,q,D,Pe),D.onAfterRender(y,V,$,k,q,Pe)}function Rm(D,V,$){!0!==V.isScene&&(V=St);const k=Ae.get(D),q=g.state.lights,je=q.state.version,nt=j.getParameters(D,q.state,g.state.shadowsArray,V,$),ot=j.getProgramCacheKey(nt);let vt=k.programs;k.environment=D.isMeshStandardMaterial?V.environment:null,k.fog=V.fog,k.envMap=(D.isMeshStandardMaterial?_t:Ke).get(D.envMap||k.environment),void 0===vt&&(D.addEventListener("dispose",Se),vt=new Map,k.programs=vt);let lt=vt.get(ot);if(void 0!==lt){if(k.currentProgram===lt&&k.lightsStateVersion===je)return wO(D,nt),lt}else nt.uniforms=j.getUniforms(D),D.onBuild($,nt,y),D.onBeforeCompile(nt,y),lt=j.acquireProgram(nt,ot),vt.set(ot,lt),k.uniforms=nt.uniforms;const ht=k.uniforms;(!D.isShaderMaterial&&!D.isRawShaderMaterial||!0===D.clipping)&&(ht.clippingPlanes=oe.uniform),wO(D,nt),k.needsLights=function UJ(D){return D.isMeshLambertMaterial||D.isMeshToonMaterial||D.isMeshPhongMaterial||D.isMeshStandardMaterial||D.isShadowMaterial||D.isShaderMaterial&&!0===D.lights}(D),k.lightsStateVersion=je,k.needsLights&&(ht.ambientLightColor.value=q.state.ambient,ht.lightProbe.value=q.state.probe,ht.directionalLights.value=q.state.directional,ht.directionalLightShadows.value=q.state.directionalShadow,ht.spotLights.value=q.state.spot,ht.spotLightShadows.value=q.state.spotShadow,ht.rectAreaLights.value=q.state.rectArea,ht.ltc_1.value=q.state.rectAreaLTC1,ht.ltc_2.value=q.state.rectAreaLTC2,ht.pointLights.value=q.state.point,ht.pointLightShadows.value=q.state.pointShadow,ht.hemisphereLights.value=q.state.hemi,ht.directionalShadowMap.value=q.state.directionalShadowMap,ht.directionalShadowMatrix.value=q.state.directionalShadowMatrix,ht.spotShadowMap.value=q.state.spotShadowMap,ht.spotLightMatrix.value=q.state.spotLightMatrix,ht.spotLightMap.value=q.state.spotLightMap,ht.pointShadowMap.value=q.state.pointShadowMap,ht.pointShadowMatrix.value=q.state.pointShadowMatrix);const sn=lt.getUniforms(),pn=Up.seqWithValue(sn.seq,ht);return k.currentProgram=lt,k.uniformsList=pn,lt}function wO(D,V){const $=Ae.get(D);$.outputColorSpace=V.outputColorSpace,$.instancing=V.instancing,$.skinning=V.skinning,$.morphTargets=V.morphTargets,$.morphNormals=V.morphNormals,$.morphColors=V.morphColors,$.morphTargetsCount=V.morphTargetsCount,$.numClippingPlanes=V.numClippingPlanes,$.numIntersection=V.numClipIntersection,$.vertexAlphas=V.vertexAlphas,$.vertexTangents=V.vertexTangents,$.toneMapping=V.toneMapping}ii.setAnimationLoop(function zr(D){Ln&&Ln(D)}),typeof self<"u"&&ii.setContext(self),this.setAnimationLoop=function(D){Ln=D,O.setAnimationLoop(D),null===D?ii.stop():ii.start()},O.addEventListener("sessionstart",rn),O.addEventListener("sessionend",Gr),this.render=function(D,V){if(void 0===V||!0===V.isCamera){if(!0!==b){if(!0===D.matrixWorldAutoUpdate&&D.updateMatrixWorld(),null===V.parent&&!0===V.matrixWorldAutoUpdate&&V.updateMatrixWorld(),!0===O.enabled&&!0===O.isPresenting&&(!0===O.cameraAutoUpdate&&O.updateCamera(V),V=O.getCamera()),!0===D.isScene&&D.onBeforeRender(y,D,V,C),g=P.get(D,v.length),g.init(),v.push(g),Ue.multiplyMatrices(V.projectionMatrix,V.matrixWorldInverse),fe.setFromProjectionMatrix(Ue),ve=this.localClippingEnabled,me=oe.init(this.clippingPlanes,ve),_=ce.get(D,m.length),_.init(),m.push(_),vO(D,V,0,y.sortObjects),_.finish(),!0===y.sortObjects&&_.sort(Q,re),this.info.render.frame++,!0===me&&oe.beginShadows(),le.render(g.state.shadowsArray,D,V),!0===me&&oe.endShadows(),!0===this.info.autoReset&&this.info.reset(),z.render(_,D),g.setupLights(y.useLegacyLights),V.isArrayCamera){const k=V.cameras;for(let q=0,Pe=k.length;q<Pe;q++){const je=k[q];yO(_,D,je,je.viewport)}}else yO(_,D,V);null!==C&&(Re.updateMultisampleRenderTarget(C),Re.updateRenderTargetMipmap(C)),!0===D.isScene&&D.onAfterRender(y,D,V),Ie.resetDefaultState(),I=-1,x=null,v.pop(),g=v.length>0?v[v.length-1]:null,m.pop(),_=m.length>0?m[m.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return w},this.getActiveMipmapLevel=function(){return S},this.getRenderTarget=function(){return C},this.setRenderTargetTextures=function(D,V,$){Ae.get(D.texture).__webglTexture=V,Ae.get(D.depthTexture).__webglTexture=$;const k=Ae.get(D);k.__hasExternalTextures=!0,k.__hasExternalTextures&&(k.__autoAllocateDepthBuffer=void 0===$,k.__autoAllocateDepthBuffer||!0===ee.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),k.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(D,V){const $=Ae.get(D);$.__webglFramebuffer=V,$.__useDefaultFramebuffer=void 0===V},this.setRenderTarget=function(D,V=0,$=0){C=D,w=V,S=$;let k=!0,q=null,Pe=!1,je=!1;if(D){const ot=Ae.get(D);void 0!==ot.__useDefaultFramebuffer?(se.bindFramebuffer(L.FRAMEBUFFER,null),k=!1):void 0===ot.__webglFramebuffer?Re.setupRenderTarget(D):ot.__hasExternalTextures&&Re.rebindTextures(D,Ae.get(D.texture).__webglTexture,Ae.get(D.depthTexture).__webglTexture);const vt=D.texture;(vt.isData3DTexture||vt.isDataArrayTexture||vt.isCompressedArrayTexture)&&(je=!0);const lt=Ae.get(D).__webglFramebuffer;D.isWebGLCubeRenderTarget?(q=lt[V],Pe=!0):q=de.isWebGL2&&D.samples>0&&!1===Re.useMultisampledRTT(D)?Ae.get(D).__webglMultisampledFramebuffer:lt,E.copy(D.viewport),B.copy(D.scissor),Y=D.scissorTest}else E.copy(ae).multiplyScalar(X).floor(),B.copy(U).multiplyScalar(X).floor(),Y=J;if(se.bindFramebuffer(L.FRAMEBUFFER,q)&&de.drawBuffers&&k&&se.drawBuffers(D,q),se.viewport(E),se.scissor(B),se.setScissorTest(Y),Pe){const ot=Ae.get(D.texture);L.framebufferTexture2D(L.FRAMEBUFFER,L.COLOR_ATTACHMENT0,L.TEXTURE_CUBE_MAP_POSITIVE_X+V,ot.__webglTexture,$)}else if(je){const ot=Ae.get(D.texture);L.framebufferTextureLayer(L.FRAMEBUFFER,L.COLOR_ATTACHMENT0,ot.__webglTexture,$||0,V||0)}I=-1},this.readRenderTargetPixels=function(D,V,$,k,q,Pe,je){if(!D||!D.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let nt=Ae.get(D).__webglFramebuffer;if(D.isWebGLCubeRenderTarget&&void 0!==je&&(nt=nt[je]),nt){se.bindFramebuffer(L.FRAMEBUFFER,nt);try{const ot=D.texture,vt=ot.format,lt=ot.type;if(vt!==Gi&&Oe.convert(vt)!==L.getParameter(L.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const ht=lt===Du&&(ee.has("EXT_color_buffer_half_float")||de.isWebGL2&&ee.has("EXT_color_buffer_float"));if(!(lt===Os||Oe.convert(lt)===L.getParameter(L.IMPLEMENTATION_COLOR_READ_TYPE)||lt===cs&&(de.isWebGL2||ee.has("OES_texture_float")||ee.has("WEBGL_color_buffer_float"))||ht))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");V>=0&&V<=D.width-k&&$>=0&&$<=D.height-q&&L.readPixels(V,$,k,q,Oe.convert(vt),Oe.convert(lt),Pe)}finally{const ot=null!==C?Ae.get(C).__webglFramebuffer:null;se.bindFramebuffer(L.FRAMEBUFFER,ot)}}},this.copyFramebufferToTexture=function(D,V,$=0){const k=Math.pow(2,-$),q=Math.floor(V.image.width*k),Pe=Math.floor(V.image.height*k);Re.setTexture2D(V,0),L.copyTexSubImage2D(L.TEXTURE_2D,$,0,0,D.x,D.y,q,Pe),se.unbindTexture()},this.copyTextureToTexture=function(D,V,$,k=0){const q=V.image.width,Pe=V.image.height,je=Oe.convert($.format),nt=Oe.convert($.type);Re.setTexture2D($,0),L.pixelStorei(L.UNPACK_FLIP_Y_WEBGL,$.flipY),L.pixelStorei(L.UNPACK_PREMULTIPLY_ALPHA_WEBGL,$.premultiplyAlpha),L.pixelStorei(L.UNPACK_ALIGNMENT,$.unpackAlignment),V.isDataTexture?L.texSubImage2D(L.TEXTURE_2D,k,D.x,D.y,q,Pe,je,nt,V.image.data):V.isCompressedTexture?L.compressedTexSubImage2D(L.TEXTURE_2D,k,D.x,D.y,V.mipmaps[0].width,V.mipmaps[0].height,je,V.mipmaps[0].data):L.texSubImage2D(L.TEXTURE_2D,k,D.x,D.y,je,nt,V.image),0===k&&$.generateMipmaps&&L.generateMipmap(L.TEXTURE_2D),se.unbindTexture()},this.copyTextureToTexture3D=function(D,V,$,k,q=0){if(y.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const Pe=D.max.x-D.min.x+1,je=D.max.y-D.min.y+1,nt=D.max.z-D.min.z+1,ot=Oe.convert(k.format),vt=Oe.convert(k.type);let lt;if(k.isData3DTexture)Re.setTexture3D(k,0),lt=L.TEXTURE_3D;else{if(!k.isDataArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");Re.setTexture2DArray(k,0),lt=L.TEXTURE_2D_ARRAY}L.pixelStorei(L.UNPACK_FLIP_Y_WEBGL,k.flipY),L.pixelStorei(L.UNPACK_PREMULTIPLY_ALPHA_WEBGL,k.premultiplyAlpha),L.pixelStorei(L.UNPACK_ALIGNMENT,k.unpackAlignment);const ht=L.getParameter(L.UNPACK_ROW_LENGTH),sn=L.getParameter(L.UNPACK_IMAGE_HEIGHT),pn=L.getParameter(L.UNPACK_SKIP_PIXELS),fr=L.getParameter(L.UNPACK_SKIP_ROWS),ws=L.getParameter(L.UNPACK_SKIP_IMAGES),bn=$.isCompressedTexture?$.mipmaps[0]:$.image;L.pixelStorei(L.UNPACK_ROW_LENGTH,bn.width),L.pixelStorei(L.UNPACK_IMAGE_HEIGHT,bn.height),L.pixelStorei(L.UNPACK_SKIP_PIXELS,D.min.x),L.pixelStorei(L.UNPACK_SKIP_ROWS,D.min.y),L.pixelStorei(L.UNPACK_SKIP_IMAGES,D.min.z),$.isDataTexture||$.isData3DTexture?L.texSubImage3D(lt,q,V.x,V.y,V.z,Pe,je,nt,ot,vt,bn.data):$.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),L.compressedTexSubImage3D(lt,q,V.x,V.y,V.z,Pe,je,nt,ot,bn.data)):L.texSubImage3D(lt,q,V.x,V.y,V.z,Pe,je,nt,ot,vt,bn),L.pixelStorei(L.UNPACK_ROW_LENGTH,ht),L.pixelStorei(L.UNPACK_IMAGE_HEIGHT,sn),L.pixelStorei(L.UNPACK_SKIP_PIXELS,pn),L.pixelStorei(L.UNPACK_SKIP_ROWS,fr),L.pixelStorei(L.UNPACK_SKIP_IMAGES,ws),0===q&&k.generateMipmaps&&L.generateMipmap(lt),se.unbindTexture()},this.initTexture=function(D){D.isCubeTexture?Re.setTextureCube(D,0):D.isData3DTexture?Re.setTexture3D(D,0):D.isDataArrayTexture||D.isCompressedArrayTexture?Re.setTexture2DArray(D,0):Re.setTexture2D(D,0),se.unbindTexture()},this.resetState=function(){w=0,S=0,C=null,se.reset(),Ie.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return us}get physicallyCorrectLights(){return console.warn("THREE.WebGLRenderer: the property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),!this.useLegacyLights}set physicallyCorrectLights(e){console.warn("THREE.WebGLRenderer: the property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),this.useLegacyLights=!e}get outputEncoding(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace===Ze?Ao:3e3}set outputEncoding(e){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=e===Ao?Ze:rr}}(class O7 extends Hu{}).prototype.isWebGL1Renderer=!0;class Y0 extends Rn{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(t.object.backgroundIntensity=this.backgroundIntensity),t}}class Z0{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=Ii()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,i){e*=this.stride,i*=t.stride;for(let r=0,s=this.stride;r<s;r++)this.array[e+r]=t.array[i+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Ii()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(t,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Ii()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const ni=new T;class Uo{constructor(e,t,i,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=i,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,i=this.data.count;t<i;t++)ni.fromBufferAttribute(this,t),ni.applyMatrix4(e),this.setXYZ(t,ni.x,ni.y,ni.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)ni.fromBufferAttribute(this,t),ni.applyNormalMatrix(e),this.setXYZ(t,ni.x,ni.y,ni.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)ni.fromBufferAttribute(this,t),ni.transformDirection(e),this.setXYZ(t,ni.x,ni.y,ni.z);return this}setX(e,t){return this.normalized&&(t=ut(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=ut(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=ut(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=ut(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=Pi(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=Pi(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=Pi(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=Pi(t,this.array)),t}setXY(e,t,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=ut(t,this.array),i=ut(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this}setXYZ(e,t,i,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=ut(t,this.array),i=ut(i,this.array),r=ut(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this}setXYZW(e,t,i,r,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=ut(t,this.array),i=ut(i,this.array),r=ut(r,this.array),s=ut(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this.data.array[e+3]=s,this}clone(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return new Gt(new this.array.constructor(t),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Uo(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}const vP=new T,yP=new Ft,bP=new Ft,k7=new T,wP=new et,Hl=new T,J0=new ar,xP=new et,Q0=new Fu;class SP extends Pn{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new et,this.bindMatrixInverse=new et,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;null===this.boundingBox&&(this.boundingBox=new Nr),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let i=0;i<t.count;i++)Hl.fromBufferAttribute(t,i),this.applyBoneTransform(i,Hl),this.boundingBox.expandByPoint(Hl)}computeBoundingSphere(){const e=this.geometry;null===this.boundingSphere&&(this.boundingSphere=new ar),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let i=0;i<t.count;i++)Hl.fromBufferAttribute(t,i),this.applyBoneTransform(i,Hl),this.boundingSphere.expandByPoint(Hl)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const r=this.matrixWorld;void 0!==this.material&&(null===this.boundingSphere&&this.computeBoundingSphere(),J0.copy(this.boundingSphere),J0.applyMatrix4(r),!1!==e.ray.intersectsSphere(J0)&&(xP.copy(r).invert(),Q0.copy(e.ray).applyMatrix4(xP),(null===this.boundingBox||!1!==Q0.intersectsBox(this.boundingBox))&&this._computeIntersections(e,t,Q0)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Ft,t=this.geometry.attributes.skinWeight;for(let i=0,r=t.count;i<r;i++){e.fromBufferAttribute(t,i);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),t.setXYZW(i,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const i=this.skeleton,r=this.geometry;yP.fromBufferAttribute(r.attributes.skinIndex,e),bP.fromBufferAttribute(r.attributes.skinWeight,e),vP.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let s=0;s<4;s++){const o=bP.getComponent(s);if(0!==o){const a=yP.getComponent(s);wP.multiplyMatrices(i.bones[a].matrixWorld,i.boneInverses[a]),t.addScaledVector(k7.copy(vP).applyMatrix4(wP),o)}}return t.applyMatrix4(this.bindMatrixInverse)}boneTransform(e,t){return console.warn("THREE.SkinnedMesh: .boneTransform() was renamed to .applyBoneTransform() in r151."),this.applyBoneTransform(e,t)}}class eb extends Rn{constructor(){super(),this.isBone=!0,this.type="Bone"}}class ju extends or{constructor(e=null,t=1,i=1,r,s,o,a,l,c=dn,u=dn,d,h){super(null,o,a,l,c,u,r,s,d,h),this.isDataTexture=!0,this.image={data:e,width:t,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const MP=new et,U7=new et;class Gp{constructor(e=[],t=[]){this.uuid=Ii(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let i=0,r=this.bones.length;i<r;i++)this.boneInverses.push(new et)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const i=new et;this.bones[e]&&i.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(i)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&i.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}update(){const e=this.bones,t=this.boneInverses,i=this.boneMatrices,r=this.boneTexture;for(let s=0,o=e.length;s<o;s++)MP.multiplyMatrices(e[s]?e[s].matrixWorld:U7,t[s]),MP.toArray(i,16*s);null!==r&&(r.needsUpdate=!0)}clone(){return new Gp(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(4*this.bones.length);e=m1(e),e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const i=new ju(t,e,e,Gi,cs);return i.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=i,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,i=this.bones.length;t<i;t++){const r=this.bones[t];if(r.name===e)return r}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let i=0,r=e.bones.length;i<r;i++){const s=e.bones[i];let o=t[s];void 0===o&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),o=new eb),this.bones.push(o),this.boneInverses.push((new et).fromArray(e.boneInverses[i]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,i=this.boneInverses;for(let r=0,s=t.length;r<s;r++)e.bones.push(t[r].uuid),e.boneInverses.push(i[r].toArray());return e}}class $u extends Gt{constructor(e,t,i,r=1){super(e,t,i),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const zl=new et,EP=new et,Wp=[],AP=new Nr,B7=new et,Xu=new Pn,qu=new ar;class CP extends Pn{constructor(e,t,i){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new $u(new Float32Array(16*i),16),this.instanceColor=null,this.count=i,this.boundingBox=null,this.boundingSphere=null;for(let r=0;r<i;r++)this.setMatrixAt(r,B7)}computeBoundingBox(){const e=this.geometry,t=this.count;null===this.boundingBox&&(this.boundingBox=new Nr),null===e.boundingBox&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let i=0;i<t;i++)this.getMatrixAt(i,zl),AP.copy(e.boundingBox).applyMatrix4(zl),this.boundingBox.union(AP)}computeBoundingSphere(){const e=this.geometry,t=this.count;null===this.boundingSphere&&(this.boundingSphere=new ar),null===e.boundingSphere&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let i=0;i<t;i++)this.getMatrixAt(i,zl),qu.copy(e.boundingSphere).applyMatrix4(zl),this.boundingSphere.union(qu)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,16*e)}raycast(e,t){const i=this.matrixWorld,r=this.count;if(Xu.geometry=this.geometry,Xu.material=this.material,void 0!==Xu.material&&(null===this.boundingSphere&&this.computeBoundingSphere(),qu.copy(this.boundingSphere),qu.applyMatrix4(i),!1!==e.ray.intersectsSphere(qu)))for(let s=0;s<r;s++){this.getMatrixAt(s,zl),EP.multiplyMatrices(i,zl),Xu.matrixWorld=EP,Xu.raycast(e,Wp);for(let o=0,a=Wp.length;o<a;o++){const l=Wp[o];l.instanceId=s,l.object=this,t.push(l)}Wp.length=0}}setColorAt(e,t){null===this.instanceColor&&(this.instanceColor=new $u(new Float32Array(3*this.instanceMatrix.count),3)),t.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,16*e)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class xi extends ur{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new be(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const TP=new T,DP=new T,RP=new et,tb=new Fu,jp=new ar;class Bo extends Rn{constructor(e=new pt,t=new xi){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,i=[0];for(let r=1,s=t.count;r<s;r++)TP.fromBufferAttribute(t,r-1),DP.fromBufferAttribute(t,r),i[r]=i[r-1],i[r]+=TP.distanceTo(DP);e.setAttribute("lineDistance",new Ne(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,s=e.params.Line.threshold,o=i.drawRange;if(null===i.boundingSphere&&i.computeBoundingSphere(),jp.copy(i.boundingSphere),jp.applyMatrix4(r),jp.radius+=s,!1===e.ray.intersectsSphere(jp))return;RP.copy(r).invert(),tb.copy(e.ray).applyMatrix4(RP);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,c=new T,u=new T,d=new T,h=new T,f=this.isLineSegments?2:1,p=i.index,g=i.attributes.position;if(null!==p)for(let y=Math.max(0,o.start),b=Math.min(p.count,o.start+o.count)-1;y<b;y+=f){const w=p.getX(y),S=p.getX(y+1);if(c.fromBufferAttribute(g,w),u.fromBufferAttribute(g,S),tb.distanceSqToSegment(c,u,h,d)>l)continue;h.applyMatrix4(this.matrixWorld);const I=e.ray.origin.distanceTo(h);I<e.near||I>e.far||t.push({distance:I,point:d.clone().applyMatrix4(this.matrixWorld),index:y,face:null,faceIndex:null,object:this})}else for(let y=Math.max(0,o.start),b=Math.min(g.count,o.start+o.count)-1;y<b;y+=f){if(c.fromBufferAttribute(g,y),u.fromBufferAttribute(g,y+1),tb.distanceSqToSegment(c,u,h,d)>l)continue;h.applyMatrix4(this.matrixWorld);const S=e.ray.origin.distanceTo(h);S<e.near||S>e.far||t.push({distance:S,point:d.clone().applyMatrix4(this.matrixWorld),index:y,face:null,faceIndex:null,object:this})}}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}const IP=new T,PP=new T;class nb extends Bo{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,i=[];for(let r=0,s=t.count;r<s;r+=2)IP.fromBufferAttribute(t,r),PP.fromBufferAttribute(t,r+1),i[r]=0===r?0:i[r-1],i[r+1]=i[r]+IP.distanceTo(PP);e.setAttribute("lineDistance",new Ne(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class LP extends Bo{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class ib extends ur{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new be(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const OP=new et,rb=new Fu,$p=new ar,Xp=new T;class NP extends Rn{constructor(e=new pt,t=new ib){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,s=e.params.Points.threshold,o=i.drawRange;if(null===i.boundingSphere&&i.computeBoundingSphere(),$p.copy(i.boundingSphere),$p.applyMatrix4(r),$p.radius+=s,!1===e.ray.intersectsSphere($p))return;OP.copy(r).invert(),rb.copy(e.ray).applyMatrix4(OP);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,c=i.index,d=i.attributes.position;if(null!==c)for(let p=Math.max(0,o.start),_=Math.min(c.count,o.start+o.count);p<_;p++){const g=c.getX(p);Xp.fromBufferAttribute(d,g),FP(Xp,g,l,r,e,t,this)}else for(let p=Math.max(0,o.start),_=Math.min(d.count,o.start+o.count);p<_;p++)Xp.fromBufferAttribute(d,p),FP(Xp,p,l,r,e,t,this)}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}function FP(n,e,t,i,r,s,o){const a=rb.distanceSqToPoint(n);if(a<t){const l=new T;rb.closestPointToPoint(n,l),l.applyMatrix4(i);const c=r.ray.origin.distanceTo(l);if(c<r.near||c>r.far)return;s.push({distance:c,distanceToRay:Math.sqrt(a),point:l,index:e,face:null,object:o})}}class td extends pt{constructor(e=1,t=32,i=16,r=0,s=2*Math.PI,o=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:i,phiStart:r,phiLength:s,thetaStart:o,thetaLength:a},t=Math.max(3,Math.floor(t)),i=Math.max(2,Math.floor(i));const l=Math.min(o+a,Math.PI);let c=0;const u=[],d=new T,h=new T,f=[],p=[],_=[],g=[];for(let m=0;m<=i;m++){const v=[],y=m/i;let b=0;0===m&&0===o?b=.5/t:m===i&&l===Math.PI&&(b=-.5/t);for(let w=0;w<=t;w++){const S=w/t;d.x=-e*Math.cos(r+S*s)*Math.sin(o+y*a),d.y=e*Math.cos(o+y*a),d.z=e*Math.sin(r+S*s)*Math.sin(o+y*a),p.push(d.x,d.y,d.z),h.copy(d).normalize(),_.push(h.x,h.y,h.z),g.push(S+b,1-y),v.push(c++)}u.push(v)}for(let m=0;m<i;m++)for(let v=0;v<t;v++){const b=u[m][v],w=u[m+1][v],S=u[m+1][v+1];(0!==m||o>0)&&f.push(u[m][v+1],b,S),(m!==i-1||l<Math.PI)&&f.push(b,w,S)}this.setIndex(f),this.setAttribute("position",new Ne(p,3)),this.setAttribute("normal",new Ne(_,3)),this.setAttribute("uv",new Ne(g,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new td(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class rm extends pt{constructor(e=1,t=.4,i=12,r=48,s=2*Math.PI){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:i,tubularSegments:r,arc:s},i=Math.floor(i),r=Math.floor(r);const o=[],a=[],l=[],c=[],u=new T,d=new T,h=new T;for(let f=0;f<=i;f++)for(let p=0;p<=r;p++){const _=p/r*s,g=f/i*Math.PI*2;d.x=(e+t*Math.cos(g))*Math.cos(_),d.y=(e+t*Math.cos(g))*Math.sin(_),d.z=t*Math.sin(g),a.push(d.x,d.y,d.z),u.x=e*Math.cos(_),u.y=e*Math.sin(_),h.subVectors(d,u).normalize(),l.push(h.x,h.y,h.z),c.push(p/r),c.push(f/i)}for(let f=1;f<=i;f++)for(let p=1;p<=r;p++){const g=(r+1)*(f-1)+p-1,m=(r+1)*(f-1)+p,v=(r+1)*f+p;o.push((r+1)*f+p-1,g,v),o.push(g,m,v)}this.setIndex(o),this.setAttribute("position",new Ne(a,3)),this.setAttribute("normal",new Ne(l,3)),this.setAttribute("uv",new Ne(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new rm(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class sm extends ur{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new be(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new be(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new K(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class ys extends sm{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new K(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return en(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new be(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new be(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new be(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}function ji(n,e,t){return Ab(n)?new n.constructor(n.subarray(e,void 0!==t?t:n.length)):n.slice(e,t)}function zo(n,e,t){return!n||!t&&n.constructor===e?n:"number"==typeof e.BYTES_PER_ELEMENT?new e(n):Array.prototype.slice.call(n)}function Ab(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function ZP(n){const t=n.length,i=new Array(t);for(let r=0;r!==t;++r)i[r]=r;return i.sort(function e(r,s){return n[r]-n[s]}),i}function Cb(n,e,t){const i=n.length,r=new n.constructor(i);for(let s=0,o=0;o!==i;++s){const a=t[s]*e;for(let l=0;l!==e;++l)r[o++]=n[a+l]}return r}function Tb(n,e,t,i){let r=1,s=n[0];for(;void 0!==s&&void 0===s[i];)s=n[r++];if(void 0===s)return;let o=s[i];if(void 0!==o)if(Array.isArray(o))do{o=s[i],void 0!==o&&(e.push(s.time),t.push.apply(t,o)),s=n[r++]}while(void 0!==s);else if(void 0!==o.toArray)do{o=s[i],void 0!==o&&(e.push(s.time),o.toArray(t,t.length)),s=n[r++]}while(void 0!==s);else do{o=s[i],void 0!==o&&(e.push(s.time),t.push(o)),s=n[r++]}while(void 0!==s)}class nd{constructor(e,t,i,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new t.constructor(i),this.sampleValues=t,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let i=this._cachedIndex,r=t[i],s=t[i-1];e:{t:{let o;n:{i:if(!(e<r)){for(let a=i+2;;){if(void 0===r){if(e<s)break i;return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===a)break;if(s=r,r=t[++i],e<r)break t}o=t.length;break n}if(e>=s)break e;{const a=t[1];e<a&&(i=2,s=a);for(let l=i-2;;){if(void 0===s)return this._cachedIndex=0,this.copySampleValue_(0);if(i===l)break;if(r=s,s=t[--i-1],e>=s)break t}o=i,i=0}}for(;i<o;){const a=i+o>>>1;e<t[a]?o=a:i=a+1}if(r=t[i],s=t[i-1],void 0===s)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===r)return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,s,r)}return this.interpolate_(i,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r;for(let o=0;o!==r;++o)t[o]=i[s+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class IZ extends nd{constructor(e,t,i,r){super(e,t,i,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:dl,endingEnd:dl}}intervalChanged_(e,t,i){const r=this.parameterPositions;let s=e-2,o=e+1,a=r[s],l=r[o];if(void 0===a)switch(this.getSettings_().endingStart){case hl:s=e,a=2*t-i;break;case 2402:s=r.length-2,a=t+r[s]-r[s+1];break;default:s=e,a=i}if(void 0===l)switch(this.getSettings_().endingEnd){case hl:o=e,l=2*i-t;break;case 2402:o=1,l=i+r[1]-r[0];break;default:o=e-1,l=t}const c=.5*(i-t),u=this.valueSize;this._weightPrev=c/(t-a),this._weightNext=c/(l-i),this._offsetPrev=s*u,this._offsetNext=o*u}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,u=this._offsetPrev,d=this._offsetNext,h=this._weightPrev,f=this._weightNext,p=(i-t)/(r-t),_=p*p,g=_*p,m=-h*g+2*h*_-h*p,v=(1+h)*g+(-1.5-2*h)*_+(-.5+h)*p+1,y=(-1-f)*g+(1.5+f)*_+.5*p,b=f*g-f*_;for(let w=0;w!==a;++w)s[w]=m*o[u+w]+v*o[c+w]+y*o[l+w]+b*o[d+w];return s}}class KP extends nd{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,u=(i-t)/(r-t),d=1-u;for(let h=0;h!==a;++h)s[h]=o[c+h]*d+o[l+h]*u;return s}}class PZ extends nd{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class Br{constructor(e,t,i,r){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=zo(t,this.TimeBufferType),this.values=zo(i,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let i;if(t.toJSON!==this.toJSON)i=t.toJSON(e);else{i={name:e.name,times:zo(e.times,Array),values:zo(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(i.interpolation=r)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new PZ(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new KP(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new IZ(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case Ru:t=this.InterpolantFactoryMethodDiscrete;break;case ul:t=this.InterpolantFactoryMethodLinear;break;case 2302:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(i);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Ru;case this.InterpolantFactoryMethodLinear:return ul;case this.InterpolantFactoryMethodSmooth:return 2302}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]*=e}return this}trim(e,t){const i=this.times,r=i.length;let s=0,o=r-1;for(;s!==r&&i[s]<e;)++s;for(;-1!==o&&i[o]>t;)--o;if(++o,0!==s||o!==r){s>=o&&(o=Math.max(o,1),s=o-1);const a=this.getValueSize();this.times=ji(i,s,o),this.values=ji(this.values,s*a,o*a)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const i=this.times,r=this.values,s=i.length;0===s&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let a=0;a!==s;a++){const l=i[a];if("number"==typeof l&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,l),e=!1;break}if(null!==o&&o>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,l,o),e=!1;break}o=l}if(void 0!==r&&Ab(r))for(let a=0,l=r.length;a!==l;++a){const c=r[a];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,c),e=!1;break}}return e}optimize(){const e=ji(this.times),t=ji(this.values),i=this.getValueSize(),r=2302===this.getInterpolation(),s=e.length-1;let o=1;for(let a=1;a<s;++a){let l=!1;const c=e[a];if(c!==e[a+1]&&(1!==a||c!==e[0]))if(r)l=!0;else{const d=a*i,h=d-i,f=d+i;for(let p=0;p!==i;++p){const _=t[d+p];if(_!==t[h+p]||_!==t[f+p]){l=!0;break}}}if(l){if(a!==o){e[o]=e[a];const d=a*i,h=o*i;for(let f=0;f!==i;++f)t[h+f]=t[d+f]}++o}}if(s>0){e[o]=e[s];for(let a=s*i,l=o*i,c=0;c!==i;++c)t[l+c]=t[a+c];++o}return o!==e.length?(this.times=ji(e,0,o),this.values=ji(t,0,o*i)):(this.times=e,this.values=t),this}clone(){const e=ji(this.times,0),t=ji(this.values,0),r=new(0,this.constructor)(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}}Br.prototype.TimeBufferType=Float32Array,Br.prototype.ValueBufferType=Float32Array,Br.prototype.DefaultInterpolation=ul;class jl extends Br{}jl.prototype.ValueTypeName="bool",jl.prototype.ValueBufferType=Array,jl.prototype.DefaultInterpolation=Ru,jl.prototype.InterpolantFactoryMethodLinear=void 0,jl.prototype.InterpolantFactoryMethodSmooth=void 0;class JP extends Br{}JP.prototype.ValueTypeName="color";class $l extends Br{}$l.prototype.ValueTypeName="number";class LZ extends nd{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=(i-t)/(r-t);let c=e*a;for(let u=c+a;c!==u;c+=4)tn.slerpFlat(s,0,o,c-a,o,c,l);return s}}class Go extends Br{InterpolantFactoryMethodLinear(e){return new LZ(this.times,this.values,this.getValueSize(),e)}}Go.prototype.ValueTypeName="quaternion",Go.prototype.DefaultInterpolation=ul,Go.prototype.InterpolantFactoryMethodSmooth=void 0;class Xl extends Br{}Xl.prototype.ValueTypeName="string",Xl.prototype.ValueBufferType=Array,Xl.prototype.DefaultInterpolation=Ru,Xl.prototype.InterpolantFactoryMethodLinear=void 0,Xl.prototype.InterpolantFactoryMethodSmooth=void 0;class id extends Br{}id.prototype.ValueTypeName="vector";class rd{constructor(e,t=-1,i,r=2500){this.name=e,this.tracks=i,this.duration=t,this.blendMode=r,this.uuid=Ii(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],i=e.tracks,r=1/(e.fps||1);for(let o=0,a=i.length;o!==a;++o)t.push(NZ(i[o]).scale(r));const s=new this(e.name,e.duration,t,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){const t=[],i=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,o=i.length;s!==o;++s)t.push(Br.toJSON(i[s]));return r}static CreateFromMorphTargetSequence(e,t,i,r){const s=t.length,o=[];for(let a=0;a<s;a++){let l=[],c=[];l.push((a+s-1)%s,a,(a+1)%s),c.push(0,1,0);const u=ZP(l);l=Cb(l,1,u),c=Cb(c,1,u),!r&&0===l[0]&&(l.push(s),c.push(c[0])),o.push(new $l(".morphTargetInfluences["+t[a].name+"]",l,c).scale(1/i))}return new this(e,-1,o)}static findByName(e,t){let i=e;Array.isArray(e)||(i=e.geometry&&e.geometry.animations||e.animations);for(let r=0;r<i.length;r++)if(i[r].name===t)return i[r];return null}static CreateClipsFromMorphTargetSequences(e,t,i){const r={},s=/^([\w-]*?)([\d]+)$/;for(let a=0,l=e.length;a<l;a++){const c=e[a],u=c.name.match(s);if(u&&u.length>1){const d=u[1];let h=r[d];h||(r[d]=h=[]),h.push(c)}}const o=[];for(const a in r)o.push(this.CreateFromMorphTargetSequence(a,r[a],t,i));return o}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const i=function(d,h,f,p,_){if(0!==f.length){const g=[],m=[];Tb(f,g,m,p),0!==g.length&&_.push(new d(h,g,m))}},r=[],s=e.name||"default",o=e.fps||30,a=e.blendMode;let l=e.length||-1;const c=e.hierarchy||[];for(let d=0;d<c.length;d++){const h=c[d].keys;if(h&&0!==h.length)if(h[0].morphTargets){const f={};let p;for(p=0;p<h.length;p++)if(h[p].morphTargets)for(let _=0;_<h[p].morphTargets.length;_++)f[h[p].morphTargets[_]]=-1;for(const _ in f){const g=[],m=[];for(let v=0;v!==h[p].morphTargets.length;++v){const y=h[p];g.push(y.time),m.push(y.morphTarget===_?1:0)}r.push(new $l(".morphTargetInfluence["+_+"]",g,m))}l=f.length*o}else{const f=".bones["+t[d].name+"]";i(id,f+".position",h,"pos",r),i(Go,f+".quaternion",h,"rot",r),i(id,f+".scale",h,"scl",r)}}return 0===r.length?null:new this(s,l,r,a)}resetDuration(){let t=0;for(let i=0,r=this.tracks.length;i!==r;++i){const s=this.tracks[i];t=Math.max(t,s.times[s.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function NZ(n){if(void 0===n.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=function OZ(n){switch(n.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return $l;case"vector":case"vector2":case"vector3":case"vector4":return id;case"color":return JP;case"quaternion":return Go;case"bool":case"boolean":return jl;case"string":return Xl}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+n)}(n.type);if(void 0===n.times){const t=[],i=[];Tb(n.keys,t,i,"value"),n.times=t,n.values=i}return void 0!==e.parse?e.parse(n):new e(n.name,n.times,n.values,n.interpolation)}const ql={enabled:!1,files:{},add:function(n,e){!1!==this.enabled&&(this.files[n]=e)},get:function(n){if(!1!==this.enabled)return this.files[n]},remove:function(n){delete this.files[n]},clear:function(){this.files={}}};class QP{constructor(e,t,i){const r=this;let l,s=!1,o=0,a=0;const c=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=i,this.itemStart=function(u){a++,!1===s&&void 0!==r.onStart&&r.onStart(u,o,a),s=!0},this.itemEnd=function(u){o++,void 0!==r.onProgress&&r.onProgress(u,o,a),o===a&&(s=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(u){void 0!==r.onError&&r.onError(u)},this.resolveURL=function(u){return l?l(u):u},this.setURLModifier=function(u){return l=u,this},this.addHandler=function(u,d){return c.push(u,d),this},this.removeHandler=function(u){const d=c.indexOf(u);return-1!==d&&c.splice(d,2),this},this.getHandler=function(u){for(let d=0,h=c.length;d<h;d+=2){const f=c[d],p=c[d+1];if(f.global&&(f.lastIndex=0),f.test(u))return p}return null}}}const FZ=new QP;let Yl=(()=>{class n{constructor(t){this.manager=void 0!==t?t:FZ,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,i){const r=this;return new Promise(function(s,o){r.load(t,s,i,o)})}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}}return n.DEFAULT_MATERIAL_NAME="__DEFAULT",n})();const bs={};class kZ extends Error{constructor(e,t){super(e),this.response=t}}class $i extends Yl{constructor(e){super(e)}load(e,t,i,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=ql.get(e);if(void 0!==s)return this.manager.itemStart(e),setTimeout(()=>{t&&t(s),this.manager.itemEnd(e)},0),s;if(void 0!==bs[e])return void bs[e].push({onLoad:t,onProgress:i,onError:r});bs[e]=[],bs[e].push({onLoad:t,onProgress:i,onError:r});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,l=this.responseType;fetch(o).then(c=>{if(200===c.status||0===c.status){if(0===c.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||void 0===c.body||void 0===c.body.getReader)return c;const u=bs[e],d=c.body.getReader(),h=c.headers.get("Content-Length")||c.headers.get("X-File-Size"),f=h?parseInt(h):0,p=0!==f;let _=0;const g=new ReadableStream({start(m){!function v(){d.read().then(({done:y,value:b})=>{if(y)m.close();else{_+=b.byteLength;const w=new ProgressEvent("progress",{lengthComputable:p,loaded:_,total:f});for(let S=0,C=u.length;S<C;S++){const I=u[S];I.onProgress&&I.onProgress(w)}m.enqueue(b),v()}})}()}});return new Response(g)}throw new kZ(`fetch for "${c.url}" responded with ${c.status}: ${c.statusText}`,c)}).then(c=>{switch(l){case"arraybuffer":return c.arrayBuffer();case"blob":return c.blob();case"document":return c.text().then(u=>(new DOMParser).parseFromString(u,a));case"json":return c.json();default:if(void 0===a)return c.text();{const d=/charset="?([^;"\s]*)"?/i.exec(a),h=d&&d[1]?d[1].toLowerCase():void 0,f=new TextDecoder(h);return c.arrayBuffer().then(p=>f.decode(p))}}}).then(c=>{ql.add(e,c);const u=bs[e];delete bs[e];for(let d=0,h=u.length;d<h;d++){const f=u[d];f.onLoad&&f.onLoad(c)}}).catch(c=>{const u=bs[e];if(void 0===u)throw this.manager.itemError(e),c;delete bs[e];for(let d=0,h=u.length;d<h;d++){const f=u[d];f.onError&&f.onError(c)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class om extends Yl{constructor(e){super(e)}load(e,t,i,r){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=ql.get(e);if(void 0!==o)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a=Pu("img");function l(){u(),ql.add(e,this),t&&t(this),s.manager.itemEnd(e)}function c(d){u(),r&&r(d),s.manager.itemError(e),s.manager.itemEnd(e)}function u(){a.removeEventListener("load",l,!1),a.removeEventListener("error",c,!1)}return a.addEventListener("load",l,!1),a.addEventListener("error",c,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),s.manager.itemStart(e),a.src=e,a}}class UZ extends Yl{constructor(e){super(e)}load(e,t,i,r){const s=new or,o=new om(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(a){s.image=a,s.needsUpdate=!0,void 0!==t&&t(s)},i,r),s}}class am extends Rn{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new be(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}class eL extends am{constructor(e,t,i){super(e,i),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Rn.DEFAULT_UP),this.updateMatrix(),this.groundColor=new be(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const Db=new et,tL=new T,nL=new T;class Rb{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new K(512,512),this.map=null,this.mapPass=null,this.matrix=new et,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new V0,this._frameExtents=new K(1,1),this._viewportCount=1,this._viewports=[new Ft(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,i=this.matrix;tL.setFromMatrixPosition(e.matrixWorld),t.position.copy(tL),nL.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(nL),t.updateMatrixWorld(),Db.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Db),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(Db)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class BZ extends Rb{constructor(){super(new hn(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,i=2*fl*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,s=e.distance||t.far;(i!==t.fov||r!==t.aspect||s!==t.far)&&(t.fov=i,t.aspect=r,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class Ib extends am{constructor(e,t,i=0,r=Math.PI/3,s=0,o=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Rn.DEFAULT_UP),this.updateMatrix(),this.target=new Rn,this.distance=i,this.angle=r,this.penumbra=s,this.decay=o,this.map=null,this.shadow=new BZ}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const iL=new et,sd=new T,Pb=new T;class VZ extends Rb{constructor(){super(new hn(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new K(4,2),this._viewportCount=6,this._viewports=[new Ft(2,1,1,1),new Ft(0,1,1,1),new Ft(3,1,1,1),new Ft(1,1,1,1),new Ft(3,0,1,1),new Ft(1,0,1,1)],this._cubeDirections=[new T(1,0,0),new T(-1,0,0),new T(0,0,1),new T(0,0,-1),new T(0,1,0),new T(0,-1,0)],this._cubeUps=[new T(0,1,0),new T(0,1,0),new T(0,1,0),new T(0,1,0),new T(0,0,1),new T(0,0,-1)]}updateMatrices(e,t=0){const i=this.camera,r=this.matrix,s=e.distance||i.far;s!==i.far&&(i.far=s,i.updateProjectionMatrix()),sd.setFromMatrixPosition(e.matrixWorld),i.position.copy(sd),Pb.copy(i.position),Pb.add(this._cubeDirections[t]),i.up.copy(this._cubeUps[t]),i.lookAt(Pb),i.updateMatrixWorld(),r.makeTranslation(-sd.x,-sd.y,-sd.z),iL.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(iL)}}class rL extends am{constructor(e,t,i=0,r=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=r,this.shadow=new VZ}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class HZ extends Rb{constructor(){super(new Np(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class Lb extends am{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Rn.DEFAULT_UP),this.updateMatrix(),this.target=new Rn,this.shadow=new HZ}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class od{static decodeText(e){if(typeof TextDecoder<"u")return(new TextDecoder).decode(e);let t="";for(let i=0,r=e.length;i<r;i++)t+=String.fromCharCode(e[i]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return-1===t?"./":e.slice(0,t+1)}static resolveURL(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class YZ extends Yl{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,i,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=ql.get(e);if(void 0!==o)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a={};a.credentials="anonymous"===this.crossOrigin?"same-origin":"include",a.headers=this.requestHeader,fetch(e,a).then(function(l){return l.blob()}).then(function(l){return createImageBitmap(l,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(l){ql.add(e,l),t&&t(l),s.manager.itemEnd(e)}).catch(function(l){r&&r(l),s.manager.itemError(e),s.manager.itemEnd(e)}),s.manager.itemStart(e)}}class Nb{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=uL(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=uL();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function uL(){return(typeof performance>"u"?Date:performance).now()}class JZ{constructor(e,t,i){let r,s,o;switch(this.binding=e,this.valueSize=i,t){case"quaternion":r=this._slerp,s=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*i),this._workIndex=5;break;case"string":case"bool":r=this._select,s=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(5*i);break;default:r=this._lerp,s=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*i)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=s,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const i=this.buffer,r=this.valueSize,s=e*r+r;let o=this.cumulativeWeight;if(0===o){for(let a=0;a!==r;++a)i[s+a]=i[a];o=t}else o+=t,this._mixBufferRegion(i,s,0,t/o,r);this.cumulativeWeight=o}accumulateAdditive(e){const t=this.buffer,i=this.valueSize,r=i*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(t,r,0,e,i),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,i=this.buffer,r=e*t+t,s=this.cumulativeWeight,o=this.cumulativeWeightAdditive,a=this.binding;this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1&&this._mixBufferRegion(i,r,t*this._origIndex,1-s,t),o>0&&this._mixBufferRegionAdditive(i,r,this._addIndex*t,1,t);for(let l=t,c=t+t;l!==c;++l)if(i[l]!==i[l+t]){a.setValue(i,r);break}}saveOriginalState(){const t=this.buffer,i=this.valueSize,r=i*this._origIndex;this.binding.getValue(t,r);for(let s=i,o=r;s!==o;++s)t[s]=t[r+s%i];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){this.binding.setValue(this.buffer,3*this.valueSize)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let i=e;i<t;i++)this.buffer[i]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let i=0;i<this.valueSize;i++)this.buffer[t+i]=this.buffer[e+i]}_select(e,t,i,r,s){if(r>=.5)for(let o=0;o!==s;++o)e[t+o]=e[i+o]}_slerp(e,t,i,r){tn.slerpFlat(e,t,e,t,e,i,r)}_slerpAdditive(e,t,i,r,s){const o=this._workIndex*s;tn.multiplyQuaternionsFlat(e,o,e,t,e,i),tn.slerpFlat(e,t,e,t,e,o,r)}_lerp(e,t,i,r,s){const o=1-r;for(let a=0;a!==s;++a){const l=t+a;e[l]=e[l]*o+e[i+a]*r}}_lerpAdditive(e,t,i,r,s){for(let o=0;o!==s;++o){const a=t+o;e[a]=e[a]+e[i+o]*r}}}const Fb="\\[\\]\\.:\\/",QZ=new RegExp("["+Fb+"]","g"),kb="[^"+Fb+"]",eK="[^"+Fb.replace("\\.","")+"]",sK=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",kb)+/(WCOD+)?/.source.replace("WCOD",eK)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",kb)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",kb)+"$"),oK=["material","materials","bones","map"];class aK{constructor(e,t,i){const r=i||Bt.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const r=this._bindings[this._targetGroup.nCachedObjects_];void 0!==r&&r.getValue(e,t)}setValue(e,t){const i=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=i.length;r!==s;++r)i[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].unbind()}}let Bt=(()=>{class n{constructor(t,i,r){this.path=i,this.parsedPath=r||n.parseTrackName(i),this.node=n.findNode(t,this.parsedPath.nodeName),this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,i,r){return t&&t.isAnimationObjectGroup?new n.Composite(t,i,r):new n(t,i,r)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(QZ,"")}static parseTrackName(t){const i=sK.exec(t);if(null===i)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const r={nodeName:i[2],objectName:i[3],objectIndex:i[4],propertyName:i[5],propertyIndex:i[6]},s=r.nodeName&&r.nodeName.lastIndexOf(".");if(void 0!==s&&-1!==s){const o=r.nodeName.substring(s+1);-1!==oK.indexOf(o)&&(r.nodeName=r.nodeName.substring(0,s),r.objectName=o)}if(null===r.propertyName||0===r.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return r}static findNode(t,i){if(void 0===i||""===i||"."===i||-1===i||i===t.name||i===t.uuid)return t;if(t.skeleton){const r=t.skeleton.getBoneByName(i);if(void 0!==r)return r}if(t.children){const r=function(o){for(let a=0;a<o.length;a++){const l=o[a];if(l.name===i||l.uuid===i)return l;const c=r(l.children);if(c)return c}return null},s=r(t.children);if(s)return s}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,i){t[i]=this.targetObject[this.propertyName]}_getValue_array(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)t[i++]=r[s]}_getValue_arrayElement(t,i){t[i]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,i){this.resolvedProperty.toArray(t,i)}_setValue_direct(t,i){this.targetObject[this.propertyName]=t[i]}_setValue_direct_setNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[i++]}_setValue_array_setNeedsUpdate(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[i++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[i++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,i){this.resolvedProperty[this.propertyIndex]=t[i]}_setValue_arrayElement_setNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,i){this.resolvedProperty.fromArray(t,i)}_setValue_fromArray_setNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,i){this.bind(),this.getValue(t,i)}_setValue_unbound(t,i){this.bind(),this.setValue(t,i)}bind(){let t=this.node;const i=this.parsedPath,r=i.objectName,s=i.propertyName;let o=i.propertyIndex;if(t||(t=n.findNode(this.rootNode,i.nodeName),this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(r){let u=i.objectIndex;switch(r){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let d=0;d<t.length;d++)if(t[d].name===u){u=d;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);t=t.material.map;break;default:if(void 0===t[r])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[r]}if(void 0!==u){if(void 0===t[u])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[u]}}const a=t[s];if(void 0===a)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+i.nodeName+"."+s+" but it wasn't found.",t);let l=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?l=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(l=this.Versioning.MatrixWorldNeedsUpdate);let c=this.BindingType.Direct;if(void 0!==o){if("morphTargetInfluences"===s){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[o]&&(o=t.morphTargetDictionary[o])}c=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=o}else void 0!==a.fromArray&&void 0!==a.toArray?(c=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(c=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=s;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][l]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}return n.Composite=aK,n})();Bt.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Bt.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},Bt.prototype.GetterByBindingType=[Bt.prototype._getValue_direct,Bt.prototype._getValue_array,Bt.prototype._getValue_arrayElement,Bt.prototype._getValue_toArray],Bt.prototype.SetterByBindingTypeAndVersioning=[[Bt.prototype._setValue_direct,Bt.prototype._setValue_direct_setNeedsUpdate,Bt.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Bt.prototype._setValue_array,Bt.prototype._setValue_array_setNeedsUpdate,Bt.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Bt.prototype._setValue_arrayElement,Bt.prototype._setValue_arrayElement_setNeedsUpdate,Bt.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Bt.prototype._setValue_fromArray,Bt.prototype._setValue_fromArray_setNeedsUpdate,Bt.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class lK{constructor(e,t,i=null,r=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=i,this.blendMode=r;const s=t.tracks,o=s.length,a=new Array(o),l={endingStart:dl,endingEnd:dl};for(let c=0;c!==o;++c){const u=s[c].createInterpolant(null);a[c]=u,u.settings=l}this._interpolantSettings=l,this._interpolants=a,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,i){if(e.fadeOut(t),this.fadeIn(t),i){const r=this._clip.duration,s=e._clip.duration,a=r/s;e.warp(1,s/r,t),this.warp(a,1,t)}return this}crossFadeTo(e,t,i){return e.crossFadeFrom(this,t,i)}stopFading(){const e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,i){const r=this._mixer,s=r.time,o=this.timeScale;let a=this._timeScaleInterpolant;null===a&&(a=r._lendControlInterpolant(),this._timeScaleInterpolant=a);const l=a.parameterPositions,c=a.sampleValues;return l[0]=s,l[1]=s+i,c[0]=e/o,c[1]=t/o,this}stopWarping(){const e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,i,r){if(!this.enabled)return void this._updateWeight(e);const s=this._startTime;if(null!==s){const l=(e-s)*i;l<0||0===i?t=0:(this._startTime=null,t=i*l)}t*=this._updateTimeScale(e);const o=this._updateTime(t),a=this._updateWeight(e);if(a>0){const l=this._interpolants,c=this._propertyBindings;if(2501===this.blendMode)for(let u=0,d=l.length;u!==d;++u)l[u].evaluate(o),c[u].accumulateAdditive(a);else for(let u=0,d=l.length;u!==d;++u)l[u].evaluate(o),c[u].accumulate(r,a)}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const i=this._weightInterpolant;if(null!==i){const r=i.evaluate(e)[0];t*=r,e>i.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const i=this._timeScaleInterpolant;null!==i&&(t*=i.evaluate(e)[0],e>i.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t))}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,i=this.loop;let r=this.time+e,s=this._loopCount;const o=2202===i;if(0===e)return-1===s?r:o&&1==(1&s)?t-r:r;if(2200===i){-1===s&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=t)r=t;else{if(!(r<0)){this.time=r;break e}r=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===s&&(e>=0?(s=0,this._setEndings(!0,0===this.repetitions,o)):this._setEndings(0===this.repetitions,!0,o)),r>=t||r<0){const a=Math.floor(r/t);r-=t*a,s+=Math.abs(a);const l=this.repetitions-s;if(l<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?t:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===l){const c=e<0;this._setEndings(c,!c,o)}else this._setEndings(!1,!1,o);this._loopCount=s,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=r;if(o&&1==(1&s))return t-r}return r}_setEndings(e,t,i){const r=this._interpolantSettings;i?(r.endingStart=hl,r.endingEnd=hl):(r.endingStart=e?this.zeroSlopeAtStart?hl:dl:2402,r.endingEnd=t?this.zeroSlopeAtEnd?hl:dl:2402)}_scheduleFading(e,t,i){const r=this._mixer,s=r.time;let o=this._weightInterpolant;null===o&&(o=r._lendControlInterpolant(),this._weightInterpolant=o);const a=o.parameterPositions,l=o.sampleValues;return a[0]=s,l[0]=t,a[1]=s+e,l[1]=i,this}}const cK=new Float32Array(1);class uK extends Fs{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const i=e._localRoot||this._root,r=e._clip.tracks,s=r.length,o=e._propertyBindings,a=e._interpolants,l=i.uuid,c=this._bindingsByRootAndName;let u=c[l];void 0===u&&(u={},c[l]=u);for(let d=0;d!==s;++d){const h=r[d],f=h.name;let p=u[f];if(void 0!==p)++p.referenceCount,o[d]=p;else{if(p=o[d],void 0!==p){null===p._cacheIndex&&(++p.referenceCount,this._addInactiveBinding(p,l,f));continue}p=new JZ(Bt.create(i,f,t&&t._propertyBindings[d].binding.parsedPath),h.ValueTypeName,h.getValueSize()),++p.referenceCount,this._addInactiveBinding(p,l,f),o[d]=p}a[d].resultBuffer=p.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){const i=(e._localRoot||this._root).uuid,r=e._clip.uuid,s=this._actionsByClip[r];this._bindAction(e,s&&s.knownActions[0]),this._addInactiveAction(e,r,i)}const t=e._propertyBindings;for(let i=0,r=t.length;i!==r;++i){const s=t[i];0==s.useCount++&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let i=0,r=t.length;i!==r;++i){const s=t[i];0==--s.useCount&&(s.restoreOriginalState(),this._takeBackBinding(s))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return null!==t&&t<this._nActiveActions}_addInactiveAction(e,t,i){const r=this._actions,s=this._actionsByClip;let o=s[t];if(void 0===o)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,s[t]=o;else{const a=o.knownActions;e._byClipCacheIndex=a.length,a.push(e)}e._cacheIndex=r.length,r.push(e),o.actionByRoot[i]=e}_removeInactiveAction(e){const t=this._actions,i=t[t.length-1],r=e._cacheIndex;i._cacheIndex=r,t[r]=i,t.pop(),e._cacheIndex=null;const s=e._clip.uuid,o=this._actionsByClip,a=o[s],l=a.knownActions,c=l[l.length-1],u=e._byClipCacheIndex;c._byClipCacheIndex=u,l[u]=c,l.pop(),e._byClipCacheIndex=null,delete a.actionByRoot[(e._localRoot||this._root).uuid],0===l.length&&delete o[s],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let i=0,r=t.length;i!==r;++i){const s=t[i];0==--s.referenceCount&&this._removeInactiveBinding(s)}}_lendAction(e){const t=this._actions,i=e._cacheIndex,r=this._nActiveActions++,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=i,t[i]=s}_takeBackAction(e){const t=this._actions,i=e._cacheIndex,r=--this._nActiveActions,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=i,t[i]=s}_addInactiveBinding(e,t,i){const r=this._bindingsByRootAndName,s=this._bindings;let o=r[t];void 0===o&&(o={},r[t]=o),o[i]=e,e._cacheIndex=s.length,s.push(e)}_removeInactiveBinding(e){const t=this._bindings,i=e.binding,r=i.rootNode.uuid,s=i.path,o=this._bindingsByRootAndName,a=o[r],l=t[t.length-1],c=e._cacheIndex;l._cacheIndex=c,t[c]=l,t.pop(),delete a[s],0===Object.keys(a).length&&delete o[r]}_lendBinding(e){const t=this._bindings,i=e._cacheIndex,r=this._nActiveBindings++,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=i,t[i]=s}_takeBackBinding(e){const t=this._bindings,i=e._cacheIndex,r=--this._nActiveBindings,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=i,t[i]=s}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let i=e[t];return void 0===i&&(i=new KP(new Float32Array(2),new Float32Array(2),1,cK),i.__cacheIndex=t,e[t]=i),i}_takeBackControlInterpolant(e){const t=this._controlInterpolants,i=e.__cacheIndex,r=--this._nActiveControlInterpolants,s=t[r];e.__cacheIndex=r,t[r]=e,s.__cacheIndex=i,t[i]=s}clipAction(e,t,i){const r=t||this._root,s=r.uuid;let o="string"==typeof e?rd.findByName(r,e):e;const a=null!==o?o.uuid:e,l=this._actionsByClip[a];let c=null;if(void 0===i&&(i=null!==o?o.blendMode:2500),void 0!==l){const d=l.actionByRoot[s];if(void 0!==d&&d.blendMode===i)return d;c=l.knownActions[0],null===o&&(o=c._clip)}if(null===o)return null;const u=new lK(this,o,t,i);return this._bindAction(u,c),this._addInactiveAction(u,a,s),u}existingAction(e,t){const i=t||this._root,r=i.uuid,s="string"==typeof e?rd.findByName(i,e):e,a=this._actionsByClip[s?s.uuid:e];return void 0!==a&&a.actionByRoot[r]||null}stopAllAction(){const e=this._actions;for(let i=this._nActiveActions-1;i>=0;--i)e[i].stop();return this}update(e){const t=this._actions,i=this._nActiveActions,r=this.time+=e*=this.timeScale,s=Math.sign(e),o=this._accuIndex^=1;for(let c=0;c!==i;++c)t[c]._update(r,e,s,o);const a=this._bindings,l=this._nActiveBindings;for(let c=0;c!==l;++c)a[c].apply(o);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,i=e.uuid,r=this._actionsByClip,s=r[i];if(void 0!==s){const o=s.knownActions;for(let a=0,l=o.length;a!==l;++a){const c=o[a];this._deactivateAction(c);const u=c._cacheIndex,d=t[t.length-1];c._cacheIndex=null,c._byClipCacheIndex=null,d._cacheIndex=u,t[u]=d,t.pop(),this._removeInactiveBindingsForAction(c)}delete r[i]}}uncacheRoot(e){const t=e.uuid,i=this._actionsByClip;for(const o in i){const l=i[o].actionByRoot[t];void 0!==l&&(this._deactivateAction(l),this._removeInactiveAction(l))}const s=this._bindingsByRootAndName[t];if(void 0!==s)for(const o in s){const a=s[o];a.restoreOriginalState(),this._removeInactiveBinding(a)}}uncacheAction(e,t){const i=this.existingAction(e,t);null!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}}class mL{constructor(e=1,t=0,i=0){return this.radius=e,this.phi=t,this.theta=i,this}set(e,t,i){return this.radius=e,this.phi=t,this.theta=i,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,i){return this.radius=Math.sqrt(e*e+t*t+i*i),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(en(t/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"154"}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__="154");const EL={type:"change"},Hb={type:"start"},AL={type:"end"};class zb extends Fs{constructor(e,t){super(),this.object=e,this.domElement=t,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new T,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:0,MIDDLE:1,RIGHT:2},this.touches={ONE:0,TWO:2},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return a.phi},this.getAzimuthalAngle=function(){return a.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(P){P.addEventListener("keydown",Ke),this._domElementKeyEvents=P},this.stopListenToKeyEvents=function(){this._domElementKeyEvents.removeEventListener("keydown",Ke),this._domElementKeyEvents=null},this.saveState=function(){i.target0.copy(i.target),i.position0.copy(i.object.position),i.zoom0=i.object.zoom},this.reset=function(){i.target.copy(i.target0),i.object.position.copy(i.position0),i.object.zoom=i.zoom0,i.object.updateProjectionMatrix(),i.dispatchEvent(EL),i.update(),s=r.NONE},this.update=function(){const P=new T,oe=(new tn).setFromUnitVectors(e.up,new T(0,1,0)),le=oe.clone().invert(),z=new T,Le=new tn,Ve=new T,ke=2*Math.PI;return function(){const Ie=i.object.position;P.copy(Ie).sub(i.target),P.applyQuaternion(oe),a.setFromVector3(P),i.autoRotate&&s===r.NONE&&x(function C(){return 2*Math.PI/60/60*i.autoRotateSpeed}()),i.enableDamping?(a.theta+=l.theta*i.dampingFactor,a.phi+=l.phi*i.dampingFactor):(a.theta+=l.theta,a.phi+=l.phi);let Je=i.minAzimuthAngle,bt=i.maxAzimuthAngle;return isFinite(Je)&&isFinite(bt)&&(Je<-Math.PI?Je+=ke:Je>Math.PI&&(Je-=ke),bt<-Math.PI?bt+=ke:bt>Math.PI&&(bt-=ke),a.theta=Je<=bt?Math.max(Je,Math.min(bt,a.theta)):a.theta>(Je+bt)/2?Math.max(Je,a.theta):Math.min(bt,a.theta)),a.phi=Math.max(i.minPolarAngle,Math.min(i.maxPolarAngle,a.phi)),a.makeSafe(),a.radius*=c,a.radius=Math.max(i.minDistance,Math.min(i.maxDistance,a.radius)),!0===i.enableDamping?i.target.addScaledVector(u,i.dampingFactor):i.target.add(u),P.setFromSpherical(a),P.applyQuaternion(le),Ie.copy(i.target).add(P),i.object.lookAt(i.target),!0===i.enableDamping?(l.theta*=1-i.dampingFactor,l.phi*=1-i.dampingFactor,u.multiplyScalar(1-i.dampingFactor)):(l.set(0,0,0),u.set(0,0,0)),c=1,!!(d||z.distanceToSquared(i.object.position)>o||8*(1-Le.dot(i.object.quaternion))>o||Ve.distanceToSquared(i.target)>0)&&(i.dispatchEvent(EL),z.copy(i.object.position),Le.copy(i.object.quaternion),Ve.copy(i.target),d=!1,!0)}}(),this.dispose=function(){i.domElement.removeEventListener("contextmenu",R),i.domElement.removeEventListener("pointerdown",ee),i.domElement.removeEventListener("pointercancel",se),i.domElement.removeEventListener("wheel",Re),i.domElement.removeEventListener("pointermove",de),i.domElement.removeEventListener("pointerup",se),null!==i._domElementKeyEvents&&(i._domElementKeyEvents.removeEventListener("keydown",Ke),i._domElementKeyEvents=null)};const i=this,r={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let s=r.NONE;const o=1e-6,a=new mL,l=new mL;let c=1;const u=new T;let d=!1;const h=new K,f=new K,p=new K,_=new K,g=new K,m=new K,v=new K,y=new K,b=new K,w=[],S={};function I(){return Math.pow(.95,i.zoomSpeed)}function x(P){l.theta-=P}function E(P){l.phi-=P}const B=function(){const P=new T;return function(le,z){P.setFromMatrixColumn(z,0),P.multiplyScalar(-le),u.add(P)}}(),Y=function(){const P=new T;return function(le,z){!0===i.screenSpacePanning?P.setFromMatrixColumn(z,1):(P.setFromMatrixColumn(z,0),P.crossVectors(i.object.up,P)),P.multiplyScalar(le),u.add(P)}}(),N=function(){const P=new T;return function(le,z){const Le=i.domElement;if(i.object.isPerspectiveCamera){P.copy(i.object.position).sub(i.target);let ke=P.length();ke*=Math.tan(i.object.fov/2*Math.PI/180),B(2*le*ke/Le.clientHeight,i.object.matrix),Y(2*z*ke/Le.clientHeight,i.object.matrix)}else i.object.isOrthographicCamera?(B(le*(i.object.right-i.object.left)/i.object.zoom/Le.clientWidth,i.object.matrix),Y(z*(i.object.top-i.object.bottom)/i.object.zoom/Le.clientHeight,i.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),i.enablePan=!1)}}();function F(P){i.object.isPerspectiveCamera?c/=P:i.object.isOrthographicCamera?(i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom*P)),i.object.updateProjectionMatrix(),d=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function H(P){i.object.isPerspectiveCamera?c*=P:i.object.isOrthographicCamera?(i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/P)),i.object.updateProjectionMatrix(),d=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function ne(P){h.set(P.clientX,P.clientY)}function Q(P){_.set(P.clientX,P.clientY)}function me(){1===w.length?h.set(w[0].pageX,w[0].pageY):h.set(.5*(w[0].pageX+w[1].pageX),.5*(w[0].pageY+w[1].pageY))}function ve(){1===w.length?_.set(w[0].pageX,w[0].pageY):_.set(.5*(w[0].pageX+w[1].pageX),.5*(w[0].pageY+w[1].pageY))}function Te(){const P=w[0].pageX-w[1].pageX,oe=w[0].pageY-w[1].pageY,le=Math.sqrt(P*P+oe*oe);v.set(0,le)}function yt(P){if(1==w.length)f.set(P.pageX,P.pageY);else{const le=ce(P);f.set(.5*(P.pageX+le.x),.5*(P.pageY+le.y))}p.subVectors(f,h).multiplyScalar(i.rotateSpeed);const oe=i.domElement;x(2*Math.PI*p.x/oe.clientHeight),E(2*Math.PI*p.y/oe.clientHeight),h.copy(f)}function St(P){if(1===w.length)g.set(P.pageX,P.pageY);else{const oe=ce(P);g.set(.5*(P.pageX+oe.x),.5*(P.pageY+oe.y))}m.subVectors(g,_).multiplyScalar(i.panSpeed),N(m.x,m.y),_.copy(g)}function ze(P){const oe=ce(P),le=P.pageX-oe.x,z=P.pageY-oe.y,Le=Math.sqrt(le*le+z*z);y.set(0,Le),b.set(0,Math.pow(y.y/v.y,i.zoomSpeed)),F(b.y),v.copy(y)}function ee(P){!1!==i.enabled&&(0===w.length&&(i.domElement.setPointerCapture(P.pointerId),i.domElement.addEventListener("pointermove",de),i.domElement.addEventListener("pointerup",se)),function M(P){w.push(P)}(P),"touch"===P.pointerType?function _t(P){switch(ue(P),w.length){case 1:switch(i.touches.ONE){case 0:if(!1===i.enableRotate)return;me(),s=r.TOUCH_ROTATE;break;case 1:if(!1===i.enablePan)return;ve(),s=r.TOUCH_PAN;break;default:s=r.NONE}break;case 2:switch(i.touches.TWO){case 2:if(!1===i.enableZoom&&!1===i.enablePan)return;(function Ue(){i.enableZoom&&Te(),i.enablePan&&ve()})(),s=r.TOUCH_DOLLY_PAN;break;case 3:if(!1===i.enableZoom&&!1===i.enableRotate)return;(function Fe(){i.enableZoom&&Te(),i.enableRotate&&me()})(),s=r.TOUCH_DOLLY_ROTATE;break;default:s=r.NONE}break;default:s=r.NONE}s!==r.NONE&&i.dispatchEvent(Hb)}(P):function Be(P){let oe;switch(P.button){case 0:oe=i.mouseButtons.LEFT;break;case 1:oe=i.mouseButtons.MIDDLE;break;case 2:oe=i.mouseButtons.RIGHT;break;default:oe=-1}switch(oe){case 1:if(!1===i.enableZoom)return;(function X(P){v.set(P.clientX,P.clientY)})(P),s=r.DOLLY;break;case 0:if(P.ctrlKey||P.metaKey||P.shiftKey){if(!1===i.enablePan)return;Q(P),s=r.PAN}else{if(!1===i.enableRotate)return;ne(P),s=r.ROTATE}break;case 2:if(P.ctrlKey||P.metaKey||P.shiftKey){if(!1===i.enableRotate)return;ne(P),s=r.ROTATE}else{if(!1===i.enablePan)return;Q(P),s=r.PAN}break;default:s=r.NONE}s!==r.NONE&&i.dispatchEvent(Hb)}(P))}function de(P){!1!==i.enabled&&("touch"===P.pointerType?function Wt(P){switch(ue(P),s){case r.TOUCH_ROTATE:if(!1===i.enableRotate)return;yt(P),i.update();break;case r.TOUCH_PAN:if(!1===i.enablePan)return;St(P),i.update();break;case r.TOUCH_DOLLY_PAN:if(!1===i.enableZoom&&!1===i.enablePan)return;(function L(P){i.enableZoom&&ze(P),i.enablePan&&St(P)})(P),i.update();break;case r.TOUCH_DOLLY_ROTATE:if(!1===i.enableZoom&&!1===i.enableRotate)return;(function pe(P){i.enableZoom&&ze(P),i.enableRotate&&yt(P)})(P),i.update();break;default:s=r.NONE}}(P):function Ae(P){switch(s){case r.ROTATE:if(!1===i.enableRotate)return;!function re(P){f.set(P.clientX,P.clientY),p.subVectors(f,h).multiplyScalar(i.rotateSpeed);const oe=i.domElement;x(2*Math.PI*p.x/oe.clientHeight),E(2*Math.PI*p.y/oe.clientHeight),h.copy(f),i.update()}(P);break;case r.DOLLY:if(!1===i.enableZoom)return;!function ae(P){y.set(P.clientX,P.clientY),b.subVectors(y,v),b.y>0?F(I()):b.y<0&&H(I()),v.copy(y),i.update()}(P);break;case r.PAN:if(!1===i.enablePan)return;!function U(P){g.set(P.clientX,P.clientY),m.subVectors(g,_).multiplyScalar(i.panSpeed),N(m.x,m.y),_.copy(g),i.update()}(P)}}(P))}function se(P){(function j(P){delete S[P.pointerId];for(let oe=0;oe<w.length;oe++)if(w[oe].pointerId==P.pointerId)return void w.splice(oe,1)})(P),0===w.length&&(i.domElement.releasePointerCapture(P.pointerId),i.domElement.removeEventListener("pointermove",de),i.domElement.removeEventListener("pointerup",se)),i.dispatchEvent(AL),s=r.NONE}function Re(P){!1===i.enabled||!1===i.enableZoom||s!==r.NONE||(P.preventDefault(),i.dispatchEvent(Hb),function J(P){P.deltaY<0?H(I()):P.deltaY>0&&F(I()),i.update()}(P),i.dispatchEvent(AL))}function Ke(P){!1===i.enabled||!1===i.enablePan||function fe(P){let oe=!1;switch(P.code){case i.keys.UP:P.ctrlKey||P.metaKey||P.shiftKey?E(2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):N(0,i.keyPanSpeed),oe=!0;break;case i.keys.BOTTOM:P.ctrlKey||P.metaKey||P.shiftKey?E(-2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):N(0,-i.keyPanSpeed),oe=!0;break;case i.keys.LEFT:P.ctrlKey||P.metaKey||P.shiftKey?x(2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):N(i.keyPanSpeed,0),oe=!0;break;case i.keys.RIGHT:P.ctrlKey||P.metaKey||P.shiftKey?x(-2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):N(-i.keyPanSpeed,0),oe=!0}oe&&(P.preventDefault(),i.update())}(P)}function R(P){!1!==i.enabled&&P.preventDefault()}function ue(P){let oe=S[P.pointerId];void 0===oe&&(oe=new K,S[P.pointerId]=oe),oe.set(P.pageX,P.pageY)}function ce(P){return S[(P.pointerId===w[0].pointerId?w[1]:w[0]).pointerId]}i.domElement.addEventListener("contextmenu",R),i.domElement.addEventListener("pointerdown",ee),i.domElement.addEventListener("pointercancel",se),i.domElement.addEventListener("wheel",Re,{passive:!1}),this.update()}}var Zl=new WeakMap,Gb=new WeakMap,Kl=new WeakMap,ad=new WeakMap;class pK extends kr{constructor(){super(...arguments),Ye(this,Zl,{writable:!0,value:void 0}),Ye(this,Gb,{writable:!0,value:void 0}),Ye(this,Kl,{writable:!0,value:void 0}),Ye(this,ad,{writable:!0,value:void 0}),this.name="laser",this.order=3,He(this,Zl,[]),He(this,Gb,.2),He(this,ad,!0)}shoot(){if(W(this,ad)){if(this.parent){W(this,Kl)||(He(this,Kl,new Pn(new rm(.4,.05,2,20),new bi({color:65280}))),this.parent.add(W(this,Kl)));const e=new Pn(new td(.3,3,3),new bi({color:65318}));W(this,Zl).push(e),this.parent.add(e)}He(this,ad,!1),function fK(n,e=1){setTimeout(n,1e3*e)}(()=>He(this,ad,!0),W(this,Gb))}}update(e,t){W(this,Kl)&&W(this,Kl).position.set(0,0,10);for(let s=W(this,Zl).length-1;s>=0;s--){const o=W(this,Zl)[s],a=1e3*t,l=new T(0,0,1).applyQuaternion(o.quaternion);o.position.addScaledVector(l,a),o.position.z>200&&(this.parent&&this.parent.remove(o),W(this,Zl).splice(s,1))}}}var Zo=new WeakMap,Vr=new WeakMap,Ko=new WeakMap,hr=new WeakMap,HL=new WeakMap,zL=new WeakMap;class PK{get connected(){return"running"===W(this,hr)?.context.state}constructor(){var t,e=this;Ye(this,Zo,{writable:!0,value:1}),Ye(this,Vr,{writable:!0,value:void 0}),Ye(this,Ko,{writable:!0,value:void 0}),Ye(this,hr,{writable:!0,value:void 0}),Ye(this,HL,{writable:!0,value:(t=sp(function*(i){return W(e,Ko).decodeAudioData(i).then(r=>{const s=W(e,Ko).createBufferSource();return s.buffer=r,s})}),function(r){return t.apply(this,arguments)})}),Ye(this,zL,{writable:!0,value:function(){var t=sp(function*(i){return fetch(i).then(r=>r.arrayBuffer())});return function(r){return t.apply(this,arguments)}}()})}connect(e){He(this,Zo,1),He(this,Ko,new AudioContext),He(this,Vr,W(this,Ko).createGain()),W(this,zL).call(this,e).then(W(this,HL)).then(t=>{He(this,hr,t),W(this,hr).loop=!0,W(this,hr).connect(W(this,Vr)),W(this,Vr).connect(W(this,Ko).destination),W(this,hr).start()})}setGain(e){He(this,Zo,e)}update(){W(this,Vr)&&(W(this,Vr).gain.value<=W(this,Zo)&&(W(this,Vr).gain.value+=.02),W(this,Vr).gain.value>=W(this,Zo)&&(W(this,Vr).gain.value-=.02),W(this,hr)&&(W(this,hr).playbackRate.value=2*W(this,Vr).gain.value))}pause(){He(this,Zo,0)}unPause(){He(this,Zo,1)}destroy(){W(this,hr)&&(W(this,hr).stop(),W(this,hr).disconnect()),W(this,Ko).close()}}class GL extends kr{constructor(){super(...arguments),this.initialized=!1}}function WL(n,e){if(0===e)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),n;if(2===e||1===e){let t=n.getIndex();if(null===t){const o=[],a=n.getAttribute("position");if(void 0===a)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),n;for(let l=0;l<a.count;l++)o.push(l);n.setIndex(o),t=n.getIndex()}const i=t.count-2,r=[];if(2===e)for(let o=1;o<=i;o++)r.push(t.getX(0)),r.push(t.getX(o)),r.push(t.getX(o+1));else for(let o=0;o<i;o++)o%2==0?(r.push(t.getX(o)),r.push(t.getX(o+1)),r.push(t.getX(o+2))):(r.push(t.getX(o+2)),r.push(t.getX(o+1)),r.push(t.getX(o)));r.length/3!==i&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=n.clone();return s.setIndex(r),s.clearGroups(),s}return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),n}class OK extends Yl{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new BK(t)}),this.register(function(t){return new XK(t)}),this.register(function(t){return new qK(t)}),this.register(function(t){return new YK(t)}),this.register(function(t){return new HK(t)}),this.register(function(t){return new zK(t)}),this.register(function(t){return new GK(t)}),this.register(function(t){return new WK(t)}),this.register(function(t){return new UK(t)}),this.register(function(t){return new jK(t)}),this.register(function(t){return new VK(t)}),this.register(function(t){return new $K(t)}),this.register(function(t){return new FK(t)}),this.register(function(t){return new ZK(t)}),this.register(function(t){return new KK(t)})}load(e,t,i,r){const s=this;let o;o=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:od.extractUrlBase(e),this.manager.itemStart(e);const a=function(c){r?r(c):console.error(c),s.manager.itemError(e),s.manager.itemEnd(e)},l=new $i(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(c){try{s.parse(c,o,function(u){t(u),s.manager.itemEnd(e)},a)}catch(u){a(u)}},i,a)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,i,r){let s;const o={},a={},l=new TextDecoder;if("string"==typeof e)s=JSON.parse(e);else if(e instanceof ArrayBuffer)if(l.decode(new Uint8Array(e,0,4))===jL){try{o[xt.KHR_BINARY_GLTF]=new JK(e)}catch(d){return void(r&&r(d))}s=JSON.parse(o[xt.KHR_BINARY_GLTF].content)}else s=JSON.parse(l.decode(e));else s=e;if(void 0===s.asset||s.asset.version[0]<2)return void(r&&r(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.")));const c=new dJ(s,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});c.fileLoader.setRequestHeader(this.requestHeader);for(let u=0;u<this.pluginCallbacks.length;u++){const d=this.pluginCallbacks[u](c);a[d.name]=d,o[d.name]=!0}if(s.extensionsUsed)for(let u=0;u<s.extensionsUsed.length;++u){const d=s.extensionsUsed[u],h=s.extensionsRequired||[];switch(d){case xt.KHR_MATERIALS_UNLIT:o[d]=new kK;break;case xt.KHR_DRACO_MESH_COMPRESSION:o[d]=new QK(s,this.dracoLoader);break;case xt.KHR_TEXTURE_TRANSFORM:o[d]=new eJ;break;case xt.KHR_MESH_QUANTIZATION:o[d]=new tJ;break;default:h.indexOf(d)>=0&&void 0===a[d]&&console.warn('THREE.GLTFLoader: Unknown extension "'+d+'".')}}c.setExtensions(o),c.setPlugins(a),c.parse(i,r)}parseAsync(e,t){const i=this;return new Promise(function(r,s){i.parse(e,t,r,s)})}}function NK(){let n={};return{get:function(e){return n[e]},add:function(e,t){n[e]=t},remove:function(e){delete n[e]},removeAll:function(){n={}}}}const xt={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class FK{constructor(e){this.parser=e,this.name=xt.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let i=0,r=t.length;i<r;i++){const s=t[i];s.extensions&&s.extensions[this.name]&&void 0!==s.extensions[this.name].light&&e._addNodeRef(this.cache,s.extensions[this.name].light)}}_loadLight(e){const t=this.parser,i="light:"+e;let r=t.cache.get(i);if(r)return r;const s=t.json,l=((s.extensions&&s.extensions[this.name]||{}).lights||[])[e];let c;const u=new be(16777215);void 0!==l.color&&u.fromArray(l.color);const d=void 0!==l.range?l.range:0;switch(l.type){case"directional":c=new Lb(u),c.target.position.set(0,0,-1),c.add(c.target);break;case"point":c=new rL(u),c.distance=d;break;case"spot":c=new Ib(u),c.distance=d,l.spot=l.spot||{},l.spot.innerConeAngle=void 0!==l.spot.innerConeAngle?l.spot.innerConeAngle:0,l.spot.outerConeAngle=void 0!==l.spot.outerConeAngle?l.spot.outerConeAngle:Math.PI/4,c.angle=l.spot.outerConeAngle,c.penumbra=1-l.spot.innerConeAngle/l.spot.outerConeAngle,c.target.position.set(0,0,-1),c.add(c.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+l.type)}return c.position.set(0,0,0),c.decay=2,Ws(c,l),void 0!==l.intensity&&(c.intensity=l.intensity),c.name=t.createUniqueName(l.name||"light_"+e),r=Promise.resolve(c),t.cache.add(i,r),r}getDependency(e,t){if("light"===e)return this._loadLight(t)}createNodeAttachment(e){const t=this,i=this.parser,s=i.json.nodes[e],a=(s.extensions&&s.extensions[this.name]||{}).light;return void 0===a?null:this._loadLight(a).then(function(l){return i._getNodeRef(t.cache,a,l)})}}class kK{constructor(){this.name=xt.KHR_MATERIALS_UNLIT}getMaterialType(){return bi}extendParams(e,t,i){const r=[];e.color=new be(1,1,1),e.opacity=1;const s=t.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){const o=s.baseColorFactor;e.color.fromArray(o),e.opacity=o[3]}void 0!==s.baseColorTexture&&r.push(i.assignTexture(e,"map",s.baseColorTexture,Ze))}return Promise.all(r)}}class UK{constructor(e){this.parser=e,this.name=xt.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name].emissiveStrength;return void 0!==s&&(t.emissiveIntensity=s),Promise.resolve()}}class BK{constructor(e){this.parser=e,this.name=xt.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?ys:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];if(void 0!==o.clearcoatFactor&&(t.clearcoat=o.clearcoatFactor),void 0!==o.clearcoatTexture&&s.push(i.assignTexture(t,"clearcoatMap",o.clearcoatTexture)),void 0!==o.clearcoatRoughnessFactor&&(t.clearcoatRoughness=o.clearcoatRoughnessFactor),void 0!==o.clearcoatRoughnessTexture&&s.push(i.assignTexture(t,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),void 0!==o.clearcoatNormalTexture&&(s.push(i.assignTexture(t,"clearcoatNormalMap",o.clearcoatNormalTexture)),void 0!==o.clearcoatNormalTexture.scale)){const a=o.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new K(a,a)}return Promise.all(s)}}class VK{constructor(e){this.parser=e,this.name=xt.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?ys:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return void 0!==o.iridescenceFactor&&(t.iridescence=o.iridescenceFactor),void 0!==o.iridescenceTexture&&s.push(i.assignTexture(t,"iridescenceMap",o.iridescenceTexture)),void 0!==o.iridescenceIor&&(t.iridescenceIOR=o.iridescenceIor),void 0===t.iridescenceThicknessRange&&(t.iridescenceThicknessRange=[100,400]),void 0!==o.iridescenceThicknessMinimum&&(t.iridescenceThicknessRange[0]=o.iridescenceThicknessMinimum),void 0!==o.iridescenceThicknessMaximum&&(t.iridescenceThicknessRange[1]=o.iridescenceThicknessMaximum),void 0!==o.iridescenceThicknessTexture&&s.push(i.assignTexture(t,"iridescenceThicknessMap",o.iridescenceThicknessTexture)),Promise.all(s)}}class HK{constructor(e){this.parser=e,this.name=xt.KHR_MATERIALS_SHEEN}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?ys:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[];t.sheenColor=new be(0,0,0),t.sheenRoughness=0,t.sheen=1;const o=r.extensions[this.name];return void 0!==o.sheenColorFactor&&t.sheenColor.fromArray(o.sheenColorFactor),void 0!==o.sheenRoughnessFactor&&(t.sheenRoughness=o.sheenRoughnessFactor),void 0!==o.sheenColorTexture&&s.push(i.assignTexture(t,"sheenColorMap",o.sheenColorTexture,Ze)),void 0!==o.sheenRoughnessTexture&&s.push(i.assignTexture(t,"sheenRoughnessMap",o.sheenRoughnessTexture)),Promise.all(s)}}class zK{constructor(e){this.parser=e,this.name=xt.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?ys:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return void 0!==o.transmissionFactor&&(t.transmission=o.transmissionFactor),void 0!==o.transmissionTexture&&s.push(i.assignTexture(t,"transmissionMap",o.transmissionTexture)),Promise.all(s)}}class GK{constructor(e){this.parser=e,this.name=xt.KHR_MATERIALS_VOLUME}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?ys:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];t.thickness=void 0!==o.thicknessFactor?o.thicknessFactor:0,void 0!==o.thicknessTexture&&s.push(i.assignTexture(t,"thicknessMap",o.thicknessTexture)),t.attenuationDistance=o.attenuationDistance||1/0;const a=o.attenuationColor||[1,1,1];return t.attenuationColor=new be(a[0],a[1],a[2]),Promise.all(s)}}class WK{constructor(e){this.parser=e,this.name=xt.KHR_MATERIALS_IOR}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?ys:null}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name];return t.ior=void 0!==s.ior?s.ior:1.5,Promise.resolve()}}class jK{constructor(e){this.parser=e,this.name=xt.KHR_MATERIALS_SPECULAR}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?ys:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];t.specularIntensity=void 0!==o.specularFactor?o.specularFactor:1,void 0!==o.specularTexture&&s.push(i.assignTexture(t,"specularIntensityMap",o.specularTexture));const a=o.specularColorFactor||[1,1,1];return t.specularColor=new be(a[0],a[1],a[2]),void 0!==o.specularColorTexture&&s.push(i.assignTexture(t,"specularColorMap",o.specularColorTexture,Ze)),Promise.all(s)}}class $K{constructor(e){this.parser=e,this.name=xt.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?ys:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return void 0!==o.anisotropyStrength&&(t.anisotropy=o.anisotropyStrength),void 0!==o.anisotropyRotation&&(t.anisotropyRotation=o.anisotropyRotation),void 0!==o.anisotropyTexture&&s.push(i.assignTexture(t,"anisotropyMap",o.anisotropyTexture)),Promise.all(s)}}class XK{constructor(e){this.parser=e,this.name=xt.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,i=t.json,r=i.textures[e];if(!r.extensions||!r.extensions[this.name])return null;const s=r.extensions[this.name],o=t.options.ktx2Loader;if(!o){if(i.extensionsRequired&&i.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,s.source,o)}}class qK{constructor(e){this.parser=e,this.name=xt.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,i=this.parser,r=i.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;const o=s.extensions[t],a=r.images[o.source];let l=i.textureLoader;if(a.uri){const c=i.options.manager.getHandler(a.uri);null!==c&&(l=c)}return this.detectSupport().then(function(c){if(c)return i.loadTextureImage(e,o.source,l);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}}class YK{constructor(e){this.parser=e,this.name=xt.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const t=this.name,i=this.parser,r=i.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;const o=s.extensions[t],a=r.images[o.source];let l=i.textureLoader;if(a.uri){const c=i.options.manager.getHandler(a.uri);null!==c&&(l=c)}return this.detectSupport().then(function(c){if(c)return i.loadTextureImage(e,o.source,l);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}}class ZK{constructor(e){this.name=xt.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,i=t.bufferViews[e];if(i.extensions&&i.extensions[this.name]){const r=i.extensions[this.name],s=this.parser.getDependency("buffer",r.buffer),o=this.parser.options.meshoptDecoder;if(!o||!o.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return s.then(function(a){const u=r.count,d=r.byteStride,h=new Uint8Array(a,r.byteOffset||0,r.byteLength||0);return o.decodeGltfBufferAsync?o.decodeGltfBufferAsync(u,d,h,r.mode,r.filter).then(function(f){return f.buffer}):o.ready.then(function(){const f=new ArrayBuffer(u*d);return o.decodeGltfBuffer(new Uint8Array(f),u,d,h,r.mode,r.filter),f})})}return null}}class KK{constructor(e){this.name=xt.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,i=t.nodes[e];if(!i.extensions||!i.extensions[this.name]||void 0===i.mesh)return null;const r=t.meshes[i.mesh];for(const c of r.primitives)if(c.mode!==Xi.TRIANGLES&&c.mode!==Xi.TRIANGLE_STRIP&&c.mode!==Xi.TRIANGLE_FAN&&void 0!==c.mode)return null;const o=i.extensions[this.name].attributes,a=[],l={};for(const c in o)a.push(this.parser.getDependency("accessor",o[c]).then(u=>(l[c]=u,l[c])));return a.length<1?null:(a.push(this.parser.createNodeMesh(e)),Promise.all(a).then(c=>{const u=c.pop(),d=u.isGroup?u.children:[u],h=c[0].count,f=[];for(const p of d){const _=new et,g=new T,m=new tn,v=new T(1,1,1),y=new CP(p.geometry,p.material,h);for(let b=0;b<h;b++)l.TRANSLATION&&g.fromBufferAttribute(l.TRANSLATION,b),l.ROTATION&&m.fromBufferAttribute(l.ROTATION,b),l.SCALE&&v.fromBufferAttribute(l.SCALE,b),y.setMatrixAt(b,_.compose(g,m,v));for(const b in l)"TRANSLATION"!==b&&"ROTATION"!==b&&"SCALE"!==b&&p.geometry.setAttribute(b,l[b]);Rn.prototype.copy.call(y,p),this.parser.assignFinalMaterial(y),f.push(y)}return u.isGroup?(u.clear(),u.add(...f),u):f[0]}))}}const jL="glTF";class JK{constructor(e){this.name=xt.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,12),i=new TextDecoder;if(this.header={magic:i.decode(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==jL)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const r=this.header.length-12,s=new DataView(e,12);let o=0;for(;o<r;){const a=s.getUint32(o,!0);o+=4;const l=s.getUint32(o,!0);if(o+=4,1313821514===l){const c=new Uint8Array(e,12+o,a);this.content=i.decode(c)}else if(5130562===l){const c=12+o;this.body=e.slice(c,c+a)}o+=a}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class QK{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=xt.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const i=this.json,r=this.dracoLoader,s=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,a={},l={},c={};for(const u in o){const d=Kb[u]||u.toLowerCase();a[d]=o[u]}for(const u in e.attributes){const d=Kb[u]||u.toLowerCase();if(void 0!==o[u]){const h=i.accessors[e.attributes[u]];c[d]=tc[h.componentType].name,l[d]=!0===h.normalized}}return t.getDependency("bufferView",s).then(function(u){return new Promise(function(d){r.decodeDracoFile(u,function(h){for(const f in h.attributes){const _=l[f];void 0!==_&&(h.attributes[f].normalized=_)}d(h)},a,c)})})}}class eJ{constructor(){this.name=xt.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(void 0===t.texCoord||t.texCoord===e.channel)&&void 0===t.offset&&void 0===t.rotation&&void 0===t.scale||(e=e.clone(),void 0!==t.texCoord&&(e.channel=t.texCoord),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class tJ{constructor(){this.name=xt.KHR_MESH_QUANTIZATION}}class XL extends nd{constructor(e,t,i,r){super(e,t,i,r)}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r*3+r;for(let o=0;o!==r;o++)t[o]=i[s+o];return t}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=2*a,c=3*a,u=r-t,d=(i-t)/u,h=d*d,f=h*d,p=e*c,_=p-c,g=-2*f+3*h,m=f-h,v=1-g,y=m-h+d;for(let b=0;b!==a;b++)s[b]=v*o[_+b+a]+y*(o[_+b+l]*u)+g*o[p+b+a]+m*(o[p+b]*u);return s}}const nJ=new tn;class iJ extends XL{interpolate_(e,t,i,r){const s=super.interpolate_(e,t,i,r);return nJ.fromArray(s).normalize().toArray(s),s}}const Xi={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},tc={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},qL={9728:dn,9729:Qt,9984:1004,9985:1007,9986:1005,9987:ls},YL={33071:$n,33648:1002,10497:So},Zb={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Kb={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},Gs={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},rJ={CUBICSPLINE:void 0,LINEAR:ul,STEP:Ru};function Jo(n,e,t){for(const i in t.extensions)void 0===n[i]&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[i]=t.extensions[i])}function Ws(n,e){void 0!==e.extras&&("object"==typeof e.extras?Object.assign(n.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function aJ(n,e){if(n.updateMorphTargets(),void 0!==e.weights)for(let t=0,i=e.weights.length;t<i;t++)n.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(n.morphTargetInfluences.length===t.length){n.morphTargetDictionary={};for(let i=0,r=t.length;i<r;i++)n.morphTargetDictionary[t[i]]=i}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function lJ(n){let e;const t=n.extensions&&n.extensions[xt.KHR_DRACO_MESH_COMPRESSION];if(e=t?"draco:"+t.bufferView+":"+t.indices+":"+Qb(t.attributes):n.indices+":"+Qb(n.attributes)+":"+n.mode,void 0!==n.targets)for(let i=0,r=n.targets.length;i<r;i++)e+=":"+Qb(n.targets[i]);return e}function Qb(n){let e="";const t=Object.keys(n).sort();for(let i=0,r=t.length;i<r;i++)e+=t[i]+":"+n[t[i]]+";";return e}function ew(n){switch(n){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}const uJ=new et;class dJ{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new NK,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let i=!1,r=!1,s=-1;typeof navigator<"u"&&(i=!0===/^((?!chrome|android).)*safari/i.test(navigator.userAgent),r=navigator.userAgent.indexOf("Firefox")>-1,s=r?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),this.textureLoader=typeof createImageBitmap>"u"||i||r&&s<98?new UZ(this.options.manager):new YZ(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new $i(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const i=this,r=this.json,s=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(o){return o._markDefs&&o._markDefs()}),Promise.all(this._invokeAll(function(o){return o.beforeRoot&&o.beforeRoot()})).then(function(){return Promise.all([i.getDependencies("scene"),i.getDependencies("animation"),i.getDependencies("camera")])}).then(function(o){const a={scene:o[0][r.scene||0],scenes:o[0],animations:o[1],cameras:o[2],asset:r.asset,parser:i,userData:{}};Jo(s,a,r),Ws(a,r),Promise.all(i._invokeAll(function(l){return l.afterRoot&&l.afterRoot(a)})).then(function(){e(a)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],i=this.json.meshes||[];for(let r=0,s=t.length;r<s;r++){const o=t[r].joints;for(let a=0,l=o.length;a<l;a++)e[o[a]].isBone=!0}for(let r=0,s=e.length;r<s;r++){const o=e[r];void 0!==o.mesh&&(this._addNodeRef(this.meshCache,o.mesh),void 0!==o.skin&&(i[o.mesh].isSkinnedMesh=!0)),void 0!==o.camera&&this._addNodeRef(this.cameraCache,o.camera)}}_addNodeRef(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,i){if(e.refs[t]<=1)return i;const r=i.clone(),s=(o,a)=>{const l=this.associations.get(o);null!=l&&this.associations.set(a,l);for(const[c,u]of o.children.entries())s(u,a.children[c])};return s(i,r),r.name+="_instance_"+e.uses[t]++,r}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let i=0;i<t.length;i++){const r=e(t[i]);if(r)return r}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const i=[];for(let r=0;r<t.length;r++){const s=e(t[r]);s&&i.push(s)}return i}getDependency(e,t){const i=e+":"+t;let r=this.cache.get(i);if(!r){switch(e){case"scene":r=this.loadScene(t);break;case"node":r=this._invokeOne(function(s){return s.loadNode&&s.loadNode(t)});break;case"mesh":r=this._invokeOne(function(s){return s.loadMesh&&s.loadMesh(t)});break;case"accessor":r=this.loadAccessor(t);break;case"bufferView":r=this._invokeOne(function(s){return s.loadBufferView&&s.loadBufferView(t)});break;case"buffer":r=this.loadBuffer(t);break;case"material":r=this._invokeOne(function(s){return s.loadMaterial&&s.loadMaterial(t)});break;case"texture":r=this._invokeOne(function(s){return s.loadTexture&&s.loadTexture(t)});break;case"skin":r=this.loadSkin(t);break;case"animation":r=this._invokeOne(function(s){return s.loadAnimation&&s.loadAnimation(t)});break;case"camera":r=this.loadCamera(t);break;default:if(r=this._invokeOne(function(s){return s!=this&&s.getDependency&&s.getDependency(e,t)}),!r)throw new Error("Unknown type: "+e)}this.cache.add(i,r)}return r}getDependencies(e){let t=this.cache.get(e);if(!t){const i=this;t=Promise.all((this.json[e+("mesh"===e?"es":"s")]||[]).map(function(s,o){return i.getDependency(e,o)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],i=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[xt.KHR_BINARY_GLTF].body);const r=this.options;return new Promise(function(s,o){i.load(od.resolveURL(t.uri,r.path),s,void 0,function(){o(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(i){const s=t.byteOffset||0;return i.slice(s,s+(t.byteLength||0))})}loadAccessor(e){const t=this,i=this.json,r=this.json.accessors[e];if(void 0===r.bufferView&&void 0===r.sparse){const o=Zb[r.type],l=!0===r.normalized,c=new(0,tc[r.componentType])(r.count*o);return Promise.resolve(new Gt(c,o,l))}const s=[];return s.push(void 0!==r.bufferView?this.getDependency("bufferView",r.bufferView):null),void 0!==r.sparse&&(s.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(s).then(function(o){const a=o[0],l=Zb[r.type],c=tc[r.componentType],u=c.BYTES_PER_ELEMENT,h=r.byteOffset||0,f=void 0!==r.bufferView?i.bufferViews[r.bufferView].byteStride:void 0,p=!0===r.normalized;let _,g;if(f&&f!==u*l){const m=Math.floor(h/f),v="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+m+":"+r.count;let y=t.cache.get(v);y||(_=new c(a,m*f,r.count*f/u),y=new Z0(_,f/u),t.cache.add(v,y)),g=new Uo(y,l,h%f/u,p)}else _=null===a?new c(r.count*l):new c(a,h,r.count*l),g=new Gt(_,l,p);if(void 0!==r.sparse){const b=r.sparse.values.byteOffset||0,w=new(0,tc[r.sparse.indices.componentType])(o[1],r.sparse.indices.byteOffset||0,r.sparse.count*Zb.SCALAR),S=new c(o[2],b,r.sparse.count*l);null!==a&&(g=new Gt(g.array.slice(),g.itemSize,g.normalized));for(let C=0,I=w.length;C<I;C++){const x=w[C];if(g.setX(x,S[C*l]),l>=2&&g.setY(x,S[C*l+1]),l>=3&&g.setZ(x,S[C*l+2]),l>=4&&g.setW(x,S[C*l+3]),l>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return g})}loadTexture(e){const t=this.json,s=t.textures[e].source,o=t.images[s];let a=this.textureLoader;if(o.uri){const l=this.options.manager.getHandler(o.uri);null!==l&&(a=l)}return this.loadTextureImage(e,s,a)}loadTextureImage(e,t,i){const r=this,s=this.json,o=s.textures[e],a=s.images[t],l=(a.uri||a.bufferView)+":"+o.sampler;if(this.textureCache[l])return this.textureCache[l];const c=this.loadImageSource(t,i).then(function(u){u.flipY=!1,u.name=o.name||a.name||"",""===u.name&&"string"==typeof a.uri&&!1===a.uri.startsWith("data:image/")&&(u.name=a.uri);const h=(s.samplers||{})[o.sampler]||{};return u.magFilter=qL[h.magFilter]||Qt,u.minFilter=qL[h.minFilter]||ls,u.wrapS=YL[h.wrapS]||So,u.wrapT=YL[h.wrapT]||So,r.associations.set(u,{textures:e}),u}).catch(function(){return null});return this.textureCache[l]=c,c}loadImageSource(e,t){const r=this.json,s=this.options;if(void 0!==this.sourceCache[e])return this.sourceCache[e].then(d=>d.clone());const o=r.images[e],a=self.URL||self.webkitURL;let l=o.uri||"",c=!1;if(void 0!==o.bufferView)l=this.getDependency("bufferView",o.bufferView).then(function(d){c=!0;const h=new Blob([d],{type:o.mimeType});return l=a.createObjectURL(h),l});else if(void 0===o.uri)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const u=Promise.resolve(l).then(function(d){return new Promise(function(h,f){let p=h;!0===t.isImageBitmapLoader&&(p=function(_){const g=new or(_);g.needsUpdate=!0,h(g)}),t.load(od.resolveURL(d,s.path),p,void 0,f)})}).then(function(d){return!0===c&&a.revokeObjectURL(l),d.userData.mimeType=o.mimeType||function cJ(n){return n.search(/\.jpe?g($|\?)/i)>0||0===n.search(/^data\:image\/jpeg/)?"image/jpeg":n.search(/\.webp($|\?)/i)>0||0===n.search(/^data\:image\/webp/)?"image/webp":"image/png"}(o.uri),d}).catch(function(d){throw console.error("THREE.GLTFLoader: Couldn't load texture",l),d});return this.sourceCache[e]=u,u}assignTexture(e,t,i,r){const s=this;return this.getDependency("texture",i.index).then(function(o){if(!o)return null;if(void 0!==i.texCoord&&i.texCoord>0&&((o=o.clone()).channel=i.texCoord),s.extensions[xt.KHR_TEXTURE_TRANSFORM]){const a=void 0!==i.extensions?i.extensions[xt.KHR_TEXTURE_TRANSFORM]:void 0;if(a){const l=s.associations.get(o);o=s.extensions[xt.KHR_TEXTURE_TRANSFORM].extendTexture(o,a),s.associations.set(o,l)}}return void 0!==r&&(o.colorSpace=r),e[t]=o,o})}assignFinalMaterial(e){const t=e.geometry;let i=e.material;const r=void 0===t.attributes.tangent,s=void 0!==t.attributes.color,o=void 0===t.attributes.normal;if(e.isPoints){const a="PointsMaterial:"+i.uuid;let l=this.cache.get(a);l||(l=new ib,ur.prototype.copy.call(l,i),l.color.copy(i.color),l.map=i.map,l.sizeAttenuation=!1,this.cache.add(a,l)),i=l}else if(e.isLine){const a="LineBasicMaterial:"+i.uuid;let l=this.cache.get(a);l||(l=new xi,ur.prototype.copy.call(l,i),l.color.copy(i.color),l.map=i.map,this.cache.add(a,l)),i=l}if(r||s||o){let a="ClonedMaterial:"+i.uuid+":";r&&(a+="derivative-tangents:"),s&&(a+="vertex-colors:"),o&&(a+="flat-shading:");let l=this.cache.get(a);l||(l=i.clone(),s&&(l.vertexColors=!0),o&&(l.flatShading=!0),r&&(l.normalScale&&(l.normalScale.y*=-1),l.clearcoatNormalScale&&(l.clearcoatNormalScale.y*=-1)),this.cache.add(a,l),this.associations.set(l,this.associations.get(i))),i=l}e.material=i}getMaterialType(){return sm}loadMaterial(e){const t=this,r=this.extensions,s=this.json.materials[e];let o;const a={},c=[];if((s.extensions||{})[xt.KHR_MATERIALS_UNLIT]){const d=r[xt.KHR_MATERIALS_UNLIT];o=d.getMaterialType(),c.push(d.extendParams(a,s,t))}else{const d=s.pbrMetallicRoughness||{};if(a.color=new be(1,1,1),a.opacity=1,Array.isArray(d.baseColorFactor)){const h=d.baseColorFactor;a.color.fromArray(h),a.opacity=h[3]}void 0!==d.baseColorTexture&&c.push(t.assignTexture(a,"map",d.baseColorTexture,Ze)),a.metalness=void 0!==d.metallicFactor?d.metallicFactor:1,a.roughness=void 0!==d.roughnessFactor?d.roughnessFactor:1,void 0!==d.metallicRoughnessTexture&&(c.push(t.assignTexture(a,"metalnessMap",d.metallicRoughnessTexture)),c.push(t.assignTexture(a,"roughnessMap",d.metallicRoughnessTexture))),o=this._invokeOne(function(h){return h.getMaterialType&&h.getMaterialType(e)}),c.push(Promise.all(this._invokeAll(function(h){return h.extendMaterialParams&&h.extendMaterialParams(e,a)})))}!0===s.doubleSided&&(a.side=2);const u=s.alphaMode||"OPAQUE";if("BLEND"===u?(a.transparent=!0,a.depthWrite=!1):(a.transparent=!1,"MASK"===u&&(a.alphaTest=void 0!==s.alphaCutoff?s.alphaCutoff:.5)),void 0!==s.normalTexture&&o!==bi&&(c.push(t.assignTexture(a,"normalMap",s.normalTexture)),a.normalScale=new K(1,1),void 0!==s.normalTexture.scale)){const d=s.normalTexture.scale;a.normalScale.set(d,d)}return void 0!==s.occlusionTexture&&o!==bi&&(c.push(t.assignTexture(a,"aoMap",s.occlusionTexture)),void 0!==s.occlusionTexture.strength&&(a.aoMapIntensity=s.occlusionTexture.strength)),void 0!==s.emissiveFactor&&o!==bi&&(a.emissive=(new be).fromArray(s.emissiveFactor)),void 0!==s.emissiveTexture&&o!==bi&&c.push(t.assignTexture(a,"emissiveMap",s.emissiveTexture,Ze)),Promise.all(c).then(function(){const d=new o(a);return s.name&&(d.name=s.name),Ws(d,s),t.associations.set(d,{materials:e}),s.extensions&&Jo(r,d,s),d})}createUniqueName(e){const t=Bt.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){const t=this,i=this.extensions,r=this.primitiveCache;function s(a){return i[xt.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(a,t).then(function(l){return ZL(l,a,t)})}const o=[];for(let a=0,l=e.length;a<l;a++){const c=e[a],u=lJ(c),d=r[u];if(d)o.push(d.promise);else{let h;h=c.extensions&&c.extensions[xt.KHR_DRACO_MESH_COMPRESSION]?s(c):ZL(new pt,c,t),r[u]={primitive:c,promise:h},o.push(h)}}return Promise.all(o)}loadMesh(e){const t=this,r=this.extensions,s=this.json.meshes[e],o=s.primitives,a=[];for(let l=0,c=o.length;l<c;l++){const u=void 0===o[l].material?(void 0===(n=this.cache).DefaultMaterial&&(n.DefaultMaterial=new sm({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:0})),n.DefaultMaterial):this.getDependency("material",o[l].material);a.push(u)}var n;return a.push(t.loadGeometries(o)),Promise.all(a).then(function(l){const c=l.slice(0,l.length-1),u=l[l.length-1],d=[];for(let f=0,p=u.length;f<p;f++){const _=u[f],g=o[f];let m;const v=c[f];if(g.mode===Xi.TRIANGLES||g.mode===Xi.TRIANGLE_STRIP||g.mode===Xi.TRIANGLE_FAN||void 0===g.mode)m=!0===s.isSkinnedMesh?new SP(_,v):new Pn(_,v),!0===m.isSkinnedMesh&&m.normalizeSkinWeights(),g.mode===Xi.TRIANGLE_STRIP?m.geometry=WL(m.geometry,1):g.mode===Xi.TRIANGLE_FAN&&(m.geometry=WL(m.geometry,2));else if(g.mode===Xi.LINES)m=new nb(_,v);else if(g.mode===Xi.LINE_STRIP)m=new Bo(_,v);else if(g.mode===Xi.LINE_LOOP)m=new LP(_,v);else{if(g.mode!==Xi.POINTS)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+g.mode);m=new NP(_,v)}Object.keys(m.geometry.morphAttributes).length>0&&aJ(m,s),m.name=t.createUniqueName(s.name||"mesh_"+e),Ws(m,s),g.extensions&&Jo(r,m,g),t.assignFinalMaterial(m),d.push(m)}for(let f=0,p=d.length;f<p;f++)t.associations.set(d[f],{meshes:e,primitives:f});if(1===d.length)return s.extensions&&Jo(r,d[0],s),d[0];const h=new kr;s.extensions&&Jo(r,h,s),t.associations.set(h,{meshes:e});for(let f=0,p=d.length;f<p;f++)h.add(d[f]);return h})}loadCamera(e){let t;const i=this.json.cameras[e],r=i[i.type];if(r)return"perspective"===i.type?t=new hn(lX_radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):"orthographic"===i.type&&(t=new Np(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),i.name&&(t.name=this.createUniqueName(i.name)),Ws(t,i),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")}loadSkin(e){const t=this.json.skins[e],i=[];for(let r=0,s=t.joints.length;r<s;r++)i.push(this._loadNodeShallow(t.joints[r]));return i.push(void 0!==t.inverseBindMatrices?this.getDependency("accessor",t.inverseBindMatrices):null),Promise.all(i).then(function(r){const s=r.pop(),o=r,a=[],l=[];for(let c=0,u=o.length;c<u;c++){const d=o[c];if(d){a.push(d);const h=new et;null!==s&&h.fromArray(s.array,16*c),l.push(h)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[c])}return new Gp(a,l)})}loadAnimation(e){const i=this,r=this.json.animations[e],s=r.name?r.name:"animation_"+e,o=[],a=[],l=[],c=[],u=[];for(let d=0,h=r.channels.length;d<h;d++){const f=r.channels[d],p=r.samplers[f.sampler],_=f.target,m=void 0!==r.parameters?r.parameters[p.input]:p.input,v=void 0!==r.parameters?r.parameters[p.output]:p.output;void 0!==_.node&&(o.push(this.getDependency("node",_.node)),a.push(this.getDependency("accessor",m)),l.push(this.getDependency("accessor",v)),c.push(p),u.push(_))}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(l),Promise.all(c),Promise.all(u)]).then(function(d){const h=d[0],f=d[1],p=d[2],_=d[3],g=d[4],m=[];for(let v=0,y=h.length;v<y;v++){const b=h[v],w=f[v],S=p[v],C=_[v],I=g[v];if(void 0===b)continue;b.updateMatrix&&(b.updateMatrix(),b.matrixAutoUpdate=!0);const x=i._createAnimationTracks(b,w,S,C,I);if(x)for(let E=0;E<x.length;E++)m.push(x[E])}return new rd(s,void 0,m)})}createNodeMesh(e){const i=this,r=this.json.nodes[e];return void 0===r.mesh?null:i.getDependency("mesh",r.mesh).then(function(s){const o=i._getNodeRef(i.meshCache,r.mesh,s);return void 0!==r.weights&&o.traverse(function(a){if(a.isMesh)for(let l=0,c=r.weights.length;l<c;l++)a.morphTargetInfluences[l]=r.weights[l]}),o})}loadNode(e){const i=this,r=this.json.nodes[e],s=i._loadNodeShallow(e),o=[],a=r.children||[];for(let c=0,u=a.length;c<u;c++)o.push(i.getDependency("node",a[c]));const l=void 0===r.skin?Promise.resolve(null):i.getDependency("skin",r.skin);return Promise.all([s,Promise.all(o),l]).then(function(c){const u=c[0],d=c[1],h=c[2];null!==h&&u.traverse(function(f){f.isSkinnedMesh&&f.bind(h,uJ)});for(let f=0,p=d.length;f<p;f++)u.add(d[f]);return u})}_loadNodeShallow(e){const i=this.extensions,r=this;if(void 0!==this.nodeCache[e])return this.nodeCache[e];const s=this.json.nodes[e],o=s.name?r.createUniqueName(s.name):"",a=[],l=r._invokeOne(function(c){return c.createNodeMesh&&c.createNodeMesh(e)});return l&&a.push(l),void 0!==s.camera&&a.push(r.getDependency("camera",s.camera).then(function(c){return r._getNodeRef(r.cameraCache,s.camera,c)})),r._invokeAll(function(c){return c.createNodeAttachment&&c.createNodeAttachment(e)}).forEach(function(c){a.push(c)}),this.nodeCache[e]=Promise.all(a).then(function(c){let u;if(u=!0===s.isBone?new eb:c.length>1?new kr:1===c.length?c[0]:new Rn,u!==c[0])for(let d=0,h=c.length;d<h;d++)u.add(c[d]);if(s.name&&(u.userData.name=s.name,u.name=o),Ws(u,s),s.extensions&&Jo(i,u,s),void 0!==s.matrix){const d=new et;d.fromArray(s.matrix),u.applyMatrix4(d)}else void 0!==s.translation&&u.position.fromArray(s.translation),void 0!==s.rotation&&u.quaternion.fromArray(s.rotation),void 0!==s.scale&&u.scale.fromArray(s.scale);return r.associations.has(u)||r.associations.set(u,{}),r.associations.get(u).nodes=e,u}),this.nodeCache[e]}loadScene(e){const t=this.extensions,i=this.json.scenes[e],r=this,s=new kr;i.name&&(s.name=r.createUniqueName(i.name)),Ws(s,i),i.extensions&&Jo(t,s,i);const o=i.nodes||[],a=[];for(let l=0,c=o.length;l<c;l++)a.push(r.getDependency("node",o[l]));return Promise.all(a).then(function(l){for(let u=0,d=l.length;u<d;u++)s.add(l[u]);return r.associations=(u=>{const d=new Map;for(const[h,f]of r.associations)(h instanceof ur||h instanceof or)&&d.set(h,f);return u.traverse(h=>{const f=r.associations.get(h);null!=f&&d.set(h,f)}),d})(s),s})}_createAnimationTracks(e,t,i,r,s){const o=[],a=e.name?e.name:e.uuid,l=[];let c;switch(Gs[s.path]===Gs.weights?e.traverse(function(h){h.morphTargetInfluences&&l.push(h.name?h.name:h.uuid)}):l.push(a),Gs[s.path]){case Gs.weights:c=$l;break;case Gs.rotation:c=Go;break;default:switch(i.itemSize){case 1:c=$l;break;case 2:case 3:c=id}}const u=void 0!==r.interpolation?rJ[r.interpolation]:ul,d=this._getArrayFromAccessor(i);for(let h=0,f=l.length;h<f;h++){const p=new c(l[h]+"."+Gs[s.path],t.array,d,u);"CUBICSPLINE"===u&&this._createCubicSplineTrackInterpolant(p),o.push(p)}return o}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){const i=ew(t.constructor),r=new Float32Array(t.length);for(let s=0,o=t.length;s<o;s++)r[s]=t[s]*i;t=r}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(i){return new(this instanceof Go?iJ:XL)(this.times,this.values,this.getValueSize()/3,i)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function ZL(n,e,t){const i=e.attributes,r=[];function s(o,a){return t.getDependency("accessor",o).then(function(l){n.setAttribute(a,l)})}for(const o in i){const a=Kb[o]||o.toLowerCase();a in n.attributes||r.push(s(i[o],a))}if(void 0!==e.indices&&!n.index){const o=t.getDependency("accessor",e.indices).then(function(a){n.setIndex(a)});r.push(o)}return Ws(n,e),function hJ(n,e,t){const i=e.attributes,r=new Nr;if(void 0===i.POSITION)return;{const a=t.json.accessors[i.POSITION],l=a.min,c=a.max;if(void 0===l||void 0===c)return void console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");if(r.set(new T(l[0],l[1],l[2]),new T(c[0],c[1],c[2])),a.normalized){const u=ew(tc[a.componentType]);r.min.multiplyScalar(u),r.max.multiplyScalar(u)}}const s=e.targets;if(void 0!==s){const a=new T,l=new T;for(let c=0,u=s.length;c<u;c++){const d=s[c];if(void 0!==d.POSITION){const h=t.json.accessors[d.POSITION],f=h.min,p=h.max;if(void 0!==f&&void 0!==p){if(l.setX(Math.max(Math.abs(f[0]),Math.abs(p[0]))),l.setY(Math.max(Math.abs(f[1]),Math.abs(p[1]))),l.setZ(Math.max(Math.abs(f[2]),Math.abs(p[2]))),h.normalized){const _=ew(tc[h.componentType]);l.multiplyScalar(_)}a.max(l)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}r.expandByVector(a)}n.boundingBox=r;const o=new ar;r.getCenter(o.center),o.radius=r.min.distanceTo(r.max)/2,n.boundingSphere=o}(n,e,t),Promise.all(r).then(function(){return void 0!==e.targets?function oJ(n,e,t){let i=!1,r=!1,s=!1;for(let c=0,u=e.length;c<u;c++){const d=e[c];if(void 0!==d.POSITION&&(i=!0),void 0!==d.NORMAL&&(r=!0),void 0!==d.COLOR_0&&(s=!0),i&&r&&s)break}if(!i&&!r&&!s)return Promise.resolve(n);const o=[],a=[],l=[];for(let c=0,u=e.length;c<u;c++){const d=e[c];if(i){const h=void 0!==d.POSITION?t.getDependency("accessor",d.POSITION):n.attributes.position;o.push(h)}if(r){const h=void 0!==d.NORMAL?t.getDependency("accessor",d.NORMAL):n.attributes.normal;a.push(h)}if(s){const h=void 0!==d.COLOR_0?t.getDependency("accessor",d.COLOR_0):n.attributes.color;l.push(h)}}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(l)]).then(function(c){const d=c[1],h=c[2];return i&&(n.morphAttributes.position=c[0]),r&&(n.morphAttributes.normal=d),s&&(n.morphAttributes.color=h),n.morphTargetsRelative=!0,n})}(n,e.targets,t):n})}const tw=new WeakMap;function pJ(){let n,e;function r(o,a,l,c,u,d){const h=d.num_components(),p=l.num_points()*h,_=p*u.BYTES_PER_ELEMENT,g=function s(o,a){switch(a){case Float32Array:return o.DT_FLOAT32;case Int8Array:return o.DT_INT8;case Int16Array:return o.DT_INT16;case Int32Array:return o.DT_INT32;case Uint8Array:return o.DT_UINT8;case Uint16Array:return o.DT_UINT16;case Uint32Array:return o.DT_UINT32}}(o,u),m=o._malloc(_);a.GetAttributeDataArrayForAllPoints(l,d,g,_,m);const v=new u(o.HEAPF32.buffer,m,p).slice();return o._free(m),{name:c,array:v,itemSize:h}}onmessage=function(o){const a=o.data;switch(a.type){case"init":n=a.decoderConfig,e=new Promise(function(u){n.onModuleLoaded=function(d){u({draco:d})},DracoDecoderModule(n)});break;case"decode":const l=a.buffer,c=a.taskConfig;e.then(u=>{const d=u.draco,h=new d.Decoder;try{const f=function t(o,a,l,c){const u=c.attributeIDs,d=c.attributeTypes;let h,f;const p=a.GetEncodedGeometryType(l);if(p===o.TRIANGULAR_MESH)h=new o.Mesh,f=a.DecodeArrayToMesh(l,l.byteLength,h);else{if(p!==o.POINT_CLOUD)throw new Error("THREE.DRACOLoader: Unexpected geometry type.");h=new o.PointCloud,f=a.DecodeArrayToPointCloud(l,l.byteLength,h)}if(!f.ok()||0===h.ptr)throw new Error("THREE.DRACOLoader: Decoding failed: "+f.error_msg());const _={index:null,attributes:[]};for(const g in u){const m=self[d[g]];let v,y;if(c.useUniqueIDs)y=u[g],v=a.GetAttributeByUniqueId(h,y);else{if(y=a.GetAttributeId(h,o[u[g]]),-1===y)continue;v=a.GetAttribute(h,y)}const b=r(o,a,h,g,m,v);"color"===g&&(b.vertexColorSpace=c.vertexColorSpace),_.attributes.push(b)}return p===o.TRIANGULAR_MESH&&(_.index=function i(o,a,l){const u=3*l.num_faces(),d=4*u,h=o._malloc(d);a.GetTrianglesUInt32Array(l,d,h);const f=new Uint32Array(o.HEAPF32.buffer,h,u).slice();return o._free(h),{array:f,itemSize:1}}(o,a,h)),o.destroy(h),_}(d,h,new Int8Array(l),c),p=f.attributes.map(_=>_.array.buffer);f.index&&p.push(f.index.array.buffer),self.postMessage({type:"decode",id:a.id,geometry:f},p)}catch(f){console.error(f),self.postMessage({type:"error",id:a.id,error:f.message})}finally{d.destroy(h)}})}}}const nw=Math.PI/180,gJ=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i;function KL(){const n=navigator.userAgent;return gJ.test(n)}const _J=()=>{},JL=new class fJ extends Yl{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,i,r){const s=new $i(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,o=>{this.parse(o,t,r)},i,r)}parse(e,t,i){this.decodeDracoFile(e,t,null,null,Ze).catch(i)}decodeDracoFile(e,t,i,r,s=rr){return this.decodeGeometry(e,{attributeIDs:i||this.defaultAttributeIDs,attributeTypes:r||this.defaultAttributeTypes,useUniqueIDs:!!i,vertexColorSpace:s}).then(t)}decodeGeometry(e,t){const i=JSON.stringify(t);if(tw.has(e)){const l=tw.get(e);if(l.key===i)return l.promise;if(0===e.byteLength)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let r;const s=this.workerNextTaskID++,a=this._getWorker(s,e.byteLength).then(l=>(r=l,new Promise((c,u)=>{r._callbacks[s]={resolve:c,reject:u},r.postMessage({type:"decode",id:s,taskConfig:t,buffer:e},[e])}))).then(l=>this._createGeometry(l.geometry));return a.catch(()=>!0).then(()=>{r&&s&&this._releaseTask(r,s)}),tw.set(e,{key:i,promise:a}),a}_createGeometry(e){const t=new pt;e.index&&t.setIndex(new Gt(e.index.array,1));for(let i=0;i<e.attributes.length;i++){const r=e.attributes[i],s=r.name,o=r.array,l=new Gt(o,r.itemSize);"color"===s&&(this._assignVertexColorSpace(l,r.vertexColorSpace),l.normalized=!(o instanceof Float32Array)),t.setAttribute(s,l)}return t}_assignVertexColorSpace(e,t){if(t!==Ze)return;const i=new be;for(let r=0,s=e.count;r<s;r++)i.fromBufferAttribute(e,r).convertSRGBToLinear(),e.setXYZ(r,i.r,i.g,i.b)}_loadLibrary(e,t){const i=new $i(this.manager);return i.setPath(this.decoderPath),i.setResponseType(t),i.setWithCredentials(this.withCredentials),new Promise((r,s)=>{i.load(e,r,void 0,s)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e="object"!=typeof WebAssembly||"js"===this.decoderConfig.type,t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(i=>{const r=i[0];e||(this.decoderConfig.wasmBinary=i[1]);const s=pJ.toString(),o=["/* draco decoder */",r,"","/* worker */",s.substring(s.indexOf("{")+1,s.lastIndexOf("}"))].join("\n");this.workerSourceURL=URL.createObjectURL(new Blob([o]))}),this.decoderPending}_getWorker(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const r=new Worker(this.workerSourceURL);r._callbacks={},r._taskCosts={},r._taskLoad=0,r.postMessage({type:"init",decoderConfig:this.decoderConfig}),r.onmessage=function(s){const o=s.data;switch(o.type){case"decode":r._callbacks[o.id].resolve(o);break;case"error":r._callbacks[o.id].reject(o);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+o.type+'"')}},this.workerPool.push(r)}else this.workerPool.sort(function(r,s){return r._taskLoad>s._taskLoad?-1:1});const i=this.workerPool[this.workerPool.length-1];return i._taskCosts[e]=t,i._taskLoad+=t,i})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,""!==this.workerSourceURL&&URL.revokeObjectURL(this.workerSourceURL),this}};JL.setDecoderPath("assets/js/");var iw=new WeakMap,xm=new WeakMap;class rw{constructor(e){Ye(this,iw,{writable:!0,value:void 0}),Ye(this,xm,{writable:!0,value:void 0}),this.basePath=e,He(this,iw,new zt),this.onLoaded$=W(this,iw).asObservable(),He(this,xm,new OK),W(this,xm).setDRACOLoader(JL)}load(e,t=_J){var i=this;return sp(function*(){return yield W(i,xm).loadAsync(`${i.basePath}/${e}`,t)})()}}var QL=new WeakMap,nc=new WeakMap,yd=new WeakMap,Sm=new WeakMap,Mm=new WeakMap,Em=new WeakMap,sw=new WeakMap,ow=new WeakMap,aw=new WeakSet,lw=new WeakSet,cw=new WeakSet;class uw{constructor(){Un(this,cw),Un(this,lw),Un(this,aw),Ye(this,QL,{get:vJ,set:void 0}),Ye(this,nc,{writable:!0,value:void 0}),Ye(this,yd,{writable:!0,value:void 0}),Ye(this,Sm,{writable:!0,value:void 0}),Ye(this,Mm,{writable:!0,value:void 0}),Ye(this,Em,{writable:!0,value:void 0}),Ye(this,sw,{writable:!0,value:void 0}),Ye(this,ow,{writable:!0,value:void 0}),this.key={W:0,A:0,S:0,D:0,Up:0,Left:0,Down:0,Right:0,Space:0,ShiftLeft:0,ControlLeft:0,Escape:0},this.direction={North:0,West:0,South:0,East:0,Some:0},He(this,nc,!1),He(this,yd,[]),He(this,Sm,[]),He(this,Mm,[]),this.deviceRotation=new tn,He(this,Em,[]),He(this,sw,({code:e})=>{if(qt(this,lw,tO).call(this,e)){qt(this,aw,eO).call(this,e,1);for(const t of W(this,Sm))t()}}),He(this,ow,({code:e})=>{if(qt(this,lw,tO).call(this,e)){if(!W(this,nc)){for(const t of W(this,yd))t();He(this,nc,!0)}qt(this,aw,eO).call(this,e,0);for(const t of W(this,Mm))t()}})}set onTouched(e){W(this,yd).push(e)}set onKeyDown(e){W(this,Sm).push(e)}set onKeyUp(e){W(this,Mm).push(e)}set onRotation(e){W(this,Em).push(e)}initialize(){onkeydown=W(this,sw),onkeyup=W(this,ow),KL()&&DeviceOrientationEvent&&(ondeviceorientation=e=>{const[t,i,r,s]=function mJ({alpha:n,beta:e,gamma:t}){const i=e?e*nw:0,r=t?t*nw:0,s=n?n*nw:0,o=Math.cos(i/2),a=Math.cos(r/2),l=Math.cos(s/2),c=Math.sin(i/2),u=Math.sin(r/2),d=Math.sin(s/2);return[o*a*l-c*u*d,c*a*l-o*u*d,o*u*l+c*a*d,o*a*d+c*u*l]}(e),o=this.deviceRotation.set(i,r,s,t);for(const a of W(this,Em))a(o);if(!W(this,nc)){for(const a of W(this,yd))a();He(this,nc,!0)}})}update(){this.direction.North=this.key.W||this.key.Up?1:0,this.direction.West=this.key.A||this.key.Left?1:0,this.direction.South=this.key.S||this.key.Down?1:0,this.direction.East=this.key.D||this.key.Right?1:0,this.direction.Some=Math.max(...W(this,QL))?1:0}}function vJ(){return[this.key.A,this.key.S,this.key.D,this.key.W,this.key.Left,this.key.Down,this.key.Right,this.key.Up]}function eO(n,e){this.key[qt(this,cw,nO).call(this,n)]=e}function tO(n){const e=qt(this,cw,nO).call(this,n);return Object.keys(this.key).includes(e)}function nO(n){return n.replace("Key","").replace("Arrow","")}class iO{constructor(){this.sun=new Lb(13421772,1),this.directional=new Ib(1184276,.8,7,.8,1,1),this.hemisphere=new eL(16777215,0,.9)}toArray(){return[this.sun,this.directional,this.hemisphere]}}var ic=new WeakMap,dw=new WeakMap,hw=new WeakMap,Am=new WeakMap,rc=new WeakMap,Cm=new WeakMap,sc=new WeakMap,Hr=new WeakMap,oc=new WeakMap,bd=new WeakMap,rO=new WeakSet,sO=new WeakSet,oO=new WeakSet,aO=new WeakSet,Tm=new WeakSet,lO=new WeakSet,cO=new WeakSet,uO=new WeakSet,dO=new WeakSet,hO=new WeakSet,fw=new WeakSet,fO=new WeakSet,pO=new WeakSet;class mO extends GL{constructor(e,t){super(),Un(this,pO),Un(this,fO),Un(this,fw),Un(this,hO),Un(this,dO),Un(this,uO),Un(this,cO),Un(this,lO),Un(this,Tm),Un(this,aO),Un(this,oO),Un(this,sO),Un(this,rO),Ye(this,ic,{writable:!0,value:void 0}),Ye(this,dw,{writable:!0,value:void 0}),Ye(this,hw,{writable:!0,value:void 0}),Ye(this,Am,{writable:!0,value:void 0}),Ye(this,rc,{writable:!0,value:void 0}),Ye(this,Cm,{writable:!0,value:void 0}),Ye(this,sc,{writable:!0,value:void 0}),Ye(this,Hr,{writable:!0,value:void 0}),Ye(this,oc,{writable:!0,value:void 0}),Ye(this,bd,{writable:!0,value:void 0}),this.input=e,this.loader=t,this.name="spaceship",this.order=2,He(this,ic,1.2),He(this,dw,4),He(this,hw,1),He(this,Am,.6),He(this,rc,.02),He(this,Cm,new T(0,1,0)),He(this,sc,new tn),He(this,Hr,new PK),He(this,bd,[]),this.actions={}}initialize(){this.initialized||(console.log("initialize"),this.loader.load("spaceship.glb").then(({scene:e,animations:t})=>{this.add(e),this.position.set(0,0,0),He(this,oc,new uK(e));for(const i of t)W(this,bd).push(W(this,oc).clipAction(i));qt(this,pO,DJ).call(this,.3),this.input.onTouched=()=>{W(this,Hr).connected||W(this,Hr).connect("assets/audio/engine-01.wav")},this.input.onRotation=i=>{W(this,sc).copy(i)},this.initialized=!0}))}pause(){W(this,Hr).pause()}unPause(){W(this,Hr).unPause()}update(e,t){qt(this,rO,yJ).call(this),W(this,Hr).connected&&qt(this,fw,gO).call(this,W(this,ic)),KL()&&qt(this,hO,CJ).call(this,Math.min(4+t,1)),W(this,oc)&&t&&W(this,oc).update(t*W(this,ic))}}function yJ(){this.input.key.A&&qt(this,uO,EJ).call(this,W(this,rc)),this.input.key.D&&qt(this,dO,AJ).call(this,W(this,rc)),this.input.key.W&&qt(this,cO,MJ).call(this,W(this,rc)),this.input.key.S&&qt(this,lO,SJ).call(this,W(this,rc)),this.input.key.Space?qt(this,sO,bJ).call(this):this.input.key.ShiftLeft||qt(this,oO,wJ).call(this),this.input.key.ShiftLeft&&qt(this,aO,xJ).call(this,W(this,ic))}function bJ(){W(this,Hr).setGain(.4),qt(this,Tm,pw).call(this,.2),qt(this,fO,TJ).call(this,W(this,ic))}function wJ(){qt(this,Tm,pw).call(this,.6),W(this,Hr).setGain(.6)}function xJ(n=0){W(this,Hr).setGain(1),qt(this,Tm,pw).call(this,1),qt(this,fw,gO).call(this,n)}function pw(n){if(W(this,oc))for(const e of W(this,bd))e.setEffectiveWeight(n),e.setEffectiveWeight(n)}function SJ(n){this.rotateX(-n)}function MJ(n){this.rotateX(n)}function EJ(n){const e=(new tn).setFromAxisAngle(W(this,Cm),n);W(this,sc).multiply(e),this.rotateZ(-n)}function AJ(n){const e=(new tn).setFromAxisAngle(W(this,Cm),-n);W(this,sc).multiply(e),this.rotateZ(n)}function CJ(n){const e=new tn;e.slerpQuaternions(this.quaternion,W(this,sc),n),this.quaternion.copy(e)}function gO(n=0){const e=Math.min(n+W(this,Am),W(this,dw)),t=new T(0,0,-1).applyQuaternion(this.quaternion);this.position.addScaledVector(t,-e)}function TJ(n=0){const e=Math.max(n-W(this,Am),W(this,hw)),t=new T(0,0,-1).applyQuaternion(this.quaternion);this.position.addScaledVector(t,e)}function DJ(n){W(this,bd).forEach(e=>{e.enabled=!0,e.setEffectiveWeight(1),e.setEffectiveWeight(n),e.play()})}class _O extends GL{constructor(e){super(),this.loader=e,this.name="station"}initialize(){this.initialized||this.loader.load("station.glb").then(({scene:e})=>{this.position.set(0,0,0),this.add(e)})}}var wd=function(){var n=0,e=document.createElement("div");function t(u){return e.appendChild(u.dom),u}function i(u){for(var d=0;d<e.children.length;d++)e.children[d].style.display=d===u?"block":"none";n=u}e.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",e.addEventListener("click",function(u){u.preventDefault(),i(++n%e.children.length)},!1);var r=(performance||Date).now(),s=r,o=0,a=t(new wd.Panel("FPS","#0ff","#002")),l=t(new wd.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var c=t(new wd.Panel("MB","#f08","#201"));return i(0),{REVISION:16,dom:e,addPanel:t,showPanel:i,begin:function(){r=(performance||Date).now()},end:function(){o++;var u=(performance||Date).now();if(l.update(u-r,200),u>=s+1e3&&(a.update(1e3*o/(u-s),100),s=u,o=0,c)){var d=performance.memory;c.update(d.usedJSHeapSize/1048576,d.jsHeapSizeLimit/1048576)}return u},update:function(){r=this.end()},domElement:e,setMode:i}};wd.Panel=function(n,e,t){var i=1/0,r=0,s=Math.round,o=s(window.devicePixelRatio||1),a=80*o,l=48*o,c=3*o,u=2*o,d=3*o,h=15*o,f=74*o,p=30*o,_=document.createElement("canvas");_.width=a,_.height=l,_.style.cssText="width:80px;height:48px";var g=_.getContext("2d");return g.font="bold "+9*o+"px Helvetica,Arial,sans-serif",g.textBaseline="top",g.fillStyle=t,g.fillRect(0,0,a,l),g.fillStyle=e,g.fillText(n,c,u),g.fillRect(d,h,f,p),g.fillStyle=t,g.globalAlpha=.9,g.fillRect(d,h,f,p),{dom:_,update:function(m,v){i=Math.min(i,m),r=Math.max(r,m),g.fillStyle=t,g.globalAlpha=1,g.fillRect(0,0,a,h),g.fillStyle=e,g.fillText(s(m)+" "+n+" ("+s(i)+"-"+s(r)+")",c,u),g.drawImage(_,d+o,h,f-o,p,d,h,f-o,p),g.fillRect(d+f-o,h,o,p),g.fillStyle=t,g.globalAlpha=.9,g.fillRect(d+f-o,h,o,s((1-m/v)*p))}}};const RJ=wd,IJ=[{path:"",component:(()=>{var n=new WeakMap,e=new WeakMap;class t{constructor(){Ye(this,n,{writable:!0,value:_e(Hf)}),Ye(this,e,{writable:!0,value:_e(vi)})}ngOnInit(){const{closed:r}=W(this,n).open({message:"Spaceship",options:[{label:"Play",value:"play"},{label:"Settings",value:"settings"}]});r.subscribe(s=>{s&&"play"===s.value&&W(this,e).navigate(["game"])})}}return t.\u0275fac=function(r){return new(r||t)},t.\u0275cmp=qs({type:t,selectors:[["game-home"]],decls:0,vars:0,template:function(r,s){},encapsulation:2,changeDetection:0}),t})()},{path:"game",component:(()=>{var n=new WeakMap,e=new WeakMap,t=new WeakMap,i=new WeakMap,r=new WeakMap,s=new WeakMap,o=new WeakMap,a=new WeakMap,l=new WeakMap,c=new WeakMap,u=new WeakMap,d=new WeakMap,h=new WeakMap,f=new WeakMap,p=new WeakMap;class _{get element(){return this.elRef.nativeElement}constructor(){Ye(this,n,{writable:!0,value:void 0}),Ye(this,e,{writable:!0,value:void 0}),Ye(this,t,{writable:!0,value:void 0}),Ye(this,i,{writable:!0,value:void 0}),Ye(this,r,{writable:!0,value:void 0}),Ye(this,s,{writable:!0,value:void 0}),Ye(this,o,{writable:!0,value:void 0}),Ye(this,a,{writable:!0,value:void 0}),Ye(this,l,{writable:!0,value:void 0}),Ye(this,c,{writable:!0,value:void 0}),Ye(this,u,{writable:!0,value:void 0}),Ye(this,d,{writable:!0,value:void 0}),Ye(this,h,{writable:!0,value:void 0}),Ye(this,f,{writable:!0,value:void 0}),Ye(this,p,{writable:!0,value:void 0}),He(this,n,_e(Y0)),He(this,e,_e(Nb)),He(this,t,_e(Hu)),He(this,i,_e(zb)),He(this,r,_e(hn)),He(this,s,_e(iO)),He(this,o,_e(uw)),He(this,a,_e(mO)),He(this,l,_e(_O)),He(this,c,_e(Hf)),He(this,u,_e(vi)),He(this,d,new RJ),He(this,h,!1),this.elRef=_e(mi),He(this,f,m=>{if(requestAnimationFrame(W(this,f)),!W(this,h)){W(this,o).update();const v=W(this,e).getDelta();W(this,a).update(m,v),W(this,i).target=W(this,a).position}W(this,i).update(),W(this,d).update(),W(this,t).render(W(this,n),W(this,r))}),He(this,p,()=>{const{innerHeight:m,innerWidth:v}=window;W(this,t).setSize(v,m),W(this,r).aspect=v/m,W(this,r).updateProjectionMatrix()})}ngOnInit(){this.element.append(W(this,t).domElement,W(this,d).dom),W(this,i).maxDistance=60,W(this,i).minDistance=30,W(this,r).position.set(4,5,20),W(this,i).update(),W(this,n).add(W(this,l),W(this,a)),W(this,n).add(...W(this,s).toArray()),W(this,o).initialize(),W(this,a).initialize(),W(this,l).initialize(),onresize=W(this,p),W(this,p).call(this),W(this,f).call(this,1),W(this,o).onKeyDown=()=>{if(W(this,o).key.Escape){let m=[{label:"Quit",value:"quit"},{label:"Cancel",value:"cancel"}];W(this,h)?m.push({label:"Play",value:"play"}):m.push({label:"Pause",value:"pause"}),m=m.reverse();const{closed:v}=W(this,c).open({options:m});He(this,h,!0),v.pipe(Rr(1)).subscribe(y=>{He(this,h,!1),y&&("quit"===y.value&&W(this,u).navigate(["/"]),"pause"===y.value&&(He(this,h,!0),W(this,a).pause()),"play"===y.value&&He(this,h,!1))})}}}}return _.\u0275fac=function(m){return new(m||_)},_.\u0275cmp=qs({type:_,selectors:[["game-canvas"]],decls:0,vars:0,template:function(m,v){},encapsulation:2,changeDetection:0}),_})()}];class PJ{static forRoot(){return[Y0,Nb,iO,uw,pK,{provide:"loader.path",useValue:"assets/models"},{provide:rw,deps:["loader.path"]},{provide:mO,deps:[uw,rw]},{provide:_O,deps:[rw]},{provide:Hf,deps:[Ey]},{provide:hn,useFactory:()=>new hn(45,innerWidth/innerHeight,10,1e7)},{provide:Hu,useFactory:()=>{const e=new Hu({antialias:!0});return e.setPixelRatio(devicePixelRatio),e.setClearColor(1184276,1),e}},{provide:zb,useFactory:(e,t)=>new zb(e,t.domElement),deps:[hn,Hu]}]}}let LJ=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=qs({type:n,selectors:[["game-root"]],decls:1,vars:0,template:function(t,i){1&t&&Wh(0,"router-outlet")},dependencies:[$y],encapsulation:2}),n})(),OJ=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=li({type:n,bootstrap:[LJ]}),n.\u0275inj=Yn({providers:[PJ.forRoot()],imports:[a4,bR,z$.forRoot(IJ,{initialNavigation:"enabledBlocking"})]}),n})();s4().bootstrapModule(OJ).catch(n=>console.error(n))}},wt=>{wt(wt.s=116)}]);